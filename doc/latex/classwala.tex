\hypertarget{classwala}{\section{wala Class Reference}
\label{classwala}\index{wala@{wala}}
}


Wang-\/\-Landau biasing class.  




{\ttfamily \#include $<$bias.\-h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classwala_a1a4483327eb3527ecc114c075b0b0598}{wala} ()
\item 
\hyperlink{classwala_ac0d2f33ee8226fb4306628a750ed0d14}{wala} (const double \hyperlink{classwala_acb8e59580d97bc3c5b9b4ff45eb6bb9a}{ln\-F}, const double g, const double s, const int Nmax, const int Nmin, const int Mtot, const std\-::vector$<$ double $>$ box)
\begin{DoxyCompactList}\small\item\em Wang-\/\-Landau biasing constructor. \end{DoxyCompactList}\item 
void \hyperlink{classwala_ab439e3f60bea6c54522a870b9ad67acf}{update} (const int Nval, const int Mval)
\begin{DoxyCompactList}\small\item\em Update the estimate of the macrostate distribution. \end{DoxyCompactList}\item 
void \hyperlink{classwala_ae06c2f1475702ec9d1b0a243b7f34e4b}{iterate\-Forward} ()
\begin{DoxyCompactList}\small\item\em This should only be called when the \char`\"{}flatness\char`\"{} criterion is met. \end{DoxyCompactList}\item 
void \hyperlink{classwala_a65569289fac85d0da9c336e17c9d809a}{print} (const std\-::string file\-Name, const bool print\-H=false)
\begin{DoxyCompactList}\small\item\em Print the U\-N-\/\-N\-O\-R\-M\-A\-L\-I\-Z\-E\-D biasing function (ln\-P\-I) and possible the visted states histogram to files. \end{DoxyCompactList}\item 
void \hyperlink{classwala_ae04916f49c11b0636e813787a3906570}{readln\-P\-I} (const std\-::string file\-Name)
\begin{DoxyCompactList}\small\item\em Read the macrostate distribution (biasing function) from a file. \end{DoxyCompactList}\item 
void \hyperlink{classwala_a0b8df0fb2b7722fc4a458e527a478b6f}{read\-H} (const std\-::string file\-Name)
\begin{DoxyCompactList}\small\item\em Read the visited states histogram from a file. \end{DoxyCompactList}\item 
void \hyperlink{classwala_a1d778061b12611b1a35eb3ca15038d02}{setln\-P\-I} (const std\-::vector$<$ double $>$ \&ln\-P\-Iguess)
\begin{DoxyCompactList}\small\item\em Blindly assign a guess of the macrostate distribution. \end{DoxyCompactList}\item 
bool \hyperlink{classwala_add6302db96fcc45811b2944de2936525}{evaluate\-Flatness} ()
\begin{DoxyCompactList}\small\item\em Evaluate if the visited states histogram is approxiamtely \char`\"{}flat\char`\"{}. \end{DoxyCompactList}\item 
const \hyperlink{bias_8h_a1ceb524363fcb94da0c64d297ea27438}{\-\_\-\-\_\-\-B\-I\-A\-S\-\_\-\-I\-N\-T\-\_\-\-T\-Y\-P\-E\-\_\-\-\_\-} \hyperlink{classwala_a6120a0549bee60f2acabf6db132ff9d9}{get\-Address} (const int Nval, const int Mval)
\begin{DoxyCompactList}\small\item\em For multidimensional Wang-\/\-Landau biasing, get the 1\-D coordinate of the macrostate distribution estimate (bias) for multidimensional data. \end{DoxyCompactList}\item 
const double \hyperlink{classwala_acb8e59580d97bc3c5b9b4ff45eb6bb9a}{ln\-F} ()
\item 
const double \hyperlink{classwala_a03f7b333aa0a280e78060bd9af7ec318}{get\-Bias} (const int address)
\item 
const std\-::vector$<$ double $>$ \hyperlink{classwala_a80b00e34135eb6da4e81cd0935622fc5}{getln\-P\-I} ()
\begin{DoxyCompactList}\small\item\em Return the current estimate of the macrostate distribution. \end{DoxyCompactList}\item 
const std\-::vector$<$ double $>$ \hyperlink{classwala_a52cec7bdf93eec7d4eefc627b71f1f65}{get\-H} ()
\begin{DoxyCompactList}\small\item\em Return the visited-\/states histogram. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Wang-\/\-Landau biasing class. 

Definition at line 59 of file bias.\-h.



\subsection{Constructor \& Destructor Documentation}
\hypertarget{classwala_a1a4483327eb3527ecc114c075b0b0598}{\index{wala@{wala}!wala@{wala}}
\index{wala@{wala}!wala@{wala}}
\subsubsection[{wala}]{\setlength{\rightskip}{0pt plus 5cm}wala\-::wala (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classwala_a1a4483327eb3527ecc114c075b0b0598}


Definition at line 61 of file bias.\-h.


\begin{DoxyCode}
61 \{\};
\end{DoxyCode}
\hypertarget{classwala_ac0d2f33ee8226fb4306628a750ed0d14}{\index{wala@{wala}!wala@{wala}}
\index{wala@{wala}!wala@{wala}}
\subsubsection[{wala}]{\setlength{\rightskip}{0pt plus 5cm}wala\-::wala (
\begin{DoxyParamCaption}
\item[{const double}]{ln\-F, }
\item[{const double}]{g, }
\item[{const double}]{s, }
\item[{const int}]{Nmax, }
\item[{const int}]{Nmin, }
\item[{const int}]{Mtot, }
\item[{const std\-::vector$<$ double $>$}]{box}
\end{DoxyParamCaption}
)}}\label{classwala_ac0d2f33ee8226fb4306628a750ed0d14}


Wang-\/\-Landau biasing constructor. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ln\-F} & Factor by which the estimate of the density of states in updated each time it is visited. \\
\hline
\mbox{\tt in}  & {\em g} & Factor by which ln\-F is reduced (multiplied) once \char`\"{}flatness\char`\"{} has been achieved. \\
\hline
\mbox{\tt in}  & {\em s} & Factor by which the min(\-H) must be within the mean of H to be considered \char`\"{}flat\char`\"{}, e.\-g. 0.\-8 --$>$ min is within 20\% error of mean \\
\hline
\mbox{\tt in}  & {\em Nmax} & Upper bound for total number of particles. \\
\hline
\mbox{\tt in}  & {\em Nmin} & Lower bound for total number of particles. \\
\hline
\mbox{\tt in}  & {\em Mtot} & Total number of expanded ensemble states in a system. \\
\hline
\mbox{\tt in}  & {\em box} & Vector of simulation box size. \\
\hline
\end{DoxyParams}


Definition at line 407 of file bias.\-cpp.



References \-\_\-\-\_\-\-B\-I\-A\-S\-\_\-\-I\-N\-T\-\_\-\-T\-Y\-P\-E\-\_\-\-\_\-, and ln\-F().


\begin{DoxyCode}
407                                                                                                            
                                     \{
408     \textcolor{keywordflow}{if} (\hyperlink{classwala_acb8e59580d97bc3c5b9b4ff45eb6bb9a}{lnF} < 0) \{
409         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"lnF in Wang-Landau cannot be < 0"});
410     \}
411     lnF\_ = \hyperlink{classwala_acb8e59580d97bc3c5b9b4ff45eb6bb9a}{lnF};
412 
413     \textcolor{keywordflow}{if} (g <= 0 || g >= 1) \{
414         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"In Wang-Landau 0 < g < 1"});
415     \}
416     g\_ = g;
417 
418     \textcolor{keywordflow}{if} (s <= 0 || s >= 1) \{
419         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"In Wang-Landau 0 < s < 1"});
420     \}
421     s\_ = s;
422 
423     \textcolor{keywordflow}{if} (Nmin > Nmax) \{
424         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Nmin > Nmax in Wang-Landau object"});
425     \}
426 
427     \textcolor{keywordflow}{if} (Nmin < 0) \{
428         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Nmin < 0 in Wang-Landau object"});
429     \}
430 
431     \textcolor{keywordflow}{if} (Mtot < 1) \{
432         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Mtot < 1 in Wang-Landau object"});
433     \}
434     Mtot\_ = Mtot;
435 
436     \textcolor{keywordflow}{if} (box.size() != 3) \{
437         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Illegal number of box dimensions in Wang-Landau"});
438     \}
439     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < box.size(); ++i) \{
440         \textcolor{keywordflow}{if} (box[i] < 0) \{
441             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Illegal box dimensions in Wang-Landau"});
442         \}
443     \}
444     box\_.resize(3, 0);
445     box\_ = box;
446 
447     \hyperlink{bias_8h_a1ceb524363fcb94da0c64d297ea27438}{\_\_BIAS\_INT\_TYPE\_\_} size = (Nmax - Nmin + 1);
448 
449     Nmin\_ = Nmin;
450     Nmax\_ = Nmax;
451 
452     \textcolor{comment}{// attempt to allocate memory for macrostate distribution matrix and initializes it all to 0}
453     \textcolor{keywordflow}{try} \{
454         lnPI\_.resize(size*Mtot\_, 0.0);
455     \} \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} std::bad\_alloc &ce) \{
456         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory, cannot allocate space for macrostate
       distribution matrix in wala"});
457     \}
458 
459     \textcolor{comment}{// initialize the visited-states histogram}
460     \textcolor{keywordflow}{try} \{
461         H\_.resize(size*Mtot\_, 0.0);
462     \} \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} std::bad\_alloc &ce) \{
463         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory, cannot allocate space for visited-states
       histogram in wala"});
464     \}
465 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\hypertarget{classwala_add6302db96fcc45811b2944de2936525}{\index{wala@{wala}!evaluate\-Flatness@{evaluate\-Flatness}}
\index{evaluate\-Flatness@{evaluate\-Flatness}!wala@{wala}}
\subsubsection[{evaluate\-Flatness}]{\setlength{\rightskip}{0pt plus 5cm}bool wala\-::evaluate\-Flatness (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classwala_add6302db96fcc45811b2944de2936525}


Evaluate if the visited states histogram is approxiamtely \char`\"{}flat\char`\"{}. 

\begin{DoxyReturn}{Returns}
Returns whether the histogram is flat or not. 
\end{DoxyReturn}


Definition at line 497 of file bias.\-cpp.



References spec\-Exp.



Referenced by perform\-Crossover(), and perform\-W\-A\-L\-A().


\begin{DoxyCode}
497                              \{
498     \textcolor{keywordtype}{double} min = H\_[0], lnMean = -DBL\_MAX;
499     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < H\_.size() - (Mtot\_-1); ++i) \{ \textcolor{comment}{// insert routine prevents the sampling past
       N = Nmax, M = 0, so N = Nmax and M > 0 are validly empty}
500         \textcolor{keywordflow}{if} (H\_[i] < min) \{
501             min = H\_[i];
502         \}
503 
504         \textcolor{comment}{// summing so many doubles may overrun DBL\_MAX, so instead track the lnMean}
505         lnMean = \hyperlink{bias_8h_a9f1e113b6454173bd61677519ec34c3a}{specExp}(lnMean, log(H\_[i]));
506     \}
507     lnMean -= log(H\_.size() - (Mtot\_-1));
508 
509     \textcolor{keywordflow}{if} (log(min) - lnMean > log(s\_)) \{
510         \textcolor{keywordflow}{return} \textcolor{keyword}{true};
511     \}
512     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
513 \}
\end{DoxyCode}
\hypertarget{classwala_a6120a0549bee60f2acabf6db132ff9d9}{\index{wala@{wala}!get\-Address@{get\-Address}}
\index{get\-Address@{get\-Address}!wala@{wala}}
\subsubsection[{get\-Address}]{\setlength{\rightskip}{0pt plus 5cm}const {\bf \-\_\-\-\_\-\-B\-I\-A\-S\-\_\-\-I\-N\-T\-\_\-\-T\-Y\-P\-E\-\_\-\-\_\-} wala\-::get\-Address (
\begin{DoxyParamCaption}
\item[{const int}]{Nval, }
\item[{const int}]{Mval}
\end{DoxyParamCaption}
)}}\label{classwala_a6120a0549bee60f2acabf6db132ff9d9}


For multidimensional Wang-\/\-Landau biasing, get the 1\-D coordinate of the macrostate distribution estimate (bias) for multidimensional data. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Nval} & Total number of atoms in the system \\
\hline
\mbox{\tt in}  & {\em Mval} & Current value of the expanded ensemble state of the system \\
\hline
\end{DoxyParams}


Definition at line 473 of file bias.\-cpp.



Referenced by calculate\-Bias(), and update().


\begin{DoxyCode}
473                                                                         \{
474     \textcolor{keywordflow}{if} (Nval > Nmax\_ || Nval < Nmin\_ || Mval < 0 || Mval > Mtot\_-1) \{
475         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"N, M out of bounds in Wang-Landau object, cannot retrieve
       address"});
476     \}
477     \textcolor{keywordflow}{return} (Nval - Nmin\_)*Mtot\_ + Mval;
478 \}
\end{DoxyCode}
\hypertarget{classwala_a03f7b333aa0a280e78060bd9af7ec318}{\index{wala@{wala}!get\-Bias@{get\-Bias}}
\index{get\-Bias@{get\-Bias}!wala@{wala}}
\subsubsection[{get\-Bias}]{\setlength{\rightskip}{0pt plus 5cm}const double wala\-::get\-Bias (
\begin{DoxyParamCaption}
\item[{const int}]{address}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classwala_a03f7b333aa0a280e78060bd9af7ec318}


Definition at line 73 of file bias.\-h.



Referenced by calculate\-Bias().


\begin{DoxyCode}
73 \{ \textcolor{keywordflow}{return} -lnPI\_[address]; \}
\end{DoxyCode}
\hypertarget{classwala_a52cec7bdf93eec7d4eefc627b71f1f65}{\index{wala@{wala}!get\-H@{get\-H}}
\index{get\-H@{get\-H}!wala@{wala}}
\subsubsection[{get\-H}]{\setlength{\rightskip}{0pt plus 5cm}const std\-::vector$<$double$>$ wala\-::get\-H (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classwala_a52cec7bdf93eec7d4eefc627b71f1f65}


Return the visited-\/states histogram. 



Definition at line 75 of file bias.\-h.

\hypertarget{classwala_a80b00e34135eb6da4e81cd0935622fc5}{\index{wala@{wala}!getln\-P\-I@{getln\-P\-I}}
\index{getln\-P\-I@{getln\-P\-I}!wala@{wala}}
\subsubsection[{getln\-P\-I}]{\setlength{\rightskip}{0pt plus 5cm}const std\-::vector$<$double$>$ wala\-::getln\-P\-I (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classwala_a80b00e34135eb6da4e81cd0935622fc5}


Return the current estimate of the macrostate distribution. 



Definition at line 74 of file bias.\-h.

\hypertarget{classwala_ae06c2f1475702ec9d1b0a243b7f34e4b}{\index{wala@{wala}!iterate\-Forward@{iterate\-Forward}}
\index{iterate\-Forward@{iterate\-Forward}!wala@{wala}}
\subsubsection[{iterate\-Forward}]{\setlength{\rightskip}{0pt plus 5cm}void wala\-::iterate\-Forward (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classwala_ae06c2f1475702ec9d1b0a243b7f34e4b}


This should only be called when the \char`\"{}flatness\char`\"{} criterion is met. 

This then resets the visited-\/states histogram H, and decrements ln\-F. 

Definition at line 518 of file bias.\-cpp.



Referenced by perform\-Crossover(), and perform\-W\-A\-L\-A().


\begin{DoxyCode}
518                            \{
519     lnF\_ = lnF\_*g\_;
520     std::fill(H\_.begin(), H\_.end(), 0);
521 \}
\end{DoxyCode}
\hypertarget{classwala_acb8e59580d97bc3c5b9b4ff45eb6bb9a}{\index{wala@{wala}!ln\-F@{ln\-F}}
\index{ln\-F@{ln\-F}!wala@{wala}}
\subsubsection[{ln\-F}]{\setlength{\rightskip}{0pt plus 5cm}const double wala\-::ln\-F (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classwala_acb8e59580d97bc3c5b9b4ff45eb6bb9a}


Definition at line 72 of file bias.\-h.



Referenced by checkpoint\-::dump(), perform\-Crossover(), perform\-W\-A\-L\-A(), and wala().


\begin{DoxyCode}
72 \{ \textcolor{keywordflow}{return} lnF\_; \}
\end{DoxyCode}
\hypertarget{classwala_a65569289fac85d0da9c336e17c9d809a}{\index{wala@{wala}!print@{print}}
\index{print@{print}!wala@{wala}}
\subsubsection[{print}]{\setlength{\rightskip}{0pt plus 5cm}void wala\-::print (
\begin{DoxyParamCaption}
\item[{const std\-::string}]{file\-Name, }
\item[{const bool}]{print\-H = {\ttfamily false}}
\end{DoxyParamCaption}
)}}\label{classwala_a65569289fac85d0da9c336e17c9d809a}


Print the U\-N-\/\-N\-O\-R\-M\-A\-L\-I\-Z\-E\-D biasing function (ln\-P\-I) and possible the visted states histogram to files. 

Will overwrite the files if another with that name exists.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em file\-Name} & Name of the file to print to. Will append with \char`\"{}\-\_\-ln\-P\-I\char`\"{} and \char`\"{}\-\_\-\-H\char`\"{} for the macrostate distribution and visited-\/states histogram, respectively. \\
\hline
\mbox{\tt in}  & {\em print\-H} & Defaults to false, but if true will also print the visited states histogram. \\
\hline
\end{DoxyParams}


Definition at line 530 of file bias.\-cpp.



Referenced by checkpoint\-::dump().


\begin{DoxyCode}
530                                                        \{
531     \textcolor{comment}{// Print visited-states histogram}
532     \textcolor{keywordflow}{if} (printH) \{
533         \textcolor{comment}{// print complete visited states histogram to restart / visualize progress}
534         std::ofstream of;
535         std::string name = fileName+\textcolor{stringliteral}{"\_H.dat"};
536         of.open(name.c\_str(), std::ofstream::out);
537         \textcolor{keywordflow}{if} (!of.is\_open()) \{
538             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Unable to write Wang-Landau visited states histogram to 
      "}+name);
539         \}
540         of << \textcolor{stringliteral}{"# Visited states histogram in single row (vectorized) notation."} << std::endl;
541         of << \textcolor{stringliteral}{"# species\_total\_upper\_bound: "} << Nmax\_ << std::endl;
542         of << \textcolor{stringliteral}{"# species\_total\_lower\_bound: "} << Nmin\_ << std::endl;
543         \textcolor{keywordtype}{double} V = box\_[0]*box\_[1]*box\_[2];
544         of << \textcolor{stringliteral}{"# volume: "} << std::setprecision(15) << V << std::endl;
545         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} i = 0; i < H\_.size(); ++i) \{
546             of << std::setprecision(15) << H\_[i] << std::endl;
547         \}
548         of.close();
549     \}
550 
551     \textcolor{comment}{// Print lnPI (bias) matrix}
552     std::ofstream of;
553     std::string name = fileName+\textcolor{stringliteral}{"\_lnPI.dat"};
554     of.open(name.c\_str(), std::ofstream::out);
555     \textcolor{keywordflow}{if} (!of.is\_open()) \{
556         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Unable to write Wang-Landau lnPI histogram to "}+name);
557     \}
558     of << \textcolor{stringliteral}{"# lnPI (bias) matrix in single row (vectorized) notation."} << std::endl;
559     of << \textcolor{stringliteral}{"# species\_total\_upper\_bound: "} << Nmax\_ << std::endl;
560     of << \textcolor{stringliteral}{"# species\_total\_lower\_bound: "} << Nmin\_ << std::endl;
561     \textcolor{keywordtype}{double} V = box\_[0]*box\_[1]*box\_[2];
562     of << \textcolor{stringliteral}{"# volume: "} << std::setprecision(15) << V << std::endl;
563     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} i = 0; i < lnPI\_.size(); ++i) \{
564         of << std::setprecision(15) << lnPI\_[i] << std::endl; \textcolor{comment}{// only ALL states for restarting purposes}
565     \}
566     of.close();
567 \}
\end{DoxyCode}
\hypertarget{classwala_a0b8df0fb2b7722fc4a458e527a478b6f}{\index{wala@{wala}!read\-H@{read\-H}}
\index{read\-H@{read\-H}!wala@{wala}}
\subsubsection[{read\-H}]{\setlength{\rightskip}{0pt plus 5cm}void wala\-::read\-H (
\begin{DoxyParamCaption}
\item[{const std\-::string}]{file\-Name}
\end{DoxyParamCaption}
)}}\label{classwala_a0b8df0fb2b7722fc4a458e527a478b6f}


Read the visited states histogram from a file. 

This assumes the user has already guaranteed that the bounds are consistent, e.\-g. Nmin and Nmax, as it will not check this automatically. Also assumes file was generated by this code. \char`\"{}\-Hand made\char`\"{} ones might have formatting issues since parsing is done based on tokens.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em file\-Name} & Name of file containing visited states. Must include file extension. \\
\hline
\end{DoxyParams}


Definition at line 600 of file bias.\-cpp.



Referenced by checkpoint\-::load().


\begin{DoxyCode}
600                                           \{
601     std::ifstream infile (fileName.c\_str());
602     \textcolor{keywordflow}{if} (!infile.is\_open()) \{
603         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Unable to read Wang-Landau visited states matrix  from "}+
      fileName);
604     \}
605     std::string line;
606     \textcolor{keywordtype}{int} lineIndex = 0;
607     \textcolor{keywordflow}{while}(std::getline(infile,line)) \{
608         std::stringstream lineStream(line);
609         \textcolor{comment}{// skip any header information}
610         \textcolor{keywordflow}{if} (line.compare(0,1,\textcolor{stringliteral}{"#"},0,1) != 0) \{
611             H\_[lineIndex] = atof(line.c\_str());
612             lineIndex++;
613         \}
614     \}
615 \}
\end{DoxyCode}
\hypertarget{classwala_ae04916f49c11b0636e813787a3906570}{\index{wala@{wala}!readln\-P\-I@{readln\-P\-I}}
\index{readln\-P\-I@{readln\-P\-I}!wala@{wala}}
\subsubsection[{readln\-P\-I}]{\setlength{\rightskip}{0pt plus 5cm}void wala\-::readln\-P\-I (
\begin{DoxyParamCaption}
\item[{const std\-::string}]{file\-Name}
\end{DoxyParamCaption}
)}}\label{classwala_ae04916f49c11b0636e813787a3906570}


Read the macrostate distribution (biasing function) from a file. 

This assumes the user has already guaranteed that the bounds are consistent, e.\-g. Nmin and Nmax, as it will not check this automatically. Also assumes file was generated by this code. \char`\"{}\-Hand made\char`\"{} ones might have formatting issues since parsing is done based on tokens.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em file\-Name} & Name of file containing ln\-P\-I. Must include file extension. \\
\hline
\end{DoxyParams}


Definition at line 576 of file bias.\-cpp.



Referenced by checkpoint\-::load(), and perform\-W\-A\-L\-A().


\begin{DoxyCode}
576                                              \{
577     std::ifstream infile (fileName.c\_str());
578     \textcolor{keywordflow}{if} (!infile.is\_open()) \{
579         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Unable to read Wang-Landau lnPI from "}+fileName);
580     \}
581     std::string line;
582     \textcolor{keywordtype}{int} lineIndex = 0;
583     \textcolor{keywordflow}{while}(std::getline(infile,line)) \{
584         std::stringstream lineStream(line);
585         \textcolor{comment}{// skip any header information}
586         \textcolor{keywordflow}{if} (line.compare(0,1,\textcolor{stringliteral}{"#"},0,1) != 0) \{
587             lnPI\_[lineIndex] = atof(line.c\_str());
588             lineIndex++;
589         \}
590     \}
591 \}
\end{DoxyCode}
\hypertarget{classwala_a1d778061b12611b1a35eb3ca15038d02}{\index{wala@{wala}!setln\-P\-I@{setln\-P\-I}}
\index{setln\-P\-I@{setln\-P\-I}!wala@{wala}}
\subsubsection[{setln\-P\-I}]{\setlength{\rightskip}{0pt plus 5cm}void wala\-::setln\-P\-I (
\begin{DoxyParamCaption}
\item[{const std\-::vector$<$ double $>$ \&}]{ln\-P\-Iguess}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classwala_a1d778061b12611b1a35eb3ca15038d02}


Blindly assign a guess of the macrostate distribution. 



Definition at line 69 of file bias.\-h.

\hypertarget{classwala_ab439e3f60bea6c54522a870b9ad67acf}{\index{wala@{wala}!update@{update}}
\index{update@{update}!wala@{wala}}
\subsubsection[{update}]{\setlength{\rightskip}{0pt plus 5cm}void wala\-::update (
\begin{DoxyParamCaption}
\item[{const int}]{Nval, }
\item[{const int}]{Mval}
\end{DoxyParamCaption}
)}}\label{classwala_ab439e3f60bea6c54522a870b9ad67acf}


Update the estimate of the macrostate distribution. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Nval} & Total current number of atoms in the system \\
\hline
\mbox{\tt in}  & {\em Mval} & Current value of the expanded ensemble state of the system \\
\hline
\end{DoxyParams}


Definition at line 486 of file bias.\-cpp.



References \-\_\-\-\_\-\-B\-I\-A\-S\-\_\-\-I\-N\-T\-\_\-\-T\-Y\-P\-E\-\_\-\-\_\-, and get\-Address().



Referenced by agg\-Vol\-Bias3\-::make(), translate\-Particle\-::make(), delete\-Particle\-::make(), insert\-Particle\-::make(), and swap\-Particles\-::make().


\begin{DoxyCode}
486                                                  \{
487     \hyperlink{bias_8h_a1ceb524363fcb94da0c64d297ea27438}{\_\_BIAS\_INT\_TYPE\_\_} address = \hyperlink{classwala_a6120a0549bee60f2acabf6db132ff9d9}{getAddress} (Nval, Mval);
488     lnPI\_[address] += lnF\_;
489     H\_[address] += 1.0;
490 \}
\end{DoxyCode}


The documentation for this class was generated from the following files\-:\begin{DoxyCompactItemize}
\item 
/home/nam4/\-Desktop/sandbox/\-F\-H\-M\-C\-Simulation/src/\hyperlink{bias_8h}{bias.\-h}\item 
/home/nam4/\-Desktop/sandbox/\-F\-H\-M\-C\-Simulation/src/\hyperlink{bias_8cpp}{bias.\-cpp}\end{DoxyCompactItemize}
