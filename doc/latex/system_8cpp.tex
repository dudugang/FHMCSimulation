\hypertarget{system_8cpp}{\section{/home/nam4/\-Desktop/sandbox/\-F\-H\-M\-C\-Simulation/src/system.cpp File Reference}
\label{system_8cpp}\index{/home/nam4/\-Desktop/sandbox/\-F\-H\-M\-C\-Simulation/src/system.\-cpp@{/home/nam4/\-Desktop/sandbox/\-F\-H\-M\-C\-Simulation/src/system.\-cpp}}
}
{\ttfamily \#include \char`\"{}system.\-h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
const double \hyperlink{system_8cpp_acfe185adf03db047fd3753c0d788e0e3}{calculate\-Bias} (\hyperlink{classsim_system}{sim\-System} \&sys, const int n\-Tot\-Final, const int m\-Final)
\begin{DoxyCompactList}\small\item\em Calculate the bias based on a systems current state and the next state being proposed. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{system_8cpp_acfe185adf03db047fd3753c0d788e0e3}{\index{system.\-cpp@{system.\-cpp}!calculate\-Bias@{calculate\-Bias}}
\index{calculate\-Bias@{calculate\-Bias}!system.cpp@{system.\-cpp}}
\subsubsection[{calculate\-Bias}]{\setlength{\rightskip}{0pt plus 5cm}const double calculate\-Bias (
\begin{DoxyParamCaption}
\item[{{\bf sim\-System} \&}]{sys, }
\item[{const int}]{n\-Tot\-Final, }
\item[{const int}]{m\-Final}
\end{DoxyParamCaption}
)}}\label{system_8cpp_acfe185adf03db047fd3753c0d788e0e3}


Calculate the bias based on a systems current state and the next state being proposed. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em sys} & System object containing the current state of the system. \\
\hline
\mbox{\tt in}  & {\em n\-Tot\-Final} & Total atoms in the proposed final state. \\
\hline
\mbox{\tt in}  & {\em m\-Final} & Final value of the expanded ensemble state of the system. \\
\hline
\mbox{\tt in}  & {\em p\-\_\-u} & Ratio of the system's partition in the final and initial state (e.\-g. unbiased p\-\_\-acc = min(1, p\-\_\-u)).\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
rel\-\_\-bias The value of the relative bias to apply in the metropolis criteria during sampling 
\end{DoxyReturn}


Definition at line 1758 of file system.\-cpp.



References \-\_\-\-\_\-\-B\-I\-A\-S\-\_\-\-I\-N\-T\-\_\-\-T\-Y\-P\-E\-\_\-\-\_\-, tmmc\-::get\-Address(), wala\-::get\-Address(), tmmc\-::get\-Bias(), wala\-::get\-Bias(), sim\-System\-::get\-Current\-M(), sim\-System\-::get\-Tot\-N(), sim\-System\-::tmmc\-Bias, sim\-System\-::use\-T\-M\-M\-C, sim\-System\-::use\-W\-A\-L\-A, and sim\-System\-::wl\-Bias.



Referenced by agg\-Vol\-Bias3\-::make(), translate\-Particle\-::make(), delete\-Particle\-::make(), insert\-Particle\-::make(), and swap\-Particles\-::make().


\begin{DoxyCode}
1758                                                                                    \{
1759     \textcolor{keywordtype}{double} rel\_bias = 1.0;
1760 
1761     \textcolor{keywordflow}{if} (sys.\hyperlink{classsim_system_aa474a50b6353c8897331b1ab1ce53ab1}{useTMMC} && !sys.\hyperlink{classsim_system_aa83b00006b3919fb6e13f1bdeadece6a}{useWALA}) \{
1762         \textcolor{comment}{// TMMC biasing}
1763         \textcolor{keyword}{const} \hyperlink{bias_8h_a1ceb524363fcb94da0c64d297ea27438}{\_\_BIAS\_INT\_TYPE\_\_} address1 = sys.\hyperlink{classsim_system_a13173f45a1e40a5f5a3552b0ebe15b54}{tmmcBias}->
      \hyperlink{classtmmc_a62acddd907713a4b2a8a142b209ddaad}{getAddress}(sys.\hyperlink{classsim_system_a37dd827f4057049763351510147b9f1d}{getTotN}(), sys.\hyperlink{classsim_system_a299fe4372e610b554eaaf5f5957b2dbc}{getCurrentM}()), address2 = sys.
      \hyperlink{classsim_system_a13173f45a1e40a5f5a3552b0ebe15b54}{tmmcBias}->\hyperlink{classtmmc_a62acddd907713a4b2a8a142b209ddaad}{getAddress}(nTotFinal, mFinal);
1764         \textcolor{keyword}{const} \textcolor{keywordtype}{double} b1 = sys.\hyperlink{classsim_system_a13173f45a1e40a5f5a3552b0ebe15b54}{tmmcBias}->\hyperlink{classtmmc_afbcaaf974280aad6d78ca7e112438641}{getBias} (address1), b2 = sys.
      \hyperlink{classsim_system_a13173f45a1e40a5f5a3552b0ebe15b54}{tmmcBias}->\hyperlink{classtmmc_afbcaaf974280aad6d78ca7e112438641}{getBias} (address2);
1765         rel\_bias = exp(b2-b1);
1766     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!sys.\hyperlink{classsim_system_aa474a50b6353c8897331b1ab1ce53ab1}{useTMMC} && sys.\hyperlink{classsim_system_aa83b00006b3919fb6e13f1bdeadece6a}{useWALA}) \{
1767         \textcolor{comment}{// Wang-Landau Biasing}
1768         \textcolor{keyword}{const} \hyperlink{bias_8h_a1ceb524363fcb94da0c64d297ea27438}{\_\_BIAS\_INT\_TYPE\_\_} address1 = sys.\hyperlink{classsim_system_a6dc8d9f89dfcfa247a59bc50889c49e7}{wlBias}->
      \hyperlink{classwala_a6120a0549bee60f2acabf6db132ff9d9}{getAddress}(sys.\hyperlink{classsim_system_a37dd827f4057049763351510147b9f1d}{getTotN}(), sys.\hyperlink{classsim_system_a299fe4372e610b554eaaf5f5957b2dbc}{getCurrentM}()), address2 = sys.
      \hyperlink{classsim_system_a6dc8d9f89dfcfa247a59bc50889c49e7}{wlBias}->\hyperlink{classwala_a6120a0549bee60f2acabf6db132ff9d9}{getAddress}(nTotFinal, mFinal);
1769         \textcolor{keyword}{const} \textcolor{keywordtype}{double} b1 = sys.\hyperlink{classsim_system_a6dc8d9f89dfcfa247a59bc50889c49e7}{wlBias}->\hyperlink{classwala_a03f7b333aa0a280e78060bd9af7ec318}{getBias} (address1), b2 = sys.
      \hyperlink{classsim_system_a6dc8d9f89dfcfa247a59bc50889c49e7}{wlBias}->\hyperlink{classwala_a03f7b333aa0a280e78060bd9af7ec318}{getBias} (address2);
1770         rel\_bias = exp(b2-b1);
1771     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sys.\hyperlink{classsim_system_aa474a50b6353c8897331b1ab1ce53ab1}{useTMMC} && sys.\hyperlink{classsim_system_aa83b00006b3919fb6e13f1bdeadece6a}{useWALA}) \{
1772         \textcolor{comment}{// Crossover phase where we use WL but update TMMC collection matrix}
1773         \textcolor{keyword}{const} \textcolor{keywordtype}{int} address1 = sys.\hyperlink{classsim_system_a6dc8d9f89dfcfa247a59bc50889c49e7}{wlBias}->\hyperlink{classwala_a6120a0549bee60f2acabf6db132ff9d9}{getAddress}(sys.\hyperlink{classsim_system_a37dd827f4057049763351510147b9f1d}{getTotN}(), sys.
      \hyperlink{classsim_system_a299fe4372e610b554eaaf5f5957b2dbc}{getCurrentM}()), address2 = sys.\hyperlink{classsim_system_a6dc8d9f89dfcfa247a59bc50889c49e7}{wlBias}->\hyperlink{classwala_a6120a0549bee60f2acabf6db132ff9d9}{getAddress}(nTotFinal, mFinal);
1774         \textcolor{keyword}{const} \textcolor{keywordtype}{double} b1 = sys.\hyperlink{classsim_system_a6dc8d9f89dfcfa247a59bc50889c49e7}{wlBias}->\hyperlink{classwala_a03f7b333aa0a280e78060bd9af7ec318}{getBias} (address1), b2 = sys.
      \hyperlink{classsim_system_a6dc8d9f89dfcfa247a59bc50889c49e7}{wlBias}->\hyperlink{classwala_a03f7b333aa0a280e78060bd9af7ec318}{getBias} (address2);
1775         rel\_bias = exp(b2-b1);
1776     \} \textcolor{keywordflow}{else} \{
1777         \textcolor{comment}{// No biasing}
1778         rel\_bias = 1.0;
1779     \}
1780 
1781     \textcolor{keywordflow}{return} rel\_bias;
1782 \}
\end{DoxyCode}
