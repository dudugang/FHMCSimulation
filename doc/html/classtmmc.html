<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Flat-Histogram Monte Carlo Simulation: tmmc Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Flat-Histogram Monte Carlo Simulation
   &#160;<span id="projectnumber">v0.1.0</span>
   </div>
   <div id="projectbrief">Extensible Flat-Histogram MC code for Simple 3D Fluids</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="classes.html"><span>Data&#160;Structure&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">tmmc Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Transition Matrix Monte Carlo biasing class.  
 <a href="classtmmc.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="bias_8h_source.html">bias.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a2dd6a666daae3a9b7c3978d8ecff887e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#a2dd6a666daae3a9b7c3978d8ecff887e">tmmc</a> ()</td></tr>
<tr class="separator:a2dd6a666daae3a9b7c3978d8ecff887e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae09ec510cf4ba97b612fa0b42b811d20"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#ae09ec510cf4ba97b612fa0b42b811d20">tmmc</a> (const int Nmax, const int Nmin, const int Mtot, const long long int tmmcSweepSize, const std::vector&lt; double &gt; box)</td></tr>
<tr class="memdesc:ae09ec510cf4ba97b612fa0b42b811d20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the tmmc object.  <a href="#ae09ec510cf4ba97b612fa0b42b811d20">More...</a><br/></td></tr>
<tr class="separator:ae09ec510cf4ba97b612fa0b42b811d20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae067afc5b52af203b9d45f18d9737219"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#ae067afc5b52af203b9d45f18d9737219">updateC</a> (const int Nstart, const int Nend, const int Mstart, const int Mend, const double pa)</td></tr>
<tr class="memdesc:ae067afc5b52af203b9d45f18d9737219"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the collection matrix.  <a href="#ae067afc5b52af203b9d45f18d9737219">More...</a><br/></td></tr>
<tr class="separator:ae067afc5b52af203b9d45f18d9737219"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e065523e9cc3c9628f91d3804cd201e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#a8e065523e9cc3c9628f91d3804cd201e">calculatePI</a> ()</td></tr>
<tr class="memdesc:a8e065523e9cc3c9628f91d3804cd201e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the (natural logarithm of the) macrostate density matrix via the probability matrix.  <a href="#a8e065523e9cc3c9628f91d3804cd201e">More...</a><br/></td></tr>
<tr class="separator:a8e065523e9cc3c9628f91d3804cd201e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad49e147dc88b3e1c2975269598f94327"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#ad49e147dc88b3e1c2975269598f94327">print</a> (const std::string fileName, bool printC=false, bool printHC=false)</td></tr>
<tr class="memdesc:ad49e147dc88b3e1c2975269598f94327"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the UN-NORMALIZED biasing function (lnPI) and possibly collection matrix to files.  <a href="#ad49e147dc88b3e1c2975269598f94327">More...</a><br/></td></tr>
<tr class="separator:ad49e147dc88b3e1c2975269598f94327"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d9ee0505dc801cbff55bc35c3654a61"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#a7d9ee0505dc801cbff55bc35c3654a61">readC</a> (const std::string fileName)</td></tr>
<tr class="memdesc:a7d9ee0505dc801cbff55bc35c3654a61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the collection matrix from a file.  <a href="#a7d9ee0505dc801cbff55bc35c3654a61">More...</a><br/></td></tr>
<tr class="separator:a7d9ee0505dc801cbff55bc35c3654a61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab51a593d041a65c4ca47e6c4e0c26992"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#ab51a593d041a65c4ca47e6c4e0c26992">readHC</a> (const std::string fileName)</td></tr>
<tr class="memdesc:ab51a593d041a65c4ca47e6c4e0c26992"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the visited states matrix from a file.  <a href="#ab51a593d041a65c4ca47e6c4e0c26992">More...</a><br/></td></tr>
<tr class="separator:ab51a593d041a65c4ca47e6c4e0c26992"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a416db4e54e3d2ab23daed2e33468df4d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#a416db4e54e3d2ab23daed2e33468df4d">setlnPI</a> (const std::vector&lt; double &gt; &amp;lnPIguess)</td></tr>
<tr class="memdesc:a416db4e54e3d2ab23daed2e33468df4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Blindly assign a guess of the macrostate distribution.  <a href="#a416db4e54e3d2ab23daed2e33468df4d">More...</a><br/></td></tr>
<tr class="separator:a416db4e54e3d2ab23daed2e33468df4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a611b5a86b3887afd9e90e2e4da66de35"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#a611b5a86b3887afd9e90e2e4da66de35">iterateForward</a> ()</td></tr>
<tr class="memdesc:a611b5a86b3887afd9e90e2e4da66de35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the visited state counter which tracks the number of times each point in the collection matrix has been visited.  <a href="#a611b5a86b3887afd9e90e2e4da66de35">More...</a><br/></td></tr>
<tr class="separator:a611b5a86b3887afd9e90e2e4da66de35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a295886d2f7a947a9de890bcb3adb51c7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#a295886d2f7a947a9de890bcb3adb51c7">dumpVisited</a> (const std::string fileName)</td></tr>
<tr class="memdesc:a295886d2f7a947a9de890bcb3adb51c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dump the current visited states counter.  <a href="#a295886d2f7a947a9de890bcb3adb51c7">More...</a><br/></td></tr>
<tr class="separator:a295886d2f7a947a9de890bcb3adb51c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa51f03f958dabefcff97be4a7c3b336c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#aa51f03f958dabefcff97be4a7c3b336c">checkFullyVisited</a> ()</td></tr>
<tr class="memdesc:aa51f03f958dabefcff97be4a7c3b336c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the the collection matrix has been samples sufficiently, i.e., if each state and transition has been visited tmmcSweepSize_ times.  <a href="#aa51f03f958dabefcff97be4a7c3b336c">More...</a><br/></td></tr>
<tr class="separator:aa51f03f958dabefcff97be4a7c3b336c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae296df3336ebf0fa1db7c34972c544eb"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#ae296df3336ebf0fa1db7c34972c544eb">getTransitionAddress</a> (const int Nstart, const int Nend, const int Mstart, const int Mend)</td></tr>
<tr class="memdesc:ae296df3336ebf0fa1db7c34972c544eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">For a given multidimensional array which has been cast into 1D, find the address that refers to a given transition.  <a href="#ae296df3336ebf0fa1db7c34972c544eb">More...</a><br/></td></tr>
<tr class="separator:ae296df3336ebf0fa1db7c34972c544eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62acddd907713a4b2a8a142b209ddaad"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#a62acddd907713a4b2a8a142b209ddaad">getAddress</a> (const int Nval, const int Mval)</td></tr>
<tr class="memdesc:a62acddd907713a4b2a8a142b209ddaad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the address in lnPI that corresponds to a given macrostate.  <a href="#a62acddd907713a4b2a8a142b209ddaad">More...</a><br/></td></tr>
<tr class="separator:a62acddd907713a4b2a8a142b209ddaad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbdc037dc9b941d71d7049855e18f4be"><td class="memItemLeft" align="right" valign="top">const long long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#afbdc037dc9b941d71d7049855e18f4be">numSweeps</a> ()</td></tr>
<tr class="separator:afbdc037dc9b941d71d7049855e18f4be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbcaaf974280aad6d78ca7e112438641"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#afbcaaf974280aad6d78ca7e112438641">getBias</a> (const int address)</td></tr>
<tr class="separator:afbcaaf974280aad6d78ca7e112438641"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a281634902422824ca2905fad6478f0c0"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#a281634902422824ca2905fad6478f0c0">getC</a> ()</td></tr>
<tr class="memdesc:a281634902422824ca2905fad6478f0c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the collection matrix as it is.  <a href="#a281634902422824ca2905fad6478f0c0">More...</a><br/></td></tr>
<tr class="separator:a281634902422824ca2905fad6478f0c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e61aead97aef135db0895e749186f47"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#a9e61aead97aef135db0895e749186f47">getHC</a> ()</td></tr>
<tr class="separator:a9e61aead97aef135db0895e749186f47"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Transition Matrix Monte Carlo biasing class. </p>

<p>Definition at line <a class="el" href="bias_8h_source.html#l00031">31</a> of file <a class="el" href="bias_8h_source.html">bias.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a2dd6a666daae3a9b7c3978d8ecff887e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">tmmc::tmmc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bias_8h_source.html#l00033">33</a> of file <a class="el" href="bias_8h_source.html">bias.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;{};</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae09ec510cf4ba97b612fa0b42b811d20"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tmmc::tmmc </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Mtot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long long int&#160;</td>
          <td class="paramname"><em>tmmcSweepSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>box</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the tmmc object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Nmax</td><td>Upper bound for total number of particles. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Nmin</td><td>Lower bound for total number of particles. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Mtot</td><td>Total number of expanded ensemble states in a system. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmmcSweepSize</td><td>Number of times the each point in the collection matrix must be visited for a "sweep" to be considered finished </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">box</td><td>Vector of simulations box dimensions. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00012">12</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>References <a class="el" href="bias_8h_source.html#l00023">__BIAS_INT_TYPE__</a>.</p>
<div class="fragment"><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;                                                                                                                            {</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="keywordflow">if</span> (Nmin &gt; Nmax) {</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Nmin (&quot;</span>+std::to_string(Nmin)+<span class="stringliteral">&quot;) &gt; Nmax (&quot;</span>+std::to_string(Nmax)+<span class="stringliteral">&quot; in TMMC bias&quot;</span>);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    }</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keywordflow">if</span> (Nmin &lt; 0) {</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Nmin &lt; 0 in TMMC bias&quot;</span>);</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    }</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keywordflow">if</span> (Mtot &lt; 1) {</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Mtot &lt; 1 in TMMC bias&quot;</span>);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    }</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <a class="code" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> size = (Nmax - Nmin + 1);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    Nmin_ = Nmin;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    Nmax_ = Nmax;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    Mtot_ = Mtot;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordflow">if</span> (box.size() != 3) {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Illegal number of box dimensions in TMMC&quot;</span>);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    }</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; box.size(); ++i) {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        <span class="keywordflow">if</span> (box[i] &lt; 0) {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Illegal box dimensions in TMMC&quot;</span>);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        }</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    }</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    box_.resize(3, 0);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    box_ = box;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    nSweeps_ = 0;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordflow">if</span> (tmmcSweepSize &lt; 1) {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;TMMC sweep size must be &gt;= 1&quot;</span>);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    tmmcSweepSize_ = tmmcSweepSize;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">// attempt to allocate memory for collection matrix and initializes it all to 0</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        C_.resize(3*Mtot_*size, 0);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::bad_alloc &amp;ce) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Out of memory, cannot allocate space for collection matrix in tmmc&quot;</span>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">// attempt to allocate memory for probability matrix and initializes it all to 0</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        P_.resize(3*Mtot_*size, 0);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::bad_alloc &amp;ce) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Out of memory, cannot allocate space for probability matrix in tmmc&quot;</span>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">// attempt to allocate memory for states counter to check how often a sweep has been performed</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        HC_.resize(3*Mtot_*size, 0);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::bad_alloc &amp;ce) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Out of memory, cannot allocate space for the sweep counter in tmmc&quot;</span>);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">// attempt to allocate memory for lnPI matrix and initializes it all to 0</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        lnPI_.resize(Mtot_*size, 0.0);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::bad_alloc &amp;ce) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Out of memory, cannot allocate space for macrostate distribution matrix in tmmc&quot;</span>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;}</div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00128">global.h:128</a></div></div>
<div class="ttc" id="bias_8h_html_a1ceb524363fcb94da0c64d297ea27438"><div class="ttname"><a href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a></div><div class="ttdeci">#define __BIAS_INT_TYPE__</div><div class="ttdoc">For biasing, need to address things with large indices. </div><div class="ttdef"><b>Definition:</b> <a href="bias_8h_source.html#l00023">bias.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a8e065523e9cc3c9628f91d3804cd201e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmmc::calculatePI </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the (natural logarithm of the) macrostate density matrix via the probability matrix. </p>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00239">239</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>References <a class="el" href="bias_8h_source.html#l00023">__BIAS_INT_TYPE__</a>, and <a class="el" href="bias_8cpp_source.html#l00141">getTransitionAddress()</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00061">checkpoint::load()</a>, <a class="el" href="crossover_8cpp_source.html#l00010">performCrossover()</a>, and <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>.</p>
<div class="fragment"><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                        {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> endPoint = C_.size() - (Mtot_-1)*3;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> i = 0; i &lt; endPoint; i += 3) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordtype">double</span> sum = 0.0;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; 3; ++j) {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            sum += C_[i+j];</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordflow">if</span> (sum &gt; 0) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; 3; ++j) {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                P_[i+j] = C_[i+j] / sum;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <span class="comment">// This state has not been visited at all if sum = 0.  However, at high system densities this could be the &quot;correct&quot;</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <span class="comment">// result so this error may need to be discarded later in favor of:</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="comment">// P_[i+j] = 0;</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            <span class="comment">// However, having this throw an exception is also a good way to find that upper bound where the system is completely packed</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <span class="comment">// so I will keep it this way for now.</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Cannot compute TMMC macrostate distribution because probability matrix contains zeros&quot;</span>);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">// Reset first value to zero just to start fresh. Since only ratios matter this is perfectly fair.</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    lnPI_[0] = 0.0;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordtype">int</span> counter = 0;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <a class="code" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> address1 = 0, address2 = 0, nStartForward = 0, mStartForward = 0, nEndForward = 0, mEndForward = 0, nStartBackward = 0, nEndBackward = 0, mStartBackward = 0, mEndBackward = 0;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> i = 0; i &lt; (Nmax_ - Nmin_); ++i) { <span class="comment">// don&#39;t calculate the last N = Nmax when M &gt; 0, stops initially at N = Nmax, M = 0</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        nStartForward = Nmin_+i;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> j = 0; j &lt; Mtot_; ++j) {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            mStartForward = j;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="keywordflow">if</span> (j == Mtot_-1) {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                nEndForward = nStartForward + 1;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                mEndForward = 0;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                nEndForward = nStartForward;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                mEndForward = j + 1;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            nStartBackward = nEndForward;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            nEndBackward = nStartForward;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            mStartBackward = mEndForward;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            mEndBackward = mStartForward;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            address1 = <a class="code" href="classtmmc.html#ae296df3336ebf0fa1db7c34972c544eb">getTransitionAddress</a>(nStartForward, nEndForward, mStartForward, mEndForward);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            address2 = <a class="code" href="classtmmc.html#ae296df3336ebf0fa1db7c34972c544eb">getTransitionAddress</a>(nStartBackward, nEndBackward, mStartBackward, mEndBackward);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            <span class="keywordflow">if</span> (!(P_[address1] &gt; 0) || !(P_[address2] &gt; 0)) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Cannot compute TMMC macrostate distribution because probability matrix contains zeros at address: P[&quot;</span>+std::to_string(address1)+<span class="stringliteral">&quot;] = &quot;</span>+std::to_string(P_[address1])+<span class="stringliteral">&quot;, P[&quot;</span>+std::to_string(address2)+<span class="stringliteral">&quot;] = &quot;</span>+std::to_string(P_[address2]));</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            lnPI_[counter+1] = lnPI_[counter] + log(P_[address1]/P_[address2]); <span class="comment">// this is why P_ cannot be zero</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            counter++;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;}</div>
<div class="ttc" id="classtmmc_html_ae296df3336ebf0fa1db7c34972c544eb"><div class="ttname"><a href="classtmmc.html#ae296df3336ebf0fa1db7c34972c544eb">tmmc::getTransitionAddress</a></div><div class="ttdeci">const __BIAS_INT_TYPE__ getTransitionAddress(const int Nstart, const int Nend, const int Mstart, const int Mend)</div><div class="ttdoc">For a given multidimensional array which has been cast into 1D, find the address that refers to a giv...</div><div class="ttdef"><b>Definition:</b> <a href="bias_8cpp_source.html#l00141">bias.cpp:141</a></div></div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00128">global.h:128</a></div></div>
<div class="ttc" id="bias_8h_html_a1ceb524363fcb94da0c64d297ea27438"><div class="ttname"><a href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a></div><div class="ttdeci">#define __BIAS_INT_TYPE__</div><div class="ttdoc">For biasing, need to address things with large indices. </div><div class="ttdef"><b>Definition:</b> <a href="bias_8h_source.html#l00023">bias.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa51f03f958dabefcff97be4a7c3b336c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tmmc::checkFullyVisited </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if the the collection matrix has been samples sufficiently, i.e., if each state and transition has been visited tmmcSweepSize_ times. </p>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00100">100</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>References <a class="el" href="bias_8h_source.html#l00023">__BIAS_INT_TYPE__</a>.</p>

<p>Referenced by <a class="el" href="crossover_8cpp_source.html#l00010">performCrossover()</a>, and <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>.</p>
<div class="fragment"><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                              {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> endPoint = HC_.size() - (Mtot_-1)*3; <span class="comment">// we don&#39;t care about the last chunk where N = Nmax, but M &gt; 0 - stop at N = Nmax, M = 0</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> i = 0; i &lt; endPoint; i += 3) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">if</span> (i == 0) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            <span class="comment">// lower bound, so only +1 and 0 moves must be sampled</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <span class="keywordflow">if</span> ((HC_[i+1] &lt; tmmcSweepSize_) || (HC_[i] &lt; tmmcSweepSize_)) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i == endPoint-3) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <span class="comment">// upper bound, so only -1 and 0 moves must be sampled</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="keywordflow">if</span> ((HC_[i] &lt; tmmcSweepSize_) || (HC_[i+2] &lt; tmmcSweepSize_)) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="comment">// midpoints, both +1 and -1 (and 0) moves must be sampled</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="keywordflow">if</span> ((HC_[i] &lt; tmmcSweepSize_) || (HC_[i+1] &lt; tmmcSweepSize_) || (HC_[i+2] &lt; tmmcSweepSize_)) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;}</div>
<div class="ttc" id="bias_8h_html_a1ceb524363fcb94da0c64d297ea27438"><div class="ttname"><a href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a></div><div class="ttdeci">#define __BIAS_INT_TYPE__</div><div class="ttdoc">For biasing, need to address things with large indices. </div><div class="ttdef"><b>Definition:</b> <a href="bias_8h_source.html#l00023">bias.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a295886d2f7a947a9de890bcb3adb51c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmmc::dumpVisited </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>fileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dump the current visited states counter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>Name of file to print to. Prints in column format. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00079">79</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>Referenced by <a class="el" href="crossover_8cpp_source.html#l00010">performCrossover()</a>, and <a class="el" href="bias_8cpp_source.html#l00302">print()</a>.</p>
<div class="fragment"><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                                                {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    std::ofstream of;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    std::string name = fileName+<span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    of.open(name.c_str(), std::ofstream::out);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">if</span> (!of.is_open()) {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Unable to write TMMC visited states matrix to &quot;</span>+name);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# TMMC visited states counter in single row (vectorized) notation.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# species_total_upper_bound: &quot;</span> &lt;&lt; Nmax_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# species_total_lower_bound: &quot;</span> &lt;&lt; Nmin_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordtype">double</span> V = box_[0]*box_[1]*box_[2];</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# volume: &quot;</span> &lt;&lt; std::setprecision(15) &lt;&lt; V &lt;&lt; std::endl;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i = 0; i &lt; HC_.size(); ++i) {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        of &lt;&lt; std::setprecision(15) &lt;&lt; HC_[i] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    of.close();</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00128">global.h:128</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a62acddd907713a4b2a8a142b209ddaad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> tmmc::getAddress </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Mval</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the address in lnPI that corresponds to a given macrostate. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Nval</td><td>Number of total atoms </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Mval</td><td>Value of expanded ensemble state </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00199">199</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>Referenced by <a class="el" href="system_8cpp_source.html#l01758">calculateBias()</a>.</p>
<div class="fragment"><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                                                                        {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">if</span> (Nval &gt; Nmax_ || Nval &lt; Nmin_ || Mval &lt; 0 || Mval &gt; Mtot_-1) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;N, M out of bounds in TMMC object, cannot retrieve address&quot;</span>);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">return</span> (Nval - Nmin_)*Mtot_ + Mval;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;}</div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00128">global.h:128</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afbcaaf974280aad6d78ca7e112438641"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double tmmc::getBias </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>address</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bias_8h_source.html#l00048">48</a> of file <a class="el" href="bias_8h_source.html">bias.h</a>.</p>

<p>Referenced by <a class="el" href="system_8cpp_source.html#l01758">calculateBias()</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{ <span class="keywordflow">return</span> -lnPI_[address]; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a281634902422824ca2905fad6478f0c0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; double &gt; tmmc::getC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the collection matrix as it is. </p>

<p>Definition at line <a class="el" href="bias_8h_source.html#l00049">49</a> of file <a class="el" href="bias_8h_source.html">bias.h</a>.</p>

</div>
</div>
<a class="anchor" id="a9e61aead97aef135db0895e749186f47"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; double &gt; tmmc::getHC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bias_8h_source.html#l00050">50</a> of file <a class="el" href="bias_8h_source.html">bias.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{ <span class="keywordflow">return</span> HC_; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae296df3336ebf0fa1db7c34972c544eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> tmmc::getTransitionAddress </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Mstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Mend</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For a given multidimensional array which has been cast into 1D, find the address that refers to a given transition. </p>
<p>Assumes only valid moves are moving by +/-1 M (and subsequently N), will throw exception if this is not met.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Nstart</td><td>Number of total species initially (before MC move) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Nend</td><td>Number of total species (in order) after the MC move </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Mstart</td><td>Expanded ensemble state the system begins in </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Mend</td><td>Expanded ensemble state the system ends in </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00141">141</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>References <a class="el" href="bias_8h_source.html#l00023">__BIAS_INT_TYPE__</a>.</p>

<p>Referenced by <a class="el" href="bias_8cpp_source.html#l00239">calculatePI()</a>, and <a class="el" href="bias_8cpp_source.html#l00215">updateC()</a>.</p>
<div class="fragment"><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                                                                                                                      {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">if</span> (Nstart &gt; Nmax_ || Nstart &lt; Nmin_ || Nend &gt; (Nmax_+1) || Nend &lt; (Nmin_-1) || Mstart &lt; 0 || Mstart &gt; Mtot_-1 || Mend &lt; 0 || Mend &gt; Mtot_-1) { <span class="comment">// Nend has array positions for going over end of bounds but are never used, still they are valid</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;N, M out of bounds in TMMC object, cannot retrieve address&quot;</span>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">if</span> (Mtot_ &gt; 1) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="comment">// expanded ensemble</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordtype">int</span> y = 0;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">if</span> (Nstart == Nend) {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <span class="comment">// moving within an expanded set</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <span class="keywordtype">int</span> addOrSubtract = Mend - Mstart;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="keywordflow">if</span> (addOrSubtract == 0) {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                y = 0;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (addOrSubtract == 1) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                y = 1;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (addOrSubtract == -1) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                y = 2;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Illegal addOrSubtract value&quot;</span>);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="comment">// crossing over</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="keywordflow">if</span> (Nend &gt; Nstart) {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                y = 1;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                <span class="keywordflow">if</span> (Mstart != Mtot_ - 1 || Mend != 0) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                    <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Illegal expanded ensemble values&quot;</span>);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                y = 2;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                <span class="keywordflow">if</span> (Mstart != 0 || Mend != (Mtot_-1)) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                    <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Illegal expanded ensemble values&quot;</span>);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordflow">return</span> 3*((Nstart - Nmin_)*Mtot_ + Mstart) + y;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="comment">// no expanded ensemble</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordtype">int</span> addOrSubtract = (Nend - Nstart), y = 0;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">if</span> (addOrSubtract == 0) {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            y = 0;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (addOrSubtract == 1) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            y = 1;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (addOrSubtract == -1) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            y = 2;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Illegal addOrSubtract value&quot;</span>);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <a class="code" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> x = Nstart - Nmin_;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordflow">return</span> x*3 + y; <span class="comment">// equivalent to expanded ensemble because Mstart = 0 always, and Mtot_ = 1</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;}</div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00128">global.h:128</a></div></div>
<div class="ttc" id="bias_8h_html_a1ceb524363fcb94da0c64d297ea27438"><div class="ttname"><a href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a></div><div class="ttdeci">#define __BIAS_INT_TYPE__</div><div class="ttdoc">For biasing, need to address things with large indices. </div><div class="ttdef"><b>Definition:</b> <a href="bias_8h_source.html#l00023">bias.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a611b5a86b3887afd9e90e2e4da66de35"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmmc::iterateForward </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset the visited state counter which tracks the number of times each point in the collection matrix has been visited. </p>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00127">127</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>Referenced by <a class="el" href="crossover_8cpp_source.html#l00010">performCrossover()</a>, and <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>.</p>
<div class="fragment"><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                           {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    std::fill(HC_.begin(), HC_.end(), 0);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    nSweeps_++;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afbdc037dc9b941d71d7049855e18f4be"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const long long int tmmc::numSweeps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bias_8h_source.html#l00047">47</a> of file <a class="el" href="bias_8h_source.html">bias.h</a>.</p>

<p>Referenced by <a class="el" href="crossover_8cpp_source.html#l00010">performCrossover()</a>.</p>
<div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;{ <span class="keywordflow">return</span> nSweeps_; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad49e147dc88b3e1c2975269598f94327"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmmc::print </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>fileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>printC</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>printHC</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print the UN-NORMALIZED biasing function (lnPI) and possibly collection matrix to files. </p>
<p>Will overwrite the files if another with that name exists. Prints in netCDF format if enabled.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>Name of the file to print to. Will append with "_lnPI" and "_C" for biasing function and collection matrix, respectively. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">printC</td><td>Defaults to false, but if true will also print the collection matrix. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">printHC</td><td>Defaults to false, but if true will also print the visited states matrix. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00302">302</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>References <a class="el" href="bias_8cpp_source.html#l00079">dumpVisited()</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00165">checkpoint::dump()</a>, <a class="el" href="crossover_8cpp_source.html#l00010">performCrossover()</a>, and <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>.</p>
<div class="fragment"><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                                                     {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="preprocessor">#ifdef NETCDF_CAPABLE</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="preprocessor"></span>    <span class="comment">// Print collection matrix</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">if</span> (printC) {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keyword">const</span> std::string name = fileName + <span class="stringliteral">&quot;_C.nc&quot;</span>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            <span class="comment">// print all states, including partial ones, so this can be used to restart from, etc.</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            NcFile outFile(name.c_str(), NcFile::replace);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            NcDim probDim = outFile.addDim(<span class="stringliteral">&quot;vectorized_position&quot;</span>, C_.size());</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            NcVar probVar = outFile.addVar(<span class="stringliteral">&quot;C&quot;</span>, ncDouble, probDim);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            std::string attName = <span class="stringliteral">&quot;species_total_upper_bound&quot;</span>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            probVar.putAtt(attName.c_str(), std::to_string(Nmax_).c_str());</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            attName = <span class="stringliteral">&quot;species_total_lower_bound&quot;</span>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            probVar.putAtt(attName.c_str(), std::to_string(Nmin_).c_str());</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            attName = <span class="stringliteral">&quot;volume&quot;</span>;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <span class="keywordtype">double</span> V = box_[0]*box_[1]*box_[2];</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            probVar.putAtt(attName.c_str(), std::to_string(V).c_str());</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            probVar.putVar(&amp;C_[0]);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        } <span class="keywordflow">catch</span> (NcException ioe) {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Unable to write TMMC collection matrix to &quot;</span>+name);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">// Print visited states matrix</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">if</span> (printHC) {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keyword">const</span> std::string name = fileName + <span class="stringliteral">&quot;_HC.nc&quot;</span>;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            <span class="comment">// print all states, including partial ones, so this can be used to restart from, etc.</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            NcFile outFile(name.c_str(), NcFile::replace);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            NcDim probDim = outFile.addDim(<span class="stringliteral">&quot;vectorized_position&quot;</span>, HC_.size());</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            NcVar probVar = outFile.addVar(<span class="stringliteral">&quot;HC&quot;</span>, ncDouble, probDim);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            std::string attName = <span class="stringliteral">&quot;species_total_upper_bound&quot;</span>;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            probVar.putAtt(attName.c_str(), std::to_string(Nmax_).c_str());</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            attName = <span class="stringliteral">&quot;species_total_lower_bound&quot;</span>;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            probVar.putAtt(attName.c_str(), std::to_string(Nmin_).c_str());</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            attName = <span class="stringliteral">&quot;volume&quot;</span>;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <span class="keywordtype">double</span> V = box_[0]*box_[1]*box_[2];</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            probVar.putAtt(attName.c_str(), std::to_string(V).c_str());</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            probVar.putVar(&amp;HC_[0]);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        } <span class="keywordflow">catch</span> (NcException ioe) {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Unable to write TMMC visited states matrix to &quot;</span>+name);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        }</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">// Print lnPI (bias) matrix</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keyword">const</span> std::string name = fileName + <span class="stringliteral">&quot;_lnPI.nc&quot;</span>;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="comment">// only print the integral states</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        std::vector &lt; double &gt; lnPI_print (Nmax_ - Nmin_ + 1, 0.0);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; lnPI_print.size(); ++i) {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            lnPI_print[i] = lnPI_[i*Mtot_];</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        NcFile outFile(name.c_str(), NcFile::replace);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        NcDim probDim = outFile.addDim(<span class="stringliteral">&quot;vectorized_position&quot;</span>, lnPI_print.size());</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        NcVar probVar = outFile.addVar(<span class="stringliteral">&quot;lnPI&quot;</span>, ncDouble, probDim);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        std::string attName = <span class="stringliteral">&quot;species_total_upper_bound&quot;</span>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        probVar.putAtt(attName.c_str(), std::to_string(Nmax_).c_str());</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        attName = <span class="stringliteral">&quot;species_total_lower_bound&quot;</span>;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        probVar.putAtt(attName.c_str(), std::to_string(Nmin_).c_str());</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        attName = <span class="stringliteral">&quot;volume&quot;</span>;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordtype">double</span> V = box_[0]*box_[1]*box_[2];</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        probVar.putAtt(attName.c_str(), std::to_string(V).c_str());</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        probVar.putVar(&amp;lnPI_print[0]);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    } <span class="keywordflow">catch</span> (NcException ioe) {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Unable to write TMMC lnPI to &quot;</span>+name);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="preprocessor"></span>    <span class="comment">// Print collection matrix</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordflow">if</span> (printC) {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="comment">// print all states, including partial ones, so this can be used to restart from, etc.</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        std::ofstream of;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        std::string name = fileName+<span class="stringliteral">&quot;_C.dat&quot;</span>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        of.open(name.c_str(), std::ofstream::out);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keywordflow">if</span> (!of.is_open()) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Unable to write TMMC collection matrix to &quot;</span>+name);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        of &lt;&lt; <span class="stringliteral">&quot;# Collection matrix in single row (vectorized) notation.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        of &lt;&lt; <span class="stringliteral">&quot;# species_total_upper_bound: &quot;</span> &lt;&lt; Nmax_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        of &lt;&lt; <span class="stringliteral">&quot;# species_total_lower_bound: &quot;</span> &lt;&lt; Nmin_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="keywordtype">double</span> V = box_[0]*box_[1]*box_[2];</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        of &lt;&lt; <span class="stringliteral">&quot;# volume: &quot;</span> &lt;&lt; std::setprecision(15) &lt;&lt; V &lt;&lt; std::endl;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i = 0; i &lt; C_.size(); ++i) {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            of &lt;&lt; std::setprecision(15) &lt;&lt; C_[i] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        of.close();</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">// Print visited states matrix</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">if</span> (printHC) {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="comment">// print all states, including partial ones, so this can be used to restart from, etc.</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <a class="code" href="classtmmc.html#a295886d2f7a947a9de890bcb3adb51c7">dumpVisited</a>(fileName+<span class="stringliteral">&quot;_HC&quot;</span>);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="comment">// Print lnPI (bias) matrix</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    std::ofstream of;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    std::string name = fileName+<span class="stringliteral">&quot;_lnPI.dat&quot;</span>;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    of.open(name.c_str(), std::ofstream::out);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">if</span> (!of.is_open()) {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Unable to write TMMC lnPI to &quot;</span>+name);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# lnPI (bias) matrix in single row (vectorized) notation.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# species_total_upper_bound: &quot;</span> &lt;&lt; Nmax_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# species_total_lower_bound: &quot;</span> &lt;&lt; Nmin_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keywordtype">double</span> V = box_[0]*box_[1]*box_[2];</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# volume: &quot;</span> &lt;&lt; std::setprecision(15) &lt;&lt; V &lt;&lt; std::endl;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i = 0; i &lt; lnPI_.size(); i += Mtot_) {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        of &lt;&lt; std::setprecision(15) &lt;&lt; lnPI_[i] &lt;&lt; std::endl; <span class="comment">// only print the integral states</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    of.close();</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="preprocessor"></span>}</div>
<div class="ttc" id="classtmmc_html_a295886d2f7a947a9de890bcb3adb51c7"><div class="ttname"><a href="classtmmc.html#a295886d2f7a947a9de890bcb3adb51c7">tmmc::dumpVisited</a></div><div class="ttdeci">void dumpVisited(const std::string fileName)</div><div class="ttdoc">Dump the current visited states counter. </div><div class="ttdef"><b>Definition:</b> <a href="bias_8cpp_source.html#l00079">bias.cpp:79</a></div></div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00128">global.h:128</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7d9ee0505dc801cbff55bc35c3654a61"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmmc::readC </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>fileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read the collection matrix from a file. </p>
<p>This assumes the user has already guaranteed that the bounds are consistent, e.g. Nmin and Nmax, as it will not check this automatically. Also assumes file was generated by this code. "Hand made" ones might have formatting issues since parsing is done based on tokens.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>Name of file containing the collection matrix. Must include file extension. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00457">457</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00061">checkpoint::load()</a>, and <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>.</p>
<div class="fragment"><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                                          {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="preprocessor">#ifdef NETCDF_CAPABLE</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        NcFile dataFile (fileName.c_str(), NcFile::read);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        NcVar C_data = dataFile.getVar(<span class="stringliteral">&quot;C&quot;</span>);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="keywordflow">if</span> (C_data.isNull()) <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a>(<span class="stringliteral">&quot;Collection matrix was empty, cannot read from &quot;</span>+fileName);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        C_data.getVar(&amp;C_[0]);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    } <span class="keywordflow">catch</span> (NcException ioe) {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Unable to read collection matrix from netCDF file &quot;</span>+fileName);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="preprocessor"></span>    std::ifstream infile (fileName.c_str());</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">if</span> (!infile.is_open()) {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a>(<span class="stringliteral">&quot;Unable to read collection matrix from ASCII file &quot;</span>+fileName);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    std::string line;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordtype">int</span> lineIndex = 0;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">while</span>(std::getline(infile,line)) {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        std::stringstream lineStream(line);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="comment">// skip any header information</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keywordflow">if</span> (line.compare(0,1,<span class="stringliteral">&quot;#&quot;</span>,0,1) != 0) {</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            C_[lineIndex] = atof(line.c_str());</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            lineIndex++;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    }</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    infile.close();</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="preprocessor"></span>}</div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00128">global.h:128</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab51a593d041a65c4ca47e6c4e0c26992"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmmc::readHC </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>fileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read the visited states matrix from a file. </p>
<p>This assumes the user has already guaranteed that the bounds are consistent, e.g. Nmin and Nmax, as it will not check this automatically. Also assumes file was generated by this code. "Hand made" ones might have formatting issues since parsing is done based on tokens.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>Name of file containing the visited states matrix. Must include file extension. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00421">421</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00061">checkpoint::load()</a>.</p>
<div class="fragment"><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                                           {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="preprocessor">#ifdef NETCDF_CAPABLE</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        NcFile dataFile (fileName.c_str(), NcFile::read);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        NcVar HC_data = dataFile.getVar(<span class="stringliteral">&quot;HC&quot;</span>);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keywordflow">if</span> (HC_data.isNull()) <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a>(<span class="stringliteral">&quot;Visited states matrix was empty, cannot read from &quot;</span>+fileName);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        HC_data.getVar(&amp;HC_[0]);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    } <span class="keywordflow">catch</span> (NcException ioe) {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Unable to read visited states matrix from netCDF file &quot;</span>+fileName);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="preprocessor"></span>    std::ifstream infile (fileName.c_str());</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">if</span> (!infile.is_open()) {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a>(<span class="stringliteral">&quot;Unable to read visited states matrix from ASCII file &quot;</span>+fileName);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    std::string line;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordtype">int</span> lineIndex = 0;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">while</span>(std::getline(infile,line)) {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        std::stringstream lineStream(line);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="comment">// skip any header information</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">if</span> (line.compare(0,1,<span class="stringliteral">&quot;#&quot;</span>,0,1) != 0) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            HC_[lineIndex] = atof(line.c_str());</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            lineIndex++;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    infile.close();</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="preprocessor"></span>}</div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00128">global.h:128</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a416db4e54e3d2ab23daed2e33468df4d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void tmmc::setlnPI </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>lnPIguess</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Blindly assign a guess of the macrostate distribution. </p>

<p>Definition at line <a class="el" href="bias_8h_source.html#l00041">41</a> of file <a class="el" href="bias_8h_source.html">bias.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae067afc5b52af203b9d45f18d9737219"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmmc::updateC </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Mstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Mend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>pa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the collection matrix. </p>
<p>This records the number of times a transition probability is measured with a finite, non-zero probability. This way, when <a class="el" href="classtmmc.html#aa51f03f958dabefcff97be4a7c3b336c" title="Check if the the collection matrix has been samples sufficiently, i.e., if each state and transition ...">checkFullyVisited()</a> returns true, all the lnPI values can be calculated since all transition probabilities will be finite. Otherwise, transitions could be "sampled" but if the dU = inf, then the collection matrix is updated with a value of 0. This could theoretically remain zero until the end of a sweep which is later caught when it creates a problem for calculating lnPI in <a class="el" href="classtmmc.html#a8e065523e9cc3c9628f91d3804cd201e" title="Calculate the (natural logarithm of the) macrostate density matrix via the probability matrix...">calculatePI()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Nstart</td><td>Total number of atoms initially (before MC move) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Nend</td><td>Total number of atoms after the MC move </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Mstart</td><td>Initial value of expanded ensemble state </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Mend</td><td>Final value of expanded ensemble state </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pa</td><td>Unbiased Metropolis criterion for making a MC move (i.e. pa = min(1, exp(...))) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00215">215</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>References <a class="el" href="bias_8cpp_source.html#l00141">getTransitionAddress()</a>, and <a class="el" href="global_8h_source.html#l00130">customException::what()</a>.</p>

<p>Referenced by <a class="el" href="aggvolbias_8cpp_source.html#l00142">aggVolBias3::make()</a>, <a class="el" href="translate_8cpp_source.html#l00010">translateParticle::make()</a>, <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>, and <a class="el" href="swap_8cpp_source.html#l00010">swapParticles::make()</a>.</p>
<div class="fragment"><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                                                                                                       {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordtype">int</span> i = 0, j = 0;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        i = <a class="code" href="classtmmc.html#ae296df3336ebf0fa1db7c34972c544eb">getTransitionAddress</a>(Nstart, Nend, Mstart, Mend);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    } <span class="keywordflow">catch</span> (<a class="code" href="classcustom_exception.html">customException</a> &amp;ce) {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Cannot update collection matrix: &quot;</span> + std::to_string(*ce.<a class="code" href="classcustom_exception.html#aeb6ab5848b038adfc68fde86a512f691">what</a>()));</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        j = <a class="code" href="classtmmc.html#ae296df3336ebf0fa1db7c34972c544eb">getTransitionAddress</a>(Nstart, Nstart, Mstart, Mstart);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    } <span class="keywordflow">catch</span> (<a class="code" href="classcustom_exception.html">customException</a> &amp;ce) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Cannot update collection matrix: &quot;</span> + std::to_string(*ce.<a class="code" href="classcustom_exception.html#aeb6ab5848b038adfc68fde86a512f691">what</a>()));</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    C_[i] += pa;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    C_[j] += (1-pa);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">if</span> (pa &gt; 0.0) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        HC_[i] += 1.0; <span class="comment">// only count the transition actually proposed, not the Nstart --&gt; Nstart unless that was what was originally proposed, and only count when transition probability is finite.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Nstart == 0 &amp;&amp; Nend == 0) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    HC_[i] += 1.0; <span class="comment">// displacement move when 0 particles in system is &quot;early rejected&quot; (p = 0), but this is valid - if N_min of window is &gt; 0 checkVisited() works fine, but if includes 0, this state is detected as never being sampled otherwise, which is the incorrect response</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;}</div>
<div class="ttc" id="classcustom_exception_html_aeb6ab5848b038adfc68fde86a512f691"><div class="ttname"><a href="classcustom_exception.html#aeb6ab5848b038adfc68fde86a512f691">customException::what</a></div><div class="ttdeci">const char * what() const </div><div class="ttdoc">Return the user&#39;s message. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00130">global.h:130</a></div></div>
<div class="ttc" id="classtmmc_html_ae296df3336ebf0fa1db7c34972c544eb"><div class="ttname"><a href="classtmmc.html#ae296df3336ebf0fa1db7c34972c544eb">tmmc::getTransitionAddress</a></div><div class="ttdeci">const __BIAS_INT_TYPE__ getTransitionAddress(const int Nstart, const int Nend, const int Mstart, const int Mend)</div><div class="ttdoc">For a given multidimensional array which has been cast into 1D, find the address that refers to a giv...</div><div class="ttdef"><b>Definition:</b> <a href="bias_8cpp_source.html#l00141">bias.cpp:141</a></div></div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00128">global.h:128</a></div></div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/nam4/Desktop/sandbox/FHMCSimulation/src/<a class="el" href="bias_8h_source.html">bias.h</a></li>
<li>/home/nam4/Desktop/sandbox/FHMCSimulation/src/<a class="el" href="bias_8cpp_source.html">bias.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Dec 22 2016 16:31:54 for Flat-Histogram Monte Carlo Simulation by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
