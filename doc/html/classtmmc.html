<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>Multicomponent  Monte Carlo Simulation: tmmc Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Multicomponent  Monte Carlo Simulation
   &#160;<span id="projectnumber">v0.0.1</span>
   </div>
   <div id="projectbrief">Simple, portable, extensible MC code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classtmmc-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">tmmc Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Transition Matrix Monte Carlo biasing class.  
 <a href="classtmmc.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="bias_8h_source.html">bias.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a2dd6a666daae3a9b7c3978d8ecff887e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#a2dd6a666daae3a9b7c3978d8ecff887e">tmmc</a> ()</td></tr>
<tr class="separator:a2dd6a666daae3a9b7c3978d8ecff887e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a643b39f7bd100470c9c632bc9ea7e45e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#a643b39f7bd100470c9c632bc9ea7e45e">tmmc</a> (const int Nmax, const int Nmin)</td></tr>
<tr class="memdesc:a643b39f7bd100470c9c632bc9ea7e45e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the tmmc object.  <a href="#a643b39f7bd100470c9c632bc9ea7e45e">More...</a><br /></td></tr>
<tr class="separator:a643b39f7bd100470c9c632bc9ea7e45e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab648f1ba2767c07fdccf9ac0e2eec8f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#ab648f1ba2767c07fdccf9ac0e2eec8f6">updateC</a> (const int Nstart, const int Nend, const double pa)</td></tr>
<tr class="memdesc:ab648f1ba2767c07fdccf9ac0e2eec8f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the collection matrix.  <a href="#ab648f1ba2767c07fdccf9ac0e2eec8f6">More...</a><br /></td></tr>
<tr class="separator:ab648f1ba2767c07fdccf9ac0e2eec8f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e065523e9cc3c9628f91d3804cd201e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#a8e065523e9cc3c9628f91d3804cd201e">calculatePI</a> ()</td></tr>
<tr class="memdesc:a8e065523e9cc3c9628f91d3804cd201e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the (natural logarithm of the) macrostate density matrix via the probability matrix.  <a href="#a8e065523e9cc3c9628f91d3804cd201e">More...</a><br /></td></tr>
<tr class="separator:a8e065523e9cc3c9628f91d3804cd201e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a059a91f0f2ebe78671b5f4fb8e1ab853"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#a059a91f0f2ebe78671b5f4fb8e1ab853">print</a> (const std::string fileName, bool printC=false)</td></tr>
<tr class="memdesc:a059a91f0f2ebe78671b5f4fb8e1ab853"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the UN-NORMALIZED biasing function (lnPI) and possibly collection matrix to files.  <a href="#a059a91f0f2ebe78671b5f4fb8e1ab853">More...</a><br /></td></tr>
<tr class="separator:a059a91f0f2ebe78671b5f4fb8e1ab853"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d9ee0505dc801cbff55bc35c3654a61"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#a7d9ee0505dc801cbff55bc35c3654a61">readC</a> (const std::string fileName)</td></tr>
<tr class="memdesc:a7d9ee0505dc801cbff55bc35c3654a61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the collection matrix from a file.  <a href="#a7d9ee0505dc801cbff55bc35c3654a61">More...</a><br /></td></tr>
<tr class="separator:a7d9ee0505dc801cbff55bc35c3654a61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c6c9f978b2093d1f4f6da7842093f3f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#a0c6c9f978b2093d1f4f6da7842093f3f">readlnPI</a> (const std::string fileName)</td></tr>
<tr class="memdesc:a0c6c9f978b2093d1f4f6da7842093f3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the macrostate distribution (biasing function) from a file.  <a href="#a0c6c9f978b2093d1f4f6da7842093f3f">More...</a><br /></td></tr>
<tr class="separator:a0c6c9f978b2093d1f4f6da7842093f3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bd3a47406bf765234e1cb3a391c79d5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#a4bd3a47406bf765234e1cb3a391c79d5">setLnPI</a> (const std::vector&lt; double &gt; &amp;lnPIguess)</td></tr>
<tr class="memdesc:a4bd3a47406bf765234e1cb3a391c79d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Blindly assign a guess of the macrostate distribution.  <a href="#a4bd3a47406bf765234e1cb3a391c79d5">More...</a><br /></td></tr>
<tr class="separator:a4bd3a47406bf765234e1cb3a391c79d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa51f03f958dabefcff97be4a7c3b336c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#aa51f03f958dabefcff97be4a7c3b336c">checkFullyVisited</a> ()</td></tr>
<tr class="memdesc:aa51f03f958dabefcff97be4a7c3b336c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the the collection matrix has been filled (i.e.  <a href="#aa51f03f958dabefcff97be4a7c3b336c">More...</a><br /></td></tr>
<tr class="separator:aa51f03f958dabefcff97be4a7c3b336c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c006c0107ba4c1d52e75fc80d8581d6"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#a7c006c0107ba4c1d52e75fc80d8581d6">getTransitionAddress</a> (const int Nstart, const int Nend)</td></tr>
<tr class="memdesc:a7c006c0107ba4c1d52e75fc80d8581d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">For a given multidimensional array which has been cast into 1D, find the address that refers to a given transition.  <a href="#a7c006c0107ba4c1d52e75fc80d8581d6">More...</a><br /></td></tr>
<tr class="separator:a7c006c0107ba4c1d52e75fc80d8581d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa93ae04c2712ef208ed4cb01b9dd1905"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#aa93ae04c2712ef208ed4cb01b9dd1905">getAddress</a> (const int Nval)</td></tr>
<tr class="memdesc:aa93ae04c2712ef208ed4cb01b9dd1905"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the address in lnPI that corresponds to a given macrostate.  <a href="#aa93ae04c2712ef208ed4cb01b9dd1905">More...</a><br /></td></tr>
<tr class="separator:aa93ae04c2712ef208ed4cb01b9dd1905"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbcaaf974280aad6d78ca7e112438641"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtmmc.html#afbcaaf974280aad6d78ca7e112438641">getBias</a> (const int address)</td></tr>
<tr class="separator:afbcaaf974280aad6d78ca7e112438641"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Transition Matrix Monte Carlo biasing class. </p>

<p>Definition at line <a class="el" href="bias_8h_source.html#l00023">23</a> of file <a class="el" href="bias_8h_source.html">bias.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a2dd6a666daae3a9b7c3978d8ecff887e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">tmmc::tmmc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bias_8h_source.html#l00025">25</a> of file <a class="el" href="bias_8h_source.html">bias.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;{};</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a643b39f7bd100470c9c632bc9ea7e45e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tmmc::tmmc </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nmin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the tmmc object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nSpec</td><td>Number of species in the simulation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Nmax</td><td>Upper bound for total number of particles. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Nmin</td><td>Lower bound for total number of particles. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00011">11</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>References <a class="el" href="bias_8h_source.html#l00015">__BIAS_INT_TYPE__</a>.</p>
<div class="fragment"><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;                                          {     </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;                <span class="keywordflow">if</span> (Nmin &gt; Nmax) {</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;                                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Nmin &gt; Nmax in TMMC bias&quot;</span>);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;                }</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;                <a class="code" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> size = (Nmax - Nmin + 1);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;                Nmin_ = Nmin;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;                Nmax_ = Nmax;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;                <span class="comment">// attempt to allocate memory for collection matrix and initializes it all to 0</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;                <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;                                C_.resize(3*size, 0);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;                } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::bad_alloc &amp;ce) {</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;                                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Out of memory, cannot allocate space for collection matrix in tmmc&quot;</span>);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;                }</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                <span class="comment">// attempt to allocate memory for probability matrix and initializes it all to 0</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;                                P_.resize(3*size, 0);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;                } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::bad_alloc &amp;ce) {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;                                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Out of memory, cannot allocate space for probability matrix in tmmc&quot;</span>);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                }</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;                <span class="comment">// attempt to allocate memory for lnPI matrix and initializes it all to 0</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                                lnPI_.resize(size, 0.0);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::bad_alloc &amp;ce) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Out of memory, cannot allocate space for macrostate distribution matrix in tmmc&quot;</span>);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                }</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;}</div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00016">global.h:16</a></div></div>
<div class="ttc" id="bias_8h_html_a1ceb524363fcb94da0c64d297ea27438"><div class="ttname"><a href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a></div><div class="ttdeci">#define __BIAS_INT_TYPE__</div><div class="ttdoc">For biasing, need to address things with large indices. </div><div class="ttdef"><b>Definition:</b> <a href="bias_8h_source.html#l00015">bias.h:15</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a8e065523e9cc3c9628f91d3804cd201e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmmc::calculatePI </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the (natural logarithm of the) macrostate density matrix via the probability matrix. </p>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00116">116</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>References <a class="el" href="bias_8h_source.html#l00015">__BIAS_INT_TYPE__</a>, <a class="el" href="bias_8cpp_source.html#l00074">getTransitionAddress()</a>, and <a class="el" href="utilities_8h_source.html#l00011">sstr</a>.</p>

<p>Referenced by <a class="el" href="main_8cpp_source.html#l00054">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                        {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> i = 0; i &lt; C_.size(); i += 3) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                <span class="keywordtype">double</span> sum = 0.0;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; 3; ++j) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                                                sum += C_[i+j];</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                                }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                                <span class="keywordflow">if</span> (sum &gt; 0) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                                                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; 3; ++j) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                                                                P_[i+j] = C_[i+j] / sum;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                                }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                                <span class="comment">// This state has not been visited at all if sum = 0.  However, at high system densities this could be the &quot;correct&quot;</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                                                <span class="comment">// result so this error may need to be discarded later in favor of:</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                                                <span class="comment">// P_[i+j] = 0;</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                                <span class="comment">// However, having this throw an exception is also a good way to find that upper bound where the system is completely packed</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                                <span class="comment">// so I will keep it this way for now.</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                                                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Cannot compute TMMC macrostate distribution because probability matrix contains zeros&quot;</span>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                                }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                <span class="comment">// Reset first value to zero just to start fresh. Since only ratios matter this is perfectly fair.</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                lnPI_[0] = 0.0;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                <a class="code" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> address1, address2;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> i = 0; i &lt; lnPI_.size()-1; ++i) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                                address1 = <a class="code" href="classtmmc.html#a7c006c0107ba4c1d52e75fc80d8581d6">getTransitionAddress</a>(Nmin_+i, Nmin_+i+1);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                                address2 = <a class="code" href="classtmmc.html#a7c006c0107ba4c1d52e75fc80d8581d6">getTransitionAddress</a>(Nmin_+i+1, Nmin_+i);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                                <span class="keywordflow">if</span> (!(P_[address1] &gt; 0) || !(P_[address2] &gt; 0)) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Cannot compute TMMC macrostate distribution because probability matrix contains zeros at address: P[&quot;</span>+<a class="code" href="utilities_8h.html#a8feb627efa8e8113cdf95f9a6151a088">sstr</a>(address1)+<span class="stringliteral">&quot;] = &quot;</span>+<a class="code" href="utilities_8h.html#a8feb627efa8e8113cdf95f9a6151a088">sstr</a>(P_[address1])+<span class="stringliteral">&quot;, P[&quot;</span>+<a class="code" href="utilities_8h.html#a8feb627efa8e8113cdf95f9a6151a088">sstr</a>(address2)+<span class="stringliteral">&quot;] = &quot;</span>+<a class="code" href="utilities_8h.html#a8feb627efa8e8113cdf95f9a6151a088">sstr</a>(P_[address2]));</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                lnPI_[i+1] = lnPI_[i] + log(P_[address1]/P_[address2]); <span class="comment">// this is why P_ cannot be zero</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;}</div>
<div class="ttc" id="utilities_8h_html_a8feb627efa8e8113cdf95f9a6151a088"><div class="ttname"><a href="utilities_8h.html#a8feb627efa8e8113cdf95f9a6151a088">sstr</a></div><div class="ttdeci">#define sstr(x)</div><div class="ttdoc">For converting to string. </div><div class="ttdef"><b>Definition:</b> <a href="utilities_8h_source.html#l00011">utilities.h:11</a></div></div>
<div class="ttc" id="classtmmc_html_a7c006c0107ba4c1d52e75fc80d8581d6"><div class="ttname"><a href="classtmmc.html#a7c006c0107ba4c1d52e75fc80d8581d6">tmmc::getTransitionAddress</a></div><div class="ttdeci">const __BIAS_INT_TYPE__ getTransitionAddress(const int Nstart, const int Nend)</div><div class="ttdoc">For a given multidimensional array which has been cast into 1D, find the address that refers to a giv...</div><div class="ttdef"><b>Definition:</b> <a href="bias_8cpp_source.html#l00074">bias.cpp:74</a></div></div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00016">global.h:16</a></div></div>
<div class="ttc" id="bias_8h_html_a1ceb524363fcb94da0c64d297ea27438"><div class="ttname"><a href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a></div><div class="ttdeci">#define __BIAS_INT_TYPE__</div><div class="ttdoc">For biasing, need to address things with large indices. </div><div class="ttdef"><b>Definition:</b> <a href="bias_8h_source.html#l00015">bias.h:15</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa51f03f958dabefcff97be4a7c3b336c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool tmmc::checkFullyVisited </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if the the collection matrix has been filled (i.e. </p>
<p>contains no zeros, except when crossing imposed bounds). Technically, if in an ideal gas state, dU ~ 0 so pacc = 1.0, therefore probability of remaining in same state is 0. However, this matrix should be considered filled, if transitions to N+1 and N-1 for each N are found (except at bounds). </p>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00046">46</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>References <a class="el" href="bias_8h_source.html#l00015">__BIAS_INT_TYPE__</a>.</p>

<p>Referenced by <a class="el" href="main_8cpp_source.html#l00054">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                              {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> i = 0; i &lt; C_.size(); i += 3) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                                <span class="keywordflow">if</span> (i == 0) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                                                <span class="comment">// lower bound, so only +1 move must be sampled</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                                                <span class="keywordflow">if</span> (!(C_[i+1] &gt; 0)) {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                                                                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                                                }                                               </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i == C_.size()-3) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                                                <span class="comment">// upper bound, so only -1 move must be sampled</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                                                <span class="keywordflow">if</span> (!(C_[i+2] &gt; 0)) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                                                                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                                                }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                                                <span class="comment">// midpoints, both +1 and -1 moves must be sampled</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                                                <span class="keywordflow">if</span> (!(C_[i+1] &gt; 0) || !(C_[i+2] &gt; 0)) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                                                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                                                }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                                }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;}</div>
<div class="ttc" id="bias_8h_html_a1ceb524363fcb94da0c64d297ea27438"><div class="ttname"><a href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a></div><div class="ttdeci">#define __BIAS_INT_TYPE__</div><div class="ttdoc">For biasing, need to address things with large indices. </div><div class="ttdef"><b>Definition:</b> <a href="bias_8h_source.html#l00015">bias.h:15</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa93ae04c2712ef208ed4cb01b9dd1905"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> tmmc::getAddress </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nval</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the address in lnPI that corresponds to a given macrostate. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Nval</td><td>Number of total atoms </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00095">95</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>References <a class="el" href="bias_8h_source.html#l00015">__BIAS_INT_TYPE__</a>.</p>

<p>Referenced by <a class="el" href="system_8cpp_source.html#l00759">calculateBias()</a>.</p>
<div class="fragment"><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                                                        {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                <a class="code" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> x = Nval - Nmin_;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                <span class="keywordflow">return</span> x;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div>
<div class="ttc" id="bias_8h_html_a1ceb524363fcb94da0c64d297ea27438"><div class="ttname"><a href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a></div><div class="ttdeci">#define __BIAS_INT_TYPE__</div><div class="ttdoc">For biasing, need to address things with large indices. </div><div class="ttdef"><b>Definition:</b> <a href="bias_8h_source.html#l00015">bias.h:15</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afbcaaf974280aad6d78ca7e112438641"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double tmmc::getBias </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>address</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bias_8h_source.html#l00037">37</a> of file <a class="el" href="bias_8h_source.html">bias.h</a>.</p>

<p>Referenced by <a class="el" href="system_8cpp_source.html#l00759">calculateBias()</a>.</p>
<div class="fragment"><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;{ <span class="keywordflow">return</span> -lnPI_[address]; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7c006c0107ba4c1d52e75fc80d8581d6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> tmmc::getTransitionAddress </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nend</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For a given multidimensional array which has been cast into 1D, find the address that refers to a given transition. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Nstart</td><td>Number of total species initially (before MC move) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Nend</td><td>Number of total species (in order) after the MC move </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00074">74</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>References <a class="el" href="bias_8h_source.html#l00015">__BIAS_INT_TYPE__</a>.</p>

<p>Referenced by <a class="el" href="bias_8cpp_source.html#l00116">calculatePI()</a>, and <a class="el" href="bias_8cpp_source.html#l00107">updateC()</a>.</p>
<div class="fragment"><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                                                                                    {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                <span class="comment">// Layout of y = [0, +1, -1] </span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                <span class="keywordtype">int</span> addOrSubtract = (Nend - Nstart), y = 0;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                <span class="keywordflow">if</span> (addOrSubtract == 0) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                                y = 0;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (addOrSubtract == 1) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                                y = 1;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (addOrSubtract == -1) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                                y = 2;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Illegal addOrSubtract value&quot;</span>);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                <a class="code" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> x = Nstart - Nmin_;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                <span class="keywordflow">return</span> x*3 + y;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;}</div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00016">global.h:16</a></div></div>
<div class="ttc" id="bias_8h_html_a1ceb524363fcb94da0c64d297ea27438"><div class="ttname"><a href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a></div><div class="ttdeci">#define __BIAS_INT_TYPE__</div><div class="ttdoc">For biasing, need to address things with large indices. </div><div class="ttdef"><b>Definition:</b> <a href="bias_8h_source.html#l00015">bias.h:15</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a059a91f0f2ebe78671b5f4fb8e1ab853"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmmc::print </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>fileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>printC</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print the UN-NORMALIZED biasing function (lnPI) and possibly collection matrix to files. </p>
<p>Will overwrite the files if another with that name exists. Prints in netCDF format if enabled.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>Name of the file to print to. Will append with "_lnPI" and "_C" for biasing function and collection matrix, respectively. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">printC</td><td>Defaults to false, but if true will also print the collection matrix. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00157">157</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>References <a class="el" href="utilities_8h_source.html#l00011">sstr</a>.</p>

<p>Referenced by <a class="el" href="main_8cpp_source.html#l00054">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                                       {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="preprocessor">#ifdef NETCDF_CAPABLE</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                <span class="comment">// Print collection matrix</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                <span class="keywordflow">if</span> (printC) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                                <span class="keyword">const</span> std::string name = fileName + <span class="stringliteral">&quot;_C.nc&quot;</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                                NcFile outFile(name.c_str(), NcFile::replace);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                                NcDim probDim = outFile.addDim(<span class="stringliteral">&quot;vectorized_position&quot;</span>, C_.size());</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                                NcVar probVar = outFile.addVar(<span class="stringliteral">&quot;C&quot;</span>, ncDouble, probDim);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                                <span class="keyword">const</span> std::string dummyName = <span class="stringliteral">&quot;number_species:&quot;</span>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                probVar.putAtt(dummyName.c_str(), <a class="code" href="utilities_8h.html#a8feb627efa8e8113cdf95f9a6151a088">sstr</a>(nSpec_).c_str());</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                                <span class="keyword">const</span> std::string attName = <span class="stringliteral">&quot;species_total_upper_bound:&quot;</span>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                                probVar.putAtt(attName.c_str(), <a class="code" href="utilities_8h.html#a8feb627efa8e8113cdf95f9a6151a088">sstr</a>(Nmax_).c_str());</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                <span class="keyword">const</span> std::string attName = <span class="stringliteral">&quot;species_total_lower_bound:&quot;</span>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                probVar.putAtt(attName.c_str(), <a class="code" href="utilities_8h.html#a8feb627efa8e8113cdf95f9a6151a088">sstr</a>(Nmin_).c_str());</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                                probVar.putVar(&amp;C_[0]);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                <span class="comment">// Print lnPI (bias) matrix</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                <span class="keyword">const</span> std::string name = fileName + <span class="stringliteral">&quot;_lnPI.nc&quot;</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                NcFile outFile(name.c_str(), NcFile::replace);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                NcDim probDim = outFile.addDim(<span class="stringliteral">&quot;vectorized_position&quot;</span>, lnPI_.size());</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                NcVar probVar = outFile.addVar(<span class="stringliteral">&quot;lnPI&quot;</span>, ncDouble, probDim);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                <span class="keyword">const</span> std::string attName = <span class="stringliteral">&quot;species_total_upper_bound:&quot;</span>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                probVar.putAtt(attName.c_str(), <a class="code" href="utilities_8h.html#a8feb627efa8e8113cdf95f9a6151a088">sstr</a>(Nmax_).c_str());</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                <span class="keyword">const</span> std::string attName = <span class="stringliteral">&quot;species_total_lower_bound:&quot;</span>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                probVar.putAtt(attName.c_str(), <a class="code" href="utilities_8h.html#a8feb627efa8e8113cdf95f9a6151a088">sstr</a>(Nmin_).c_str());</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                probVar.putVar(&amp;lnPI_[0]);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                <span class="comment">// Print collection matrix</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                <span class="keywordflow">if</span> (printC) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                                std::ofstream of;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                                of.open(fileName+<span class="stringliteral">&quot;_C.dat&quot;</span>, std::ofstream::out);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                                of &lt;&lt; <span class="stringliteral">&quot;# Collection matrix in single row (vectorized) notation.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                                of &lt;&lt; <span class="stringliteral">&quot;# species_total_upper_bound: &quot;</span> &lt;&lt; Nmax_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                                of &lt;&lt; <span class="stringliteral">&quot;# species_total_lower_bound: &quot;</span> &lt;&lt; Nmin_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i = 0; i &lt; C_.size(); ++i) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                                of &lt;&lt; C_[i] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                of.close();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                <span class="comment">// Print lnPI (bias) matrix</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                std::ofstream of;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                of.open(fileName+<span class="stringliteral">&quot;_lnPI.dat&quot;</span>, std::ofstream::out);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                of &lt;&lt; <span class="stringliteral">&quot;# lnPI (bias) matrix in single row (vectorized) notation.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                of &lt;&lt; <span class="stringliteral">&quot;# species_total_upper_bound: &quot;</span> &lt;&lt; Nmax_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                of &lt;&lt; <span class="stringliteral">&quot;# species_total_lower_bound: &quot;</span> &lt;&lt; Nmin_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i = 0; i &lt; lnPI_.size(); ++i) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                                of &lt;&lt; lnPI_[i] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                of.close();</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;}</div>
<div class="ttc" id="utilities_8h_html_a8feb627efa8e8113cdf95f9a6151a088"><div class="ttname"><a href="utilities_8h.html#a8feb627efa8e8113cdf95f9a6151a088">sstr</a></div><div class="ttdeci">#define sstr(x)</div><div class="ttdoc">For converting to string. </div><div class="ttdef"><b>Definition:</b> <a href="utilities_8h_source.html#l00011">utilities.h:11</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7d9ee0505dc801cbff55bc35c3654a61"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmmc::readC </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>fileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read the collection matrix from a file. </p>
<p>This assumes the user has already guaranteed that the bounds are consistent, e.g. Nmin and Nmax, as it will not check this automatically. Also assumes file was generated by this code. "Hand made" ones might have formatting issues since parsing is done based on tokens.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>Name of file containing the collection matrix. Must include file extension. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00218">218</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>References <a class="el" href="bias_8h_source.html#l00015">__BIAS_INT_TYPE__</a>.</p>
<div class="fragment"><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                                          {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="preprocessor">#ifdef NETCDF_CAPABLE</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                NcFile dataFile (fileName.c_str(), NcFile::read);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                NcVar C_data = dataFile.getVar(<span class="stringliteral">&quot;C&quot;</span>);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                <span class="keywordflow">if</span> (C_data.isNull()) <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a>(<span class="stringliteral">&quot;Collection matrix was empty, cannot read&quot;</span>);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                C_data.getVar(&amp;C_[0]);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                std::string line;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                std::ifstream inF (fileName);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                <span class="comment">// Skip file header</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                <span class="keywordtype">bool</span> header = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                <span class="keywordflow">while</span> (header) {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                                std::getline (inF, line);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                                <span class="keywordflow">if</span> (line.compare(0,1,<span class="stringliteral">&quot;#&quot;</span>,0,1) != 0) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                                                header = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                                }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                <span class="comment">// Read line by line, parsing based on token</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                C_[0] = atof(line.c_str());</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                <a class="code" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> index = 1;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                <span class="keywordflow">while</span> (inF &gt;&gt; C_[index]) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                                index++;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;}</div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00016">global.h:16</a></div></div>
<div class="ttc" id="bias_8h_html_a1ceb524363fcb94da0c64d297ea27438"><div class="ttname"><a href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a></div><div class="ttdeci">#define __BIAS_INT_TYPE__</div><div class="ttdoc">For biasing, need to address things with large indices. </div><div class="ttdef"><b>Definition:</b> <a href="bias_8h_source.html#l00015">bias.h:15</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0c6c9f978b2093d1f4f6da7842093f3f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmmc::readlnPI </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>fileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read the macrostate distribution (biasing function) from a file. </p>
<p>This assumes the user has already guaranteed that the bounds are consistent, e.g. Nmin and Nmax, as it will not check this automatically. Also assumes file was generated by this code. "Hand made" ones might have formatting issues since parsing is done based on tokens.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>Name of file containing lnPI. Must include file extension. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00253">253</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                             {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="preprocessor">#ifdef NETCDF_CAPABLE</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                NcFile dataFile (fileName.c_str(), NcFile::read);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                NcVar lnPI_data = dataFile.getVar(<span class="stringliteral">&quot;lnPI&quot;</span>);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                <span class="keywordflow">if</span> (lnPI_data.isNull()) <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a>(<span class="stringliteral">&quot;Macrostate distribution matrix (biasing function) was empty, cannot read&quot;</span>);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                lnPI_data.getVar(&amp;lnPI_[0]);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                std::string line;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                std::ifstream inF (fileName);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                <span class="comment">// Skip file header</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                <span class="keywordtype">bool</span> header = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                <span class="keywordflow">while</span> (header) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                                std::getline (inF, line);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                                <span class="keywordflow">if</span> (line.compare(0,1,<span class="stringliteral">&quot;#&quot;</span>,0,1) != 0) {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                                                header = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                <span class="comment">// Read line by line, parsing based on token</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                lnPI_[0] = atof(line.c_str());</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index = 1;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                <span class="keywordflow">while</span> (inF &gt;&gt; lnPI_[index]) {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                                index++;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;}</div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00016">global.h:16</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4bd3a47406bf765234e1cb3a391c79d5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void tmmc::setLnPI </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>lnPIguess</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Blindly assign a guess of the macrostate distribution. </p>

<p>Definition at line <a class="el" href="bias_8h_source.html#l00033">33</a> of file <a class="el" href="bias_8h_source.html">bias.h</a>.</p>

<p>Referenced by <a class="el" href="main_8cpp_source.html#l00054">main()</a>.</p>

</div>
</div>
<a class="anchor" id="ab648f1ba2767c07fdccf9ac0e2eec8f6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tmmc::updateC </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nend</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>pa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the collection matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Nstart</td><td>Total number of atoms initially (before MC move) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Nend</td><td>Total number of atoms after the MC move </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pa</td><td>Unbiased Metropolis criterion for making a MC move (i.e. pa = min(1, exp(...))) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00107">107</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>References <a class="el" href="bias_8cpp_source.html#l00074">getTransitionAddress()</a>.</p>

<p>Referenced by <a class="el" href="system_8cpp_source.html#l00759">calculateBias()</a>.</p>
<div class="fragment"><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                                                                     {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> i = <a class="code" href="classtmmc.html#a7c006c0107ba4c1d52e75fc80d8581d6">getTransitionAddress</a>(Nstart, Nend), j = <a class="code" href="classtmmc.html#a7c006c0107ba4c1d52e75fc80d8581d6">getTransitionAddress</a>(Nstart, Nstart);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                C_[i] += pa;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                C_[j] += (1-pa);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;}</div>
<div class="ttc" id="classtmmc_html_a7c006c0107ba4c1d52e75fc80d8581d6"><div class="ttname"><a href="classtmmc.html#a7c006c0107ba4c1d52e75fc80d8581d6">tmmc::getTransitionAddress</a></div><div class="ttdeci">const __BIAS_INT_TYPE__ getTransitionAddress(const int Nstart, const int Nend)</div><div class="ttdoc">For a given multidimensional array which has been cast into 1D, find the address that refers to a giv...</div><div class="ttdef"><b>Definition:</b> <a href="bias_8cpp_source.html#l00074">bias.cpp:74</a></div></div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/Users/nam4/Desktop/omcs/src/<a class="el" href="bias_8h_source.html">bias.h</a></li>
<li>/Users/nam4/Desktop/omcs/src/<a class="el" href="bias_8cpp_source.html">bias.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 10 2015 19:26:37 for Multicomponent  Monte Carlo Simulation by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
