<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>Multicomponent  Monte Carlo Simulation: wala Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Multicomponent  Monte Carlo Simulation
   &#160;<span id="projectnumber">v0.0.1</span>
   </div>
   <div id="projectbrief">Simple, portable, extensible MC code</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classwala-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">wala Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Wang-Landau biasing class.  
 <a href="classwala.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="bias_8h_source.html">bias.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1a4483327eb3527ecc114c075b0b0598"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#a1a4483327eb3527ecc114c075b0b0598">wala</a> ()</td></tr>
<tr class="separator:a1a4483327eb3527ecc114c075b0b0598"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f8890a10284e1551b1603ecc45433e8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#a6f8890a10284e1551b1603ecc45433e8">wala</a> (const double <a class="el" href="classwala.html#acb8e59580d97bc3c5b9b4ff45eb6bb9a">lnF</a>, const double g, const double s, const int Nmax, const int Nmin)</td></tr>
<tr class="memdesc:a6f8890a10284e1551b1603ecc45433e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wang-Landau biasing constructor.  <a href="#a6f8890a10284e1551b1603ecc45433e8">More...</a><br /></td></tr>
<tr class="separator:a6f8890a10284e1551b1603ecc45433e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5eb2622be6a9e89f5e59ba0b15aca4bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#a5eb2622be6a9e89f5e59ba0b15aca4bd">update</a> (const int Nval)</td></tr>
<tr class="memdesc:a5eb2622be6a9e89f5e59ba0b15aca4bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the estimate of the macrostate distribution.  <a href="#a5eb2622be6a9e89f5e59ba0b15aca4bd">More...</a><br /></td></tr>
<tr class="separator:a5eb2622be6a9e89f5e59ba0b15aca4bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae06c2f1475702ec9d1b0a243b7f34e4b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#ae06c2f1475702ec9d1b0a243b7f34e4b">iterateForward</a> ()</td></tr>
<tr class="memdesc:ae06c2f1475702ec9d1b0a243b7f34e4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This should only be called when the "flatness" criterion is met.  <a href="#ae06c2f1475702ec9d1b0a243b7f34e4b">More...</a><br /></td></tr>
<tr class="separator:ae06c2f1475702ec9d1b0a243b7f34e4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65569289fac85d0da9c336e17c9d809a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#a65569289fac85d0da9c336e17c9d809a">print</a> (const std::string fileName, const bool printH=false)</td></tr>
<tr class="memdesc:a65569289fac85d0da9c336e17c9d809a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the UN-NORMALIZED biasing function (lnPI) and possible the visted-states histogram to files.  <a href="#a65569289fac85d0da9c336e17c9d809a">More...</a><br /></td></tr>
<tr class="separator:a65569289fac85d0da9c336e17c9d809a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae04916f49c11b0636e813787a3906570"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#ae04916f49c11b0636e813787a3906570">readlnPI</a> (const std::string fileName)</td></tr>
<tr class="memdesc:ae04916f49c11b0636e813787a3906570"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the macrostate distribution (biasing function) from a file.  <a href="#ae04916f49c11b0636e813787a3906570">More...</a><br /></td></tr>
<tr class="separator:ae04916f49c11b0636e813787a3906570"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add6302db96fcc45811b2944de2936525"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#add6302db96fcc45811b2944de2936525">evaluateFlatness</a> ()</td></tr>
<tr class="memdesc:add6302db96fcc45811b2944de2936525"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate if the visited states histogram is approxiamtely "flat".  <a href="#add6302db96fcc45811b2944de2936525">More...</a><br /></td></tr>
<tr class="separator:add6302db96fcc45811b2944de2936525"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01a9bf2af8eaf65c719745ad1b12d238"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#a01a9bf2af8eaf65c719745ad1b12d238">getAddress</a> (const int Nval)</td></tr>
<tr class="memdesc:a01a9bf2af8eaf65c719745ad1b12d238"><td class="mdescLeft">&#160;</td><td class="mdescRight">For multidimensional Wang-Landau biasing, get the 1D coordinate of the macrostate distribution estimate (bias) for multidimensional data.  <a href="#a01a9bf2af8eaf65c719745ad1b12d238">More...</a><br /></td></tr>
<tr class="separator:a01a9bf2af8eaf65c719745ad1b12d238"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb8e59580d97bc3c5b9b4ff45eb6bb9a"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#acb8e59580d97bc3c5b9b4ff45eb6bb9a">lnF</a> ()</td></tr>
<tr class="separator:acb8e59580d97bc3c5b9b4ff45eb6bb9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03f7b333aa0a280e78060bd9af7ec318"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#a03f7b333aa0a280e78060bd9af7ec318">getBias</a> (const int address)</td></tr>
<tr class="separator:a03f7b333aa0a280e78060bd9af7ec318"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80b00e34135eb6da4e81cd0935622fc5"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#a80b00e34135eb6da4e81cd0935622fc5">getlnPI</a> ()</td></tr>
<tr class="memdesc:a80b00e34135eb6da4e81cd0935622fc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the current estimate of the macrostate distribution.  <a href="#a80b00e34135eb6da4e81cd0935622fc5">More...</a><br /></td></tr>
<tr class="separator:a80b00e34135eb6da4e81cd0935622fc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Wang-Landau biasing class. </p>

<p>Definition at line <a class="el" href="bias_8h_source.html#l00048">48</a> of file <a class="el" href="bias_8h_source.html">bias.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a1a4483327eb3527ecc114c075b0b0598"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">wala::wala </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bias_8h_source.html#l00050">50</a> of file <a class="el" href="bias_8h_source.html">bias.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{};</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6f8890a10284e1551b1603ecc45433e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">wala::wala </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lnF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nmin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wang-Landau biasing constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lnF</td><td>Factor by which the estimate of the density of states in updated each time it is visited. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">g</td><td>Factor by which lnF is reduced (multiplied) once "flatness" has been achieved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Factor by which the min(H) must be within the mean of H to be considered "flat", e.g. 0.8 &ndash;&gt; min is within 20% error of mean </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nSpec</td><td>Number of species in the simulation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Nmax</td><td>Upper bound for total number of particles. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Nmin</td><td>Lower bound for total number of particles. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00292">292</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>References <a class="el" href="bias_8h_source.html#l00015">__BIAS_INT_TYPE__</a>, and <a class="el" href="bias_8h_source.html#l00059">lnF()</a>.</p>
<div class="fragment"><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                                                                                            {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classwala.html#acb8e59580d97bc3c5b9b4ff45eb6bb9a">lnF</a> &lt; 0) {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;lnF in Wang-Landau cannot be &lt; 0&quot;</span>);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                lnF_ = <a class="code" href="classwala.html#acb8e59580d97bc3c5b9b4ff45eb6bb9a">lnF</a>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                <span class="keywordflow">if</span> (g &lt;= 0 || g &gt;= 1) {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;In Wang-Landau 0 &lt; g &lt; 1&quot;</span>);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                g_ = g;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                <span class="keywordflow">if</span> (s &lt;= 0 || s &gt;= 1) {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;In Wang-Landau 0 &lt; s &lt; 1&quot;</span>);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                s_ = s;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                <span class="keywordflow">if</span> (Nmin &gt; Nmax) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Nmin &gt; Nmax in Wang-Landau object&quot;</span>);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                <a class="code" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> size = (Nmax - Nmin + 1);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                Nmin_ = Nmin;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                Nmax_ = Nmax;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                <span class="comment">// attempt to allocate memory for macrostate distribution matrix and initializes it all to 0</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                                lnPI_.resize(size, 0.0);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::bad_alloc &amp;ce) {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Out of memory, cannot allocate space for macrostate distribution matrix in wala&quot;</span>);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                <span class="comment">// initialize the visited-states histogram</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                                H_.resize(size, 0.0);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::bad_alloc &amp;ce) {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Out of memory, cannot allocate space for visited-states histogram in wala&quot;</span>);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;}</div>
<div class="ttc" id="classwala_html_acb8e59580d97bc3c5b9b4ff45eb6bb9a"><div class="ttname"><a href="classwala.html#acb8e59580d97bc3c5b9b4ff45eb6bb9a">wala::lnF</a></div><div class="ttdeci">const double lnF()</div><div class="ttdef"><b>Definition:</b> <a href="bias_8h_source.html#l00059">bias.h:59</a></div></div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00016">global.h:16</a></div></div>
<div class="ttc" id="bias_8h_html_a1ceb524363fcb94da0c64d297ea27438"><div class="ttname"><a href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a></div><div class="ttdeci">#define __BIAS_INT_TYPE__</div><div class="ttdoc">For biasing, need to address things with large indices. </div><div class="ttdef"><b>Definition:</b> <a href="bias_8h_source.html#l00015">bias.h:15</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="add6302db96fcc45811b2944de2936525"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool wala::evaluateFlatness </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate if the visited states histogram is approxiamtely "flat". </p>
<dl class="section return"><dt>Returns</dt><dd>Returns whether the histogram is flat or not. </dd></dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00358">358</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>References <a class="el" href="bias_8h_source.html#l00020">specExp</a>.</p>

<p>Referenced by <a class="el" href="main_8cpp_source.html#l00054">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                             {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                <span class="keywordtype">double</span> min = H_[0], lnMean = -DBL_MAX;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; H_.size(); ++i) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                                <span class="keywordflow">if</span> (H_[i] &lt; min) {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                                                min = H_[i];</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                                }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                                </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                                <span class="comment">// summing so many doubles may overrun DBL_MAX, so instead track the lnMean</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                                lnMean = <a class="code" href="bias_8h.html#a9f1e113b6454173bd61677519ec34c3a">specExp</a>(lnMean, log(H_[i]));</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                lnMean -= log(H_.size());</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                <span class="keywordflow">if</span> (log(min) - lnMean &gt; log(s_)) {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;}</div>
<div class="ttc" id="bias_8h_html_a9f1e113b6454173bd61677519ec34c3a"><div class="ttname"><a href="bias_8h.html#a9f1e113b6454173bd61677519ec34c3a">specExp</a></div><div class="ttdeci">#define specExp(a, b)</div><div class="ttdoc">Jacobi method for evaluating natural logarithm of a sum of exponentials E.g. </div><div class="ttdef"><b>Definition:</b> <a href="bias_8h_source.html#l00020">bias.h:20</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a01a9bf2af8eaf65c719745ad1b12d238"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> wala::getAddress </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nval</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For multidimensional Wang-Landau biasing, get the 1D coordinate of the macrostate distribution estimate (bias) for multidimensional data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Nval</td><td>Total number of atoms in the system </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00337">337</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>References <a class="el" href="bias_8h_source.html#l00015">__BIAS_INT_TYPE__</a>.</p>

<p>Referenced by <a class="el" href="system_8cpp_source.html#l00759">calculateBias()</a>, and <a class="el" href="bias_8cpp_source.html#l00347">update()</a>.</p>
<div class="fragment"><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                                                        {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                <a class="code" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> x = Nval - Nmin_;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                <span class="keywordflow">return</span> x;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;}</div>
<div class="ttc" id="bias_8h_html_a1ceb524363fcb94da0c64d297ea27438"><div class="ttname"><a href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a></div><div class="ttdeci">#define __BIAS_INT_TYPE__</div><div class="ttdoc">For biasing, need to address things with large indices. </div><div class="ttdef"><b>Definition:</b> <a href="bias_8h_source.html#l00015">bias.h:15</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a03f7b333aa0a280e78060bd9af7ec318"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double wala::getBias </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>address</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bias_8h_source.html#l00060">60</a> of file <a class="el" href="bias_8h_source.html">bias.h</a>.</p>

<p>Referenced by <a class="el" href="system_8cpp_source.html#l00759">calculateBias()</a>.</p>
<div class="fragment"><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;{ <span class="keywordflow">return</span> -lnPI_[address]; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a80b00e34135eb6da4e81cd0935622fc5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt;double&gt; wala::getlnPI </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the current estimate of the macrostate distribution. </p>

<p>Definition at line <a class="el" href="bias_8h_source.html#l00061">61</a> of file <a class="el" href="bias_8h_source.html">bias.h</a>.</p>

<p>Referenced by <a class="el" href="main_8cpp_source.html#l00054">main()</a>.</p>

</div>
</div>
<a class="anchor" id="ae06c2f1475702ec9d1b0a243b7f34e4b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wala::iterateForward </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This should only be called when the "flatness" criterion is met. </p>
<p>This then resets the visited-states histogram H, and decrements lnF. </p>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00379">379</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>Referenced by <a class="el" href="main_8cpp_source.html#l00054">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                           {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                lnF_ = lnF_*g_;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                std::fill(H_.begin(), H_.end(), 0);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acb8e59580d97bc3c5b9b4ff45eb6bb9a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double wala::lnF </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bias_8h_source.html#l00059">59</a> of file <a class="el" href="bias_8h_source.html">bias.h</a>.</p>

<p>Referenced by <a class="el" href="main_8cpp_source.html#l00054">main()</a>, and <a class="el" href="bias_8cpp_source.html#l00292">wala()</a>.</p>
<div class="fragment"><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;{ <span class="keywordflow">return</span> lnF_; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a65569289fac85d0da9c336e17c9d809a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wala::print </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>fileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>printH</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print the UN-NORMALIZED biasing function (lnPI) and possible the visted-states histogram to files. </p>
<p>Will overwrite the files if another with that name exists. Prints in netCDF format if enabled.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>Name of the file to print to. Will append with "_lnPI" and "_H" for the macrostate distribution and visited-states histogram, respectively. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">printH</td><td>Defaults to false, but if true will also print the visited-states histogram. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00392">392</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>References <a class="el" href="utilities_8h_source.html#l00011">sstr</a>.</p>

<p>Referenced by <a class="el" href="main_8cpp_source.html#l00054">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                                                       {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="preprocessor">#ifdef NETCDF_CAPABLE</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                <span class="comment">// Print visited-states histogram</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                <span class="keywordflow">if</span> (printH) {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                                <span class="keyword">const</span> std::string name = fileName + <span class="stringliteral">&quot;_H.nc&quot;</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                                NcFile outFile(name.c_str(), NcFile::replace);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                                NcDim probDim = outFile.addDim(<span class="stringliteral">&quot;vectorized_position&quot;</span>, H_.size());</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                                NcVar probVar = outFile.addVar(<span class="stringliteral">&quot;H&quot;</span>, ncDouble, probDim);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                                <span class="keyword">const</span> std::string dummyName = <span class="stringliteral">&quot;number_species:&quot;</span>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                                probVar.putAtt(dummyName.c_str(), <a class="code" href="utilities_8h.html#a8feb627efa8e8113cdf95f9a6151a088">sstr</a>(nSpec_).c_str());</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                                <span class="keyword">const</span> std::string attName = <span class="stringliteral">&quot;species_total_upper_bound:&quot;</span>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                                probVar.putAtt(attName.c_str(), <a class="code" href="utilities_8h.html#a8feb627efa8e8113cdf95f9a6151a088">sstr</a>(Nmax_).c_str());</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                                <span class="keyword">const</span> std::string attName = <span class="stringliteral">&quot;species_upper_lower_bound:&quot;</span>;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                                probVar.putAtt(attName.c_str(), <a class="code" href="utilities_8h.html#a8feb627efa8e8113cdf95f9a6151a088">sstr</a>(Nmin_).c_str());</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                                probVar.putVar(&amp;H_[0]);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                }</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                <span class="comment">// Print lnPI (bias) matrix</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                <span class="keyword">const</span> std::string name = fileName + <span class="stringliteral">&quot;_lnPI.nc&quot;</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                NcFile outFile(name.c_str(), NcFile::replace);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                NcDim probDim = outFile.addDim(<span class="stringliteral">&quot;vectorized_position&quot;</span>, lnPI_.size());</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                NcVar probVar = outFile.addVar(<span class="stringliteral">&quot;lnPI&quot;</span>, ncDouble, probDim);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                <span class="keyword">const</span> std::string dummyName = <span class="stringliteral">&quot;number_species:&quot;</span>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                probVar.putAtt(dummyName.c_str(), <a class="code" href="utilities_8h.html#a8feb627efa8e8113cdf95f9a6151a088">sstr</a>(nSpec_).c_str());</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                <span class="keyword">const</span> std::string attName = <span class="stringliteral">&quot;species_total_upper_bound:&quot;</span>;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                probVar.putAtt(attName.c_str(), <a class="code" href="utilities_8h.html#a8feb627efa8e8113cdf95f9a6151a088">sstr</a>(Nmax_).c_str());</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                <span class="keyword">const</span> std::string attName = <span class="stringliteral">&quot;species_total_lower_bound:&quot;</span>;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                probVar.putAtt(attName.c_str(), <a class="code" href="utilities_8h.html#a8feb627efa8e8113cdf95f9a6151a088">sstr</a>(Nmin_).c_str());</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                probVar.putVar(&amp;lnPI_[0]);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                <span class="comment">// Print visited-states histogram</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                <span class="keywordflow">if</span> (printH) {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                                std::ofstream of;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                                of.open(fileName+<span class="stringliteral">&quot;_H.dat&quot;</span>, std::ofstream::out);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                                of &lt;&lt; <span class="stringliteral">&quot;# Visited-states histogram in single row (vectorized) notation.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                                of &lt;&lt; <span class="stringliteral">&quot;# species_total_upper_bound:&quot;</span> &lt;&lt; Nmax_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                                of &lt;&lt; <span class="stringliteral">&quot;# species_total_lower_bound:&quot;</span> &lt;&lt; Nmin_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i = 0; i &lt; H_.size(); ++i) {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                                                of &lt;&lt; H_[i] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                                }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                                of.close();</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                <span class="comment">// Print lnPI (bias) matrix</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                std::ofstream of;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                of.open(fileName+<span class="stringliteral">&quot;_lnPI.dat&quot;</span>, std::ofstream::out);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                of &lt;&lt; <span class="stringliteral">&quot;# lnPI (bias) matrix in single row (vectorized) notation.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                of &lt;&lt; <span class="stringliteral">&quot;# species_total_upper_bound:&quot;</span> &lt;&lt; Nmax_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                of &lt;&lt; <span class="stringliteral">&quot;# species_total_lower_bound:&quot;</span> &lt;&lt; Nmin_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i = 0; i &lt; lnPI_.size(); ++i) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                                of &lt;&lt; lnPI_[i] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                of.close();</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;}</div>
<div class="ttc" id="utilities_8h_html_a8feb627efa8e8113cdf95f9a6151a088"><div class="ttname"><a href="utilities_8h.html#a8feb627efa8e8113cdf95f9a6151a088">sstr</a></div><div class="ttdeci">#define sstr(x)</div><div class="ttdoc">For converting to string. </div><div class="ttdef"><b>Definition:</b> <a href="utilities_8h_source.html#l00011">utilities.h:11</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae04916f49c11b0636e813787a3906570"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wala::readlnPI </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>fileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read the macrostate distribution (biasing function) from a file. </p>
<p>This assumes the user has already guaranteed that the bounds are consistent, e.g. Nmin and Nmax, as it will not check this automatically. Also assumes file was generated by this code. "Hand made" ones might have formatting issues since parsing is done based on tokens.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>Name of file containing lnPI. Must include file extension. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00455">455</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>References <a class="el" href="bias_8h_source.html#l00015">__BIAS_INT_TYPE__</a>.</p>
<div class="fragment"><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                                             {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="preprocessor">#ifdef NETCDF_CAPABLE</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                NcFile dataFile (fileName.c_str(), NcFile::read);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                NcVar lnPI_data = dataFile.getVar(<span class="stringliteral">&quot;lnPI&quot;</span>);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                <span class="keywordflow">if</span> (lnPI_data.isNull()) <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a>(<span class="stringliteral">&quot;Macrostate distribution matrix (biasing function) was empty, cannot read&quot;</span>);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                lnPI_data.getVar(&amp;lnPI_[0]);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                std::string line;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                std::ifstream inF (fileName);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                <span class="comment">// Skip file header</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                <span class="keywordtype">bool</span> header = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                <span class="keywordflow">while</span> (header) {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                                std::getline (inF, line);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                                <span class="keywordflow">if</span> (line.compare(0,1,<span class="stringliteral">&quot;#&quot;</span>,0,1) != 0) {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                                                header = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                                }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                <span class="comment">// Read line by line, parsing based on token</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                lnPI_[0] = atof(line.c_str());</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                <a class="code" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> index = 1;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                <span class="keywordflow">while</span> (inF &gt;&gt; lnPI_[index]) {</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                                index++;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="preprocessor">}<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00016">global.h:16</a></div></div>
<div class="ttc" id="bias_8h_html_a1ceb524363fcb94da0c64d297ea27438"><div class="ttname"><a href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a></div><div class="ttdeci">#define __BIAS_INT_TYPE__</div><div class="ttdoc">For biasing, need to address things with large indices. </div><div class="ttdef"><b>Definition:</b> <a href="bias_8h_source.html#l00015">bias.h:15</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5eb2622be6a9e89f5e59ba0b15aca4bd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wala::update </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nval</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the estimate of the macrostate distribution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Nval</td><td>Total current number of atoms in the system </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00347">347</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>References <a class="el" href="bias_8h_source.html#l00015">__BIAS_INT_TYPE__</a>, and <a class="el" href="bias_8cpp_source.html#l00337">getAddress()</a>.</p>

<p>Referenced by <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, <a class="el" href="translate_8cpp_source.html#l00010">translateParticle::make()</a>, <a class="el" href="swap_8cpp_source.html#l00010">swapParticles::make()</a>, and <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>.</p>
<div class="fragment"><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                                 {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                <a class="code" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> address = <a class="code" href="classwala.html#a01a9bf2af8eaf65c719745ad1b12d238">getAddress</a> (Nval);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                lnPI_[address] += lnF_;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                H_[address] += 1.0;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;}</div>
<div class="ttc" id="classwala_html_a01a9bf2af8eaf65c719745ad1b12d238"><div class="ttname"><a href="classwala.html#a01a9bf2af8eaf65c719745ad1b12d238">wala::getAddress</a></div><div class="ttdeci">const __BIAS_INT_TYPE__ getAddress(const int Nval)</div><div class="ttdoc">For multidimensional Wang-Landau biasing, get the 1D coordinate of the macrostate distribution estima...</div><div class="ttdef"><b>Definition:</b> <a href="bias_8cpp_source.html#l00337">bias.cpp:337</a></div></div>
<div class="ttc" id="bias_8h_html_a1ceb524363fcb94da0c64d297ea27438"><div class="ttname"><a href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a></div><div class="ttdeci">#define __BIAS_INT_TYPE__</div><div class="ttdoc">For biasing, need to address things with large indices. </div><div class="ttdef"><b>Definition:</b> <a href="bias_8h_source.html#l00015">bias.h:15</a></div></div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/Users/nam4/Desktop/omcs/src/<a class="el" href="bias_8h_source.html">bias.h</a></li>
<li>/Users/nam4/Desktop/omcs/src/<a class="el" href="bias_8cpp_source.html">bias.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Aug 10 2015 19:26:37 for Multicomponent  Monte Carlo Simulation by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
