\hypertarget{classwala}{\section{wala Class Reference}
\label{classwala}\index{wala@{wala}}
}


Wang-\/\-Landau biasing class.  




{\ttfamily \#include $<$bias.\-h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classwala_a1a4483327eb3527ecc114c075b0b0598}{wala} ()
\item 
\hyperlink{classwala_ac0d2f33ee8226fb4306628a750ed0d14}{wala} (const double \hyperlink{classwala_acb8e59580d97bc3c5b9b4ff45eb6bb9a}{ln\-F}, const double g, const double s, const int Nmax, const int Nmin, const int Mtot, const std\-::vector$<$ double $>$ box)
\begin{DoxyCompactList}\small\item\em Wang-\/\-Landau biasing constructor. \end{DoxyCompactList}\item 
void \hyperlink{classwala_ab439e3f60bea6c54522a870b9ad67acf}{update} (const int Nval, const int Mval)
\begin{DoxyCompactList}\small\item\em Update the estimate of the macrostate distribution. \end{DoxyCompactList}\item 
void \hyperlink{classwala_ae06c2f1475702ec9d1b0a243b7f34e4b}{iterate\-Forward} ()
\begin{DoxyCompactList}\small\item\em This should only be called when the \char`\"{}flatness\char`\"{} criterion is met. \end{DoxyCompactList}\item 
void \hyperlink{classwala_a65569289fac85d0da9c336e17c9d809a}{print} (const std\-::string file\-Name, const bool print\-H=false)
\begin{DoxyCompactList}\small\item\em Print the U\-N-\/\-N\-O\-R\-M\-A\-L\-I\-Z\-E\-D biasing function (ln\-P\-I) and possible the visted states histogram to files. \end{DoxyCompactList}\item 
void \hyperlink{classwala_ae04916f49c11b0636e813787a3906570}{readln\-P\-I} (const std\-::string file\-Name)
\begin{DoxyCompactList}\small\item\em Read the macrostate distribution (biasing function) from a file. \end{DoxyCompactList}\item 
void \hyperlink{classwala_a0b8df0fb2b7722fc4a458e527a478b6f}{read\-H} (const std\-::string file\-Name)
\begin{DoxyCompactList}\small\item\em Read the visited states histogram from a file. \end{DoxyCompactList}\item 
void \hyperlink{classwala_a1d778061b12611b1a35eb3ca15038d02}{setln\-P\-I} (const std\-::vector$<$ double $>$ \&ln\-P\-Iguess)
\begin{DoxyCompactList}\small\item\em Blindly assign a guess of the macrostate distribution. \end{DoxyCompactList}\item 
bool \hyperlink{classwala_add6302db96fcc45811b2944de2936525}{evaluate\-Flatness} ()
\begin{DoxyCompactList}\small\item\em Evaluate if the visited states histogram is approxiamtely \char`\"{}flat\char`\"{}. \end{DoxyCompactList}\item 
const long long int \hyperlink{classwala_a85b637b892b3c24cb252397433cbfad0}{get\-Address} (const int Nval, const int Mval)
\begin{DoxyCompactList}\small\item\em For multidimensional Wang-\/\-Landau biasing, get the 1\-D coordinate of the macrostate distribution estimate (bias) for multidimensional data. \end{DoxyCompactList}\item 
const double \hyperlink{classwala_acb8e59580d97bc3c5b9b4ff45eb6bb9a}{ln\-F} ()
\item 
const double \hyperlink{classwala_a03f7b333aa0a280e78060bd9af7ec318}{get\-Bias} (const int address)
\item 
const std\-::vector$<$ double $>$ \hyperlink{classwala_a80b00e34135eb6da4e81cd0935622fc5}{getln\-P\-I} ()
\begin{DoxyCompactList}\small\item\em Return the current estimate of the macrostate distribution. \end{DoxyCompactList}\item 
const std\-::vector$<$ double $>$ \hyperlink{classwala_a52cec7bdf93eec7d4eefc627b71f1f65}{get\-H} ()
\begin{DoxyCompactList}\small\item\em Return the visited-\/states histogram. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Wang-\/\-Landau biasing class. 

Definition at line 56 of file bias.\-h.



\subsection{Constructor \& Destructor Documentation}
\hypertarget{classwala_a1a4483327eb3527ecc114c075b0b0598}{\index{wala@{wala}!wala@{wala}}
\index{wala@{wala}!wala@{wala}}
\subsubsection[{wala}]{\setlength{\rightskip}{0pt plus 5cm}wala\-::wala (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classwala_a1a4483327eb3527ecc114c075b0b0598}


Definition at line 58 of file bias.\-h.


\begin{DoxyCode}
58 \{\};
\end{DoxyCode}
\hypertarget{classwala_ac0d2f33ee8226fb4306628a750ed0d14}{\index{wala@{wala}!wala@{wala}}
\index{wala@{wala}!wala@{wala}}
\subsubsection[{wala}]{\setlength{\rightskip}{0pt plus 5cm}wala\-::wala (
\begin{DoxyParamCaption}
\item[{const double}]{ln\-F, }
\item[{const double}]{g, }
\item[{const double}]{s, }
\item[{const int}]{Nmax, }
\item[{const int}]{Nmin, }
\item[{const int}]{Mtot, }
\item[{const std\-::vector$<$ double $>$}]{box}
\end{DoxyParamCaption}
)}}\label{classwala_ac0d2f33ee8226fb4306628a750ed0d14}


Wang-\/\-Landau biasing constructor. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em ln\-F} & Factor by which the estimate of the density of states in updated each time it is visited. \\
\hline
\mbox{\tt in}  & {\em g} & Factor by which ln\-F is reduced (multiplied) once \char`\"{}flatness\char`\"{} has been achieved. \\
\hline
\mbox{\tt in}  & {\em s} & Factor by which the min(\-H) must be within the mean of H to be considered \char`\"{}flat\char`\"{}, e.\-g. 0.\-8 --$>$ min is within 20\% error of mean \\
\hline
\mbox{\tt in}  & {\em Nmax} & Upper bound for total number of particles. \\
\hline
\mbox{\tt in}  & {\em Nmin} & Lower bound for total number of particles. \\
\hline
\mbox{\tt in}  & {\em Mtot} & Total number of expanded ensemble states in a system. \\
\hline
\mbox{\tt in}  & {\em box} & Vector of simulation box size. \\
\hline
\end{DoxyParams}


Definition at line 405 of file bias.\-cpp.



References ln\-F().


\begin{DoxyCode}
405                                                                                                            
                                     \{
406     \textcolor{keywordflow}{if} (\hyperlink{classwala_acb8e59580d97bc3c5b9b4ff45eb6bb9a}{lnF} < 0) \{
407         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"lnF in Wang-Landau cannot be < 0"});
408     \}
409     lnF\_ = \hyperlink{classwala_acb8e59580d97bc3c5b9b4ff45eb6bb9a}{lnF};
410 
411     \textcolor{keywordflow}{if} (g <= 0 || g >= 1) \{
412         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"In Wang-Landau 0 < g < 1"});
413     \}
414     g\_ = g;
415 
416     \textcolor{keywordflow}{if} (s <= 0 || s >= 1) \{
417         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"In Wang-Landau 0 < s < 1"});
418     \}
419     s\_ = s;
420 
421     \textcolor{keywordflow}{if} (Nmin > Nmax) \{
422         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Nmin > Nmax in Wang-Landau object"});
423     \}
424 
425     \textcolor{keywordflow}{if} (Nmin < 0) \{
426         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Nmin < 0 in Wang-Landau object"});
427     \}
428 
429     \textcolor{keywordflow}{if} (Mtot < 1) \{
430         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Mtot < 1 in Wang-Landau object"});
431     \}
432     Mtot\_ = Mtot;
433 
434     \textcolor{keywordflow}{if} (box.size() != 3) \{
435         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Illegal number of box dimensions in Wang-Landau"});
436     \}
437     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < box.size(); ++i) \{
438         \textcolor{keywordflow}{if} (box[i] < 0) \{
439             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Illegal box dimensions in Wang-Landau"});
440         \}
441     \}
442     box\_.resize(3, 0);
443     box\_ = box;
444 
445     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} size = (Nmax - Nmin + 1);
446 
447     Nmin\_ = Nmin;
448     Nmax\_ = Nmax;
449 
450     \textcolor{comment}{// attempt to allocate memory for macrostate distribution matrix and initializes it all to 0}
451     \textcolor{keywordflow}{try} \{
452         lnPI\_.resize(size*Mtot\_, 0.0);
453     \} \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} std::bad\_alloc &ce) \{
454         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory, cannot allocate space for macrostate
       distribution matrix in wala"});
455     \}
456 
457     \textcolor{comment}{// initialize the visited-states histogram}
458     \textcolor{keywordflow}{try} \{
459         H\_.resize(size*Mtot\_, 0.0);
460     \} \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} std::bad\_alloc &ce) \{
461         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory, cannot allocate space for visited-states
       histogram in wala"});
462     \}
463 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\hypertarget{classwala_add6302db96fcc45811b2944de2936525}{\index{wala@{wala}!evaluate\-Flatness@{evaluate\-Flatness}}
\index{evaluate\-Flatness@{evaluate\-Flatness}!wala@{wala}}
\subsubsection[{evaluate\-Flatness}]{\setlength{\rightskip}{0pt plus 5cm}bool wala\-::evaluate\-Flatness (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classwala_add6302db96fcc45811b2944de2936525}


Evaluate if the visited states histogram is approxiamtely \char`\"{}flat\char`\"{}. 

\begin{DoxyReturn}{Returns}
Returns whether the histogram is flat or not. 
\end{DoxyReturn}


Definition at line 495 of file bias.\-cpp.



References spec\-Exp.



Referenced by perform\-Crossover(), and perform\-W\-A\-L\-A().


\begin{DoxyCode}
495                              \{
496     \textcolor{keywordtype}{double} min = H\_[0], lnMean = -DBL\_MAX;
497     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < H\_.size() - (Mtot\_-1); ++i) \{ \textcolor{comment}{// insert routine prevents the sampling past
       N = Nmax, M = 0, so N = Nmax and M > 0 are validly empty}
498         \textcolor{keywordflow}{if} (H\_[i] < min) \{
499             min = H\_[i];
500         \}
501 
502         \textcolor{comment}{// summing so many doubles may overrun DBL\_MAX, so instead track the lnMean}
503         lnMean = \hyperlink{bias_8h_a9f1e113b6454173bd61677519ec34c3a}{specExp}(lnMean, log(H\_[i]));
504     \}
505     lnMean -= log(H\_.size() - (Mtot\_-1));
506 
507     \textcolor{keywordflow}{if} (log(min) - lnMean > log(s\_)) \{
508         \textcolor{keywordflow}{return} \textcolor{keyword}{true};
509     \}
510     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
511 \}
\end{DoxyCode}
\hypertarget{classwala_a85b637b892b3c24cb252397433cbfad0}{\index{wala@{wala}!get\-Address@{get\-Address}}
\index{get\-Address@{get\-Address}!wala@{wala}}
\subsubsection[{get\-Address}]{\setlength{\rightskip}{0pt plus 5cm}const long long int wala\-::get\-Address (
\begin{DoxyParamCaption}
\item[{const int}]{Nval, }
\item[{const int}]{Mval}
\end{DoxyParamCaption}
)}}\label{classwala_a85b637b892b3c24cb252397433cbfad0}


For multidimensional Wang-\/\-Landau biasing, get the 1\-D coordinate of the macrostate distribution estimate (bias) for multidimensional data. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Nval} & Total number of atoms in the system \\
\hline
\mbox{\tt in}  & {\em Mval} & Current value of the expanded ensemble state of the system \\
\hline
\end{DoxyParams}


Definition at line 471 of file bias.\-cpp.



Referenced by calculate\-Bias(), and update().


\begin{DoxyCode}
471                                                                     \{
472     \textcolor{keywordflow}{if} (Nval > Nmax\_ || Nval < Nmin\_ || Mval < 0 || Mval > Mtot\_-1) \{
473         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"N, M out of bounds in Wang-Landau object, cannot retrieve
       address"});
474     \}
475     \textcolor{keywordflow}{return} (Nval - Nmin\_)*Mtot\_ + Mval;
476 \}
\end{DoxyCode}
\hypertarget{classwala_a03f7b333aa0a280e78060bd9af7ec318}{\index{wala@{wala}!get\-Bias@{get\-Bias}}
\index{get\-Bias@{get\-Bias}!wala@{wala}}
\subsubsection[{get\-Bias}]{\setlength{\rightskip}{0pt plus 5cm}const double wala\-::get\-Bias (
\begin{DoxyParamCaption}
\item[{const int}]{address}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classwala_a03f7b333aa0a280e78060bd9af7ec318}


Definition at line 70 of file bias.\-h.



Referenced by calculate\-Bias().


\begin{DoxyCode}
70 \{ \textcolor{keywordflow}{return} -lnPI\_[address]; \}
\end{DoxyCode}
\hypertarget{classwala_a52cec7bdf93eec7d4eefc627b71f1f65}{\index{wala@{wala}!get\-H@{get\-H}}
\index{get\-H@{get\-H}!wala@{wala}}
\subsubsection[{get\-H}]{\setlength{\rightskip}{0pt plus 5cm}const std\-::vector$<$double$>$ wala\-::get\-H (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classwala_a52cec7bdf93eec7d4eefc627b71f1f65}


Return the visited-\/states histogram. 



Definition at line 72 of file bias.\-h.

\hypertarget{classwala_a80b00e34135eb6da4e81cd0935622fc5}{\index{wala@{wala}!getln\-P\-I@{getln\-P\-I}}
\index{getln\-P\-I@{getln\-P\-I}!wala@{wala}}
\subsubsection[{getln\-P\-I}]{\setlength{\rightskip}{0pt plus 5cm}const std\-::vector$<$double$>$ wala\-::getln\-P\-I (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classwala_a80b00e34135eb6da4e81cd0935622fc5}


Return the current estimate of the macrostate distribution. 



Definition at line 71 of file bias.\-h.

\hypertarget{classwala_ae06c2f1475702ec9d1b0a243b7f34e4b}{\index{wala@{wala}!iterate\-Forward@{iterate\-Forward}}
\index{iterate\-Forward@{iterate\-Forward}!wala@{wala}}
\subsubsection[{iterate\-Forward}]{\setlength{\rightskip}{0pt plus 5cm}void wala\-::iterate\-Forward (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classwala_ae06c2f1475702ec9d1b0a243b7f34e4b}


This should only be called when the \char`\"{}flatness\char`\"{} criterion is met. 

This then resets the visited-\/states histogram H, and decrements ln\-F. 

Definition at line 516 of file bias.\-cpp.



Referenced by perform\-Crossover(), and perform\-W\-A\-L\-A().


\begin{DoxyCode}
516                            \{
517     lnF\_ = lnF\_*g\_;
518     std::fill(H\_.begin(), H\_.end(), 0);
519 \}
\end{DoxyCode}
\hypertarget{classwala_acb8e59580d97bc3c5b9b4ff45eb6bb9a}{\index{wala@{wala}!ln\-F@{ln\-F}}
\index{ln\-F@{ln\-F}!wala@{wala}}
\subsubsection[{ln\-F}]{\setlength{\rightskip}{0pt plus 5cm}const double wala\-::ln\-F (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classwala_acb8e59580d97bc3c5b9b4ff45eb6bb9a}


Definition at line 69 of file bias.\-h.



Referenced by checkpoint\-::dump(), perform\-Crossover(), perform\-W\-A\-L\-A(), and wala().


\begin{DoxyCode}
69 \{ \textcolor{keywordflow}{return} lnF\_; \}
\end{DoxyCode}
\hypertarget{classwala_a65569289fac85d0da9c336e17c9d809a}{\index{wala@{wala}!print@{print}}
\index{print@{print}!wala@{wala}}
\subsubsection[{print}]{\setlength{\rightskip}{0pt plus 5cm}void wala\-::print (
\begin{DoxyParamCaption}
\item[{const std\-::string}]{file\-Name, }
\item[{const bool}]{print\-H = {\ttfamily false}}
\end{DoxyParamCaption}
)}}\label{classwala_a65569289fac85d0da9c336e17c9d809a}


Print the U\-N-\/\-N\-O\-R\-M\-A\-L\-I\-Z\-E\-D biasing function (ln\-P\-I) and possible the visted states histogram to files. 

Will overwrite the files if another with that name exists.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em file\-Name} & Name of the file to print to. Will append with \char`\"{}\-\_\-ln\-P\-I\char`\"{} and \char`\"{}\-\_\-\-H\char`\"{} for the macrostate distribution and visited-\/states histogram, respectively. \\
\hline
\mbox{\tt in}  & {\em print\-H} & Defaults to false, but if true will also print the visited states histogram. \\
\hline
\end{DoxyParams}


Definition at line 528 of file bias.\-cpp.



Referenced by checkpoint\-::dump().


\begin{DoxyCode}
528                                                        \{
529     \textcolor{comment}{// Print visited-states histogram}
530     \textcolor{keywordflow}{if} (printH) \{
531         \textcolor{comment}{// print complete visited states histogram to restart / visualize progress}
532         std::ofstream of;
533         std::string name = fileName+\textcolor{stringliteral}{"\_H.dat"};
534         of.open(name.c\_str(), std::ofstream::out);
535         \textcolor{keywordflow}{if} (!of.is\_open()) \{
536             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Unable to write Wang-Landau visited states histogram to 
      "}+name);
537         \}
538         of << \textcolor{stringliteral}{"# Visited states histogram in single row (vectorized) notation."} << std::endl;
539         of << \textcolor{stringliteral}{"# species\_total\_upper\_bound: "} << Nmax\_ << std::endl;
540         of << \textcolor{stringliteral}{"# species\_total\_lower\_bound: "} << Nmin\_ << std::endl;
541         \textcolor{keywordtype}{double} V = box\_[0]*box\_[1]*box\_[2];
542         of << \textcolor{stringliteral}{"# volume: "} << std::setprecision(15) << V << std::endl;
543         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} i = 0; i < H\_.size(); ++i) \{
544             of << std::setprecision(15) << H\_[i] << std::endl;
545         \}
546         of.close();
547     \}
548 
549     \textcolor{comment}{// Print lnPI (bias) matrix}
550     std::ofstream of;
551     std::string name = fileName+\textcolor{stringliteral}{"\_lnPI.dat"};
552     of.open(name.c\_str(), std::ofstream::out);
553     \textcolor{keywordflow}{if} (!of.is\_open()) \{
554         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Unable to write Wang-Landau lnPI histogram to "}+name);
555     \}
556     of << \textcolor{stringliteral}{"# lnPI (bias) matrix in single row (vectorized) notation."} << std::endl;
557     of << \textcolor{stringliteral}{"# species\_total\_upper\_bound: "} << Nmax\_ << std::endl;
558     of << \textcolor{stringliteral}{"# species\_total\_lower\_bound: "} << Nmin\_ << std::endl;
559     \textcolor{keywordtype}{double} V = box\_[0]*box\_[1]*box\_[2];
560     of << \textcolor{stringliteral}{"# volume: "} << std::setprecision(15) << V << std::endl;
561     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} i = 0; i < lnPI\_.size(); ++i) \{
562         of << std::setprecision(15) << lnPI\_[i] << std::endl; \textcolor{comment}{// only ALL states for restarting purposes}
563     \}
564     of.close();
565 \}
\end{DoxyCode}
\hypertarget{classwala_a0b8df0fb2b7722fc4a458e527a478b6f}{\index{wala@{wala}!read\-H@{read\-H}}
\index{read\-H@{read\-H}!wala@{wala}}
\subsubsection[{read\-H}]{\setlength{\rightskip}{0pt plus 5cm}void wala\-::read\-H (
\begin{DoxyParamCaption}
\item[{const std\-::string}]{file\-Name}
\end{DoxyParamCaption}
)}}\label{classwala_a0b8df0fb2b7722fc4a458e527a478b6f}


Read the visited states histogram from a file. 

This assumes the user has already guaranteed that the bounds are consistent, e.\-g. Nmin and Nmax, as it will not check this automatically. Also assumes file was generated by this code. \char`\"{}\-Hand made\char`\"{} ones might have formatting issues since parsing is done based on tokens.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em file\-Name} & Name of file containing visited states. Must include file extension. \\
\hline
\end{DoxyParams}


Definition at line 598 of file bias.\-cpp.



Referenced by checkpoint\-::load().


\begin{DoxyCode}
598                                           \{
599     std::ifstream infile (fileName.c\_str());
600     \textcolor{keywordflow}{if} (!infile.is\_open()) \{
601         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Unable to read Wang-Landau visited states matrix  from "}+
      fileName);
602     \}
603     std::string line;
604     \textcolor{keywordtype}{int} lineIndex = 0;
605     \textcolor{keywordflow}{while}(std::getline(infile,line)) \{
606         std::stringstream lineStream(line);
607         \textcolor{comment}{// skip any header information}
608         \textcolor{keywordflow}{if} (line.compare(0,1,\textcolor{stringliteral}{"#"},0,1) != 0) \{
609             H\_[lineIndex] = atof(line.c\_str());
610             lineIndex++;
611         \}
612     \}
613 \}
\end{DoxyCode}
\hypertarget{classwala_ae04916f49c11b0636e813787a3906570}{\index{wala@{wala}!readln\-P\-I@{readln\-P\-I}}
\index{readln\-P\-I@{readln\-P\-I}!wala@{wala}}
\subsubsection[{readln\-P\-I}]{\setlength{\rightskip}{0pt plus 5cm}void wala\-::readln\-P\-I (
\begin{DoxyParamCaption}
\item[{const std\-::string}]{file\-Name}
\end{DoxyParamCaption}
)}}\label{classwala_ae04916f49c11b0636e813787a3906570}


Read the macrostate distribution (biasing function) from a file. 

This assumes the user has already guaranteed that the bounds are consistent, e.\-g. Nmin and Nmax, as it will not check this automatically. Also assumes file was generated by this code. \char`\"{}\-Hand made\char`\"{} ones might have formatting issues since parsing is done based on tokens.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em file\-Name} & Name of file containing ln\-P\-I. Must include file extension. \\
\hline
\end{DoxyParams}


Definition at line 574 of file bias.\-cpp.



Referenced by checkpoint\-::load(), and perform\-W\-A\-L\-A().


\begin{DoxyCode}
574                                              \{
575     std::ifstream infile (fileName.c\_str());
576     \textcolor{keywordflow}{if} (!infile.is\_open()) \{
577         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Unable to read Wang-Landau lnPI from "}+fileName);
578     \}
579     std::string line;
580     \textcolor{keywordtype}{int} lineIndex = 0;
581     \textcolor{keywordflow}{while}(std::getline(infile,line)) \{
582         std::stringstream lineStream(line);
583         \textcolor{comment}{// skip any header information}
584         \textcolor{keywordflow}{if} (line.compare(0,1,\textcolor{stringliteral}{"#"},0,1) != 0) \{
585             lnPI\_[lineIndex] = atof(line.c\_str());
586             lineIndex++;
587         \}
588     \}
589 \}
\end{DoxyCode}
\hypertarget{classwala_a1d778061b12611b1a35eb3ca15038d02}{\index{wala@{wala}!setln\-P\-I@{setln\-P\-I}}
\index{setln\-P\-I@{setln\-P\-I}!wala@{wala}}
\subsubsection[{setln\-P\-I}]{\setlength{\rightskip}{0pt plus 5cm}void wala\-::setln\-P\-I (
\begin{DoxyParamCaption}
\item[{const std\-::vector$<$ double $>$ \&}]{ln\-P\-Iguess}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classwala_a1d778061b12611b1a35eb3ca15038d02}


Blindly assign a guess of the macrostate distribution. 



Definition at line 66 of file bias.\-h.

\hypertarget{classwala_ab439e3f60bea6c54522a870b9ad67acf}{\index{wala@{wala}!update@{update}}
\index{update@{update}!wala@{wala}}
\subsubsection[{update}]{\setlength{\rightskip}{0pt plus 5cm}void wala\-::update (
\begin{DoxyParamCaption}
\item[{const int}]{Nval, }
\item[{const int}]{Mval}
\end{DoxyParamCaption}
)}}\label{classwala_ab439e3f60bea6c54522a870b9ad67acf}


Update the estimate of the macrostate distribution. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em Nval} & Total current number of atoms in the system \\
\hline
\mbox{\tt in}  & {\em Mval} & Current value of the expanded ensemble state of the system \\
\hline
\end{DoxyParams}


Definition at line 484 of file bias.\-cpp.



References get\-Address().



Referenced by agg\-Vol\-Bias3\-::make(), translate\-Particle\-::make(), delete\-Particle\-::make(), insert\-Particle\-::make(), and swap\-Particles\-::make().


\begin{DoxyCode}
484                                                  \{
485     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} address = \hyperlink{classwala_a85b637b892b3c24cb252397433cbfad0}{getAddress} (Nval, Mval);
486     lnPI\_[address] += lnF\_;
487     H\_[address] += 1.0;
488 \}
\end{DoxyCode}


The documentation for this class was generated from the following files\-:\begin{DoxyCompactItemize}
\item 
/home/nam4/\-Desktop/sandbox/\-F\-H\-M\-C\-Simulation/src/\hyperlink{bias_8h}{bias.\-h}\item 
/home/nam4/\-Desktop/sandbox/\-F\-H\-M\-C\-Simulation/src/\hyperlink{bias_8cpp}{bias.\-cpp}\end{DoxyCompactItemize}
