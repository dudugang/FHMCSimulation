\hypertarget{input_8h}{\section{/home/nam4/\-Desktop/sandbox/\-F\-H\-M\-C\-Simulation/src/input.h File Reference}
\label{input_8h}\index{/home/nam4/\-Desktop/sandbox/\-F\-H\-M\-C\-Simulation/src/input.\-h@{/home/nam4/\-Desktop/sandbox/\-F\-H\-M\-C\-Simulation/src/input.\-h}}
}
{\ttfamily \#include $<$string$>$}\\*
{\ttfamily \#include \char`\"{}mover.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}system.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}insert.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}delete.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}translate.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}swap.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}utilities.\-h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classsim_system}{sim\-System} \hyperlink{input_8h_ad56bfc4ca544015cc3b845070f627c88}{initialize} (const std\-::string filename, \hyperlink{classmoves}{moves} $\ast$eq\-Moves, \hyperlink{classmoves}{moves} $\ast$pr\-Moves)
\begin{DoxyCompactList}\small\item\em Parse a json input file and initialize system object accordingly. \end{DoxyCompactList}\item 
void \hyperlink{input_8h_abb58279d5b9992aef3dcd304a3963954}{set\-Config} (\hyperlink{classsim_system}{sim\-System} \&sys, const std\-::string filename)
\begin{DoxyCompactList}\small\item\em Setup a system's initial configuration as necessary. \end{DoxyCompactList}\item 
void \hyperlink{input_8h_a4541b66a5d6bfc7c4d90c3cf5c58ba27}{set\-Moves} (\hyperlink{classsim_system}{sim\-System} \&sys, const rapidjson\-::\-Document \&doc, \hyperlink{classmoves}{moves} $\ast$used\-Moves\-Eq, \hyperlink{classmoves}{moves} $\ast$used\-Moves\-Pr)
\begin{DoxyCompactList}\small\item\em Assign the Monte Carlo moves based on the J\-S\-O\-N input file. \end{DoxyCompactList}\item 
void \hyperlink{input_8h_a76e6e0f38bf684278b7bebb317b71e5b}{set\-System\-Barriers} (\hyperlink{classsim_system}{sim\-System} \&sys, const rapidjson\-::\-Document \&doc)
\begin{DoxyCompactList}\small\item\em Initialize the barriers in a system by parsing the input document. \end{DoxyCompactList}\item 
void \hyperlink{input_8h_afcd470506b012754a93b2012b65e3fc4}{set\-Pair\-Potentials} (\hyperlink{classsim_system}{sim\-System} \&sys, const rapidjson\-::\-Document \&doc)
\begin{DoxyCompactList}\small\item\em Assign the pair potentials based on the J\-S\-O\-N input file. \end{DoxyCompactList}\item 
void \hyperlink{input_8h_aa89df4b08049cfd9bdd875d78591ba5b}{check\-Bounds} (\hyperlink{classsim_system}{sim\-System} \&sys)
\begin{DoxyCompactList}\small\item\em Check the following bounds on system. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{input_8h_aa89df4b08049cfd9bdd875d78591ba5b}{\index{input.\-h@{input.\-h}!check\-Bounds@{check\-Bounds}}
\index{check\-Bounds@{check\-Bounds}!input.h@{input.\-h}}
\subsubsection[{check\-Bounds}]{\setlength{\rightskip}{0pt plus 5cm}void check\-Bounds (
\begin{DoxyParamCaption}
\item[{{\bf sim\-System} \&}]{sys}
\end{DoxyParamCaption}
)}}\label{input_8h_aa89df4b08049cfd9bdd875d78591ba5b}


Check the following bounds on system. 

If any fail, an emergency exit is performed.
\begin{DoxyEnumerate}
\item Check all pair potentials are set.
\item Check that rcut $<$ L/2 for all potentials
\end{DoxyEnumerate}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em sys} & System to check bounds on \\
\hline
\end{DoxyParams}


Definition at line 10 of file input.\-cpp.



References sim\-System\-::box(), sim\-System\-::n\-Species(), num\-To\-Str(), sim\-System\-::potential\-Is\-Set(), sim\-System\-::ppot, send\-Err(), and S\-Y\-S\-\_\-\-F\-A\-I\-L\-U\-R\-E.



Referenced by initialize().


\begin{DoxyCode}
10                                   \{
11     \textcolor{comment}{// check all pair potentials have been set and all r\_cut < L/2}
12     \textcolor{keywordtype}{double} minL = sys.\hyperlink{classsim_system_a8bff9dfb95b1b09a0fab2c1c485ade07}{box}()[0];
13     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 1; i < 3; ++i) \{
14         minL = std::min(minL, sys.\hyperlink{classsim_system_a8bff9dfb95b1b09a0fab2c1c485ade07}{box}()[i]);
15     \}
16     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++i) \{
17         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++j) \{
18             \textcolor{keywordflow}{if} (!sys.\hyperlink{classsim_system_a40af191fae6091e26413ee06ae188ae9}{potentialIsSet}(i, j)) \{
19                 \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Not all pair potentials are set"});
20                 exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
21             \}
22             \textcolor{keywordflow}{if} (!(sys.\hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[i][j]->rcut() < minL/2.0)) \{
23                 \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Pair potential r\_cut for species "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i)+\textcolor{stringliteral}{", "}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j)+\textcolor{stringliteral}{" is > L/2"});
24                 exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
25             \}
26         \}
27     \}
28 \}
\end{DoxyCode}
\hypertarget{input_8h_ad56bfc4ca544015cc3b845070f627c88}{\index{input.\-h@{input.\-h}!initialize@{initialize}}
\index{initialize@{initialize}!input.h@{input.\-h}}
\subsubsection[{initialize}]{\setlength{\rightskip}{0pt plus 5cm}{\bf sim\-System} initialize (
\begin{DoxyParamCaption}
\item[{const std\-::string}]{filename, }
\item[{{\bf moves} $\ast$}]{used\-Moves\-Eq, }
\item[{{\bf moves} $\ast$}]{used\-Moves\-Pr}
\end{DoxyParamCaption}
)}}\label{input_8h_ad56bfc4ca544015cc3b845070f627c88}


Parse a json input file and initialize system object accordingly. 

\mbox{[}in\mbox{]} filename Input J\-S\-O\-N document's filename  \mbox{[}in\mbox{]} used\-Moves\-Eq Pointer to move object that will be used during \char`\"{}equilibration\char`\"{} (W\-L)  \mbox{[}in\mbox{]} used\-Moves\-Pr Pointer to move object that will be used during \char`\"{}production\char`\"{} (T\-M\-M\-C) 

Definition at line 37 of file input.\-cpp.



References sim\-System\-::add\-K\-E\-Correction(), check\-Bounds(), sim\-System\-::ln\-F\-\_\-end, sim\-System\-::ln\-F\-\_\-start, sim\-System\-::n\-Crossover\-Visits, parse\-Json(), sim\-System\-::restart\-From\-T\-M\-M\-C, sim\-System\-::restart\-From\-T\-M\-M\-C\-File, sim\-System\-::restart\-From\-W\-A\-L\-A, sim\-System\-::restart\-From\-W\-A\-L\-A\-File, R\-N\-G\-\_\-\-S\-E\-E\-D, send\-Err(), send\-Msg(), set\-Moves(), set\-Pair\-Potentials(), set\-System\-Barriers(), sim\-System\-::set\-Tot\-N\-Bounds(), S\-Y\-S\-\_\-\-F\-A\-I\-L\-U\-R\-E, sim\-System\-::tmmc\-Sweep\-Size, sim\-System\-::toggle\-K\-E(), sim\-System\-::total\-T\-M\-M\-C\-Sweeps, sim\-System\-::wala\-\_\-g, sim\-System\-::wala\-\_\-s, and sim\-System\-::wl\-Sweep\-Size.


\begin{DoxyCode}
37                                                                                         \{
38     rapidjson::Document doc;
39     \hyperlink{utilities_8cpp_a3f494918ff3c252de4914c9905be04e7}{parseJson} (filename, doc);
40 
41     \textcolor{comment}{// Check each member exists and is in the correct format}
42     assert(doc.HasMember(\textcolor{stringliteral}{"num\_species"}));
43     assert(doc[\textcolor{stringliteral}{"num\_species"}].IsInt());
44     assert(doc.HasMember(\textcolor{stringliteral}{"beta"}));
45     assert(doc[\textcolor{stringliteral}{"beta"}].IsNumber());
46 
47     assert(doc.HasMember(\textcolor{stringliteral}{"box"}));
48     assert(doc[\textcolor{stringliteral}{"box"}].IsArray());
49     assert(doc[\textcolor{stringliteral}{"box"}].Size() == 3);
50     std::vector < double > sysBox (3, 0);
51     \textcolor{keywordflow}{for} (rapidjson::SizeType i = 0; i < doc[\textcolor{stringliteral}{"box"}].Size(); ++i) \{
52         assert(doc[\textcolor{stringliteral}{"box"}][i].IsNumber());
53         sysBox[i] = doc[\textcolor{stringliteral}{"box"}][i].GetDouble();
54     \}
55 
56     \textcolor{keywordtype}{double} duh = 10.0;
57     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"delta\_u\_hist"})) \{
58         assert(doc[\textcolor{stringliteral}{"delta\_u\_hist"}].IsNumber());
59         duh = doc[\textcolor{stringliteral}{"delta\_u\_hist"}].GetDouble();
60     \}
61 
62     \textcolor{keywordtype}{int} max\_order = 2;
63     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"max\_order"})) \{
64         assert(doc[\textcolor{stringliteral}{"max\_order"}].IsNumber());
65         max\_order = doc[\textcolor{stringliteral}{"max\_order"}].GetInt();
66     \}
67 
68     \textcolor{keywordtype}{bool} use\_ke = \textcolor{keyword}{false};
69     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"use\_ke"})) \{
70         assert(doc[\textcolor{stringliteral}{"use\_ke"}].IsBool());
71         use\_ke = doc[\textcolor{stringliteral}{"use\_ke"}].GetBool();
72     \}
73 
74     assert(doc.HasMember(\textcolor{stringliteral}{"mu"}));
75     assert(doc[\textcolor{stringliteral}{"mu"}].IsArray());
76     assert(doc[\textcolor{stringliteral}{"mu"}].Size() == doc[\textcolor{stringliteral}{"num\_species"}].GetInt());
77     std::vector < double > sysMu (doc[\textcolor{stringliteral}{"mu"}].Size(), 0);
78     \textcolor{keywordflow}{for} (rapidjson::SizeType i = 0; i < doc[\textcolor{stringliteral}{"mu"}].Size(); ++i) \{
79         assert(doc[\textcolor{stringliteral}{"mu"}][i].IsNumber());
80         sysMu[i] = doc[\textcolor{stringliteral}{"mu"}][i].GetDouble();
81     \}
82 
83     assert(doc.HasMember(\textcolor{stringliteral}{"seed"}));
84     assert(doc[\textcolor{stringliteral}{"seed"}].IsInt());
85     \hyperlink{global_8h_a3f4e4ea24d5a5c66feae55d1f329c884}{RNG\_SEED} = doc[\textcolor{stringliteral}{"seed"}].GetInt();
86 
87     assert(doc.HasMember(\textcolor{stringliteral}{"max\_N"}));
88     assert(doc[\textcolor{stringliteral}{"max\_N"}].IsArray());
89     assert(doc[\textcolor{stringliteral}{"max\_N"}].Size() == doc[\textcolor{stringliteral}{"num\_species"}].GetInt());
90     std::vector < int > sysMax (doc[\textcolor{stringliteral}{"max\_N"}].Size(), 0);
91     \textcolor{keywordflow}{for} (rapidjson::SizeType i = 0; i < doc[\textcolor{stringliteral}{"max\_N"}].Size(); ++i) \{
92         assert(doc[\textcolor{stringliteral}{"max\_N"}][i].IsInt());
93         sysMax[i] = doc[\textcolor{stringliteral}{"max\_N"}][i].GetInt();
94     \}
95 
96     assert(doc.HasMember(\textcolor{stringliteral}{"min\_N"}));
97     assert(doc[\textcolor{stringliteral}{"min\_N"}].IsArray());
98     assert(doc[\textcolor{stringliteral}{"min\_N"}].Size() == doc[\textcolor{stringliteral}{"num\_species"}].GetInt());
99     std::vector < int > sysMin (doc[\textcolor{stringliteral}{"min\_N"}].Size(), 0);
100     \textcolor{keywordflow}{for} (rapidjson::SizeType i = 0; i < doc[\textcolor{stringliteral}{"min\_N"}].Size(); ++i) \{
101         assert(doc[\textcolor{stringliteral}{"min\_N"}][i].IsInt());
102         sysMin[i] = doc[\textcolor{stringliteral}{"min\_N"}][i].GetInt();
103     \}
104 
105     \textcolor{keywordtype}{int} Mtot = 1;
106     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"num\_expanded\_states"})) \{
107         assert(doc[\textcolor{stringliteral}{"num\_expanded\_states"}].IsInt());
108         Mtot = doc[\textcolor{stringliteral}{"num\_expanded\_states"}].GetInt();
109     \}
110 
111     \hyperlink{classsim_system}{simSystem} sys (doc[\textcolor{stringliteral}{"num\_species"}].GetInt(), doc[\textcolor{stringliteral}{"beta"}].GetDouble(), sysBox, sysMu, sysMax, 
      sysMin, Mtot, duh, max\_order);
112     \textcolor{keywordflow}{if} (use\_ke) \{
113         sys.toggleKE();
114         \textcolor{keywordflow}{if} (sys.addKECorrection() == \textcolor{keyword}{false}) \{
115             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Unable to set KE flag"});
116         \}
117     \}
118 
119     std::vector < int > sysWindow;
120     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"window"})) \{
121         assert(doc[\textcolor{stringliteral}{"window"}].IsArray());
122         assert(doc[\textcolor{stringliteral}{"window"}].Size() == 2);
123         sysWindow.resize(2, 0);
124         sysWindow[0] = doc[\textcolor{stringliteral}{"window"}][0].GetInt();
125         sysWindow[1] = doc[\textcolor{stringliteral}{"window"}][1].GetInt();
126     \}
127 
128     \textcolor{keywordflow}{if} (sysWindow.begin() != sysWindow.end()) \{
129         sys.setTotNBounds(sysWindow);
130     \}
131 
132     assert(doc.HasMember(\textcolor{stringliteral}{"tmmc\_sweep\_size"}));
133     assert(doc[\textcolor{stringliteral}{"tmmc\_sweep\_size"}].IsNumber());
134     \textcolor{keywordtype}{double} tmpT = doc[\textcolor{stringliteral}{"tmmc\_sweep\_size"}].GetDouble(); \textcolor{comment}{// possibly in scientific notation}
135     sys.tmmcSweepSize = tmpT; \textcolor{comment}{// convert}
136 
137     assert(doc.HasMember(\textcolor{stringliteral}{"total\_tmmc\_sweeps"}));
138     assert(doc[\textcolor{stringliteral}{"total\_tmmc\_sweeps"}].IsNumber());
139     \textcolor{keywordtype}{double} tmpS = doc[\textcolor{stringliteral}{"total\_tmmc\_sweeps"}].GetDouble(); \textcolor{comment}{// possibly in scientific notation}
140     sys.totalTMMCSweeps = tmpS; \textcolor{comment}{// convert}
141 
142     assert(doc.HasMember(\textcolor{stringliteral}{"wala\_sweep\_size"}));
143     assert(doc[\textcolor{stringliteral}{"wala\_sweep\_size"}].IsNumber());
144     \textcolor{keywordtype}{double} tmpW = doc[\textcolor{stringliteral}{"wala\_sweep\_size"}].GetDouble(); \textcolor{comment}{// possibly in scientific notation}
145     sys.wlSweepSize = tmpW; \textcolor{comment}{// convert}
146 
147     assert(doc.HasMember(\textcolor{stringliteral}{"wala\_g"}));
148     assert(doc[\textcolor{stringliteral}{"wala\_g"}].IsNumber());
149     sys.wala\_g = doc[\textcolor{stringliteral}{"wala\_g"}].GetDouble();
150 
151     assert(doc.HasMember(\textcolor{stringliteral}{"wala\_s"}));
152     assert(doc[\textcolor{stringliteral}{"wala\_s"}].IsNumber());
153     sys.wala\_s = doc[\textcolor{stringliteral}{"wala\_s"}].GetDouble();
154 
155     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"lnF\_start"})) \{
156         assert(doc[\textcolor{stringliteral}{"lnF\_start"}].IsNumber());
157         sys.lnF\_start = doc[\textcolor{stringliteral}{"lnF\_start"}].GetDouble(); \textcolor{comment}{// bounds are checked later}
158     \}
159 
160     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"lnF\_end"})) \{
161         assert(doc[\textcolor{stringliteral}{"lnF\_end"}].IsNumber());
162         sys.lnF\_end = doc[\textcolor{stringliteral}{"lnF\_end"}].GetDouble();
163         \textcolor{keywordflow}{if} (sys.lnF\_end >= 1.0) \{
164             \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Terminal lnF factor for Wang-Landau must be < 1"});
165             exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
166         \}
167     \}
168     \textcolor{keywordflow}{if} (sys.lnF\_end >= sys.lnF\_start) \{
169         \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"lnF\_end must be < lnF\_start for Wang-Landau to proceed forward"});
170         exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
171     \}
172 
173     sys.restartFromWALA = \textcolor{keyword}{false};
174     sys.restartFromWALAFile = \textcolor{stringliteral}{""};
175     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"restart\_from\_wala\_lnPI"})) \{
176         assert(doc[\textcolor{stringliteral}{"restart\_from\_wala\_lnPI"}].IsString());
177         sys.restartFromWALAFile = doc[\textcolor{stringliteral}{"restart\_from\_wala\_lnPI"}].GetString();
178         \textcolor{keywordflow}{if} (sys.restartFromWALAFile != \textcolor{stringliteral}{""}) \{
179             sys.restartFromWALA = \textcolor{keyword}{true};
180         \}
181     \}
182 
183     \textcolor{comment}{// restarting from TMMC overrides WL by skipping that portion altogether}
184     sys.restartFromTMMC = \textcolor{keyword}{false};
185     sys.restartFromTMMCFile = \textcolor{stringliteral}{""};
186     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"restart\_from\_tmmc\_C"})) \{
187         assert(doc[\textcolor{stringliteral}{"restart\_from\_tmmc\_C"}].IsString());
188         sys.restartFromTMMCFile = doc[\textcolor{stringliteral}{"restart\_from\_tmmc\_C"}].GetString();
189         \textcolor{keywordflow}{if} (sys.restartFromTMMCFile != \textcolor{stringliteral}{""}) \{
190             sys.restartFromTMMC = \textcolor{keyword}{true};
191         \}
192     \}
193 
194     \textcolor{comment}{// number of times the TMMC C matrix has to be traversed during the WALA --> TMMC crossover}
195     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"num\_crossover\_visits"})) \{
196         assert(doc[\textcolor{stringliteral}{"num\_crossover\_visits"}].IsNumber());
197         sys.nCrossoverVisits = doc[\textcolor{stringliteral}{"num\_crossover\_visits"}].GetDouble(); \textcolor{comment}{// convert}
198         \textcolor{keywordflow}{if} (sys.nCrossoverVisits < 1) \{
199             \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Must allow the collection matrix to be traversed at least once in the crossover
       from Wang-Landau to TMMC"});
200             exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
201         \}
202     \}
203 
204     \hyperlink{input_8cpp_a4541b66a5d6bfc7c4d90c3cf5c58ba27}{setMoves} (sys, doc, usedMovesEq, usedMovesPr);
205     \hyperlink{input_8cpp_afcd470506b012754a93b2012b65e3fc4}{setPairPotentials} (sys, doc);
206 
207     \hyperlink{input_8cpp_aa89df4b08049cfd9bdd875d78591ba5b}{checkBounds} (sys);
208     \hyperlink{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}{sendMsg}(\textcolor{stringliteral}{"System from "}+filename+\textcolor{stringliteral}{" passed bounds checks"});
209 
210     \hyperlink{input_8cpp_a76e6e0f38bf684278b7bebb317b71e5b}{setSystemBarriers} (sys, doc);
211     \hyperlink{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}{sendMsg}(\textcolor{stringliteral}{"Initialized barriers from "}+filename);
212 
213     \hyperlink{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}{sendMsg}(\textcolor{stringliteral}{"Successfully read valid parameters from "}+filename);
214     \textcolor{keywordflow}{return} sys;
215 \}
\end{DoxyCode}
\hypertarget{input_8h_abb58279d5b9992aef3dcd304a3963954}{\index{input.\-h@{input.\-h}!set\-Config@{set\-Config}}
\index{set\-Config@{set\-Config}!input.h@{input.\-h}}
\subsubsection[{set\-Config}]{\setlength{\rightskip}{0pt plus 5cm}void set\-Config (
\begin{DoxyParamCaption}
\item[{{\bf sim\-System} \&}]{sys, }
\item[{const std\-::string}]{filename}
\end{DoxyParamCaption}
)}}\label{input_8h_abb58279d5b9992aef3dcd304a3963954}


Setup a system's initial configuration as necessary. 


\begin{DoxyEnumerate}
\item If \char`\"{}restart\-\_\-file\char`\"{} in input json file, read initial config from there.
\item In not, randomly generate initial configuration.
\end{DoxyEnumerate}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em sys} & System to initialize \\
\hline
\mbox{\tt in}  & {\em filename} & Input J\-S\-O\-N filename \\
\hline
\end{DoxyParams}


Definition at line 404 of file input.\-cpp.



References moves\-::add\-Insert(), sim\-System\-::add\-K\-E\-Correction(), sim\-System\-::box(), sim\-System\-::get\-Total\-M(), sim\-System\-::n\-Species(), sim\-System\-::num\-Species, num\-To\-Str(), parse\-Json(), sim\-System\-::print\-Snapshot(), sim\-System\-::read\-Config(), send\-Err(), send\-Msg(), set\-Pair\-Potentials(), set\-System\-Barriers(), S\-Y\-S\-\_\-\-F\-A\-I\-L\-U\-R\-E, sim\-System\-::toggle\-K\-E(), sim\-System\-::tot\-N\-Min(), and custom\-Exception\-::what().


\begin{DoxyCode}
404                                                           \{
405     rapidjson::Document doc;
406     \hyperlink{utilities_8cpp_a3f494918ff3c252de4914c9905be04e7}{parseJson} (filename, doc);
407 
408     std::string restart\_file = \textcolor{stringliteral}{""};
409     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"restart\_file"})) \{
410         assert(doc[\textcolor{stringliteral}{"restart\_file"}].IsString());
411         restart\_file = doc[\textcolor{stringliteral}{"restart\_file"}].GetString();
412     \}
413 
414     std::vector < double > sysBox = sys.\hyperlink{classsim_system_a8bff9dfb95b1b09a0fab2c1c485ade07}{box}();
415 
416     \textcolor{keywordtype}{double} duh = 10.0;
417     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"delta\_u\_hist"})) \{
418         assert(doc[\textcolor{stringliteral}{"delta\_u\_hist"}].IsNumber());
419         duh = doc[\textcolor{stringliteral}{"delta\_u\_hist"}].GetDouble();
420     \}
421 
422     \textcolor{keywordtype}{int} max\_order = 2;
423     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"max\_order"})) \{
424         assert(doc[\textcolor{stringliteral}{"max\_order"}].IsNumber());
425         max\_order = doc[\textcolor{stringliteral}{"max\_order"}].GetInt();
426     \}
427 
428     \textcolor{keywordtype}{bool} use\_ke = sys.\hyperlink{classsim_system_a09c4ea670168c9f1d549d2a5120eb13c}{addKECorrection}();
429     \textcolor{keywordtype}{int} Mtot = sys.\hyperlink{classsim_system_aa4ad1afff101bb530e1590df05035276}{getTotalM}();
430 
431     std::vector < double > sysMu (doc[\textcolor{stringliteral}{"mu"}].Size(), 0);
432     \textcolor{keywordflow}{for} (rapidjson::SizeType i = 0; i < doc[\textcolor{stringliteral}{"mu"}].Size(); ++i) \{
433         sysMu[i] = doc[\textcolor{stringliteral}{"mu"}][i].GetDouble();
434     \}
435     std::vector < int > sysMax (doc[\textcolor{stringliteral}{"max\_N"}].Size(), 0);
436     \textcolor{keywordflow}{for} (rapidjson::SizeType i = 0; i < doc[\textcolor{stringliteral}{"max\_N"}].Size(); ++i) \{
437         sysMax[i] = doc[\textcolor{stringliteral}{"max\_N"}][i].GetInt();
438     \}
439     std::vector < int > sysMin (doc[\textcolor{stringliteral}{"min\_N"}].Size(), 0);
440     \textcolor{keywordflow}{for} (rapidjson::SizeType i = 0; i < doc[\textcolor{stringliteral}{"min\_N"}].Size(); ++i) \{
441         sysMin[i] = doc[\textcolor{stringliteral}{"min\_N"}][i].GetInt();
442     \}
443 
444     \textcolor{comment}{// Read from restart file if specified}
445     \textcolor{keywordflow}{if} (restart\_file != \textcolor{stringliteral}{""}) \{
446         \textcolor{keywordflow}{try} \{
447             sys.\hyperlink{classsim_system_a3161d95bbb800d5d95a732ac5fc32b95}{readConfig}(restart\_file);
448         \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
449             \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(ce.\hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}());
450         \}
451     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (restart\_file == \textcolor{stringliteral}{""} && sys.\hyperlink{classsim_system_af10842e0eaa638373b8717c87b47e6bc}{totNMin}() > 0) \{
452         \hyperlink{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}{sendMsg}(\textcolor{stringliteral}{"Automatically generating the initial configuration"});
453 
454         \textcolor{comment}{// have to generate initial configuration manually - start with mu = INF}
455         std::vector < double > initMu (doc[\textcolor{stringliteral}{"num\_species"}].GetInt(), 1.0e2);
456 
457         \hyperlink{classsim_system}{simSystem} initSys (doc[\textcolor{stringliteral}{"num\_species"}].GetInt(), doc[\textcolor{stringliteral}{"beta"}].GetDouble()/100.0, sysBox, 
      initMu, sysMax, sysMin, Mtot, duh, max\_order); \textcolor{comment}{// beta =  1/T, so low beta to have high T}
458         \textcolor{keywordflow}{if} (use\_ke) \{
459             initSys.toggleKE();
460             \textcolor{keywordflow}{if} (initSys.addKECorrection() == \textcolor{keyword}{false}) \{
461                 \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Unable to set KE flag"});
462             \}
463         \}
464 
465         \textcolor{comment}{// add the same potentials}
466         \hyperlink{input_8cpp_afcd470506b012754a93b2012b65e3fc4}{setPairPotentials} (initSys, doc);
467         \hyperlink{input_8cpp_a76e6e0f38bf684278b7bebb317b71e5b}{setSystemBarriers} (initSys, doc);
468 
469         std::vector < int > initialization\_order (sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(), 0), check\_init (sys.
      \hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(), 0);
470         std::vector < double > init\_frac (sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(), 1.0);
471         \textcolor{keywordtype}{double} sum = 0.0;
472         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++i) \{
473             initialization\_order[i] = i;
474             \textcolor{keywordflow}{if} (i > 0) init\_frac[i] = 0.0;
475             sum += init\_frac[i];
476         \}
477         \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"init\_order"})) \{
478             assert(doc[\textcolor{stringliteral}{"init\_order"}].IsArray());
479             assert(doc[\textcolor{stringliteral}{"init\_order"}].Size() == doc[\textcolor{stringliteral}{"num\_species"}].GetInt());
480 
481             \textcolor{keywordflow}{for} (rapidjson::SizeType i = 0; i < doc[\textcolor{stringliteral}{"init\_order"}].Size(); ++i) \{
482                 assert(doc[\textcolor{stringliteral}{"init\_order"}][i].IsInt());
483                 initialization\_order[i] = doc[\textcolor{stringliteral}{"init\_order"}][i].GetInt();
484                 \textcolor{keywordflow}{if} (initialization\_order[i] < 0 || initialization\_order[i] >= sys.
      \hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}()) \{
485                     \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Order of initialization goes out of bounds, should include 0 <= i <
       nSpec"});
486                     exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
487                 \}
488                 \textcolor{keywordflow}{if} (check\_init[initialization\_order[i]] != 0) \{
489                     \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Order of initialization repeats itself"});
490                     exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
491                 \} \textcolor{keywordflow}{else} \{
492                     check\_init[initialization\_order[i]] = 1;
493                 \}
494             \}
495         \}
496         \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"init\_frac"})) \{
497             assert(doc[\textcolor{stringliteral}{"init\_frac"}].IsArray());
498             assert(doc[\textcolor{stringliteral}{"init\_frac"}].Size() == doc[\textcolor{stringliteral}{"num\_species"}].GetInt());
499             sum = 0.0;
500             \textcolor{keywordflow}{for} (rapidjson::SizeType i = 0; i < doc[\textcolor{stringliteral}{"init\_frac"}].Size(); ++i) \{
501                 assert(doc[\textcolor{stringliteral}{"init\_frac"}][i].IsNumber());
502                 init\_frac[i] = doc[\textcolor{stringliteral}{"init\_frac"}][i].GetDouble();
503                 \textcolor{keywordflow}{if} (init\_frac[i] < 0 || init\_frac[i] >= 1.0) \{
504                     \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Initialization fraction out of bounds"});
505                     exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
506                 \}
507                 sum += init\_frac[i];
508             \}
509         \}
510         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++i) \{
511             init\_frac[i] /= sum;
512         \}
513 
514         \textcolor{comment}{// iteratively add each individual species, assume we want an equimolar mixture to start from}
515         \textcolor{keywordtype}{int} added = 0;
516         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} idx = 0; idx < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++idx) \{
517             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = initialization\_order[idx];
518             \hyperlink{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}{sendMsg}(\textcolor{stringliteral}{"Initializing species "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i)+\textcolor{stringliteral}{" configurations"});
519 
520             \textcolor{comment}{// insert this species i}
521             \hyperlink{classmoves}{moves} initMove (initSys.getTotalM());
522             initMove.\hyperlink{classmoves_ab4583b3075f51cce55c3aeb84a58430d}{addInsert}(i, 1.0);
523 
524             \textcolor{comment}{// also add displacment moves for all species present}
525             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j <= idx; ++j) \{
526                 \hyperlink{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}{sendMsg}(\textcolor{stringliteral}{"Added translation moves for initialization of species "}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(initialization\_order[j]));
527                 initMove.addTranslate(initialization\_order[j], 2.0, 1.0, initSys.box());
528             \}
529 
530             \textcolor{comment}{// now do simuation until within proper range}
531             \textcolor{keywordtype}{int} targetNum = sys.\hyperlink{classsim_system_af10842e0eaa638373b8717c87b47e6bc}{totNMin}()*init\_frac[idx];
532             \textcolor{keywordflow}{if} (idx == sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}() - 1) \{
533                 \textcolor{comment}{// to account for integer rounding}
534                 targetNum = sys.\hyperlink{classsim_system_af10842e0eaa638373b8717c87b47e6bc}{totNMin}() - added;
535             \}
536             added += targetNum;
537 
538             \hyperlink{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}{sendMsg}(\textcolor{stringliteral}{"Target number = "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(targetNum)+\textcolor{stringliteral}{" for species "}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1));
539             \textcolor{keywordtype}{int} tmpCounter = 0, statusPrint = 10e6;
540             \textcolor{keywordflow}{while} (initSys.numSpecies[i] < targetNum) \{
541                 \textcolor{keywordflow}{try} \{
542                     initMove.makeMove(initSys);
543                 \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
544                     std::string msg = ce.\hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}();
545                     \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Failed to create an initial configuration because "}+msg);
546                     exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
547                 \}
548                 tmpCounter++;
549                 \textcolor{keywordflow}{if} (tmpCounter%statusPrint == 0) \{
550                     tmpCounter = 0;
551                     \hyperlink{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}{sendMsg}(\textcolor{stringliteral}{"Grew "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(initSys.numSpecies[i])+\textcolor{stringliteral}{" atoms of type "}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i)+\textcolor{stringliteral}{" so far"});
552                 \}
553             \}
554         \}
555 
556         \textcolor{comment}{// print snapshot from Reading initial configuration}
557         initSys.printSnapshot(\textcolor{stringliteral}{"auto-init.xyz"}, \textcolor{stringliteral}{"auto-generated initial configuration"});
558 
559         \textcolor{comment}{// read into sys}
560         \textcolor{keywordflow}{try} \{
561             sys.\hyperlink{classsim_system_a3161d95bbb800d5d95a732ac5fc32b95}{readConfig}(\textcolor{stringliteral}{"auto-init.xyz"});
562         \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
563             std::string msg = ce.\hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}();
564             \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Failed to read auto-generated initialization file because "}+msg);
565         \}
566     \}
567 \}
\end{DoxyCode}
\hypertarget{input_8h_a4541b66a5d6bfc7c4d90c3cf5c58ba27}{\index{input.\-h@{input.\-h}!set\-Moves@{set\-Moves}}
\index{set\-Moves@{set\-Moves}!input.h@{input.\-h}}
\subsubsection[{set\-Moves}]{\setlength{\rightskip}{0pt plus 5cm}void set\-Moves (
\begin{DoxyParamCaption}
\item[{{\bf sim\-System} \&}]{sys, }
\item[{const rapidjson\-::\-Document \&}]{doc, }
\item[{{\bf moves} $\ast$}]{used\-Moves\-Eq, }
\item[{{\bf moves} $\ast$}]{used\-Moves\-Pr}
\end{DoxyParamCaption}
)}}\label{input_8h_a4541b66a5d6bfc7c4d90c3cf5c58ba27}


Assign the Monte Carlo moves based on the J\-S\-O\-N input file. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em sys} & Simulation system that has been initialized \\
\hline
\mbox{\tt in}  & {\em doc} & J\-S\-O\-N document corresponding to input file  \mbox{[}in\mbox{]} used\-Moves\-Eq Pointer to move object that will be used during \char`\"{}equilibration\char`\"{} (W\-L)  \mbox{[}in\mbox{]} used\-Moves\-Pr Pointer to move object that will be used during \char`\"{}production\char`\"{} (T\-M\-M\-C) \\
\hline
\end{DoxyParams}


Definition at line 225 of file input.\-cpp.



References moves\-::add\-Delete(), moves\-::add\-Insert(), moves\-::add\-Swap(), moves\-::add\-Translate(), sim\-System\-::box(), sim\-System\-::get\-Total\-M(), sim\-System\-::n\-Species(), num\-To\-Str(), send\-Err(), moves\-::set\-M(), and S\-Y\-S\-\_\-\-F\-A\-I\-L\-U\-R\-E.



Referenced by initialize().


\begin{DoxyCode}
225                                                                                                      \{
226     std::vector < double > ref (sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(), 0);
227     std::vector < std::vector < double > > probEqSwap (sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(), ref), probPrSwap (sys.
      \hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(), ref);
228     std::vector < double > probPrInsDel (sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(), 0), probPrDisp (sys.
      \hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(), 0);
229     std::vector < double > probEqInsDel (sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(), 0), probEqDisp (sys.
      \hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(), 0);
230     std::vector < double > maxPrD (sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(), 0), maxEqD (sys.
      \hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(), 0);
231     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++i) \{
232         std::string dummy = \textcolor{stringliteral}{"prob\_pr\_ins\_del\_"} + std::to\_string(i+1);
233         assert(doc.HasMember(dummy.c\_str()));
234         assert(doc[dummy.c\_str()].IsNumber());
235         probPrInsDel[i] = doc[dummy.c\_str()].GetDouble();
236     \}
237 
238     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++i) \{
239         std::string dummy = \textcolor{stringliteral}{"prob\_pr\_displace\_"} + std::to\_string(i+1);
240         assert(doc.HasMember(dummy.c\_str()));
241         assert(doc[dummy.c\_str()].IsNumber());
242         probPrDisp[i] = doc[dummy.c\_str()].GetDouble();
243         dummy = \textcolor{stringliteral}{"max\_pr\_displacement\_"} + std::to\_string(i+1);
244         assert(doc.HasMember(dummy.c\_str()));
245         assert(doc[dummy.c\_str()].IsNumber());
246         maxPrD[i] = doc[dummy.c\_str()].GetDouble();
247     \}
248 
249     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++i) \{
250         std::string dummy = \textcolor{stringliteral}{"prob\_eq\_ins\_del\_"} + std::to\_string(i+1);
251         assert(doc.HasMember(dummy.c\_str()));
252         assert(doc[dummy.c\_str()].IsNumber());
253         probEqInsDel[i] = doc[dummy.c\_str()].GetDouble();
254     \}
255 
256     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++i) \{
257         std::string dummy = \textcolor{stringliteral}{"prob\_eq\_displace\_"} + std::to\_string(i+1);
258         assert(doc.HasMember(dummy.c\_str()));
259         assert(doc[dummy.c\_str()].IsNumber());
260         probEqDisp[i] = doc[dummy.c\_str()].GetDouble();
261         dummy = \textcolor{stringliteral}{"max\_eq\_displacement\_"} + std::to\_string(i+1);
262         assert(doc.HasMember(dummy.c\_str()));
263         assert(doc[dummy.c\_str()].IsNumber());
264         maxEqD[i] = doc[dummy.c\_str()].GetDouble();
265     \}
266 
267     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++i) \{
268         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = i+1; j < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++j) \{
269             std::string name1 = \textcolor{stringliteral}{"prob\_pr\_swap\_"}+std::to\_string(i+1)+\textcolor{stringliteral}{"\_"}+std::to\_string(j+1);
270             std::string name2 = \textcolor{stringliteral}{"prob\_pr\_swap\_"}+std::to\_string(j+1)+\textcolor{stringliteral}{"\_"}+std::to\_string(i+1);
271             std::string moveName = \textcolor{stringliteral}{""};
272             \textcolor{keywordtype}{bool} foundIJ = \textcolor{keyword}{false};
273             \textcolor{keywordflow}{if} (doc.HasMember(name1.c\_str())) \{
274                 moveName = name1;
275                 foundIJ = \textcolor{keyword}{true};
276             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (doc.HasMember(name2.c\_str()) && !foundIJ) \{
277                 moveName = name2;
278                 foundIJ = \textcolor{keyword}{true};
279             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (doc.HasMember(name2.c\_str()) && foundIJ) \{
280                 \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Input file doubly specifies production swap move probability for species
       pair ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{", "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{")"});
281                 exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
282             \} \textcolor{keywordflow}{else} \{
283                 \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Input file does not specify production swap move probability for species
       pair ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{", "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{")"});
284                 exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
285             \}
286             assert(doc[moveName.c\_str()].IsNumber());
287             probPrSwap[i][j] = doc[moveName.c\_str()].GetDouble();
288             probPrSwap[j][i] = doc[moveName.c\_str()].GetDouble();
289         \}
290     \}
291 
292     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++i) \{
293         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = i+1; j < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++j) \{
294             std::string name1 = \textcolor{stringliteral}{"prob\_eq\_swap\_"}+std::to\_string(i+1)+\textcolor{stringliteral}{"\_"}+std::to\_string(j+1);
295             std::string name2 = \textcolor{stringliteral}{"prob\_eq\_swap\_"}+std::to\_string(j+1)+\textcolor{stringliteral}{"\_"}+std::to\_string(i+1);
296             std::string moveName = \textcolor{stringliteral}{""};
297             \textcolor{keywordtype}{bool} foundIJ = \textcolor{keyword}{false};
298             \textcolor{keywordflow}{if} (doc.HasMember(name1.c\_str())) \{
299                 moveName = name1;
300                 foundIJ = \textcolor{keyword}{true};
301             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (doc.HasMember(name2.c\_str()) && !foundIJ) \{
302                 moveName = name2;
303                 foundIJ = \textcolor{keyword}{true};
304             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (doc.HasMember(name2.c\_str()) && foundIJ) \{
305                 \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Input file doubly specifies equilibration swap move probability for species
       pair ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{", "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{")"});
306                 exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
307             \} \textcolor{keywordflow}{else} \{
308                 \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Input file does not specify equilibration swap move probability for species
       pair ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{", "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{")"});
309                 exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
310             \}
311             assert(doc[moveName.c\_str()].IsNumber());
312             probEqSwap[i][j] = doc[moveName.c\_str()].GetDouble();
313             probEqSwap[j][i] = doc[moveName.c\_str()].GetDouble();
314         \}
315     \}
316 
317     usedMovesEq->\hyperlink{classmoves_ab603c6ce829075e3232ff41a7d5e2aab}{setM}(sys.\hyperlink{classsim_system_aa4ad1afff101bb530e1590df05035276}{getTotalM}());
318     usedMovesPr->\hyperlink{classmoves_ab603c6ce829075e3232ff41a7d5e2aab}{setM}(sys.\hyperlink{classsim_system_aa4ad1afff101bb530e1590df05035276}{getTotalM}());
319     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++i) \{
320         usedMovesEq->\hyperlink{classmoves_ab4583b3075f51cce55c3aeb84a58430d}{addInsert}(i, probEqInsDel[i]);
321         usedMovesPr->\hyperlink{classmoves_ab4583b3075f51cce55c3aeb84a58430d}{addInsert}(i, probPrInsDel[i]);
322 
323         usedMovesEq->\hyperlink{classmoves_ac4307636570c4d4bc07c4cba3887005e}{addDelete}(i, probEqInsDel[i]);
324         usedMovesPr->\hyperlink{classmoves_ac4307636570c4d4bc07c4cba3887005e}{addDelete}(i, probPrInsDel[i]);
325 
326         usedMovesEq->\hyperlink{classmoves_a91bb7969368fdbb66920a11d79fe7552}{addTranslate}(i, probEqDisp[i], maxEqD[i], sys.
      \hyperlink{classsim_system_a8bff9dfb95b1b09a0fab2c1c485ade07}{box}());
327         usedMovesPr->\hyperlink{classmoves_a91bb7969368fdbb66920a11d79fe7552}{addTranslate}(i, probPrDisp[i], maxPrD[i], sys.
      \hyperlink{classsim_system_a8bff9dfb95b1b09a0fab2c1c485ade07}{box}());
328 
329         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = i+1; j < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++j) \{
330             usedMovesEq->\hyperlink{classmoves_a03cebfa2d8d1cecf253df573fdecc5d0}{addSwap}(i, j, probEqSwap[i][j]);
331             usedMovesPr->\hyperlink{classmoves_a03cebfa2d8d1cecf253df573fdecc5d0}{addSwap}(i, j, probPrSwap[i][j]);
332         \}
333     \}
334 \}
\end{DoxyCode}
\hypertarget{input_8h_afcd470506b012754a93b2012b65e3fc4}{\index{input.\-h@{input.\-h}!set\-Pair\-Potentials@{set\-Pair\-Potentials}}
\index{set\-Pair\-Potentials@{set\-Pair\-Potentials}!input.h@{input.\-h}}
\subsubsection[{set\-Pair\-Potentials}]{\setlength{\rightskip}{0pt plus 5cm}void set\-Pair\-Potentials (
\begin{DoxyParamCaption}
\item[{{\bf sim\-System} \&}]{sys, }
\item[{const rapidjson\-::\-Document \&}]{doc}
\end{DoxyParamCaption}
)}}\label{input_8h_afcd470506b012754a93b2012b65e3fc4}


Assign the pair potentials based on the J\-S\-O\-N input file. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em sys} & Simulation system that has been initialized \\
\hline
\mbox{\tt in}  & {\em doc} & J\-S\-O\-N document corresponding to input file \\
\hline
\end{DoxyParams}


Definition at line 342 of file input.\-cpp.



References sim\-System\-::add\-Potential(), sim\-System\-::n\-Species(), num\-To\-Str(), sim\-System\-::ppot, send\-Err(), and S\-Y\-S\-\_\-\-F\-A\-I\-L\-U\-R\-E.



Referenced by initialize(), and set\-Config().


\begin{DoxyCode}
342                                                                       \{
343     \textcolor{keywordtype}{int} Mtot = 1;
344     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"num\_expanded\_states"})) \{
345         Mtot = doc[\textcolor{stringliteral}{"num\_expanded\_states"}].GetInt();
346     \}
347 
348     \textcolor{comment}{//std::vector < pairPotential* > ppotArray (sys.nSpecies()*(sys.nSpecies()-1)/2 + sys.nSpecies());}
349     std::vector < std::string > ppotType (sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}()*(sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}()-1)/2 + sys.
      \hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}());
350     \textcolor{keywordtype}{int} ppotTypeIndex = 0;
351     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++i) \{
352         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = i; j < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++j) \{
353             std::string name1 = \textcolor{stringliteral}{"ppot\_"}+std::to\_string(i+1)+\textcolor{stringliteral}{"\_"}+std::to\_string(j+1), name2 = \textcolor{stringliteral}{"ppot\_"}+
      std::to\_string(j+1)+\textcolor{stringliteral}{"\_"}+std::to\_string(i+1);
354             std::string ppotName = \textcolor{stringliteral}{""}, dummy = \textcolor{stringliteral}{""};
355             \textcolor{keywordtype}{bool} foundIJ = \textcolor{keyword}{false};
356             \textcolor{keywordflow}{if} (doc.HasMember(name1.c\_str())) \{
357                 ppotName = name1;
358                 foundIJ = \textcolor{keyword}{true};
359             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (doc.HasMember(name2.c\_str()) && !foundIJ) \{
360                 ppotName = name2;
361                 foundIJ = \textcolor{keyword}{true};
362             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (doc.HasMember(name2.c\_str()) && foundIJ) \{
363                 \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Input file doubly specifies pair potential for species pair ("}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{", "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{")"});
364                 exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
365             \} \textcolor{keywordflow}{else} \{
366                 \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Input file does not specify pair potential for species pair ("}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{", "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{")"});
367                 exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
368             \}
369             assert(doc[ppotName.c\_str()].IsString());
370             ppotType[ppotTypeIndex] = doc[ppotName.c\_str()].GetString();
371             dummy = ppotName+\textcolor{stringliteral}{"\_params"};
372             assert(doc.HasMember(dummy.c\_str()));
373             assert(doc[dummy.c\_str()].IsArray());
374             std::vector < double > params (doc[dummy.c\_str()].Size()+1, 0);
375             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} k = 0; k < params.size()-1; ++k) \{
376                 assert(doc[dummy.c\_str()][k].IsNumber());
377                 params[k] = doc[dummy.c\_str()][k].GetDouble();
378             \}
379             params[params.size()-1] = Mtot;
380 
381             \textcolor{keywordtype}{bool} useCellList = \textcolor{keyword}{false}; \textcolor{comment}{// default}
382             dummy = ppotName+\textcolor{stringliteral}{"\_use\_cell\_list"};
383             \textcolor{keywordflow}{if} (doc.HasMember(dummy.c\_str())) \{
384                 assert(doc[dummy.c\_str()].IsBool());
385                 useCellList = doc[dummy.c\_str()].GetBool();
386             \}
387 
388             sys.\hyperlink{classsim_system_a43ae18ca5e66c8e916b88b71c5ee5240}{addPotential}(i, j, ppotType[ppotTypeIndex], params, useCellList);
389             sys.\hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[i][j]->savePotential(ppotName+\textcolor{stringliteral}{".dat"}, 0.01, 0.01);
390 
391             ppotTypeIndex++;
392         \}
393     \}
394 \}
\end{DoxyCode}
\hypertarget{input_8h_a76e6e0f38bf684278b7bebb317b71e5b}{\index{input.\-h@{input.\-h}!set\-System\-Barriers@{set\-System\-Barriers}}
\index{set\-System\-Barriers@{set\-System\-Barriers}!input.h@{input.\-h}}
\subsubsection[{set\-System\-Barriers}]{\setlength{\rightskip}{0pt plus 5cm}void set\-System\-Barriers (
\begin{DoxyParamCaption}
\item[{{\bf sim\-System} \&}]{sys, }
\item[{const rapidjson\-::\-Document \&}]{doc}
\end{DoxyParamCaption}
)}}\label{input_8h_a76e6e0f38bf684278b7bebb317b71e5b}


Initialize the barriers in a system by parsing the input document. 

This function is defined separately since it must be done several times.

\mbox{[}in, out\mbox{]} sys System to initialize with barriers  \mbox{[}in\mbox{]} doc Input J\-S\-O\-N document 

Definition at line 575 of file input.\-cpp.



References sim\-System\-::get\-Total\-M(), M\-A\-X\-\_\-\-B\-A\-R\-R\-I\-E\-R\-S\-\_\-\-P\-E\-R\-\_\-\-S\-P\-E\-C\-I\-E\-S, sim\-System\-::n\-Species(), send\-Err(), sim\-System\-::species\-Barriers, S\-Y\-S\-\_\-\-F\-A\-I\-L\-U\-R\-E, and custom\-Exception\-::what().



Referenced by initialize(), and set\-Config().


\begin{DoxyCode}
575                                                                       \{
576     \textcolor{comment}{// get Mtot, first from doc, otherwise try sys, but they should be the same}
577     \textcolor{keywordtype}{int} Mtot = 1;
578     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"num\_expanded\_states"})) \{
579         assert(doc[\textcolor{stringliteral}{"num\_expanded\_states"}].IsInt());
580         Mtot = doc[\textcolor{stringliteral}{"num\_expanded\_states"}].GetInt();
581     \} \textcolor{keywordflow}{else} \{
582         Mtot = sys.\hyperlink{classsim_system_aa4ad1afff101bb530e1590df05035276}{getTotalM}();
583     \}
584 
585     \textcolor{comment}{// Hard wall (expect parameters: \{lb, ub, sigma\})}
586     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++i) \{
587         \textcolor{keywordtype}{bool} convention0 = \textcolor{keyword}{false};
588         std::string dummy = \textcolor{stringliteral}{"hardWallZ\_"} + std::to\_string(i+1);
589         std::vector < double > wallParams (3, 0);
590         \textcolor{keywordflow}{if} (doc.HasMember(dummy.c\_str())) \{
591             assert(doc[dummy.c\_str()].IsArray());
592             assert(doc[dummy.c\_str()].Size() == 3);
593             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < 3; ++j) \{
594                 wallParams[j] = doc[dummy.c\_str()][j].GetDouble();
595             \}
596             \textcolor{keywordflow}{try} \{
597                 sys.\hyperlink{classsim_system_a5ae652ff4519f39c3862abae32a9581b}{speciesBarriers}[i].addHardWallZ (wallParams[0], wallParams[1], 
      wallParams[2], Mtot);
598             \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
599                 \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(ce.\hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}());
600                 exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
601             \}
602             convention0 = \textcolor{keyword}{true};
603         \}
604         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 1; j <= \hyperlink{global_8h_a85f9382b07ebd88cde9cd3667d50c0a6}{MAX\_BARRIERS\_PER\_SPECIES}; ++j) \{
605             \textcolor{comment}{// alternatively allow multiple walls to specified with a suffix up to a max}
606             std::string dummy = \textcolor{stringliteral}{"hardWallZ\_"} + std::to\_string(i+1) + \textcolor{stringliteral}{"\_"} + std::to\_string(j);
607             \textcolor{keywordflow}{if} (doc.HasMember(dummy.c\_str())) \{
608                 \textcolor{keywordflow}{if} (convention0) \{
609                     \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Error, multiple barrier naming conventions used for the same species"});
610                     exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
611                 \}
612                 \textcolor{keywordflow}{if} (doc.HasMember(dummy.c\_str())) \{
613                     assert(doc[dummy.c\_str()].IsArray());
614                     assert(doc[dummy.c\_str()].Size() == 3);
615                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < 3; ++j) \{
616                         wallParams[j] = doc[dummy.c\_str()][j].GetDouble();
617                     \}
618                     \textcolor{keywordflow}{try} \{
619                         sys.\hyperlink{classsim_system_a5ae652ff4519f39c3862abae32a9581b}{speciesBarriers}[i].addHardWallZ (wallParams[0], wallParams[1], 
      wallParams[2], Mtot);
620                     \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
621                         \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(ce.\hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}());
622                         exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
623                     \}
624                 \}
625             \}
626         \}
627     \}
628 
629     \textcolor{comment}{// Square well wall (expect parameters: \{lb, ub, sigma, range, eps\})}
630     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++i) \{
631         \textcolor{keywordtype}{bool} convention0 = \textcolor{keyword}{false};
632         std::string dummy = \textcolor{stringliteral}{"squareWellWallZ\_"} + std::to\_string(i+1);
633         std::vector < double > wallParams (5, 0);
634         \textcolor{keywordflow}{if} (doc.HasMember(dummy.c\_str())) \{
635             assert(doc[dummy.c\_str()].IsArray());
636             assert(doc[dummy.c\_str()].Size() == 5);
637             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < 5; ++j) \{
638                 wallParams[j] = doc[dummy.c\_str()][j].GetDouble();
639             \}
640             \textcolor{keywordflow}{try} \{
641                 sys.\hyperlink{classsim_system_a5ae652ff4519f39c3862abae32a9581b}{speciesBarriers}[i].addSquareWellWallZ (wallParams[0], wallParams[1], 
      wallParams[2], wallParams[3], wallParams[4], Mtot);
642             \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
643                 \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(ce.\hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}());
644                 exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
645             \}
646             convention0 = \textcolor{keyword}{true};
647         \}
648         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 1; j <= \hyperlink{global_8h_a85f9382b07ebd88cde9cd3667d50c0a6}{MAX\_BARRIERS\_PER\_SPECIES}; ++j) \{
649             \textcolor{comment}{// alternatively allow multiple walls to specified with a suffix up to a max}
650             std::string dummy = \textcolor{stringliteral}{"squareWellWallZ\_"} + std::to\_string(i+1) + \textcolor{stringliteral}{"\_"} + std::to\_string(j);
651             \textcolor{keywordflow}{if} (doc.HasMember(dummy.c\_str())) \{
652                 \textcolor{keywordflow}{if} (convention0) \{
653                     \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Error, multiple barrier naming conventions used for the same species"});
654                     exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
655                 \}
656                 \textcolor{keywordflow}{if} (doc.HasMember(dummy.c\_str())) \{
657                     assert(doc[dummy.c\_str()].IsArray());
658                     assert(doc[dummy.c\_str()].Size() == 5);
659                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < 5; ++j) \{
660                         wallParams[j] = doc[dummy.c\_str()][j].GetDouble();
661                     \}
662                     \textcolor{keywordflow}{try} \{
663                         sys.\hyperlink{classsim_system_a5ae652ff4519f39c3862abae32a9581b}{speciesBarriers}[i].addSquareWellWallZ (wallParams[0], wallParams
      [1], wallParams[2], wallParams[3], wallParams[4], Mtot);
664                     \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
665                         \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(ce.\hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}());
666                         exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
667                     \}
668                 \}
669             \}
670         \}
671     \}
672 
673     \textcolor{comment}{// cylinderZ (expect parameters: \{x, y, radius, width, sigma, eps\})}
674     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++i) \{
675         \textcolor{keywordtype}{bool} convention0 = \textcolor{keyword}{false};
676         std::string dummy = \textcolor{stringliteral}{"cylinderZ\_"} + std::to\_string(i+1);
677         std::vector < double > wallParams (6, 0);
678         \textcolor{keywordflow}{if} (doc.HasMember(dummy.c\_str())) \{
679             assert(doc[dummy.c\_str()].IsArray());
680             assert(doc[dummy.c\_str()].Size() == 6);
681             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < 6; ++j) \{
682                 wallParams[j] = doc[dummy.c\_str()][j].GetDouble();
683             \}
684             \textcolor{keywordflow}{try} \{
685                 sys.\hyperlink{classsim_system_a5ae652ff4519f39c3862abae32a9581b}{speciesBarriers}[i].addCylinderZ (wallParams[0], wallParams[1], 
      wallParams[2], wallParams[3], wallParams[4], wallParams[5], Mtot);
686             \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
687                 \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(ce.\hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}());
688                 exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
689             \}
690             convention0 = \textcolor{keyword}{true};
691         \}
692         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 1; j <= \hyperlink{global_8h_a85f9382b07ebd88cde9cd3667d50c0a6}{MAX\_BARRIERS\_PER\_SPECIES}; ++j) \{
693             \textcolor{comment}{// alternatively allow multiple walls to specified with a suffix up to a max}
694             std::string dummy = \textcolor{stringliteral}{"cylinderZ\_"} + std::to\_string(i+1) + \textcolor{stringliteral}{"\_"} + std::to\_string(j);
695             \textcolor{keywordflow}{if} (doc.HasMember(dummy.c\_str())) \{
696                 \textcolor{keywordflow}{if} (convention0) \{
697                     \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Error, multiple barrier naming conventions used for the same species"});
698                     exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
699                 \}
700                 \textcolor{keywordflow}{if} (doc.HasMember(dummy.c\_str())) \{
701                     assert(doc[dummy.c\_str()].IsArray());
702                     assert(doc[dummy.c\_str()].Size() == 6);
703                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < 6; ++j) \{
704                         wallParams[j] = doc[dummy.c\_str()][j].GetDouble();
705                     \}
706                     \textcolor{keywordflow}{try} \{
707                         sys.\hyperlink{classsim_system_a5ae652ff4519f39c3862abae32a9581b}{speciesBarriers}[i].addCylinderZ (wallParams[0], wallParams[1], 
      wallParams[2], wallParams[3], wallParams[4], wallParams[5], Mtot);
708                     \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
709                         \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(ce.\hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}());
710                         exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
711                     \}
712                 \}
713             \}
714         \}
715     \}
716 
717     \textcolor{comment}{// rightTriangleXZ (expect parameters: \{width, theta, lamW, eps, sigma, sep, offset, zbase, top\})}
718     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++i) \{
719         \textcolor{keywordtype}{bool} convention0 = \textcolor{keyword}{false};
720         std::string dummy = \textcolor{stringliteral}{"rightTriangleXZ\_"} + std::to\_string(i+1);
721         std::vector < double > wallParams (8, 0);
722         \textcolor{keywordtype}{bool} top = \textcolor{keyword}{false};
723         assert(doc.HasMember(\textcolor{stringliteral}{"box"}));
724         assert(doc[\textcolor{stringliteral}{"box"}].IsArray());
725         assert(doc[\textcolor{stringliteral}{"box"}].Size() == 3);
726         std::vector < double > sysBox (3, 0);
727         \textcolor{keywordflow}{for} (rapidjson::SizeType j = 0; j < doc[\textcolor{stringliteral}{"box"}].Size(); ++j) \{
728             assert(doc[\textcolor{stringliteral}{"box"}][j].IsNumber());
729             sysBox[j] = doc[\textcolor{stringliteral}{"box"}][j].GetDouble();
730         \}
731         \textcolor{keywordflow}{if} (doc.HasMember(dummy.c\_str())) \{
732             assert(doc[dummy.c\_str()].IsArray());
733             assert(doc[dummy.c\_str()].Size() == 9);
734             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < 8; ++j) \{
735                 assert (doc[dummy.c\_str()][j].IsDouble());
736                 wallParams[j] = doc[dummy.c\_str()][j].GetDouble();
737             \}
738             assert (doc[dummy.c\_str()][8].IsBool());
739             top = doc[dummy.c\_str()][8].GetBool();
740             \textcolor{keywordflow}{try} \{
741                 sys.\hyperlink{classsim_system_a5ae652ff4519f39c3862abae32a9581b}{speciesBarriers}[i].addRightTriangleXZ (wallParams[0], wallParams[1], 
      wallParams[2], wallParams[3], wallParams[4], wallParams[5], wallParams[6], sysBox, wallParams[7], top, Mtot);
742             \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
743                 \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(ce.\hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}());
744                 exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
745             \}
746             convention0 = \textcolor{keyword}{true};
747         \}
748         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 1; j <= \hyperlink{global_8h_a85f9382b07ebd88cde9cd3667d50c0a6}{MAX\_BARRIERS\_PER\_SPECIES}; ++j) \{
749             \textcolor{comment}{// alternatively allow multiple walls to specified with a suffix up to a max}
750             std::string dummy = \textcolor{stringliteral}{"rightTriangleXZ\_"} + std::to\_string(i+1) + \textcolor{stringliteral}{"\_"} + std::to\_string(j);
751             \textcolor{keywordflow}{if} (doc.HasMember(dummy.c\_str())) \{
752                 \textcolor{keywordflow}{if} (convention0) \{
753                     \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Error, multiple barrier naming conventions used for the same species"});
754                     exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
755                 \}
756                 \textcolor{keywordflow}{if} (doc.HasMember(dummy.c\_str())) \{
757                     assert(doc[dummy.c\_str()].IsArray());
758                     assert(doc[dummy.c\_str()].Size() == 9);
759                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} k = 0; k < 8; ++k) \{
760                         assert (doc[dummy.c\_str()][k].IsNumber());
761                         wallParams[k] = doc[dummy.c\_str()][k].GetDouble();
762                     \}
763                     assert (doc[dummy.c\_str()][8].IsBool());
764                     top = doc[dummy.c\_str()][8].GetBool();
765                     \textcolor{keywordflow}{try} \{
766                         sys.\hyperlink{classsim_system_a5ae652ff4519f39c3862abae32a9581b}{speciesBarriers}[i].addRightTriangleXZ (wallParams[0], wallParams
      [1], wallParams[2], wallParams[3], wallParams[4], wallParams[5], wallParams[6], sysBox, wallParams[7], top, 
      Mtot);
767                     \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
768                         \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(ce.\hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}());
769                         exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
770                     \}
771                 \}
772             \}
773         \}
774     \}
775 \}
\end{DoxyCode}
