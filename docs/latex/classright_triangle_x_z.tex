\hypertarget{classright_triangle_x_z}{\section{right\-Triangle\-X\-Z Class Reference}
\label{classright_triangle_x_z}\index{right\-Triangle\-X\-Z@{right\-Triangle\-X\-Z}}
}


{\ttfamily \#include $<$barrier.\-h$>$}

Inheritance diagram for right\-Triangle\-X\-Z\-:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classright_triangle_x_z}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classright_triangle_x_z_a3ce16261ab80928bbfbc2b0d0aa67399}{$\sim$right\-Triangle\-X\-Z} ()
\item 
\hyperlink{classright_triangle_x_z_a8f252f8cb6cbe2861d05565484accc17}{right\-Triangle\-X\-Z} (const double width, const double theta, const double lam\-W, const double eps, const double sigma, const double sep, const double offset, const std\-::vector$<$ double $>$ \&box, const double zbase, bool top=false, const int M=1)
\begin{DoxyCompactList}\small\item\em Instantiate a right triangle feature with its base in the xy-\/plane. \end{DoxyCompactList}\item 
bool \hyperlink{classright_triangle_x_z_a574bcc38639a6d599aaa38fd9085ff63}{inside} (const \hyperlink{classatom}{atom} $\ast$a1, const std\-::vector$<$ double $>$ \&box)
\begin{DoxyCompactList}\small\item\em Check if an atom is overlapping the feature. \end{DoxyCompactList}\item 
double \hyperlink{classright_triangle_x_z_a0a15ebff4238aeb15cad052cf9904f43}{energy} (const \hyperlink{classatom}{atom} $\ast$a1, const std\-::vector$<$ double $>$ \&box)
\begin{DoxyCompactList}\small\item\em Get the energy of a position assuming it is located within window 8. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}


Definition at line 81 of file barrier.\-h.



\subsection{Constructor \& Destructor Documentation}
\hypertarget{classright_triangle_x_z_a3ce16261ab80928bbfbc2b0d0aa67399}{\index{right\-Triangle\-X\-Z@{right\-Triangle\-X\-Z}!$\sim$right\-Triangle\-X\-Z@{$\sim$right\-Triangle\-X\-Z}}
\index{$\sim$right\-Triangle\-X\-Z@{$\sim$right\-Triangle\-X\-Z}!rightTriangleXZ@{right\-Triangle\-X\-Z}}
\subsubsection[{$\sim$right\-Triangle\-X\-Z}]{\setlength{\rightskip}{0pt plus 5cm}right\-Triangle\-X\-Z\-::$\sim$right\-Triangle\-X\-Z (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classright_triangle_x_z_a3ce16261ab80928bbfbc2b0d0aa67399}


Definition at line 83 of file barrier.\-h.


\begin{DoxyCode}
83 \{\};
\end{DoxyCode}
\hypertarget{classright_triangle_x_z_a8f252f8cb6cbe2861d05565484accc17}{\index{right\-Triangle\-X\-Z@{right\-Triangle\-X\-Z}!right\-Triangle\-X\-Z@{right\-Triangle\-X\-Z}}
\index{right\-Triangle\-X\-Z@{right\-Triangle\-X\-Z}!rightTriangleXZ@{right\-Triangle\-X\-Z}}
\subsubsection[{right\-Triangle\-X\-Z}]{\setlength{\rightskip}{0pt plus 5cm}right\-Triangle\-X\-Z\-::right\-Triangle\-X\-Z (
\begin{DoxyParamCaption}
\item[{const double}]{width, }
\item[{const double}]{theta, }
\item[{const double}]{lam\-W, }
\item[{const double}]{eps, }
\item[{const double}]{sigma, }
\item[{const double}]{sep, }
\item[{const double}]{offset, }
\item[{const std\-::vector$<$ double $>$ \&}]{box, }
\item[{const double}]{zbase, }
\item[{bool}]{top = {\ttfamily false}, }
\item[{const int}]{M = {\ttfamily 1}}
\end{DoxyParamCaption}
)}}\label{classright_triangle_x_z_a8f252f8cb6cbe2861d05565484accc17}


Instantiate a right triangle feature with its base in the xy-\/plane. 

It is raised in the z-\/direction and extends in the x-\/direction. Expanded ensembles scale the range of interaction as well as the magnitude.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em width} & Width of triangle's feature \\
\hline
\mbox{\tt in}  & {\em theta} & Elevation angle of the feature in radians (0, P\-I) \\
\hline
\mbox{\tt in}  & {\em lam\-W} & Attractive range ratio relative to hard sphere in contact with the feature (akin to a square well potential's lambda), must be $>$= 1 \\
\hline
\mbox{\tt in}  & {\em eps} & Attraction strength to feature \\
\hline
\mbox{\tt in}  & {\em sigma} & Hard sphere diameter of interaction with the feature \\
\hline
\mbox{\tt in}  & {\em sep} & Distance between features \\
\hline
\mbox{\tt in}  & {\em offset} & Offset from x = 0 position of the first feature. A positive offset shifts the feature in the +x direction. \\
\hline
\mbox{\tt in}  & {\em box} & System box size to check the feature (as specified) is periodic in the box \\
\hline
\mbox{\tt in}  & {\em zbase} & Z-\/coordinate of X\-Y plane that defines the base of the feature. To avoid periodicity effects be sure it is $>$ 0 and less than Lz, but this depends on other interactions so it cannot be checked automatically here. \\
\hline
\mbox{\tt in}  & {\em top} & If true, feature is on the \char`\"{}top\char`\"{}, else is on the bottom (default) \\
\hline
\mbox{\tt in}  & {\em M} & Number of expanded ensemble states to recognize (default = 1) \\
\hline
\end{DoxyParams}


Definition at line 18 of file barrier.\-cpp.



References barrier\-::\-M\-\_\-, N\-U\-M\-\_\-\-I\-N\-F\-I\-N\-I\-T\-Y, and P\-I.


\begin{DoxyCode}
18                                                                                                            
                                                                                                                  
                                   \{
19     \textcolor{keywordflow}{if} (sep < 0.0) \{
20         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"rightTriangle sep is out of bounds"});
21     \}
22     \textcolor{comment}{// Check the feature fits periodically in the box}
23     \textcolor{keywordflow}{if} (fmod(box[0]/(sep+width), 1) != 0.0) \{
24         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"rightTriangle width+separation is not commensurate with the
       box size"});
25     \}
26     \textcolor{keywordflow}{if} (theta <= 0.0 || theta >= \hyperlink{global_8h_a598a3330b3c21701223ee0ca14316eca}{PI}/2.0) \{
27         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"rightTriangle elevation angle theta is out of bounds, must
       be within (0, PI)"});
28     \}
29     \textcolor{keywordflow}{if} (sigma <= 0.0) \{
30         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"rightTriangle sigma is out of bounds <= 0"});
31     \}
32     \textcolor{keywordflow}{if} (lamW < 1.0) \{
33         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"rightTriangle lamW is out of bounds < 1.0"});
34     \}
35     \textcolor{keywordflow}{if} (eps < 0.0) \{
36         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"rightTriangle epsilon is out of bounds < 0.0"});
37     \}
38     \textcolor{keywordflow}{if} (M < 1) \{
39         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"rightTriangle M value is out of bounds < 1"});
40     \}
41     \textcolor{keywordflow}{if} (zbase < 0.0 || zbase > box[2]) \{
42         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"rightTriangle zbase value is out of bounds, must be within
       [0, box[2]]"});
43     \}
44     \textcolor{keywordflow}{if} (offset >= box[0] || offset < 0) \{
45         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"rightTriangle offset value is out of bounds, must be within
       [0, box[0])"});
46     \}
47 
48     \textcolor{comment}{// store variables internally and do conversion to conventions in which derivation was done}
49     zbase\_ = zbase;
50     width\_ = width;
51     sep\_ = sep;
52     theta\_ = theta;
53     xOffset\_ = offset;
54     top\_ = top;
55     \hyperlink{classbarrier_a274cf283ffc97c22ffa9a4258369c400}{M\_} = M;
56     lamW\_ = lamW;
57     x\_max\_image\_ = (int) round(box[0]/(sep+width)) - 1;
58 
59     \textcolor{comment}{// precompute points and trigonometry}
60     a\_ = width\_*cos(theta\_)*sin(theta\_);
61     b\_ = width\_*sin(theta\_)*cos(\hyperlink{global_8h_a598a3330b3c21701223ee0ca14316eca}{PI}/2.0-theta\_);
62     c\_ = width\_*cos(theta\_)*cos(theta\_);
63 
64     \textcolor{keywordflow}{try} \{
65         sigma\_.resize(\hyperlink{classbarrier_a274cf283ffc97c22ffa9a4258369c400}{M\_});
66     \} \textcolor{keywordflow}{catch} (std::bad\_alloc &ba) \{
67         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory"});
68     \}
69     \textcolor{keywordflow}{try} \{
70         eps\_.resize(\hyperlink{classbarrier_a274cf283ffc97c22ffa9a4258369c400}{M\_});
71     \} \textcolor{keywordflow}{catch} (std::bad\_alloc &ba) \{
72         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory"});
73     \}
74     \textcolor{keywordflow}{try} \{
75         box\_.resize(3);
76     \} \textcolor{keywordflow}{catch} (std::bad\_alloc &ba) \{
77         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory"});
78     \}
79     box\_ = box;
80     \textcolor{keywordflow}{try} \{
81         ub\_check\_.resize(\hyperlink{classbarrier_a274cf283ffc97c22ffa9a4258369c400}{M\_}, -\hyperlink{potentials_8h_ab94ab1d09e2291d03fe92a0e24a9d33b}{NUM\_INFINITY});
82     \} \textcolor{keywordflow}{catch} (std::bad\_alloc &ba) \{
83         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory"});
84     \}
85 
86     \textcolor{keywordflow}{try} \{
87         ub\_seg\_x\_.resize(\hyperlink{classbarrier_a274cf283ffc97c22ffa9a4258369c400}{M\_});
88     \} \textcolor{keywordflow}{catch} (std::bad\_alloc &ba) \{
89         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory"});
90     \}
91     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \hyperlink{classbarrier_a274cf283ffc97c22ffa9a4258369c400}{M\_}; ++i) \{
92         \textcolor{keywordflow}{try} \{
93             ub\_seg\_x\_[i].resize(4);
94         \} \textcolor{keywordflow}{catch} (std::bad\_alloc &ba) \{
95             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory"});
96         \}
97     \}
98     \textcolor{keywordflow}{try} \{
99         lb\_seg\_x\_.resize(M\_);
100     \} \textcolor{keywordflow}{catch} (std::bad\_alloc &ba) \{
101         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory"});
102     \}
103     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \hyperlink{classbarrier_a274cf283ffc97c22ffa9a4258369c400}{M\_}; ++i) \{
104         \textcolor{keywordflow}{try} \{
105             lb\_seg\_x\_[i].resize(4);
106         \} \textcolor{keywordflow}{catch} (std::bad\_alloc &ba) \{
107             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory"});
108         \}
109     \}
110     \textcolor{keywordflow}{try} \{
111         ub\_seg\_z\_.resize(M\_);
112     \} \textcolor{keywordflow}{catch} (std::bad\_alloc &ba) \{
113         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory"});
114     \}
115     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \hyperlink{classbarrier_a274cf283ffc97c22ffa9a4258369c400}{M\_}; ++i) \{
116         \textcolor{keywordflow}{try} \{
117             ub\_seg\_z\_[i].resize(4);
118         \} \textcolor{keywordflow}{catch} (std::bad\_alloc &ba) \{
119             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory"});
120         \}
121     \}
122     \textcolor{keywordflow}{try} \{
123         lb\_seg\_z\_.resize(M\_);
124     \} \textcolor{keywordflow}{catch} (std::bad\_alloc &ba) \{
125         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory"});
126     \}
127     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \hyperlink{classbarrier_a274cf283ffc97c22ffa9a4258369c400}{M\_}; ++i) \{
128         \textcolor{keywordflow}{try} \{
129             lb\_seg\_z\_[i].resize(4);
130         \} \textcolor{keywordflow}{catch} (std::bad\_alloc &ba) \{
131             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory"});
132         \}
133     \}
134     \textcolor{keywordflow}{try} \{
135         ub\_slope\_.resize(M\_);
136     \} \textcolor{keywordflow}{catch} (std::bad\_alloc &ba) \{
137         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory"});
138     \}
139     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \hyperlink{classbarrier_a274cf283ffc97c22ffa9a4258369c400}{M\_}; ++i) \{
140         \textcolor{keywordflow}{try} \{
141             ub\_slope\_[i].resize(5);
142         \} \textcolor{keywordflow}{catch} (std::bad\_alloc &ba) \{
143             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory"});
144         \}
145     \}
146     \textcolor{keywordflow}{try} \{
147         lb\_slope\_.resize(M\_);
148     \} \textcolor{keywordflow}{catch} (std::bad\_alloc &ba) \{
149         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory"});
150     \}
151     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \hyperlink{classbarrier_a274cf283ffc97c22ffa9a4258369c400}{M\_}; ++i) \{
152         \textcolor{keywordflow}{try} \{
153             lb\_slope\_[i].resize(5);
154         \} \textcolor{keywordflow}{catch} (std::bad\_alloc &ba) \{
155             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory"});
156         \}
157     \}
158     \textcolor{keywordflow}{try} \{
159         ub\_int\_.resize(M\_);
160     \} \textcolor{keywordflow}{catch} (std::bad\_alloc &ba) \{
161         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory"});
162     \}
163     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \hyperlink{classbarrier_a274cf283ffc97c22ffa9a4258369c400}{M\_}; ++i) \{
164         \textcolor{keywordflow}{try} \{
165             ub\_int\_[i].resize(5);
166         \} \textcolor{keywordflow}{catch} (std::bad\_alloc &ba) \{
167             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory"});
168         \}
169     \}
170     \textcolor{keywordflow}{try} \{
171         lb\_int\_.resize(M\_);
172     \} \textcolor{keywordflow}{catch} (std::bad\_alloc &ba) \{
173         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory"});
174     \}
175     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \hyperlink{classbarrier_a274cf283ffc97c22ffa9a4258369c400}{M\_}; ++i) \{
176         \textcolor{keywordflow}{try} \{
177             lb\_int\_[i].resize(5);
178         \} \textcolor{keywordflow}{catch} (std::bad\_alloc &ba) \{
179             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory"});
180         \}
181     \}
182 
183     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \hyperlink{classbarrier_a274cf283ffc97c22ffa9a4258369c400}{M\_}; ++i) \{
184         \textcolor{keywordflow}{if} (i == 0) \{
185             sigma\_[i] = sigma;
186             eps\_[i] = eps;
187         \} \textcolor{keywordflow}{else} \{
188             sigma\_[i] = sigma\_[0]/M\_*i;
189             eps\_[i] = eps\_[0]/M\_*i;
190         \}
191 
192         ub\_seg\_x\_[i][0] = -lamW\_*sigma\_[i]*sin(theta\_);
193         ub\_seg\_x\_[i][1] = c\_ - lamW\_*sigma\_[i]*sin(theta\_);
194         ub\_seg\_x\_[i][2] = c\_ + lamW\_*sigma\_[i]*cos(theta\_);
195         ub\_seg\_x\_[i][3] = width\_ + lamW\_*sigma\_[i]*cos(theta\_);
196 
197         lb\_seg\_x\_[i][0] = -sigma\_[i]/2.0*sin(theta\_);
198         lb\_seg\_x\_[i][1] = c\_ - sigma\_[i]/2.0*sin(theta\_);
199         lb\_seg\_x\_[i][2] = c\_ + sigma\_[i]/2.0*cos(theta\_);
200         lb\_seg\_x\_[i][3] = width\_ + sigma\_[i]/2.0*cos(theta\_);
201 
202         ub\_seg\_z\_[i][0] = lamW\_*sigma\_[i]*cos(theta\_);
203         ub\_seg\_z\_[i][1] = a\_ + lamW\_*sigma\_[i]*cos(theta\_);
204         ub\_seg\_z\_[i][2] = a\_ + lamW\_*sigma\_[i]*sin(theta\_);
205         ub\_seg\_z\_[i][3] = lamW\_*sigma\_[i]*sin(theta\_);
206 
207         lb\_seg\_z\_[i][0] = sigma\_[i]/2.0*cos(theta\_);
208         lb\_seg\_z\_[i][1] = a\_ + sigma\_[i]/2.0*cos(theta\_);
209         lb\_seg\_z\_[i][2] = a\_ + sigma\_[i]/2.0*sin(theta\_);
210         lb\_seg\_z\_[i][3] = sigma\_[i]/2.0*sin(theta\_);
211 
212         ub\_check\_[i] = *std::max\_element(ub\_seg\_z\_[i].begin(), ub\_seg\_z\_[i].end());
213 
214         ub\_slope\_[i][0] = 0.0;
215         ub\_slope\_[i][1] = (ub\_seg\_z\_[i][1] - ub\_seg\_z\_[i][0])/(ub\_seg\_x\_[i][1] - ub\_seg\_x\_[i][0]);
216         ub\_slope\_[i][2] = (ub\_seg\_z\_[i][2] - ub\_seg\_z\_[i][1])/(ub\_seg\_x\_[i][2] - ub\_seg\_x\_[i][1]);
217         ub\_slope\_[i][3] = (ub\_seg\_z\_[i][3] - ub\_seg\_z\_[i][2])/(ub\_seg\_x\_[i][3] - ub\_seg\_x\_[i][2]);
218         ub\_slope\_[i][4] = 0.0;
219 
220         ub\_int\_[i][0] = 0.0;
221         ub\_int\_[i][1] = ub\_seg\_z\_[i][0];
222         ub\_int\_[i][2] = ub\_seg\_z\_[i][1];
223         ub\_int\_[i][3] = ub\_seg\_z\_[i][2];
224         ub\_int\_[i][4] = 0.0;
225 
226         lb\_slope\_[i][0] = 0.0;
227         lb\_slope\_[i][1] = (lb\_seg\_z\_[i][1] - lb\_seg\_z\_[i][0])/(lb\_seg\_x\_[i][1] - lb\_seg\_x\_[i][0]);
228         lb\_slope\_[i][2] = (lb\_seg\_z\_[i][2] - lb\_seg\_z\_[i][1])/(lb\_seg\_x\_[i][2] - lb\_seg\_x\_[i][1]);
229         lb\_slope\_[i][3] = (lb\_seg\_z\_[i][3] - lb\_seg\_z\_[i][2])/(lb\_seg\_x\_[i][3] - lb\_seg\_x\_[i][2]);
230         lb\_slope\_[i][4] = 0.0;
231 
232         lb\_int\_[i][0] = 0.0;
233         lb\_int\_[i][1] = lb\_seg\_z\_[i][0];
234         lb\_int\_[i][2] = lb\_seg\_z\_[i][1];
235         lb\_int\_[i][3] = lb\_seg\_z\_[i][2];
236         lb\_int\_[i][4] = 0.0;
237     \}
238 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\hypertarget{classright_triangle_x_z_a0a15ebff4238aeb15cad052cf9904f43}{\index{right\-Triangle\-X\-Z@{right\-Triangle\-X\-Z}!energy@{energy}}
\index{energy@{energy}!rightTriangleXZ@{right\-Triangle\-X\-Z}}
\subsubsection[{energy}]{\setlength{\rightskip}{0pt plus 5cm}double right\-Triangle\-X\-Z\-::energy (
\begin{DoxyParamCaption}
\item[{const {\bf atom} $\ast$}]{a1, }
\item[{const std\-::vector$<$ double $>$ \&}]{box}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classright_triangle_x_z_a0a15ebff4238aeb15cad052cf9904f43}


Get the energy of a position assuming it is located within window 8. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em atom} & Pointer to atom to examine \\
\hline
\mbox{\tt in}  & {\em box} & System box size. Will be checked that it is identical to value at class instantiation. \\
\hline
\end{DoxyParams}


Implements \hyperlink{classbarrier_a2d308cfd5709aa479d0b37733f1a0db7}{barrier}.



Definition at line 292 of file barrier.\-cpp.



References barrier\-::\-M\-\_\-, atom\-::m\-State, N\-U\-M\-\_\-\-I\-N\-F\-I\-N\-I\-T\-Y, pbc(), and atom\-::pos.



Referenced by inside().


\begin{DoxyCode}
292                                                                                \{
293     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < box\_.size(); ++i) \{
294         \textcolor{keywordflow}{if} (box[i] != box\_[i]) \{
295             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"System box size has changed from when rightTriangleXZ
       was instantiated"});
296         \}
297     \}
298 
299     \textcolor{keyword}{const} \textcolor{keywordtype}{int} mv = a1->\hyperlink{classatom_a3cb00c0c5b7533657e05af6ff4a42740}{mState};
300     std::vector < double > p = a1->\hyperlink{classatom_a3ae5f4880e7831d8b2c9fda72b4eb24a}{pos};
301 
302 
303     \textcolor{keywordflow}{if} (mv < 0 || mv > \hyperlink{classbarrier_a274cf283ffc97c22ffa9a4258369c400}{M\_}-1) \{
304         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"mState out of bounds for rightTriangleZ"});
305     \}
306 
307     \textcolor{comment}{// First find nearest feature (the one right below)}
308     \hyperlink{utilities_8cpp_ad858a38f435e9a0ee890aa0f526714d2}{pbc} (p, box);
309     \textcolor{keywordtype}{double} dx = p[0] - xOffset\_, dz = 0.0;
310     \textcolor{keywordtype}{int} x\_image = int(floor(dx/(width\_+sep\_)));
311     \textcolor{keywordtype}{double} x\_shift = x\_image*(width\_+sep\_);
312 
313     \textcolor{keywordflow}{if} (top\_) \{
314         dz = zbase\_ - p[2];
315     \} \textcolor{keywordflow}{else} \{
316         dz = p[2] - zbase\_;
317     \}
318 
319     \textcolor{keywordflow}{if} (dz > ub\_check\_[mv]) \{
320         \textcolor{keywordflow}{return} 0.0;
321     \}
322 
323     \textcolor{keywordtype}{double} U = featureInteraction\_ (dx, dz, x\_shift, mv);
324     \textcolor{keywordflow}{if} (U == \hyperlink{potentials_8h_ab94ab1d09e2291d03fe92a0e24a9d33b}{NUM\_INFINITY}) \{
325         \textcolor{keywordflow}{return} U;
326     \}
327 
328     \textcolor{comment}{// Must check all neighboring images, including images beyond edge of each box for periodicity effects}
329     \textcolor{keywordtype}{int} x\_i = x\_image+1;
330     \textcolor{keywordflow}{if} (x\_i > x\_max\_image\_+1) \{
331         x\_i = -1;
332     \}
333     \textcolor{keywordflow}{while} (x\_i != x\_image) \{ \textcolor{comment}{// Stop once one complete cycle is finished}
334         x\_shift = x\_i*(width\_+sep\_);
335         \textcolor{keywordtype}{double} dU = featureInteraction\_ (dx, dz, x\_shift, mv);
336         \textcolor{keywordflow}{if} (dU == \hyperlink{potentials_8h_ab94ab1d09e2291d03fe92a0e24a9d33b}{NUM\_INFINITY}) \{
337             \textcolor{keywordflow}{return} \hyperlink{potentials_8h_ab94ab1d09e2291d03fe92a0e24a9d33b}{NUM\_INFINITY};
338         \} \textcolor{keywordflow}{else} \{
339             U += dU;
340         \}
341         x\_i += 1;
342         \textcolor{keywordflow}{if} (x\_i > x\_max\_image\_+1) \{
343             x\_i = -1;
344         \}
345     \}
346 
347     \textcolor{keywordflow}{return} U;
348 \}
\end{DoxyCode}
\hypertarget{classright_triangle_x_z_a574bcc38639a6d599aaa38fd9085ff63}{\index{right\-Triangle\-X\-Z@{right\-Triangle\-X\-Z}!inside@{inside}}
\index{inside@{inside}!rightTriangleXZ@{right\-Triangle\-X\-Z}}
\subsubsection[{inside}]{\setlength{\rightskip}{0pt plus 5cm}bool right\-Triangle\-X\-Z\-::inside (
\begin{DoxyParamCaption}
\item[{const {\bf atom} $\ast$}]{a1, }
\item[{const std\-::vector$<$ double $>$ \&}]{box}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{classright_triangle_x_z_a574bcc38639a6d599aaa38fd9085ff63}


Check if an atom is overlapping the feature. 

The term \char`\"{}inside\char`\"{} can be a bit confusing here. This function returns true if an atom does N\-O\-T overlap the feature (have infinite interaction energy), which might be considered as being \char`\"{}outside\char`\"{} the feature depending on how you look at it. However, to be consistent with the expected behavior of this virtual function, this is how this function must behave.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em a1} & Atom whose position to test. \\
\hline
\mbox{\tt in}  & {\em box} & System box size. Not actually used, but will be checked that it is identical to value at class instantiation. \\
\hline
\end{DoxyParams}


Implements \hyperlink{classbarrier_a948ebdcfac501cb75d1a1f045a7d9125}{barrier}.



Definition at line 360 of file barrier.\-cpp.



References energy(), N\-U\-M\-\_\-\-I\-N\-F\-I\-N\-I\-T\-Y, and custom\-Exception\-::what().


\begin{DoxyCode}
360                                                                              \{
361     \textcolor{keywordtype}{double} U = \hyperlink{potentials_8h_ab94ab1d09e2291d03fe92a0e24a9d33b}{NUM\_INFINITY};
362     \textcolor{keywordflow}{try} \{
363         U = \hyperlink{classright_triangle_x_z_a0a15ebff4238aeb15cad052cf9904f43}{energy} (a1, box); \textcolor{comment}{// takes care of pbc internally}
364     \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
365         \textcolor{keyword}{const} std::string msg = ce.\hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}();
366         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Unable to test if inside rightTriangleXZ : "}+msg);
367         \textcolor{comment}{//exit (SYS\_FAILURE);}
368     \}
369 
370     \textcolor{keywordflow}{if} (U < \hyperlink{potentials_8h_ab94ab1d09e2291d03fe92a0e24a9d33b}{NUM\_INFINITY}) \{
371         \textcolor{keywordflow}{return} \textcolor{keyword}{true};
372     \} \textcolor{keywordflow}{else} \{
373         \textcolor{keywordflow}{return} \textcolor{keyword}{false};
374     \}
375 \}
\end{DoxyCode}


The documentation for this class was generated from the following files\-:\begin{DoxyCompactItemize}
\item 
/home/nam4/\-Desktop/sandbox/\-F\-H\-M\-C\-Simulation/src/\hyperlink{barrier_8h}{barrier.\-h}\item 
/home/nam4/\-Desktop/sandbox/\-F\-H\-M\-C\-Simulation/src/\hyperlink{barrier_8cpp}{barrier.\-cpp}\end{DoxyCompactItemize}
