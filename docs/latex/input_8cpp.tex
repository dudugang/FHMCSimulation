\hypertarget{input_8cpp}{\section{/home/nam4/\-Desktop/sandbox/\-F\-H\-M\-C\-Simulation/src/input.cpp File Reference}
\label{input_8cpp}\index{/home/nam4/\-Desktop/sandbox/\-F\-H\-M\-C\-Simulation/src/input.\-cpp@{/home/nam4/\-Desktop/sandbox/\-F\-H\-M\-C\-Simulation/src/input.\-cpp}}
}
{\ttfamily \#include \char`\"{}input.\-h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{input_8cpp_aa89df4b08049cfd9bdd875d78591ba5b}{check\-Bounds} (\hyperlink{classsim_system}{sim\-System} \&sys)
\begin{DoxyCompactList}\small\item\em Check the following bounds on system. \end{DoxyCompactList}\item 
\hyperlink{classsim_system}{sim\-System} \hyperlink{input_8cpp_a904001bba4e2facc93d1df9d214ed86e}{initialize} (const std\-::string filename, \hyperlink{classmoves}{moves} $\ast$used\-Moves\-Eq, \hyperlink{classmoves}{moves} $\ast$used\-Moves\-Pr)
\begin{DoxyCompactList}\small\item\em Parse a json input file and initialize system object accordingly. \end{DoxyCompactList}\item 
void \hyperlink{input_8cpp_a4541b66a5d6bfc7c4d90c3cf5c58ba27}{set\-Moves} (\hyperlink{classsim_system}{sim\-System} \&sys, const rapidjson\-::\-Document \&doc, \hyperlink{classmoves}{moves} $\ast$used\-Moves\-Eq, \hyperlink{classmoves}{moves} $\ast$used\-Moves\-Pr)
\begin{DoxyCompactList}\small\item\em Assign the Monte Carlo moves based on the J\-S\-O\-N input file. \end{DoxyCompactList}\item 
void \hyperlink{input_8cpp_afcd470506b012754a93b2012b65e3fc4}{set\-Pair\-Potentials} (\hyperlink{classsim_system}{sim\-System} \&sys, const rapidjson\-::\-Document \&doc)
\begin{DoxyCompactList}\small\item\em Assign the pair potentials based on the J\-S\-O\-N input file. \end{DoxyCompactList}\item 
void \hyperlink{input_8cpp_abb58279d5b9992aef3dcd304a3963954}{set\-Config} (\hyperlink{classsim_system}{sim\-System} \&sys, const std\-::string filename)
\begin{DoxyCompactList}\small\item\em Setup a system's initial configuration as necessary. \end{DoxyCompactList}\item 
void \hyperlink{input_8cpp_ab6dc74f7fbe4f517a72a21da3b795dfa}{set\-Barriers} (\hyperlink{classsim_system}{sim\-System} \&sys, const rapidjson\-::\-Document \&doc)
\begin{DoxyCompactList}\small\item\em Initialize the barriers in a system by parsing the input document. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{input_8cpp_aa89df4b08049cfd9bdd875d78591ba5b}{\index{input.\-cpp@{input.\-cpp}!check\-Bounds@{check\-Bounds}}
\index{check\-Bounds@{check\-Bounds}!input.cpp@{input.\-cpp}}
\subsubsection[{check\-Bounds}]{\setlength{\rightskip}{0pt plus 5cm}void check\-Bounds (
\begin{DoxyParamCaption}
\item[{{\bf sim\-System} \&}]{sys}
\end{DoxyParamCaption}
)}}\label{input_8cpp_aa89df4b08049cfd9bdd875d78591ba5b}


Check the following bounds on system. 

If any fail, an emergency exit is performed.
\begin{DoxyEnumerate}
\item Check all pair potentials are set.
\item Check that rcut $<$ L/2 for all potentials
\end{DoxyEnumerate}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em sys} & System to check bounds on \\
\hline
\end{DoxyParams}


Definition at line 10 of file input.\-cpp.



References sim\-System\-::box(), sim\-System\-::n\-Species(), num\-To\-Str(), sim\-System\-::potential\-Is\-Set(), sim\-System\-::ppot, send\-Err(), and S\-Y\-S\-\_\-\-F\-A\-I\-L\-U\-R\-E.



Referenced by initialize().


\begin{DoxyCode}
10                                   \{
11     \textcolor{comment}{// check all pair potentials have been set and all r\_cut < L/2}
12     \textcolor{keywordtype}{double} minL = sys.\hyperlink{classsim_system_a8bff9dfb95b1b09a0fab2c1c485ade07}{box}()[0];
13     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 1; i < 3; ++i) \{
14         minL = std::min(minL, sys.\hyperlink{classsim_system_a8bff9dfb95b1b09a0fab2c1c485ade07}{box}()[i]);
15     \}
16     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++i) \{
17         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++j) \{
18             \textcolor{keywordflow}{if} (!sys.\hyperlink{classsim_system_a40af191fae6091e26413ee06ae188ae9}{potentialIsSet}(i, j)) \{
19                 \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Not all pair potentials are set"});
20                 exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
21             \}
22             \textcolor{keywordflow}{if} (!(sys.\hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[i][j]->rcut() < minL/2.0)) \{
23                 \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Pair potential r\_cut for species "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i)+\textcolor{stringliteral}{", "}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j)+\textcolor{stringliteral}{" is > L/2"});
24                 exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
25             \}
26         \}
27     \}
28 \}
\end{DoxyCode}
\hypertarget{input_8cpp_a904001bba4e2facc93d1df9d214ed86e}{\index{input.\-cpp@{input.\-cpp}!initialize@{initialize}}
\index{initialize@{initialize}!input.cpp@{input.\-cpp}}
\subsubsection[{initialize}]{\setlength{\rightskip}{0pt plus 5cm}{\bf sim\-System} initialize (
\begin{DoxyParamCaption}
\item[{const std\-::string}]{filename, }
\item[{{\bf moves} $\ast$}]{used\-Moves\-Eq, }
\item[{{\bf moves} $\ast$}]{used\-Moves\-Pr}
\end{DoxyParamCaption}
)}}\label{input_8cpp_a904001bba4e2facc93d1df9d214ed86e}


Parse a json input file and initialize system object accordingly. 

\mbox{[}in\mbox{]} filename Input J\-S\-O\-N document's filename  \mbox{[}in\mbox{]} used\-Moves\-Eq Pointer to move object that will be used during \char`\"{}equilibration\char`\"{} (W\-L)  \mbox{[}in\mbox{]} used\-Moves\-Pr Pointer to move object that will be used during \char`\"{}production\char`\"{} (T\-M\-M\-C) 

Definition at line 37 of file input.\-cpp.



References sim\-System\-::add\-K\-E\-Correction(), check\-Bounds(), sim\-System\-::ln\-F\-\_\-end, sim\-System\-::ln\-F\-\_\-start, sim\-System\-::n\-Crossover\-Visits, num\-To\-Str(), parse\-Json(), sim\-System\-::restart\-From\-T\-M\-M\-C, sim\-System\-::restart\-From\-T\-M\-M\-C\-File, sim\-System\-::restart\-From\-W\-A\-L\-A, sim\-System\-::restart\-From\-W\-A\-L\-A\-File, R\-N\-G\-\_\-\-S\-E\-E\-D, send\-Err(), send\-Msg(), set\-Barriers(), set\-Moves(), set\-Pair\-Potentials(), sim\-System\-::set\-Tot\-N\-Bounds(), S\-Y\-S\-\_\-\-F\-A\-I\-L\-U\-R\-E, sim\-System\-::tmmc\-Sweep\-Size, sim\-System\-::toggle\-K\-E(), sim\-System\-::total\-T\-M\-M\-C\-Sweeps, sim\-System\-::wala\-\_\-g, sim\-System\-::wala\-\_\-s, and sim\-System\-::wl\-Sweep\-Size.


\begin{DoxyCode}
37                                                                                         \{
38     rapidjson::Document doc;
39     \textcolor{keywordflow}{try} \{
40         \hyperlink{utilities_8cpp_a3f494918ff3c252de4914c9905be04e7}{parseJson} (filename, doc);
41     \} \textcolor{keywordflow}{catch} (std::exception &ex) \{
42         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (ex.what());
43     \}
44 
45     \textcolor{comment}{// Check each member exists and is in the correct format}
46     \textcolor{keywordflow}{if} (!doc.HasMember(\textcolor{stringliteral}{"num\_species"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"num\_species\(\backslash\)" is not
       specified in "}+filename);
47     \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"num\_species"}].IsInt()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"num\_species\(\backslash\)" is not an
       integer in "}+filename);
48 
49     \textcolor{keywordflow}{if} (!doc.HasMember(\textcolor{stringliteral}{"beta"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"beta\(\backslash\)" is not specified in "}+
      filename);
50     \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"beta"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"beta\(\backslash\)" is not a number in "}+
      filename);
51 
52     \textcolor{keywordflow}{if} (!doc.HasMember(\textcolor{stringliteral}{"box"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"box\(\backslash\)" is not specified in "}+filename
      );
53     \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"box"}].IsArray()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"box\(\backslash\)" is not an array in "}+filename)
      ;
54     \textcolor{keywordflow}{if} (doc[\textcolor{stringliteral}{"box"}].Size() != 3) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"box\(\backslash\)" is not a length 3 array in "}+
      filename);
55     std::vector < double > sysBox (3, 0);
56     \textcolor{keywordflow}{for} (rapidjson::SizeType i = 0; i < doc[\textcolor{stringliteral}{"box"}].Size(); ++i) \{
57         \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"box"}][i].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"box index "}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i)+\textcolor{stringliteral}{" is not a number in "}+filename);
58         sysBox[i] = doc[\textcolor{stringliteral}{"box"}][i].GetDouble();
59     \}
60 
61     \textcolor{keywordtype}{double} duh = 10.0;
62     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"delta\_u\_hist"})) \{
63         \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"delta\_u\_hist"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"delta\_u\_hist\(\backslash\)" is not
       a number in "}+filename);
64         duh = doc[\textcolor{stringliteral}{"delta\_u\_hist"}].GetDouble();
65     \}
66 
67     \textcolor{keywordtype}{int} maxOrder = 2;
68     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"max\_order"})) \{
69         \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"max\_order"}].IsInt()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"max\_order\(\backslash\)" is not an
       integer in "}+filename);
70         maxOrder = doc[\textcolor{stringliteral}{"max\_order"}].GetInt();
71     \}
72 
73     \textcolor{keywordtype}{bool} useKe = \textcolor{keyword}{false};
74     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"use\_ke"})) \{
75         \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"use\_ke"}].IsBool()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"use\_ke\(\backslash\)" is not a boolean in "}
      +filename);
76         useKe = doc[\textcolor{stringliteral}{"use\_ke"}].GetBool();
77     \}
78 
79     \textcolor{keywordflow}{if} (!doc.HasMember(\textcolor{stringliteral}{"mu"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"mu\(\backslash\)" is not specified in "}+filename);
80     \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"mu"}].IsArray()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"mu\(\backslash\)" is not an array in "}+filename);
81     \textcolor{keywordflow}{if} (doc[\textcolor{stringliteral}{"mu"}].Size() != doc[\textcolor{stringliteral}{"num\_species"}].GetInt()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"mu\(\backslash\)" is
       not specified for each species in "}+filename);
82     std::vector < double > sysMu (doc[\textcolor{stringliteral}{"mu"}].Size(), 0);
83     \textcolor{keywordflow}{for} (rapidjson::SizeType i = 0; i < doc[\textcolor{stringliteral}{"mu"}].Size(); ++i) \{
84         \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"mu"}][i].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"mu\(\backslash\)" for species "}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{" is not a number in "}+filename);
85         sysMu[i] = doc[\textcolor{stringliteral}{"mu"}][i].GetDouble();
86     \}
87 
88     \textcolor{keywordflow}{if} (!doc.HasMember(\textcolor{stringliteral}{"seed"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"seed\(\backslash\)" is not specified in "}+
      filename);
89     \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"seed"}].IsInt()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"seed\(\backslash\)" is not an integer in "}+
      filename);
90     \hyperlink{global_8h_a3f4e4ea24d5a5c66feae55d1f329c884}{RNG\_SEED} = doc[\textcolor{stringliteral}{"seed"}].GetInt();
91 
92     \textcolor{keywordflow}{if} (!doc.HasMember(\textcolor{stringliteral}{"max\_N"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"max\_N\(\backslash\)" is not specified in "}+
      filename);
93     \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"max\_N"}].IsArray()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"max\_N\(\backslash\)" is not an array in "}+
      filename);
94     \textcolor{keywordflow}{if} (doc[\textcolor{stringliteral}{"max\_N"}].Size() != doc[\textcolor{stringliteral}{"num\_species"}].GetInt()) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"max\_N\(\backslash\)" is not specified for each species in "}+filename);
95     std::vector < int > sysMax (doc[\textcolor{stringliteral}{"max\_N"}].Size(), 0);
96     \textcolor{keywordflow}{for} (rapidjson::SizeType i = 0; i < doc[\textcolor{stringliteral}{"max\_N"}].Size(); ++i) \{
97         \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"max\_N"}][i].IsInt()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"max\_N\(\backslash\)" of species "}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{" is not an integer in "}+filename);
98         sysMax[i] = doc[\textcolor{stringliteral}{"max\_N"}][i].GetInt();
99     \}
100 
101     \textcolor{keywordflow}{if} (!doc.HasMember(\textcolor{stringliteral}{"min\_N"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"min\_N\(\backslash\)" is not specified in "}+
      filename);
102     \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"min\_N"}].IsArray()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"min\_N\(\backslash\)" is not an array in "}+
      filename);
103     \textcolor{keywordflow}{if} (doc[\textcolor{stringliteral}{"min\_N"}].Size() != doc[\textcolor{stringliteral}{"num\_species"}].GetInt()) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"min\_N\(\backslash\)" is not specified for each species in "}+filename);
104     std::vector < int > sysMin (doc[\textcolor{stringliteral}{"min\_N"}].Size(), 0);
105     \textcolor{keywordflow}{for} (rapidjson::SizeType i = 0; i < doc[\textcolor{stringliteral}{"min\_N"}].Size(); ++i) \{
106         \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"min\_N"}][i].IsInt()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"min\_N\(\backslash\)" of species "}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{" is not an integer in "}+filename);
107         sysMin[i] = doc[\textcolor{stringliteral}{"min\_N"}][i].GetInt();
108     \}
109 
110     \textcolor{keywordtype}{int} Mtot = 1;
111     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"num\_expanded\_states"})) \{
112         \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"num\_expanded\_states"}].IsInt()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"
      num\_expanded\_states\(\backslash\)" is not an integer in "}+filename);
113         Mtot = doc[\textcolor{stringliteral}{"num\_expanded\_states"}].GetInt();
114     \}
115 
116     \hyperlink{classsim_system}{simSystem} sys (doc[\textcolor{stringliteral}{"num\_species"}].GetInt(), doc[\textcolor{stringliteral}{"beta"}].GetDouble(), sysBox, sysMu, sysMax, 
      sysMin, Mtot, duh, maxOrder);
117     \textcolor{keywordflow}{if} (useKe) \{
118         sys.toggleKE();
119         \textcolor{keywordflow}{if} (sys.addKECorrection() == \textcolor{keyword}{false}) \{
120             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Unable to set KE flag"});
121         \}
122     \}
123 
124     std::vector < int > sysWindow;
125     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"window"})) \{
126         \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"window"}].IsArray()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"window\(\backslash\)" is not an array in "}
      +filename);
127         \textcolor{keywordflow}{if} (doc[\textcolor{stringliteral}{"window"}].Size() != 2) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"window\(\backslash\)" should have 2
       entries (min,max) in "}+filename);
128         sysWindow.resize(2, 0);
129         \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"window"}][0].IsInt()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"window\(\backslash\)" min is not an
       integer in "}+filename);
130         \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"window"}][1].IsInt()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"window\(\backslash\)" max is not an
       integer in "}+filename);
131         sysWindow[0] = doc[\textcolor{stringliteral}{"window"}][0].GetInt();
132         sysWindow[1] = doc[\textcolor{stringliteral}{"window"}][1].GetInt();
133     \}
134 
135     \textcolor{keywordflow}{if} (sysWindow.begin() != sysWindow.end()) \{
136         sys.setTotNBounds(sysWindow);
137     \}
138 
139     \textcolor{keywordflow}{if} (!doc.HasMember(\textcolor{stringliteral}{"tmmc\_sweep\_size"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"tmmc\_sweep\_size\(\backslash\)" is not
       specified in "}+filename);
140     \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"tmmc\_sweep\_size"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"tmmc\_sweep\_size\(\backslash\)" is
       not a number in "}+filename);
141     \textcolor{keywordtype}{double} tmpT = doc[\textcolor{stringliteral}{"tmmc\_sweep\_size"}].GetDouble(); \textcolor{comment}{// Possibly in scientific notation}
142     sys.tmmcSweepSize = tmpT; \textcolor{comment}{// Convert}
143 
144     \textcolor{keywordflow}{if} (!doc.HasMember(\textcolor{stringliteral}{"total\_tmmc\_sweeps"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"total\_tmmc\_sweeps\(\backslash\)" is
       not specified in "}+filename);
145     \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"total\_tmmc\_sweeps"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"total\_tmmc\_sweeps\(\backslash\)"
       is not a number in "}+filename);
146     \textcolor{keywordtype}{double} tmpS = doc[\textcolor{stringliteral}{"total\_tmmc\_sweeps"}].GetDouble(); \textcolor{comment}{// Possibly in scientific notation}
147     sys.totalTMMCSweeps = tmpS; \textcolor{comment}{// Convert}
148 
149     \textcolor{keywordflow}{if} (!doc.HasMember(\textcolor{stringliteral}{"wala\_sweep\_size"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"wala\_sweep\_size\(\backslash\)" is not
       specified in "}+filename);
150     \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"wala\_sweep\_size"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"wala\_sweep\_size\(\backslash\)" is
       not a number in "}+filename);
151     \textcolor{keywordtype}{double} tmpW = doc[\textcolor{stringliteral}{"wala\_sweep\_size"}].GetDouble(); \textcolor{comment}{// Possibly in scientific notation}
152     sys.wlSweepSize = tmpW; \textcolor{comment}{// Convert}
153 
154     \textcolor{keywordflow}{if} (!doc.HasMember(\textcolor{stringliteral}{"wala\_g"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"wala\_g\(\backslash\)" is not specified in "}+
      filename);
155     \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"wala\_g"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"wala\_g\(\backslash\)" is not a number in "}+
      filename);
156     sys.wala\_g = doc[\textcolor{stringliteral}{"wala\_g"}].GetDouble();
157 
158     \textcolor{keywordflow}{if} (!doc.HasMember(\textcolor{stringliteral}{"wala\_s"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"wala\_s\(\backslash\)" is not specified in "}+
      filename);
159     \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"wala\_s"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"wala\_s\(\backslash\)" is not a number in "}+
      filename);
160     sys.wala\_s = doc[\textcolor{stringliteral}{"wala\_s"}].GetDouble();
161 
162     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"lnF\_start"})) \{
163         \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"lnF\_start"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"lnF\_start\(\backslash\)" is not a
       number in "}+filename);
164         sys.lnF\_start = doc[\textcolor{stringliteral}{"lnF\_start"}].GetDouble(); \textcolor{comment}{// Bounds are checked later}
165     \}
166 
167     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"lnF\_end"})) \{
168         \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"lnF\_end"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"lnF\_end\(\backslash\)" is not a number
       in "}+filename);
169         sys.lnF\_end = doc[\textcolor{stringliteral}{"lnF\_end"}].GetDouble();
170         \textcolor{keywordflow}{if} (sys.lnF\_end >= 1.0) \{
171             \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Terminal lnF factor for Wang-Landau must be < 1"});
172             exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
173         \}
174         \textcolor{keywordflow}{if} (sys.lnF\_end <= 0.0) \{
175             \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Terminal lnF factor for Wang-Landau must be a positive number"});
176             exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
177         \}
178     \}
179     \textcolor{keywordflow}{if} (sys.lnF\_end >= sys.lnF\_start) \{
180         \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"lnF\_end must be < lnF\_start for Wang-Landau to proceed forward"});
181         exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
182     \}
183 
184     sys.restartFromWALA = \textcolor{keyword}{false};
185     sys.restartFromWALAFile = \textcolor{stringliteral}{""};
186     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"restart\_from\_wala\_lnPI"})) \{
187         \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"restart\_from\_wala\_lnPI"}].IsString()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"
      restart\_from\_wala\_lnPI\(\backslash\)" filename is not a string in "}+filename);
188         sys.restartFromWALAFile = doc[\textcolor{stringliteral}{"restart\_from\_wala\_lnPI"}].GetString();
189         \textcolor{keywordflow}{if} (sys.restartFromWALAFile != \textcolor{stringliteral}{""}) \{
190             sys.restartFromWALA = \textcolor{keyword}{true};
191         \}
192     \}
193 
194     \textcolor{comment}{// Restarting from TMMC overrides WL by skipping that portion altogether}
195     sys.restartFromTMMC = \textcolor{keyword}{false};
196     sys.restartFromTMMCFile = \textcolor{stringliteral}{""};
197     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"restart\_from\_tmmc\_C"})) \{
198         \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"restart\_from\_tmmc\_C"}].IsString()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"
      restart\_from\_tmmc\_C\(\backslash\)" filename is not a string in "}+filename);
199         sys.restartFromTMMCFile = doc[\textcolor{stringliteral}{"restart\_from\_tmmc\_C"}].GetString();
200         \textcolor{keywordflow}{if} (sys.restartFromTMMCFile != \textcolor{stringliteral}{""}) \{
201             sys.restartFromTMMC = \textcolor{keyword}{true};
202         \}
203     \}
204 
205     \textcolor{comment}{// Number of times the TMMC C matrix has to be traversed during the WALA --> TMMC crossover}
206     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"num\_crossover\_visits"})) \{
207         \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"num\_crossover\_visits"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"
      num\_crossover\_visits\(\backslash\)" is not a number in "}+filename);
208         sys.nCrossoverVisits = doc[\textcolor{stringliteral}{"num\_crossover\_visits"}].GetDouble(); \textcolor{comment}{// convert}
209         \textcolor{keywordflow}{if} (sys.nCrossoverVisits < 1) \{
210             \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Must allow the collection matrix to be traversed at least once in the crossover
       from Wang-Landau to TMMC"});
211             exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
212         \}
213     \}
214 
215     \hyperlink{input_8cpp_a4541b66a5d6bfc7c4d90c3cf5c58ba27}{setMoves} (sys, doc, usedMovesEq, usedMovesPr);
216     \hyperlink{input_8cpp_afcd470506b012754a93b2012b65e3fc4}{setPairPotentials} (sys, doc);
217 
218     \hyperlink{input_8cpp_aa89df4b08049cfd9bdd875d78591ba5b}{checkBounds} (sys);
219     \hyperlink{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}{sendMsg}(\textcolor{stringliteral}{"System from "}+filename+\textcolor{stringliteral}{" passed bounds checks"});
220 
221     \hyperlink{input_8cpp_ab6dc74f7fbe4f517a72a21da3b795dfa}{setBarriers} (sys, doc);
222 
223     \hyperlink{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}{sendMsg}(\textcolor{stringliteral}{"Successfully read valid parameters from "}+filename);
224     \textcolor{keywordflow}{return} sys;
225 \}
\end{DoxyCode}
\hypertarget{input_8cpp_ab6dc74f7fbe4f517a72a21da3b795dfa}{\index{input.\-cpp@{input.\-cpp}!set\-Barriers@{set\-Barriers}}
\index{set\-Barriers@{set\-Barriers}!input.cpp@{input.\-cpp}}
\subsubsection[{set\-Barriers}]{\setlength{\rightskip}{0pt plus 5cm}void set\-Barriers (
\begin{DoxyParamCaption}
\item[{{\bf sim\-System} \&}]{sys, }
\item[{const rapidjson\-::\-Document \&}]{doc}
\end{DoxyParamCaption}
)}}\label{input_8cpp_ab6dc74f7fbe4f517a72a21da3b795dfa}


Initialize the barriers in a system by parsing the input document. 

Clears any existing information and will overwrite with information from doc.

\mbox{[}in, out\mbox{]} sys System to initialize with barriers  \mbox{[}in\mbox{]} doc Input J\-S\-O\-N document 

Definition at line 616 of file input.\-cpp.



References sim\-System\-::box(), sim\-System\-::get\-Total\-M(), sim\-System\-::n\-Species(), send\-Msg(), sim\-System\-::species\-Barriers, and custom\-Exception\-::what().



Referenced by initialize(), and set\-Config().


\begin{DoxyCode}
616                                                                 \{
617     \textcolor{keywordtype}{int} Mtot = sys.\hyperlink{classsim_system_aa4ad1afff101bb530e1590df05035276}{getTotalM}();
618 
619     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"barriers"})) \{
620         \textcolor{comment}{// Clear any existing barriers}
621         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++i) \{
622             sys.\hyperlink{classsim_system_a5ae652ff4519f39c3862abae32a9581b}{speciesBarriers}[i].clearAll();
623         \}
624 
625         \textcolor{comment}{// Iterate over all barriers specified for this species}
626         \textcolor{keywordflow}{for} (rapidjson::Value::ConstMemberIterator itr = doc[\textcolor{stringliteral}{"barriers"}].MemberBegin(); itr != doc[\textcolor{stringliteral}{"
      barriers"}].MemberEnd(); ++itr) \{
627             \textcolor{comment}{// Get barrier type and name}
628             std::string barrName = itr->name.GetString();
629             \textcolor{keywordflow}{if} (!itr->value.IsObject()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Barrier "}+barrName+\textcolor{stringliteral}{" is not
       in a valid json document"});
630             \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"type"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Barrier "}+barrName+\textcolor{stringliteral}{"
       does not specify a type"});
631             \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"type"}].IsString()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Barrier "}+barrName+\textcolor{stringliteral}{"
       type is not a string"});
632             std::string barrType = itr->value[\textcolor{stringliteral}{"type"}].GetString();
633 
634             \textcolor{comment}{// Get the species this barrier interacts with}
635             \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"species"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Barrier "}+barrName
      +\textcolor{stringliteral}{" does not specify a species to interact with"});
636             \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"species"}].IsInt()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Barrier "}+barrName+\textcolor{stringliteral}{"
       species is not an integer"});
637             \textcolor{keyword}{const} \textcolor{keywordtype}{int} species = itr->value[\textcolor{stringliteral}{"species"}].GetInt();
638             \textcolor{keywordflow}{if} (species < 1 || species > sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}()) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Barrier "}+barrName+\textcolor{stringliteral}{" species is not valid for this system"});
639 
640             \textcolor{comment}{// Depending on barrier type, read parameters and initialize}
641             \textcolor{keywordflow}{if} (barrType == \textcolor{stringliteral}{"hard\_wall\_z"}) \{
642                 \textcolor{comment}{// Expects lb, ub, sigma}
643                 \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"lb"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (barrName+\textcolor{stringliteral}{" does not
       contain \(\backslash\)"lb\(\backslash\)" parameter"});
644                 \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"ub"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (barrName+\textcolor{stringliteral}{" does not
       contain \(\backslash\)"ub\(\backslash\)" parameter"});
645                 \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"sigma"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (barrName+\textcolor{stringliteral}{" does
       not contain \(\backslash\)"sigma\(\backslash\)" parameter"});
646 
647                 \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"lb"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"\(\backslash\)"lb\(\backslash\)" for "}+
      barrName+\textcolor{stringliteral}{" is not a number"});
648                 \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"ub"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"\(\backslash\)"ub\(\backslash\)" for "}+
      barrName+\textcolor{stringliteral}{" is not a number"});
649                 \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"sigma"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"\(\backslash\)"sigma\(\backslash\)" for "}
      +barrName+\textcolor{stringliteral}{" is not a number"});
650 
651                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} lbBarr = itr->value[\textcolor{stringliteral}{"lb"}].GetDouble();
652                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} ubBarr = itr->value[\textcolor{stringliteral}{"ub"}].GetDouble();
653                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} sigmaBarr = itr->value[\textcolor{stringliteral}{"sigma"}].GetDouble();
654 
655                 \textcolor{keywordflow}{try} \{
656                     sys.\hyperlink{classsim_system_a5ae652ff4519f39c3862abae32a9581b}{speciesBarriers}[species-1].addHardWallZ (lbBarr, ubBarr, sigmaBarr, 
      Mtot);
657                 \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
658                     \textcolor{keyword}{const} std::string msg = ce.\hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}();
659                     \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Cannot initialize barrier "}+barrName+\textcolor{stringliteral}{" : "}+msg);
660                 \}
661             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (barrType == \textcolor{stringliteral}{"square\_well\_wall\_z"}) \{
662                 \textcolor{comment}{// Expect lb, ub, sigma, range, epsilon}
663                 \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"lb"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (barrName+\textcolor{stringliteral}{" does not
       contain \(\backslash\)"lb\(\backslash\)" parameter"});
664                 \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"ub"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (barrName+\textcolor{stringliteral}{" does not
       contain \(\backslash\)"ub\(\backslash\)" parameter"});
665                 \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"sigma"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (barrName+\textcolor{stringliteral}{" does
       not contain \(\backslash\)"sigma\(\backslash\)" parameter"});
666                 \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"range"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (barrName+\textcolor{stringliteral}{" does
       not contain \(\backslash\)"range\(\backslash\)" parameter"});
667                 \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"epsilon"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (barrName+\textcolor{stringliteral}{" does
       not contain \(\backslash\)"epsilon\(\backslash\)" parameter"});
668 
669                 \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"lb"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"\(\backslash\)"lb\(\backslash\)" for "}+
      barrName+\textcolor{stringliteral}{" is not a number"});
670                 \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"ub"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"\(\backslash\)"ub\(\backslash\)" for "}+
      barrName+\textcolor{stringliteral}{" is not a number"});
671                 \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"sigma"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"\(\backslash\)"sigma\(\backslash\)" for "}
      +barrName+\textcolor{stringliteral}{" is not a number"});
672                 \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"range"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"\(\backslash\)"range\(\backslash\)" for "}
      +barrName+\textcolor{stringliteral}{" is not a number"});
673                 \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"epsilon"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"\(\backslash\)"epsilon\(\backslash\)"
       for "}+barrName+\textcolor{stringliteral}{" is not a number"});
674 
675                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} lbBarr = itr->value[\textcolor{stringliteral}{"lb"}].GetDouble();
676                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} ubBarr = itr->value[\textcolor{stringliteral}{"ub"}].GetDouble();
677                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} sigmaBarr = itr->value[\textcolor{stringliteral}{"sigma"}].GetDouble();
678                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} rangeBarr = itr->value[\textcolor{stringliteral}{"range"}].GetDouble();
679                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} epsBarr = itr->value[\textcolor{stringliteral}{"epsilon"}].GetDouble();
680 
681                 \textcolor{keywordflow}{try} \{
682                     sys.\hyperlink{classsim_system_a5ae652ff4519f39c3862abae32a9581b}{speciesBarriers}[species-1].addSquareWellWallZ (lbBarr, ubBarr, 
      sigmaBarr, rangeBarr, epsBarr, Mtot);
683                 \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
684                     \textcolor{keyword}{const} std::string msg = ce.\hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}();
685                     \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Cannot initialize barrier "}+barrName+\textcolor{stringliteral}{" : "}+msg);
686                 \}
687             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (barrType == \textcolor{stringliteral}{"cylinder\_z"}) \{
688                 \textcolor{comment}{// Expect x, y, radius, width, sigma, epsilon}
689                 \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"x"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (barrName+\textcolor{stringliteral}{" does not
       contain \(\backslash\)"x\(\backslash\)" parameter"});
690                 \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"y"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (barrName+\textcolor{stringliteral}{" does not
       contain \(\backslash\)"y\(\backslash\)" parameter"});
691                 \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"radius"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (barrName+\textcolor{stringliteral}{" does
       not contain \(\backslash\)"radius\(\backslash\)" parameter"});
692                 \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"width"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (barrName+\textcolor{stringliteral}{" does
       not contain \(\backslash\)"width\(\backslash\)" parameter"});
693                 \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"sigma"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (barrName+\textcolor{stringliteral}{" does
       not contain \(\backslash\)"sigma\(\backslash\)" parameter"});
694                 \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"epsilon"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (barrName+\textcolor{stringliteral}{" does
       not contain \(\backslash\)"epsilon\(\backslash\)" parameter"});
695 
696                 \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"x"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"\(\backslash\)"x\(\backslash\)" for "}+
      barrName+\textcolor{stringliteral}{" is not a number"});
697                 \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"y"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"\(\backslash\)"y\(\backslash\)" for "}+
      barrName+\textcolor{stringliteral}{" is not a number"});
698                 \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"radius"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"\(\backslash\)"radius\(\backslash\)" for
       "}+barrName+\textcolor{stringliteral}{" is not a number"});
699                 \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"width"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"\(\backslash\)"width\(\backslash\)" for "}
      +barrName+\textcolor{stringliteral}{" is not a number"});
700                 \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"sigma"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"\(\backslash\)"sigma\(\backslash\)" for "}
      +barrName+\textcolor{stringliteral}{" is not a number"});
701                 \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"epsilon"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"\(\backslash\)"epsilon\(\backslash\)"
       for "}+barrName+\textcolor{stringliteral}{" is not a number"});
702 
703                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} xBarr = itr->value[\textcolor{stringliteral}{"x"}].GetDouble();
704                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} yBarr = itr->value[\textcolor{stringliteral}{"y"}].GetDouble();
705                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} radiusBarr = itr->value[\textcolor{stringliteral}{"radius"}].GetDouble();
706                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} widthBarr = itr->value[\textcolor{stringliteral}{"width"}].GetDouble();
707                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} sigmaBarr = itr->value[\textcolor{stringliteral}{"sigma"}].GetDouble();
708                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} epsBarr = itr->value[\textcolor{stringliteral}{"epsilon"}].GetDouble();
709 
710                 \textcolor{keywordflow}{try} \{
711                     sys.\hyperlink{classsim_system_a5ae652ff4519f39c3862abae32a9581b}{speciesBarriers}[species-1].addCylinderZ (xBarr, yBarr, radiusBarr, 
      widthBarr, sigmaBarr, epsBarr, Mtot);
712                 \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
713                     \textcolor{keyword}{const} std::string msg = ce.\hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}();
714                     \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Cannot initialize barrier "}+barrName+\textcolor{stringliteral}{" : "}+msg);
715                 \}
716             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (barrType == \textcolor{stringliteral}{"right\_triangle\_xz"}) \{
717                 \textcolor{comment}{// Expect parameters width, theta, lamW, epsilon, sigma, sep, offset, zbase, top}
718                 \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"width"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (barrName+\textcolor{stringliteral}{" does
       not contain \(\backslash\)"width\(\backslash\)" parameter"});
719                 \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"theta"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (barrName+\textcolor{stringliteral}{" does
       not contain \(\backslash\)"theta\(\backslash\)" parameter"});
720                 \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"lamW"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (barrName+\textcolor{stringliteral}{" does
       not contain \(\backslash\)"lamW\(\backslash\)" parameter"});
721                 \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"epsilon"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (barrName+\textcolor{stringliteral}{" does
       not contain \(\backslash\)"epsilon\(\backslash\)" parameter"});
722                 \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"sigma"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (barrName+\textcolor{stringliteral}{" does
       not contain \(\backslash\)"sigma\(\backslash\)" parameter"});
723                 \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"sep"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (barrName+\textcolor{stringliteral}{" does not
       contain \(\backslash\)"sep\(\backslash\)" parameter"});
724                 \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"offset"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (barrName+\textcolor{stringliteral}{" does
       not contain \(\backslash\)"offset\(\backslash\)" parameter"});
725                 \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"zbase"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (barrName+\textcolor{stringliteral}{" does
       not contain \(\backslash\)"zbase\(\backslash\)" parameter"});
726                 \textcolor{keywordflow}{if} (!itr->value.HasMember(\textcolor{stringliteral}{"top"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (barrName+\textcolor{stringliteral}{" does not
       contain \(\backslash\)"top\(\backslash\)" parameter"});
727 
728                 \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"width"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"\(\backslash\)"width\(\backslash\)" for "}
      +barrName+\textcolor{stringliteral}{" is not a number"});
729                 \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"theta"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"\(\backslash\)"theta\(\backslash\)" for "}
      +barrName+\textcolor{stringliteral}{" is not a number"});
730                 \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"lamW"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"\(\backslash\)"lamW\(\backslash\)" for "}+
      barrName+\textcolor{stringliteral}{" is not a number"});
731                 \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"epsilon"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"\(\backslash\)"epsilon\(\backslash\)"
       for "}+barrName+\textcolor{stringliteral}{" is not a number"});
732                 \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"sigma"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"\(\backslash\)"sigma\(\backslash\)" for "}
      +barrName+\textcolor{stringliteral}{" is not a number"});
733                 \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"sep"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"\(\backslash\)"sep\(\backslash\)" for "}+
      barrName+\textcolor{stringliteral}{" is not a number"});
734                 \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"offset"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"\(\backslash\)"offset\(\backslash\)" for
       "}+barrName+\textcolor{stringliteral}{" is not a number"});
735                 \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"zbase"}].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"\(\backslash\)"zbase\(\backslash\)" for "}
      +barrName+\textcolor{stringliteral}{" is not a number"});
736                 \textcolor{keywordflow}{if} (!itr->value[\textcolor{stringliteral}{"top"}].IsBool()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"\(\backslash\)"top\(\backslash\)" for "}+
      barrName+\textcolor{stringliteral}{" is not a boolean"});
737 
738                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} widthBarr = itr->value[\textcolor{stringliteral}{"width"}].GetDouble();
739                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} thetaBarr = itr->value[\textcolor{stringliteral}{"theta"}].GetDouble();
740                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} lamwBarr = itr->value[\textcolor{stringliteral}{"lamW"}].GetDouble();
741                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} epsBarr = itr->value[\textcolor{stringliteral}{"epsilon"}].GetDouble();
742                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} sigmaBarr = itr->value[\textcolor{stringliteral}{"sigma"}].GetDouble();
743                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} sepBarr = itr->value[\textcolor{stringliteral}{"sep"}].GetDouble();
744                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} offsetBarr = itr->value[\textcolor{stringliteral}{"offset"}].GetDouble();
745                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} zbaseBarr = itr->value[\textcolor{stringliteral}{"zbase"}].GetDouble();
746                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} topBarr = itr->value[\textcolor{stringliteral}{"top"}].GetBool();
747 
748                 \textcolor{keywordflow}{try} \{
749                     sys.\hyperlink{classsim_system_a5ae652ff4519f39c3862abae32a9581b}{speciesBarriers}[species-1].addRightTriangleXZ (widthBarr, thetaBarr,
       lamwBarr, epsBarr, sigmaBarr, sepBarr, offsetBarr, sys.\hyperlink{classsim_system_a8bff9dfb95b1b09a0fab2c1c485ade07}{box}(), zbaseBarr, topBarr, Mtot);
750                 \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
751                     \textcolor{keyword}{const} std::string msg = ce.\hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}();
752                     \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Cannot initialize barrier "}+barrName+\textcolor{stringliteral}{" : "}+msg);
753                 \}
754             \} \textcolor{keywordflow}{else} \{
755                 \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Unrecognized barrier type "}+barrType+\textcolor{stringliteral}{" from barrier 
      "}+barrName);
756             \}
757         \}
758         \hyperlink{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}{sendMsg}(\textcolor{stringliteral}{"Initialized barriers"});
759     \} \textcolor{keywordflow}{else} \{
760         \hyperlink{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}{sendMsg}(\textcolor{stringliteral}{"No barriers to initialize"});
761     \}
762 \}
\end{DoxyCode}
\hypertarget{input_8cpp_abb58279d5b9992aef3dcd304a3963954}{\index{input.\-cpp@{input.\-cpp}!set\-Config@{set\-Config}}
\index{set\-Config@{set\-Config}!input.cpp@{input.\-cpp}}
\subsubsection[{set\-Config}]{\setlength{\rightskip}{0pt plus 5cm}void set\-Config (
\begin{DoxyParamCaption}
\item[{{\bf sim\-System} \&}]{sys, }
\item[{const std\-::string}]{filename}
\end{DoxyParamCaption}
)}}\label{input_8cpp_abb58279d5b9992aef3dcd304a3963954}


Setup a system's initial configuration as necessary. 

Will empty a system if there are currently any particles present and overwrite with new information.
\begin{DoxyEnumerate}
\item If \char`\"{}restart\-\_\-file\char`\"{} in input json file, read initial config from there.
\item In not, randomly generate initial configuration.
\end{DoxyEnumerate}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em sys} & System to initialize \\
\hline
\mbox{\tt in}  & {\em filename} & Input J\-S\-O\-N filename \\
\hline
\end{DoxyParams}


Definition at line 457 of file input.\-cpp.



References moves\-::add\-Insert(), sim\-System\-::add\-K\-E\-Correction(), sim\-System\-::box(), sim\-System\-::get\-Max\-Order(), sim\-System\-::get\-Total\-M(), sim\-System\-::n\-Species(), sim\-System\-::num\-Species, num\-To\-Str(), parse\-Json(), sim\-System\-::print\-Snapshot(), sim\-System\-::read\-Config(), send\-Err(), send\-Msg(), set\-Barriers(), set\-Pair\-Potentials(), S\-Y\-S\-\_\-\-F\-A\-I\-L\-U\-R\-E, sim\-System\-::toggle\-K\-E(), sim\-System\-::tot\-N\-Min(), and custom\-Exception\-::what().


\begin{DoxyCode}
457                                                           \{
458     rapidjson::Document doc;
459     \hyperlink{utilities_8cpp_a3f494918ff3c252de4914c9905be04e7}{parseJson} (filename, doc);
460 
461     \textcolor{comment}{// Get a few things from file not easily accessible from system object}
462     std::string restart\_file = \textcolor{stringliteral}{""};
463     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"restart\_file"})) \{
464         restart\_file = doc[\textcolor{stringliteral}{"restart\_file"}].GetString();
465     \}
466 
467     std::vector < int > sysMax (doc[\textcolor{stringliteral}{"max\_N"}].Size(), 0);
468     \textcolor{keywordflow}{for} (rapidjson::SizeType i = 0; i < doc[\textcolor{stringliteral}{"max\_N"}].Size(); ++i) \{
469         sysMax[i] = doc[\textcolor{stringliteral}{"max\_N"}][i].GetInt();
470     \}
471     std::vector < int > sysMin (doc[\textcolor{stringliteral}{"min\_N"}].Size(), 0);
472     \textcolor{keywordflow}{for} (rapidjson::SizeType i = 0; i < doc[\textcolor{stringliteral}{"min\_N"}].Size(); ++i) \{
473         sysMin[i] = doc[\textcolor{stringliteral}{"min\_N"}][i].GetInt();
474     \}
475 
476     \textcolor{comment}{// Rest from existing system}
477     \textcolor{keywordtype}{int} Mtot = sys.\hyperlink{classsim_system_aa4ad1afff101bb530e1590df05035276}{getTotalM}();
478     \textcolor{keywordtype}{int} maxOrder = sys.\hyperlink{classsim_system_afe08187d318113c33bda890c69570c36}{getMaxOrder}();
479     \textcolor{keywordtype}{bool} useKe = sys.\hyperlink{classsim_system_a09c4ea670168c9f1d549d2a5120eb13c}{addKECorrection}();
480     \textcolor{keywordtype}{double} duh = 10.0;
481     std::vector < double > sysBox = sys.\hyperlink{classsim_system_a8bff9dfb95b1b09a0fab2c1c485ade07}{box}();
482 
483     \textcolor{comment}{// Read from restart file if specified}
484     \textcolor{keywordflow}{if} (restart\_file != \textcolor{stringliteral}{""}) \{
485         \textcolor{keywordflow}{try} \{
486             sys.\hyperlink{classsim_system_a3161d95bbb800d5d95a732ac5fc32b95}{readConfig}(restart\_file);
487         \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
488             \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(ce.\hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}());
489         \}
490     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (restart\_file == \textcolor{stringliteral}{""} && sys.\hyperlink{classsim_system_af10842e0eaa638373b8717c87b47e6bc}{totNMin}() > 0) \{
491         \hyperlink{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}{sendMsg}(\textcolor{stringliteral}{"Automatically generating the initial configuration"});
492 
493         \textcolor{comment}{// Have to generate initial configuration manually - start with mu = INF}
494         std::vector < double > initMu (doc[\textcolor{stringliteral}{"num\_species"}].GetInt(), 1.0e2);
495 
496         \hyperlink{classsim_system}{simSystem} initSys (doc[\textcolor{stringliteral}{"num\_species"}].GetInt(), doc[\textcolor{stringliteral}{"beta"}].GetDouble()/100.0, sysBox, 
      initMu, sysMax, sysMin, Mtot, duh, maxOrder); \textcolor{comment}{// beta =  1/T, so low beta to have high T}
497         \textcolor{keywordflow}{if} (useKe) \{
498             initSys.toggleKE();
499             \textcolor{keywordflow}{if} (initSys.addKECorrection() == \textcolor{keyword}{false}) \{
500                 \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Unable to set KE flag"});
501             \}
502         \}
503 
504         \textcolor{comment}{// Add the same potentials}
505         \hyperlink{input_8cpp_afcd470506b012754a93b2012b65e3fc4}{setPairPotentials} (initSys, doc);
506         \hyperlink{input_8cpp_ab6dc74f7fbe4f517a72a21da3b795dfa}{setBarriers} (initSys, doc);
507 
508         std::vector < int > initialization\_order (sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(), 0), check\_init (sys.
      \hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(), 0);
509         std::vector < double > init\_frac (sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(), 1.0);
510         \textcolor{keywordtype}{double} sum = 0.0;
511         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++i) \{
512             initialization\_order[i] = i;
513             \textcolor{keywordflow}{if} (i > 0) init\_frac[i] = 0.0;
514             sum += init\_frac[i];
515         \}
516         \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"init\_order"})) \{
517             \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"init\_order"}].IsArray()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"init\_order\(\backslash\)" is not
       an array in "}+filename);
518             \textcolor{keywordflow}{if} (doc[\textcolor{stringliteral}{"init\_order"}].Size() != doc[\textcolor{stringliteral}{"num\_species"}].GetInt()) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"init\_order\(\backslash\)" not specified for each species in "}+filename);
519 
520             \textcolor{keywordflow}{for} (rapidjson::SizeType i = 0; i < doc[\textcolor{stringliteral}{"init\_order"}].Size(); ++i) \{
521                 \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"init\_order"}][i].IsInt()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"init\_order\(\backslash\)" is
       not an integer for species "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{" in "}+filename);
522                 initialization\_order[i] = doc[\textcolor{stringliteral}{"init\_order"}][i].GetInt();
523                 \textcolor{keywordflow}{if} (initialization\_order[i] < 0 || initialization\_order[i] >= sys.
      \hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}()) \{
524                     \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Order of initialization goes out of bounds, should include 0 <= i <
       nSpec"});
525                     exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
526                 \}
527                 \textcolor{keywordflow}{if} (check\_init[initialization\_order[i]] != 0) \{
528                     \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Order of initialization repeats itself"});
529                     exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
530                 \} \textcolor{keywordflow}{else} \{
531                     check\_init[initialization\_order[i]] = 1;
532                 \}
533             \}
534         \}
535         \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"init\_frac"})) \{
536             \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"init\_frac"}].IsArray()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"init\_frac\(\backslash\)" is not an
       array in "}+filename);
537             \textcolor{keywordflow}{if} (doc[\textcolor{stringliteral}{"init\_frac"}].Size() != doc[\textcolor{stringliteral}{"num\_species"}].GetInt()) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"init\_frac\(\backslash\)" not specified for each species in "}+filename);
538 
539             sum = 0.0;
540             \textcolor{keywordflow}{for} (rapidjson::SizeType i = 0; i < doc[\textcolor{stringliteral}{"init\_frac"}].Size(); ++i) \{
541                 \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"init\_frac"}][i].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"\(\backslash\)"init\_frac\(\backslash\)" is
       not a number for species "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{" in "}+filename);
542                 init\_frac[i] = doc[\textcolor{stringliteral}{"init\_frac"}][i].GetDouble();
543                 \textcolor{keywordflow}{if} (init\_frac[i] < 0 || init\_frac[i] >= 1.0) \{
544                     \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Initialization fraction out of bounds"});
545                     exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
546                 \}
547                 sum += init\_frac[i];
548             \}
549         \}
550         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++i) \{
551             init\_frac[i] /= sum;
552         \}
553 
554         \textcolor{comment}{// Iteratively add each individual species, assume we want an equimolar mixture to start from}
555         \textcolor{keywordtype}{int} added = 0;
556         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} idx = 0; idx < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++idx) \{
557             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = initialization\_order[idx];
558             \hyperlink{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}{sendMsg}(\textcolor{stringliteral}{"Initializing species "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i)+\textcolor{stringliteral}{" configurations"});
559 
560             \textcolor{comment}{// Insert this species i}
561             \hyperlink{classmoves}{moves} initMove (initSys.getTotalM());
562             initMove.\hyperlink{classmoves_ab4583b3075f51cce55c3aeb84a58430d}{addInsert}(i, 1.0);
563 
564             \textcolor{comment}{// Also add translation moves for all species present}
565             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j <= idx; ++j) \{
566                 \hyperlink{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}{sendMsg}(\textcolor{stringliteral}{"Added translation moves for initialization of species "}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(initialization\_order[j]));
567                 initMove.addTranslate(initialization\_order[j], 2.0, 1.0, initSys.box());
568             \}
569 
570             \textcolor{comment}{// Now do simuation until within proper range}
571             \textcolor{keywordtype}{int} targetNum = sys.\hyperlink{classsim_system_af10842e0eaa638373b8717c87b47e6bc}{totNMin}()*init\_frac[idx];
572             \textcolor{keywordflow}{if} (idx == sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}() - 1) \{
573                 \textcolor{comment}{// To account for integer rounding}
574                 targetNum = sys.\hyperlink{classsim_system_af10842e0eaa638373b8717c87b47e6bc}{totNMin}() - added;
575             \}
576             added += targetNum;
577 
578             \hyperlink{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}{sendMsg}(\textcolor{stringliteral}{"Target number = "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(targetNum)+\textcolor{stringliteral}{" for species "}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1));
579             \textcolor{keywordtype}{int} tmpCounter = 0, statusPrint = 10e6;
580             \textcolor{keywordflow}{while} (initSys.numSpecies[i] < targetNum) \{
581                 \textcolor{keywordflow}{try} \{
582                     initMove.makeMove(initSys);
583                 \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
584                     std::string msg = ce.\hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}();
585                     \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Failed to create an initial configuration : "}+msg);
586                     exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
587                 \}
588                 tmpCounter++;
589                 \textcolor{keywordflow}{if} (tmpCounter%statusPrint == 0) \{
590                     tmpCounter = 0;
591                     \hyperlink{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}{sendMsg}(\textcolor{stringliteral}{"Grew "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(initSys.numSpecies[i])+\textcolor{stringliteral}{" atoms of type "}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i)+\textcolor{stringliteral}{" so far"});
592                 \}
593             \}
594         \}
595 
596         \textcolor{comment}{// Print snapshot from Reading initial configuration}
597         initSys.printSnapshot(\textcolor{stringliteral}{"auto-init.xyz"}, \textcolor{stringliteral}{"auto-generated initial configuration"});
598 
599         \textcolor{comment}{// Read into sys}
600         \textcolor{keywordflow}{try} \{
601             sys.\hyperlink{classsim_system_a3161d95bbb800d5d95a732ac5fc32b95}{readConfig}(\textcolor{stringliteral}{"auto-init.xyz"});
602         \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
603             std::string msg = ce.\hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}();
604             \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Failed to read auto-generated initialization file : "}+msg);
605         \}
606     \}
607 \}
\end{DoxyCode}
\hypertarget{input_8cpp_a4541b66a5d6bfc7c4d90c3cf5c58ba27}{\index{input.\-cpp@{input.\-cpp}!set\-Moves@{set\-Moves}}
\index{set\-Moves@{set\-Moves}!input.cpp@{input.\-cpp}}
\subsubsection[{set\-Moves}]{\setlength{\rightskip}{0pt plus 5cm}void set\-Moves (
\begin{DoxyParamCaption}
\item[{{\bf sim\-System} \&}]{sys, }
\item[{const rapidjson\-::\-Document \&}]{doc, }
\item[{{\bf moves} $\ast$}]{used\-Moves\-Eq, }
\item[{{\bf moves} $\ast$}]{used\-Moves\-Pr}
\end{DoxyParamCaption}
)}}\label{input_8cpp_a4541b66a5d6bfc7c4d90c3cf5c58ba27}


Assign the Monte Carlo moves based on the J\-S\-O\-N input file. 

Uses same information to specify \char`\"{}production\char`\"{} and \char`\"{}equilibration\char`\"{} phases. Clears any existing information and will overwrite with information from doc.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em sys} & Simulation system that has been initialized \\
\hline
\mbox{\tt in}  & {\em doc} & J\-S\-O\-N document corresponding to input file  \mbox{[}in\mbox{]} used\-Moves\-Eq Pointer to move object that will be used during \char`\"{}equilibration\char`\"{} (W\-L + Crossover)  \mbox{[}in\mbox{]} used\-Moves\-Pr Pointer to move object that will be used during \char`\"{}production\char`\"{} (T\-M\-M\-C) \\
\hline
\end{DoxyParams}


Definition at line 236 of file input.\-cpp.



References moves\-::add\-Delete(), moves\-::add\-Insert(), moves\-::add\-Swap(), moves\-::add\-Translate(), sim\-System\-::box(), moves\-::clear\-All(), sim\-System\-::get\-Total\-M(), sim\-System\-::n\-Species(), num\-To\-Str(), send\-Err(), moves\-::set\-M(), and S\-Y\-S\-\_\-\-F\-A\-I\-L\-U\-R\-E.



Referenced by initialize().


\begin{DoxyCode}
236                                                                                                      \{
237     usedMovesEq->\hyperlink{classmoves_a3695f6a6d0128e2d0d76702f718accf8}{clearAll}();
238     usedMovesPr->\hyperlink{classmoves_a3695f6a6d0128e2d0d76702f718accf8}{clearAll}();
239 
240     std::vector < double > ref (sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(), 0);
241     std::vector < std::vector < double > > probPrSwap (sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(), ref);
242     std::vector < double > probPrInsDel (sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(), 0), probPrDisp (sys.
      \hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(), 0), maxPrD (sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(), 0);
243 
244     \textcolor{keywordflow}{if} (!doc.HasMember(\textcolor{stringliteral}{"moves"})) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"Input file does not have Monte Carlo
       moves specified"});
245     \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"moves"}].IsObject()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"Input file does not have Monte
       Carlo moves specified as correct JSON document"});
246 
247     \textcolor{comment}{// Insert/Delete moves}
248     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++i) \{
249         std::string dummy = \textcolor{stringliteral}{"ins\_del\_"} + \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1);
250         \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"moves"}].HasMember(dummy.c\_str())) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"Input file does
       not have insert/delete move specified for species "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1));
251         \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"moves"}][dummy.c\_str()].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"Input file does
       not correctly specify insert/delete move probability for species "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1));
252         probPrInsDel[i] = doc[\textcolor{stringliteral}{"moves"}][dummy.c\_str()].GetDouble();
253     \}
254 
255     \textcolor{comment}{// Translation moves}
256     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++i) \{
257         std::string dummy = \textcolor{stringliteral}{"translate\_"} + \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1);
258         \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"moves"}].HasMember(dummy.c\_str())) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"Input file does
       not have translation move specified for species "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1));
259         \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"moves"}][dummy.c\_str()].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"Input file does
       not correctly specify translation move probability for species "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1));
260         probPrDisp[i] = doc[\textcolor{stringliteral}{"moves"}][dummy.c\_str()].GetDouble();
261 
262         dummy = \textcolor{stringliteral}{"max\_translation\_"} + \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1);
263         \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"moves"}].HasMember(dummy.c\_str())) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"Input file does
       not have translation magnitude specified for species "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1));
264         \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"moves"}][dummy.c\_str()].IsNumber()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"Input file does
       not correctly specify translation move magnitude for species "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1));
265         maxPrD[i] = doc[\textcolor{stringliteral}{"moves"}][dummy.c\_str()].GetDouble();
266     \}
267 
268     \textcolor{comment}{// Swap moves}
269     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++i) \{
270         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = i+1; j < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++j) \{
271             std::string name1 = \textcolor{stringliteral}{"swap\_"}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{"\_"}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1);
272             std::string name2 = \textcolor{stringliteral}{"swap\_"}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{"\_"}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1);
273             std::string moveName = \textcolor{stringliteral}{""};
274             \textcolor{keywordtype}{bool} foundIJ = \textcolor{keyword}{false};
275 
276             \textcolor{keywordflow}{if} (doc[\textcolor{stringliteral}{"moves"}].HasMember(name1.c\_str())) \{
277                 moveName = name1;
278                 foundIJ = \textcolor{keyword}{true};
279             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (doc[\textcolor{stringliteral}{"moves"}].HasMember(name2.c\_str()) && !foundIJ) \{
280                 moveName = name2;
281                 foundIJ = \textcolor{keyword}{true};
282             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (doc[\textcolor{stringliteral}{"moves"}].HasMember(name2.c\_str()) && foundIJ) \{
283                 \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Input file doubly specifies production swap move probability for species
       pair ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{", "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{")"});
284                 exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
285             \} \textcolor{keywordflow}{else} \{
286                 \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Input file does not specify production swap move probability for species
       pair ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{", "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{")"});
287                 exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
288             \}
289 
290             \textcolor{keywordflow}{if} (!doc[\textcolor{stringliteral}{"moves"}][moveName.c\_str()].IsNumber()) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"Input file does not correctly specify swap move probability for species
       pair ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{", "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{")"});
291             probPrSwap[i][j] = doc[\textcolor{stringliteral}{"moves"}][moveName.c\_str()].GetDouble();
292             probPrSwap[j][i] = doc[\textcolor{stringliteral}{"moves"}][moveName.c\_str()].GetDouble();
293         \}
294     \}
295 
296     usedMovesEq->\hyperlink{classmoves_ab603c6ce829075e3232ff41a7d5e2aab}{setM}(sys.\hyperlink{classsim_system_aa4ad1afff101bb530e1590df05035276}{getTotalM}());
297     usedMovesPr->\hyperlink{classmoves_ab603c6ce829075e3232ff41a7d5e2aab}{setM}(sys.\hyperlink{classsim_system_aa4ad1afff101bb530e1590df05035276}{getTotalM}());
298     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++i) \{
299         usedMovesEq->\hyperlink{classmoves_ab4583b3075f51cce55c3aeb84a58430d}{addInsert}(i, probPrInsDel[i]);
300         usedMovesPr->\hyperlink{classmoves_ab4583b3075f51cce55c3aeb84a58430d}{addInsert}(i, probPrInsDel[i]);
301 
302         usedMovesEq->\hyperlink{classmoves_ac4307636570c4d4bc07c4cba3887005e}{addDelete}(i, probPrInsDel[i]);
303         usedMovesPr->\hyperlink{classmoves_ac4307636570c4d4bc07c4cba3887005e}{addDelete}(i, probPrInsDel[i]);
304 
305         usedMovesEq->\hyperlink{classmoves_a91bb7969368fdbb66920a11d79fe7552}{addTranslate}(i, probPrDisp[i], maxPrD[i], sys.
      \hyperlink{classsim_system_a8bff9dfb95b1b09a0fab2c1c485ade07}{box}());
306         usedMovesPr->\hyperlink{classmoves_a91bb7969368fdbb66920a11d79fe7552}{addTranslate}(i, probPrDisp[i], maxPrD[i], sys.
      \hyperlink{classsim_system_a8bff9dfb95b1b09a0fab2c1c485ade07}{box}());
307 
308         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = i+1; j < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++j) \{
309             usedMovesEq->\hyperlink{classmoves_a03cebfa2d8d1cecf253df573fdecc5d0}{addSwap}(i, j, probPrSwap[i][j]);
310             usedMovesPr->\hyperlink{classmoves_a03cebfa2d8d1cecf253df573fdecc5d0}{addSwap}(i, j, probPrSwap[i][j]);
311         \}
312     \}
313 \}
\end{DoxyCode}
\hypertarget{input_8cpp_afcd470506b012754a93b2012b65e3fc4}{\index{input.\-cpp@{input.\-cpp}!set\-Pair\-Potentials@{set\-Pair\-Potentials}}
\index{set\-Pair\-Potentials@{set\-Pair\-Potentials}!input.cpp@{input.\-cpp}}
\subsubsection[{set\-Pair\-Potentials}]{\setlength{\rightskip}{0pt plus 5cm}void set\-Pair\-Potentials (
\begin{DoxyParamCaption}
\item[{{\bf sim\-System} \&}]{sys, }
\item[{const rapidjson\-::\-Document \&}]{doc}
\end{DoxyParamCaption}
)}}\label{input_8cpp_afcd470506b012754a93b2012b65e3fc4}


Assign the pair potentials based on the J\-S\-O\-N input file. 

Overwrites any existing pair potential information with new settings from doc.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em sys} & Simulation system that has been initialized \\
\hline
\mbox{\tt in}  & {\em doc} & J\-S\-O\-N document corresponding to input file \\
\hline
\end{DoxyParams}


Definition at line 322 of file input.\-cpp.



References sim\-System\-::add\-Potential(), sim\-System\-::n\-Species(), num\-To\-Str(), and sim\-System\-::ppot.



Referenced by initialize(), and set\-Config().


\begin{DoxyCode}
322                                                                       \{
323     \textcolor{keywordtype}{int} Mtot = 1;
324     \textcolor{keywordflow}{if} (doc.HasMember(\textcolor{stringliteral}{"num\_expanded\_states"})) \{
325         Mtot = doc[\textcolor{stringliteral}{"num\_expanded\_states"}].GetInt();
326     \}
327 
328     std::vector < std::string > ppotType (sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}()*(sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}()-1)/2 + sys.
      \hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}());
329     \textcolor{keywordtype}{int} ppotTypeIndex = 0;
330     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++i) \{
331         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = i; j < sys.\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}(); ++j) \{
332             std::string name1 = \textcolor{stringliteral}{"ppot\_"}+std::to\_string(i+1)+\textcolor{stringliteral}{"\_"}+std::to\_string(j+1), name2 = \textcolor{stringliteral}{"ppot\_"}+
      std::to\_string(j+1)+\textcolor{stringliteral}{"\_"}+std::to\_string(i+1);
333             std::string ppotName = \textcolor{stringliteral}{""}, dummy = \textcolor{stringliteral}{""}, tabFile = \textcolor{stringliteral}{""};
334             \textcolor{keywordtype}{bool} foundIJ = \textcolor{keyword}{false};
335             \textcolor{keywordflow}{if} (doc.HasMember(name1.c\_str())) \{
336                 ppotName = name1;
337                 foundIJ = \textcolor{keyword}{true};
338             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (doc.HasMember(name2.c\_str()) && !foundIJ) \{
339                 ppotName = name2;
340                 foundIJ = \textcolor{keyword}{true};
341             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (doc.HasMember(name2.c\_str()) && foundIJ) \{
342                 \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"Input file doubly specifies pair potential for
       species pair ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{", "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{")"});
343             \} \textcolor{keywordflow}{else} \{
344                 \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"Input file does not specify pair potential for
       species pair ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{", "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{")"});
345             \}
346 
347             \textcolor{keywordflow}{if} (!doc[ppotName.c\_str()].IsString()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential is
       not a name for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{")"});
348             ppotType[ppotTypeIndex] = doc[ppotName.c\_str()].GetString();
349             dummy = ppotName+\textcolor{stringliteral}{"\_params"};
350             \textcolor{keywordflow}{if} (!doc.HasMember(dummy.c\_str())) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Input file missing
       pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{")"});
351             \textcolor{keywordflow}{if} (!doc[dummy.c\_str()].IsObject()) \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential's
       parameters are not valid json document"});
352 
353             std::vector < double > params;
354 
355             \textcolor{keywordtype}{bool} useCellList = \textcolor{keyword}{false}; \textcolor{comment}{// default}
356             \textcolor{keywordflow}{if} (doc[dummy.c\_str()].HasMember(\textcolor{stringliteral}{"cell\_list"})) \{
357                 useCellList = doc[dummy.c\_str()][\textcolor{stringliteral}{"cell\_list"}].GetBool();
358             \}
359 
360             \textcolor{keywordflow}{if} (ppotType[ppotTypeIndex] == \textcolor{stringliteral}{"square\_well"}) \{
361                 \textcolor{comment}{// Expects sigma, width, epsilon, cell\_list}
362                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()].HasMember(\textcolor{stringliteral}{"sigma"})) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") is missing \(\backslash\)"sigma\(\backslash\)""});
363                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()].HasMember(\textcolor{stringliteral}{"width"})) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") is missing \(\backslash\)"width\(\backslash\)""});
364                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()].HasMember(\textcolor{stringliteral}{"epsilon"})) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") is missing \(\backslash\)"epsilon\(\backslash\)""});
365 
366                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()][\textcolor{stringliteral}{"sigma"}].IsNumber()) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") parameter \(\backslash\)"sigma\(\backslash\)" is not a number"});
367                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()][\textcolor{stringliteral}{"width"}].IsNumber()) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") parameter \(\backslash\)"width\(\backslash\)" is not a number"});
368                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()][\textcolor{stringliteral}{"epsilon"}].IsNumber()) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") parameter \(\backslash\)"epsilon\(\backslash\)" is not a number"});
369 
370                 params.push\_back(doc[dummy.c\_str()][\textcolor{stringliteral}{"sigma"}].GetDouble());
371                 params.push\_back(doc[dummy.c\_str()][\textcolor{stringliteral}{"width"}].GetDouble());
372                 params.push\_back(doc[dummy.c\_str()][\textcolor{stringliteral}{"epsilon"}].GetDouble());
373             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ppotType[ppotTypeIndex] == \textcolor{stringliteral}{"lennard\_jones"}) \{
374                 \textcolor{comment}{// Expects epsilon, sigma, r\_cut, u\_shift}
375                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()].HasMember(\textcolor{stringliteral}{"epsilon"})) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") is missing \(\backslash\)"epsilon\(\backslash\)""});
376                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()].HasMember(\textcolor{stringliteral}{"sigma"})) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") is missing \(\backslash\)"sigma\(\backslash\)""});
377                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()].HasMember(\textcolor{stringliteral}{"r\_cut"})) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") is missing \(\backslash\)"r\_cut\(\backslash\)""});
378                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()].HasMember(\textcolor{stringliteral}{"u\_shift"})) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") is missing \(\backslash\)"u\_shift\(\backslash\)""});
379 
380                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()][\textcolor{stringliteral}{"epsilon"}].IsNumber()) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") parameter \(\backslash\)"epsilon\(\backslash\)" is not a number"});
381                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()][\textcolor{stringliteral}{"sigma"}].IsNumber()) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") parameter \(\backslash\)"sigma\(\backslash\)" is not a number"});
382                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()][\textcolor{stringliteral}{"r\_cut"}].IsNumber()) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") parameter \(\backslash\)"r\_cut\(\backslash\)" is not a number"});
383                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()][\textcolor{stringliteral}{"u\_shift"}].IsNumber()) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") parameter \(\backslash\)"u\_shift\(\backslash\)" is not a number"});
384 
385                 params.push\_back(doc[dummy.c\_str()][\textcolor{stringliteral}{"epsilon"}].GetDouble());
386                 params.push\_back(doc[dummy.c\_str()][\textcolor{stringliteral}{"sigma"}].GetDouble());
387                 params.push\_back(doc[dummy.c\_str()][\textcolor{stringliteral}{"r\_cut"}].GetDouble());
388                 params.push\_back(doc[dummy.c\_str()][\textcolor{stringliteral}{"u\_shift"}].GetDouble());
389             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ppotType[ppotTypeIndex] == \textcolor{stringliteral}{"fs\_lennard\_jones"}) \{
390                 \textcolor{comment}{// Expects epsilon, sigma, r\_cut}
391                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()].HasMember(\textcolor{stringliteral}{"epsilon"})) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") is missing \(\backslash\)"epsilon\(\backslash\)""});
392                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()].HasMember(\textcolor{stringliteral}{"sigma"})) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") is missing \(\backslash\)"sigma\(\backslash\)""});
393                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()].HasMember(\textcolor{stringliteral}{"r\_cut"})) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") is missing \(\backslash\)"r\_cut\(\backslash\)""});
394 
395                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()][\textcolor{stringliteral}{"epsilon"}].IsNumber()) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") parameter \(\backslash\)"epsilon\(\backslash\)" is not a number"});
396                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()][\textcolor{stringliteral}{"sigma"}].IsNumber()) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") parameter \(\backslash\)"sigma\(\backslash\)" is not a number"});
397                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()][\textcolor{stringliteral}{"r\_cut"}].IsNumber()) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") parameter \(\backslash\)"r\_cut\(\backslash\)" is not a number"});
398 
399                 params.push\_back(doc[dummy.c\_str()][\textcolor{stringliteral}{"epsilon"}].GetDouble());
400                 params.push\_back(doc[dummy.c\_str()][\textcolor{stringliteral}{"sigma"}].GetDouble());
401                 params.push\_back(doc[dummy.c\_str()][\textcolor{stringliteral}{"r\_cut"}].GetDouble());
402             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ppotType[ppotTypeIndex] == \textcolor{stringliteral}{"hard\_sphere"}) \{
403                 \textcolor{comment}{// Expects sigma}
404                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()].HasMember(\textcolor{stringliteral}{"sigma"})) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") is missing \(\backslash\)"sigma\(\backslash\)""});
405 
406                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()][\textcolor{stringliteral}{"sigma"}].IsNumber()) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") parameter \(\backslash\)"sigma\(\backslash\)" is not a number"});
407 
408                 params.push\_back(doc[dummy.c\_str()][\textcolor{stringliteral}{"sigma"}].GetDouble());
409             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ppotType[ppotTypeIndex] == \textcolor{stringliteral}{"tabulated"}) \{
410                 \textcolor{comment}{// Expects r\_cut, r\_shift, u\_shift, u\_infinity}
411                 \textcolor{comment}{// Also must specify file to load potential from}
412                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()].HasMember(\textcolor{stringliteral}{"r\_cut"})) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") is missing \(\backslash\)"r\_cut\(\backslash\)""});
413                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()].HasMember(\textcolor{stringliteral}{"r\_shift"})) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") is missing \(\backslash\)"r\_shift\(\backslash\)""});
414                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()].HasMember(\textcolor{stringliteral}{"u\_shift"})) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") is missing \(\backslash\)"u\_shift\(\backslash\)""});
415                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()].HasMember(\textcolor{stringliteral}{"u\_infinity"})) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") is missing \(\backslash\)"u\_infinity\(\backslash\)""});
416                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()].HasMember(\textcolor{stringliteral}{"filename"})) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") is missing \(\backslash\)"filename\(\backslash\)""});
417 
418                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()][\textcolor{stringliteral}{"r\_cut"}].IsNumber()) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") parameter \(\backslash\)"r\_cut\(\backslash\)" is not a number"});
419                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()][\textcolor{stringliteral}{"r\_shift"}].IsNumber()) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") parameter \(\backslash\)"r\_shift\(\backslash\)" is not a number"});
420                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()][\textcolor{stringliteral}{"u\_shift"}].IsNumber()) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") parameter \(\backslash\)"u\_shift\(\backslash\)" is not a number"});
421                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()][\textcolor{stringliteral}{"u\_infinity"}].IsNumber()) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") parameter \(\backslash\)"u\_infinity\(\backslash\)" is not a number"});
422                 \textcolor{keywordflow}{if} (!doc[dummy.c\_str()][\textcolor{stringliteral}{"filename"}].IsString()) \textcolor{keywordflow}{throw} 
      \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Pair potential parameters for ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") parameter \(\backslash\)"filename\(\backslash\)" is not a string"});
423 
424                 params.push\_back(doc[dummy.c\_str()][\textcolor{stringliteral}{"r\_cut"}].GetDouble());
425                 params.push\_back(doc[dummy.c\_str()][\textcolor{stringliteral}{"r\_shift"}].GetDouble());
426                 params.push\_back(doc[dummy.c\_str()][\textcolor{stringliteral}{"u\_shift"}].GetDouble());
427                 params.push\_back(doc[dummy.c\_str()][\textcolor{stringliteral}{"u\_infinity"}].GetDouble());
428                 tabFile = doc[dummy.c\_str()][\textcolor{stringliteral}{"filename"}].GetString();
429             \} \textcolor{keywordflow}{else} \{
430                 \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Unrecognized pair potential "}+ppotType[ppotTypeIndex
      ]);
431             \}
432 
433             params.push\_back(Mtot);
434 
435             \textcolor{keywordflow}{try} \{
436                 sys.\hyperlink{classsim_system_a5abdfae81ca00a79f162c0ce2b4307c9}{addPotential}(i, j, ppotType[ppotTypeIndex], params, useCellList, tabFile);
437                 sys.\hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[i][j]->savePotential(ppotName+\textcolor{stringliteral}{".dat"}, 0.01, 0.01);
438             \} \textcolor{keywordflow}{catch} (std::exception &ex) \{
439                 \textcolor{keyword}{const} std::string msg = ex.what();
440                 \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Unable to add potential "}+ppotType[ppotTypeIndex]+\textcolor{stringliteral}{"
       for species pair ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(i+1)+\textcolor{stringliteral}{","}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(j+1)+\textcolor{stringliteral}{") : "}+msg);
441             \}
442 
443             ppotTypeIndex++;
444         \}
445     \}
446 \}
\end{DoxyCode}
