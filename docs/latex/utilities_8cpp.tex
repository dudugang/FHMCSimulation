\hypertarget{utilities_8cpp}{\section{/home/nam4/\-Desktop/sandbox/\-F\-H\-M\-C\-Simulation/src/utilities.cpp File Reference}
\label{utilities_8cpp}\index{/home/nam4/\-Desktop/sandbox/\-F\-H\-M\-C\-Simulation/src/utilities.\-cpp@{/home/nam4/\-Desktop/sandbox/\-F\-H\-M\-C\-Simulation/src/utilities.\-cpp}}
}
{\ttfamily \#include \char`\"{}utilities.\-h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{utilities_8cpp_a78325bdf48423acef7c012567628b391}{I\-M1}~2147483563
\item 
\#define \hyperlink{utilities_8cpp_ad8c519de7e5de4ae35344ddcf21fd062}{I\-M2}~2147483399
\item 
\#define \hyperlink{utilities_8cpp_ad301e6a88b1c01108f4867f2ea6f683c}{A\-M}~(1.\-0/\hyperlink{utilities_8cpp_a78325bdf48423acef7c012567628b391}{I\-M1})
\item 
\#define \hyperlink{utilities_8cpp_a87a6e0054f9d827c979c43aa0d5e621a}{I\-M\-M1}~(\hyperlink{utilities_8cpp_a78325bdf48423acef7c012567628b391}{I\-M1}-\/1)
\item 
\#define \hyperlink{utilities_8cpp_a6ef2749dca39c605c3d033f788afe6e3}{I\-A1}~40014
\item 
\#define \hyperlink{utilities_8cpp_a372a58d7e9e25912fd79e7afaa06cc7a}{I\-A2}~40692
\item 
\#define \hyperlink{utilities_8cpp_a9afa86ff22da69bda72fe271ae71ad46}{I\-Q1}~53668
\item 
\#define \hyperlink{utilities_8cpp_abae040385946a6acdf5e10d2efd86f3d}{I\-Q2}~52774
\item 
\#define \hyperlink{utilities_8cpp_a7b2b32709f9770a283701ffcf3723497}{I\-R1}~12211
\item 
\#define \hyperlink{utilities_8cpp_a5a08e4f5cb3582e623cc14a6c92d48de}{I\-R2}~3791
\item 
\#define \hyperlink{utilities_8cpp_a0e93cfb2d62849853fd34957ba6e6fdc}{N\-T\-A\-B}~32
\item 
\#define \hyperlink{utilities_8cpp_a62339d74dd5d9d00480e1a288cf88fe8}{N\-D\-I\-V}~(1+\hyperlink{utilities_8cpp_a87a6e0054f9d827c979c43aa0d5e621a}{I\-M\-M1}/\hyperlink{utilities_8cpp_a0e93cfb2d62849853fd34957ba6e6fdc}{N\-T\-A\-B})
\item 
\#define \hyperlink{utilities_8cpp_a6ebf6899d6c1c8b7b9d09be872c05aae}{E\-P\-S}~1.\-2e-\/7
\item 
\#define \hyperlink{utilities_8cpp_aa7436c9270ffb06f8c1eae8d2e605cec}{R\-N\-M\-X}~(1.\-0-\/\hyperlink{utilities_8cpp_a6ebf6899d6c1c8b7b9d09be872c05aae}{E\-P\-S})
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}{send\-Msg} (const std\-::string msg)
\begin{DoxyCompactList}\small\item\em Send a message to std\-::cout. \end{DoxyCompactList}\item 
void \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{send\-Err} (const std\-::string msg)
\begin{DoxyCompactList}\small\item\em Send a message to std\-::cerr. \end{DoxyCompactList}\item 
void \hyperlink{utilities_8cpp_a3f494918ff3c252de4914c9905be04e7}{parse\-Json} (const std\-::string filename, rapidjson\-::\-Document \&doc)
\begin{DoxyCompactList}\small\item\em Parse a J\-S\-O\-N file and return the corresponding document. \end{DoxyCompactList}\item 
void \hyperlink{utilities_8cpp_a2c482530b256030d81cdbfcdc1d191c3}{pause\-Code} (long int dur)
\begin{DoxyCompactList}\small\item\em Pause the code for a certain time. \end{DoxyCompactList}\item 
std\-::vector$<$ std\-::string $>$ \hyperlink{utilities_8cpp_ac84b085638619e2d7926ef816d833f7c}{splitstr} (const std\-::string \&s, char delim)
\begin{DoxyCompactList}\small\item\em C++ explode a string. \end{DoxyCompactList}\item 
std\-::string \hyperlink{utilities_8cpp_aa6d910bf51f18a75deb20c6f0fbba285}{get\-Time\-Stamp} ()
\begin{DoxyCompactList}\small\item\em Obtain instantaneous timestamp. \end{DoxyCompactList}\item 
std\-::vector$<$ std\-::vector\\*
$<$ double $>$ $>$ \hyperlink{utilities_8cpp_a198e6f6658163fec9b36be3542407727}{matrix\-Product} (std\-::vector$<$ std\-::vector$<$ double $>$ $>$ \&mat1, std\-::vector$<$ std\-::vector$<$ double $>$ $>$ \&mat2)
\begin{DoxyCompactList}\small\item\em Compute product of 2 matrices, W = U\-V. \end{DoxyCompactList}\item 
std\-::vector$<$ std\-::vector\\*
$<$ double $>$ $>$ \hyperlink{utilities_8cpp_a2b3e32432e13d1a3feeb00de5466e456}{rotation\-Matrix} (const double alpha, const double beta, const double gamma)
\begin{DoxyCompactList}\small\item\em Create 3\-D rotation matrix from angles (x, then y, then z) \end{DoxyCompactList}\item 
std\-::vector$<$ double $>$ \hyperlink{utilities_8cpp_af1bc480936b7436d4e679abc5a837815}{random3\-D\-Surface\-Vector} (const double magnitude)
\begin{DoxyCompactList}\small\item\em Chose a random vector sampled from a random distribution on the surface of a sphere. \end{DoxyCompactList}\item 
double \hyperlink{utilities_8cpp_a0f9542af4b475ac79cb679d7a8d14db0}{rng} (int $\ast$idum)
\begin{DoxyCompactList}\small\item\em Random number generator (from Numerical Recipes) \end{DoxyCompactList}\item 
void \hyperlink{utilities_8cpp_ad858a38f435e9a0ee890aa0f526714d2}{pbc} (std\-::vector$<$ double $>$ \&pos, const std\-::vector$<$ double $>$ \&box)
\begin{DoxyCompactList}\small\item\em Replace a position inside a box assuming periodic boundary conditions. \end{DoxyCompactList}\item 
double \hyperlink{utilities_8cpp_abb1db3a8a3ac46e044bbe7b2c5684c0a}{pbc\-Dist2} (const std\-::vector$<$ double $>$ \&p1, const std\-::vector$<$ double $>$ \&p2, const std\-::vector$<$ double $>$ \&box)
\begin{DoxyCompactList}\small\item\em Calculate the minimum image distance squared between two coordinates assuming periodic boundary conditions. \end{DoxyCompactList}\item 
bool \hyperlink{utilities_8cpp_a9d1e3672fd331d4185c1763c80226307}{file\-Exists} (std\-::string file\-Name)
\begin{DoxyCompactList}\small\item\em Function to check whether a given file exists or not. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{utilities_8cpp_a3f4e4ea24d5a5c66feae55d1f329c884}{R\-N\-G\-\_\-\-S\-E\-E\-D} = -\/1024
\begin{DoxyCompactList}\small\item\em Default R\-N\-G seed. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{utilities_8cpp_ad301e6a88b1c01108f4867f2ea6f683c}{\index{utilities.\-cpp@{utilities.\-cpp}!A\-M@{A\-M}}
\index{A\-M@{A\-M}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{A\-M}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\-M~(1.\-0/{\bf I\-M1})}}\label{utilities_8cpp_ad301e6a88b1c01108f4867f2ea6f683c}


Definition at line 8 of file utilities.\-cpp.



Referenced by rng().

\hypertarget{utilities_8cpp_a6ebf6899d6c1c8b7b9d09be872c05aae}{\index{utilities.\-cpp@{utilities.\-cpp}!E\-P\-S@{E\-P\-S}}
\index{E\-P\-S@{E\-P\-S}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{E\-P\-S}]{\setlength{\rightskip}{0pt plus 5cm}\#define E\-P\-S~1.\-2e-\/7}}\label{utilities_8cpp_a6ebf6899d6c1c8b7b9d09be872c05aae}


Definition at line 18 of file utilities.\-cpp.

\hypertarget{utilities_8cpp_a6ef2749dca39c605c3d033f788afe6e3}{\index{utilities.\-cpp@{utilities.\-cpp}!I\-A1@{I\-A1}}
\index{I\-A1@{I\-A1}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{I\-A1}]{\setlength{\rightskip}{0pt plus 5cm}\#define I\-A1~40014}}\label{utilities_8cpp_a6ef2749dca39c605c3d033f788afe6e3}


Definition at line 10 of file utilities.\-cpp.



Referenced by rng().

\hypertarget{utilities_8cpp_a372a58d7e9e25912fd79e7afaa06cc7a}{\index{utilities.\-cpp@{utilities.\-cpp}!I\-A2@{I\-A2}}
\index{I\-A2@{I\-A2}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{I\-A2}]{\setlength{\rightskip}{0pt plus 5cm}\#define I\-A2~40692}}\label{utilities_8cpp_a372a58d7e9e25912fd79e7afaa06cc7a}


Definition at line 11 of file utilities.\-cpp.



Referenced by rng().

\hypertarget{utilities_8cpp_a78325bdf48423acef7c012567628b391}{\index{utilities.\-cpp@{utilities.\-cpp}!I\-M1@{I\-M1}}
\index{I\-M1@{I\-M1}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{I\-M1}]{\setlength{\rightskip}{0pt plus 5cm}\#define I\-M1~2147483563}}\label{utilities_8cpp_a78325bdf48423acef7c012567628b391}


Definition at line 6 of file utilities.\-cpp.



Referenced by rng().

\hypertarget{utilities_8cpp_ad8c519de7e5de4ae35344ddcf21fd062}{\index{utilities.\-cpp@{utilities.\-cpp}!I\-M2@{I\-M2}}
\index{I\-M2@{I\-M2}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{I\-M2}]{\setlength{\rightskip}{0pt plus 5cm}\#define I\-M2~2147483399}}\label{utilities_8cpp_ad8c519de7e5de4ae35344ddcf21fd062}


Definition at line 7 of file utilities.\-cpp.



Referenced by rng().

\hypertarget{utilities_8cpp_a87a6e0054f9d827c979c43aa0d5e621a}{\index{utilities.\-cpp@{utilities.\-cpp}!I\-M\-M1@{I\-M\-M1}}
\index{I\-M\-M1@{I\-M\-M1}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{I\-M\-M1}]{\setlength{\rightskip}{0pt plus 5cm}\#define I\-M\-M1~({\bf I\-M1}-\/1)}}\label{utilities_8cpp_a87a6e0054f9d827c979c43aa0d5e621a}


Definition at line 9 of file utilities.\-cpp.



Referenced by rng().

\hypertarget{utilities_8cpp_a9afa86ff22da69bda72fe271ae71ad46}{\index{utilities.\-cpp@{utilities.\-cpp}!I\-Q1@{I\-Q1}}
\index{I\-Q1@{I\-Q1}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{I\-Q1}]{\setlength{\rightskip}{0pt plus 5cm}\#define I\-Q1~53668}}\label{utilities_8cpp_a9afa86ff22da69bda72fe271ae71ad46}


Definition at line 12 of file utilities.\-cpp.



Referenced by rng().

\hypertarget{utilities_8cpp_abae040385946a6acdf5e10d2efd86f3d}{\index{utilities.\-cpp@{utilities.\-cpp}!I\-Q2@{I\-Q2}}
\index{I\-Q2@{I\-Q2}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{I\-Q2}]{\setlength{\rightskip}{0pt plus 5cm}\#define I\-Q2~52774}}\label{utilities_8cpp_abae040385946a6acdf5e10d2efd86f3d}


Definition at line 13 of file utilities.\-cpp.



Referenced by rng().

\hypertarget{utilities_8cpp_a7b2b32709f9770a283701ffcf3723497}{\index{utilities.\-cpp@{utilities.\-cpp}!I\-R1@{I\-R1}}
\index{I\-R1@{I\-R1}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{I\-R1}]{\setlength{\rightskip}{0pt plus 5cm}\#define I\-R1~12211}}\label{utilities_8cpp_a7b2b32709f9770a283701ffcf3723497}


Definition at line 14 of file utilities.\-cpp.



Referenced by rng().

\hypertarget{utilities_8cpp_a5a08e4f5cb3582e623cc14a6c92d48de}{\index{utilities.\-cpp@{utilities.\-cpp}!I\-R2@{I\-R2}}
\index{I\-R2@{I\-R2}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{I\-R2}]{\setlength{\rightskip}{0pt plus 5cm}\#define I\-R2~3791}}\label{utilities_8cpp_a5a08e4f5cb3582e623cc14a6c92d48de}


Definition at line 15 of file utilities.\-cpp.



Referenced by rng().

\hypertarget{utilities_8cpp_a62339d74dd5d9d00480e1a288cf88fe8}{\index{utilities.\-cpp@{utilities.\-cpp}!N\-D\-I\-V@{N\-D\-I\-V}}
\index{N\-D\-I\-V@{N\-D\-I\-V}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{N\-D\-I\-V}]{\setlength{\rightskip}{0pt plus 5cm}\#define N\-D\-I\-V~(1+{\bf I\-M\-M1}/{\bf N\-T\-A\-B})}}\label{utilities_8cpp_a62339d74dd5d9d00480e1a288cf88fe8}


Definition at line 17 of file utilities.\-cpp.



Referenced by rng().

\hypertarget{utilities_8cpp_a0e93cfb2d62849853fd34957ba6e6fdc}{\index{utilities.\-cpp@{utilities.\-cpp}!N\-T\-A\-B@{N\-T\-A\-B}}
\index{N\-T\-A\-B@{N\-T\-A\-B}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{N\-T\-A\-B}]{\setlength{\rightskip}{0pt plus 5cm}\#define N\-T\-A\-B~32}}\label{utilities_8cpp_a0e93cfb2d62849853fd34957ba6e6fdc}


Definition at line 16 of file utilities.\-cpp.



Referenced by rng().

\hypertarget{utilities_8cpp_aa7436c9270ffb06f8c1eae8d2e605cec}{\index{utilities.\-cpp@{utilities.\-cpp}!R\-N\-M\-X@{R\-N\-M\-X}}
\index{R\-N\-M\-X@{R\-N\-M\-X}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{R\-N\-M\-X}]{\setlength{\rightskip}{0pt plus 5cm}\#define R\-N\-M\-X~(1.\-0-\/{\bf E\-P\-S})}}\label{utilities_8cpp_aa7436c9270ffb06f8c1eae8d2e605cec}


Definition at line 19 of file utilities.\-cpp.



Referenced by rng().



\subsection{Function Documentation}
\hypertarget{utilities_8cpp_a9d1e3672fd331d4185c1763c80226307}{\index{utilities.\-cpp@{utilities.\-cpp}!file\-Exists@{file\-Exists}}
\index{file\-Exists@{file\-Exists}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{file\-Exists}]{\setlength{\rightskip}{0pt plus 5cm}bool file\-Exists (
\begin{DoxyParamCaption}
\item[{std\-::string}]{file\-Name}
\end{DoxyParamCaption}
)}}\label{utilities_8cpp_a9d1e3672fd331d4185c1763c80226307}


Function to check whether a given file exists or not. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em file\-Name} & Name of file to check\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
If file exists 
\end{DoxyReturn}


Definition at line 271 of file utilities.\-cpp.



Referenced by checkpoint\-::checkpoint(), checkpoint\-::load(), and tabulated\-::load\-Potential().


\begin{DoxyCode}
271                                     \{
272     \textcolor{keyword}{struct }stat stFileInfo;
273 
274     \textcolor{keywordflow}{if} (stat(fileName.c\_str(),&stFileInfo) == 0)
275         \textcolor{keywordflow}{return} \textcolor{keyword}{true};
276     \textcolor{keywordflow}{else}
277         \textcolor{keywordflow}{return} \textcolor{keyword}{false};
278 \}
\end{DoxyCode}
\hypertarget{utilities_8cpp_aa6d910bf51f18a75deb20c6f0fbba285}{\index{utilities.\-cpp@{utilities.\-cpp}!get\-Time\-Stamp@{get\-Time\-Stamp}}
\index{get\-Time\-Stamp@{get\-Time\-Stamp}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{get\-Time\-Stamp}]{\setlength{\rightskip}{0pt plus 5cm}std\-::string get\-Time\-Stamp (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{utilities_8cpp_aa6d910bf51f18a75deb20c6f0fbba285}


Obtain instantaneous timestamp. 

\begin{DoxyReturn}{Returns}
char$\ast$ timestamp 
\end{DoxyReturn}


Definition at line 90 of file utilities.\-cpp.



Referenced by checkpoint\-::dump(), moves\-::print(), send\-Err(), and send\-Msg().


\begin{DoxyCode}
90                           \{
91     time\_t rawtime;
92     time (&rawtime);
93     \textcolor{keyword}{struct }tm * timeinfo;
94     timeinfo = localtime (&rawtime);
95     \textcolor{keywordtype}{char} timestamp [80];
96     strftime (timestamp,80,\textcolor{stringliteral}{"%d/%m/%Y %H:%M:%S"},timeinfo);
97     std::string ans (timestamp);
98     \textcolor{keywordflow}{return} ans;
99 \}
\end{DoxyCode}
\hypertarget{utilities_8cpp_a198e6f6658163fec9b36be3542407727}{\index{utilities.\-cpp@{utilities.\-cpp}!matrix\-Product@{matrix\-Product}}
\index{matrix\-Product@{matrix\-Product}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{matrix\-Product}]{\setlength{\rightskip}{0pt plus 5cm}std\-::vector$<$ std\-::vector $<$ double $>$ $>$ matrix\-Product (
\begin{DoxyParamCaption}
\item[{std\-::vector$<$ std\-::vector$<$ double $>$ $>$ \&}]{mat1, }
\item[{std\-::vector$<$ std\-::vector$<$ double $>$ $>$ \&}]{mat2}
\end{DoxyParamCaption}
)}}\label{utilities_8cpp_a198e6f6658163fec9b36be3542407727}


Compute product of 2 matrices, W = U\-V. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em mat1} & Matrix U \\
\hline
\mbox{\tt in}  & {\em mat2} & Matrix V \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
W 
\end{DoxyReturn}


Definition at line 108 of file utilities.\-cpp.



Referenced by rotation\-Matrix().


\begin{DoxyCode}
108                                                                                                            
                                 \{
109     std::vector < double > dummy (3, 0);
110     std::vector < std::vector < double > > W (3, dummy);
111 
112     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < 3; ++i) \{
113         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < 3; ++j) \{
114             W[i][j] = mat1[i][j]*mat2[j][i];
115         \}
116     \}
117 
118     \textcolor{keywordflow}{return} W;
119 \}
\end{DoxyCode}
\hypertarget{utilities_8cpp_a3f494918ff3c252de4914c9905be04e7}{\index{utilities.\-cpp@{utilities.\-cpp}!parse\-Json@{parse\-Json}}
\index{parse\-Json@{parse\-Json}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{parse\-Json}]{\setlength{\rightskip}{0pt plus 5cm}void parse\-Json (
\begin{DoxyParamCaption}
\item[{const std\-::string}]{filename, }
\item[{rapidjson\-::\-Document \&}]{doc}
\end{DoxyParamCaption}
)}}\label{utilities_8cpp_a3f494918ff3c252de4914c9905be04e7}


Parse a J\-S\-O\-N file and return the corresponding document. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em filename} & Input J\-S\-O\-N document's filename \\
\hline
\end{DoxyParams}


Definition at line 44 of file utilities.\-cpp.



References send\-Msg().



Referenced by initialize(), checkpoint\-::load(), and set\-Config().


\begin{DoxyCode}
44                                                                   \{
45     \textcolor{keywordflow}{try} \{
46         FILE* fp = fopen(filename.c\_str(), \textcolor{stringliteral}{"r"});
47         \textcolor{keywordtype}{char} readBuffer[65536];
48         rapidjson::FileReadStream is(fp, readBuffer, \textcolor{keyword}{sizeof}(readBuffer));
49         doc.ParseStream(is);
50         fclose(fp);
51     \} \textcolor{keywordflow}{catch} (...) \{
52         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Unable to parse "}+filename);
53     \}
54 
55     \textcolor{keywordflow}{if} (doc.IsObject()) \{
56         \hyperlink{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}{sendMsg}(\textcolor{stringliteral}{"Parsed JSON file "}+filename);
57     \} \textcolor{keywordflow}{else} \{
58         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Error in "}+filename+\textcolor{stringliteral}{", not begin detected as proper JSON
       document"});
59     \}
60 \}
\end{DoxyCode}
\hypertarget{utilities_8cpp_a2c482530b256030d81cdbfcdc1d191c3}{\index{utilities.\-cpp@{utilities.\-cpp}!pause\-Code@{pause\-Code}}
\index{pause\-Code@{pause\-Code}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{pause\-Code}]{\setlength{\rightskip}{0pt plus 5cm}void pause\-Code (
\begin{DoxyParamCaption}
\item[{long int}]{dur}
\end{DoxyParamCaption}
)}}\label{utilities_8cpp_a2c482530b256030d81cdbfcdc1d191c3}


Pause the code for a certain time. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em dur} & Number of seconds to pause for \\
\hline
\end{DoxyParams}


Definition at line 67 of file utilities.\-cpp.


\begin{DoxyCode}
67                               \{
68     \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} temp = time(NULL) + dur;
69     \textcolor{keywordflow}{while}(temp > time(NULL));
70 \}
\end{DoxyCode}
\hypertarget{utilities_8cpp_ad858a38f435e9a0ee890aa0f526714d2}{\index{utilities.\-cpp@{utilities.\-cpp}!pbc@{pbc}}
\index{pbc@{pbc}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{pbc}]{\setlength{\rightskip}{0pt plus 5cm}void pbc (
\begin{DoxyParamCaption}
\item[{std\-::vector$<$ double $>$ \&}]{pos, }
\item[{const std\-::vector$<$ double $>$ \&}]{box}
\end{DoxyParamCaption}
)}}\label{utilities_8cpp_ad858a38f435e9a0ee890aa0f526714d2}


Replace a position inside a box assuming periodic boundary conditions. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in,out}  & {\em pos} & Position to be placed in box \\
\hline
\mbox{\tt in}  & {\em box} & Box dimensions \\
\hline
\end{DoxyParams}


Definition at line 227 of file utilities.\-cpp.



Referenced by hard\-Wall\-Z\-::energy(), square\-Well\-Wall\-Z\-::energy(), right\-Triangle\-X\-Z\-::energy(), hard\-Wall\-Z\-::inside(), and square\-Well\-Wall\-Z\-::inside().


\begin{DoxyCode}
227                                                                       \{
228     \textcolor{comment}{// generally while loops are faster than round statements}
229     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < pos.size(); ++i) \{
230         \textcolor{keywordflow}{while} (pos[i] < 0.0) \{
231             pos[i] += box[i];
232         \}
233         \textcolor{keywordflow}{while} (pos[i] >= box[i]) \{
234             pos[i] -= box[i];
235         \}
236     \}
237 \}
\end{DoxyCode}
\hypertarget{utilities_8cpp_abb1db3a8a3ac46e044bbe7b2c5684c0a}{\index{utilities.\-cpp@{utilities.\-cpp}!pbc\-Dist2@{pbc\-Dist2}}
\index{pbc\-Dist2@{pbc\-Dist2}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{pbc\-Dist2}]{\setlength{\rightskip}{0pt plus 5cm}double pbc\-Dist2 (
\begin{DoxyParamCaption}
\item[{const std\-::vector$<$ double $>$ \&}]{p1, }
\item[{const std\-::vector$<$ double $>$ \&}]{p2, }
\item[{const std\-::vector$<$ double $>$ \&}]{box}
\end{DoxyParamCaption}
)}}\label{utilities_8cpp_abb1db3a8a3ac46e044bbe7b2c5684c0a}


Calculate the minimum image distance squared between two coordinates assuming periodic boundary conditions. 

Coordinates do not have to be in the box to begin with.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em \textbackslash{}p1} & Position 1 \\
\hline
\mbox{\tt in}  & {\em \textbackslash{}p1} & Position 2 \\
\hline
\mbox{\tt in}  & {\em \textbackslash{}box} & Box size\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
d2 (distance squared) 
\end{DoxyReturn}


Definition at line 248 of file utilities.\-cpp.



Referenced by lennard\-Jones\-::energy(), fs\-Lennard\-Jones\-::energy(), cylinder\-Z\-::energy(), tabulated\-::energy(), square\-Well\-::energy(), hard\-Core\-::energy(), cylinder\-Z\-::inside(), and agg\-Vol\-Bias3\-::make().


\begin{DoxyCode}
248                                                                                                            
             \{
249     \textcolor{keywordtype}{double} d2 = 0.0;
250     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < p2.size(); ++i) \{
251         \textcolor{keywordtype}{double} dr = p2[i] - p1[i];
252         \textcolor{keywordflow}{while} (dr < -box[i]/2.0) \{
253             dr += box[i];
254         \}
255         \textcolor{keywordflow}{while} (dr > box[i]/2.0) \{
256             dr -= box[i];
257         \}
258         d2 += dr*dr;
259     \}
260 
261     \textcolor{keywordflow}{return} d2;
262 \}
\end{DoxyCode}
\hypertarget{utilities_8cpp_af1bc480936b7436d4e679abc5a837815}{\index{utilities.\-cpp@{utilities.\-cpp}!random3\-D\-Surface\-Vector@{random3\-D\-Surface\-Vector}}
\index{random3\-D\-Surface\-Vector@{random3\-D\-Surface\-Vector}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{random3\-D\-Surface\-Vector}]{\setlength{\rightskip}{0pt plus 5cm}std\-::vector$<$ double $>$ random3\-D\-Surface\-Vector (
\begin{DoxyParamCaption}
\item[{const double}]{magnitude}
\end{DoxyParamCaption}
)}}\label{utilities_8cpp_af1bc480936b7436d4e679abc5a837815}


Chose a random vector sampled from a random distribution on the surface of a sphere. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em magnitude} & Mangitude of the vector (radius of sphere)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
ans double3 containing coordinates of vector 
\end{DoxyReturn}


Definition at line 165 of file utilities.\-cpp.



References rng(), and R\-N\-G\-\_\-\-S\-E\-E\-D.



Referenced by agg\-Vol\-Bias3\-::make().


\begin{DoxyCode}
165                                                                     \{
166     \textcolor{keywordtype}{int} success = 0;
167     std::vector < double > ans (3, 0);
168     \textcolor{keywordflow}{while} (success == 0) \{
169         \textcolor{keywordtype}{double} r1 = \hyperlink{utilities_8cpp_a0f9542af4b475ac79cb679d7a8d14db0}{rng}(&\hyperlink{utilities_8cpp_a3f4e4ea24d5a5c66feae55d1f329c884}{RNG\_SEED}), r2 = \hyperlink{utilities_8cpp_a0f9542af4b475ac79cb679d7a8d14db0}{rng}(&\hyperlink{utilities_8cpp_a3f4e4ea24d5a5c66feae55d1f329c884}{RNG\_SEED}), x1 = 1.0-2.0*r1, x2 = 1.0-2.
      0*r2;
170         \textcolor{keywordtype}{double} sum2 = x1*x1+x2*x2;
171         \textcolor{keywordflow}{if} (sum2 < 1.0) \{
172             ans[0] = 2*x1*sqrt(1-sum2)*magnitude;
173             ans[1] = 2*x2*sqrt(1-sum2)*magnitude;
174             ans[2] = (1-2.0*sum2)*magnitude;
175             success = 1;
176         \}
177     \}
178     \textcolor{keywordflow}{return} ans;
179 \}
\end{DoxyCode}
\hypertarget{utilities_8cpp_a0f9542af4b475ac79cb679d7a8d14db0}{\index{utilities.\-cpp@{utilities.\-cpp}!rng@{rng}}
\index{rng@{rng}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{rng}]{\setlength{\rightskip}{0pt plus 5cm}double rng (
\begin{DoxyParamCaption}
\item[{int $\ast$}]{idum}
\end{DoxyParamCaption}
)}}\label{utilities_8cpp_a0f9542af4b475ac79cb679d7a8d14db0}


Random number generator (from Numerical Recipes) 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em idum} & seed\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
temp Pseudo-\/random number between \mbox{[}0, 1) 
\end{DoxyReturn}


Definition at line 188 of file utilities.\-cpp.



References A\-M, I\-A1, I\-A2, I\-M1, I\-M2, I\-M\-M1, I\-Q1, I\-Q2, I\-R1, I\-R2, N\-D\-I\-V, N\-T\-A\-B, and R\-N\-M\-X.



Referenced by agg\-Vol\-Bias3\-::make(), delete\-Particle\-::make(), translate\-Particle\-::make(), swap\-Particles\-::make(), insert\-Particle\-::make(), moves\-::make\-Move(), random3\-D\-Surface\-Vector(), and quaternion\-::set\-Random\-Rot().


\begin{DoxyCode}
188                        \{
189     \textcolor{keywordtype}{int} j;
190     \textcolor{keywordtype}{long} k;
191     \textcolor{keyword}{static} \textcolor{keywordtype}{long} idum2=123456789;
192     \textcolor{keyword}{static} \textcolor{keywordtype}{long} iy=0;
193     \textcolor{keyword}{static} \textcolor{keywordtype}{long} iv[\hyperlink{utilities_8cpp_a0e93cfb2d62849853fd34957ba6e6fdc}{NTAB}];
194     \textcolor{keywordtype}{double} temp;
195 
196     \textcolor{keywordflow}{if} (*idum <= 0) \{
197         \textcolor{keywordflow}{if} (-(*idum) < 1) *idum=1;
198         \textcolor{keywordflow}{else} *idum = -(*idum);
199         idum2=(*idum);
200         \textcolor{keywordflow}{for} (j=\hyperlink{utilities_8cpp_a0e93cfb2d62849853fd34957ba6e6fdc}{NTAB}+7;j>=0;j--) \{
201             k=(*idum)/\hyperlink{utilities_8cpp_a9afa86ff22da69bda72fe271ae71ad46}{IQ1};
202             *idum=\hyperlink{utilities_8cpp_a6ef2749dca39c605c3d033f788afe6e3}{IA1}*(*idum-k*\hyperlink{utilities_8cpp_a9afa86ff22da69bda72fe271ae71ad46}{IQ1})-k*\hyperlink{utilities_8cpp_a7b2b32709f9770a283701ffcf3723497}{IR1};
203             \textcolor{keywordflow}{if} (*idum < 0) *idum += \hyperlink{utilities_8cpp_a78325bdf48423acef7c012567628b391}{IM1};
204             \textcolor{keywordflow}{if} (j < \hyperlink{utilities_8cpp_a0e93cfb2d62849853fd34957ba6e6fdc}{NTAB}) iv[j] = *idum;
205         \} iy=iv[0];
206     \}
207     k=(*idum)/\hyperlink{utilities_8cpp_a9afa86ff22da69bda72fe271ae71ad46}{IQ1};
208     *idum=\hyperlink{utilities_8cpp_a6ef2749dca39c605c3d033f788afe6e3}{IA1}*(*idum-k*\hyperlink{utilities_8cpp_a9afa86ff22da69bda72fe271ae71ad46}{IQ1})-k*\hyperlink{utilities_8cpp_a7b2b32709f9770a283701ffcf3723497}{IR1};
209     \textcolor{keywordflow}{if} (*idum < 0) *idum += \hyperlink{utilities_8cpp_a78325bdf48423acef7c012567628b391}{IM1};
210     k=idum2/\hyperlink{utilities_8cpp_abae040385946a6acdf5e10d2efd86f3d}{IQ2};
211     idum2=\hyperlink{utilities_8cpp_a372a58d7e9e25912fd79e7afaa06cc7a}{IA2}*(idum2-k*\hyperlink{utilities_8cpp_abae040385946a6acdf5e10d2efd86f3d}{IQ2})-k*\hyperlink{utilities_8cpp_a5a08e4f5cb3582e623cc14a6c92d48de}{IR2};
212     \textcolor{keywordflow}{if} (idum2 < 0) idum2 += \hyperlink{utilities_8cpp_ad8c519de7e5de4ae35344ddcf21fd062}{IM2};
213     j=iy/\hyperlink{utilities_8cpp_a62339d74dd5d9d00480e1a288cf88fe8}{NDIV};
214     iy=iv[j]-idum2;
215     iv[j] = *idum;
216     \textcolor{keywordflow}{if} (iy < 1) iy += \hyperlink{utilities_8cpp_a87a6e0054f9d827c979c43aa0d5e621a}{IMM1};
217     \textcolor{keywordflow}{if} ((temp=\hyperlink{utilities_8cpp_ad301e6a88b1c01108f4867f2ea6f683c}{AM}*iy) > \hyperlink{utilities_8cpp_aa7436c9270ffb06f8c1eae8d2e605cec}{RNMX}) \textcolor{keywordflow}{return} \hyperlink{utilities_8cpp_aa7436c9270ffb06f8c1eae8d2e605cec}{RNMX};
218     \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} temp;
219 \}
\end{DoxyCode}
\hypertarget{utilities_8cpp_a2b3e32432e13d1a3feeb00de5466e456}{\index{utilities.\-cpp@{utilities.\-cpp}!rotation\-Matrix@{rotation\-Matrix}}
\index{rotation\-Matrix@{rotation\-Matrix}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{rotation\-Matrix}]{\setlength{\rightskip}{0pt plus 5cm}std\-::vector$<$ std\-::vector $<$ double $>$ $>$ rotation\-Matrix (
\begin{DoxyParamCaption}
\item[{const double}]{alpha, }
\item[{const double}]{beta, }
\item[{const double}]{gamma}
\end{DoxyParamCaption}
)}}\label{utilities_8cpp_a2b3e32432e13d1a3feeb00de5466e456}


Create 3\-D rotation matrix from angles (x, then y, then z) 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em alpha} & Radians to rotate centers by around x-\/axis \\
\hline
\mbox{\tt in}  & {\em beta} & Radians to rotate centers by around y-\/axis \\
\hline
\mbox{\tt in}  & {\em gamma} & Radians to rotate centers by around z-\/axis \\
\hline
\end{DoxyParams}


Definition at line 128 of file utilities.\-cpp.



References matrix\-Product().


\begin{DoxyCode}
128                                                                                                            
         \{
129 
130     std::vector < double > dummy (3, 0);
131     std::vector < std::vector < double > > Rx (3, dummy), Ry(3, dummy), Rz(3, dummy), Ryx, Rzyx;
132 
133     \textcolor{comment}{// https://en.wikipedia.org/wiki/Rotation\_matrix#General\_rotations}
134     Rx[0][0] = 1.0;
135     Rx[1][1] = cos(alpha);
136     Rx[1][2] = -sin(alpha);
137     Rx[2][1] = sin(alpha);
138     Rx[2][2] = cos(alpha);
139 
140     Ry[0][0] = cos(beta);
141     Ry[0][2] = sin(beta);
142     Ry[1][1] = 1.0;
143     Ry[2][0] = -sin(beta);
144     Ry[2][2] = cos(beta);
145 
146     Rz[0][0] = cos(gamma);
147     Rz[0][1] = -sin(gamma);
148     Rz[1][0] = sin(gamma);
149     Rz[1][1] = cos(gamma);
150     Rz[2][2] = 1.0;
151 
152     Ryx = \hyperlink{utilities_8cpp_a198e6f6658163fec9b36be3542407727}{matrixProduct}(Ry, Rx);
153     Rzyx = \hyperlink{utilities_8cpp_a198e6f6658163fec9b36be3542407727}{matrixProduct}(Rz, Ryx);
154 
155     \textcolor{keywordflow}{return} Rzyx;
156 \}
\end{DoxyCode}
\hypertarget{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{\index{utilities.\-cpp@{utilities.\-cpp}!send\-Err@{send\-Err}}
\index{send\-Err@{send\-Err}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{send\-Err}]{\setlength{\rightskip}{0pt plus 5cm}void send\-Err (
\begin{DoxyParamCaption}
\item[{const std\-::string}]{msg}
\end{DoxyParamCaption}
)}}\label{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}


Send a message to std\-::cerr. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em msg} & Message as string \\
\hline
\end{DoxyParams}


Definition at line 35 of file utilities.\-cpp.



References get\-Time\-Stamp().



Referenced by sim\-System\-::add\-Potential(), check\-Bounds(), tabulated\-::energy(), initialize(), checkpoint\-::load(), tabulated\-::load\-Potential(), moves\-::moves(), perform\-Crossover(), perform\-T\-M\-M\-C(), perform\-W\-A\-L\-A(), sim\-System\-::read\-Config(), sanity\-Checks(), set\-Config(), set\-Moves(), set\-Pair\-Potentials(), and set\-System\-Barriers().


\begin{DoxyCode}
35                                    \{
36     std::cerr << \textcolor{stringliteral}{" *** ERROR: "} << \hyperlink{utilities_8cpp_aa6d910bf51f18a75deb20c6f0fbba285}{getTimeStamp}() << \textcolor{stringliteral}{" : "} << msg << \textcolor{stringliteral}{" *** "} << std::endl;
37 \}
\end{DoxyCode}
\hypertarget{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}{\index{utilities.\-cpp@{utilities.\-cpp}!send\-Msg@{send\-Msg}}
\index{send\-Msg@{send\-Msg}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{send\-Msg}]{\setlength{\rightskip}{0pt plus 5cm}void send\-Msg (
\begin{DoxyParamCaption}
\item[{const std\-::string}]{msg}
\end{DoxyParamCaption}
)}}\label{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}


Send a message to std\-::cout. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em msg} & Message as string \\
\hline
\end{DoxyParams}


Definition at line 26 of file utilities.\-cpp.



References get\-Time\-Stamp().



Referenced by sim\-System\-::add\-Potential(), initialize(), checkpoint\-::load(), tabulated\-::load\-Potential(), parse\-Json(), perform\-Crossover(), perform\-T\-M\-M\-C(), perform\-W\-A\-L\-A(), sim\-System\-::read\-Config(), sanity\-Checks(), and set\-Config().


\begin{DoxyCode}
26                                    \{
27     std::cout << \hyperlink{utilities_8cpp_aa6d910bf51f18a75deb20c6f0fbba285}{getTimeStamp}() << \textcolor{stringliteral}{" : "} << msg << std::endl;
28 \}
\end{DoxyCode}
\hypertarget{utilities_8cpp_ac84b085638619e2d7926ef816d833f7c}{\index{utilities.\-cpp@{utilities.\-cpp}!splitstr@{splitstr}}
\index{splitstr@{splitstr}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{splitstr}]{\setlength{\rightskip}{0pt plus 5cm}std\-::vector$<$ std\-::string $>$ splitstr (
\begin{DoxyParamCaption}
\item[{const std\-::string \&}]{s, }
\item[{char}]{delim}
\end{DoxyParamCaption}
)}}\label{utilities_8cpp_ac84b085638619e2d7926ef816d833f7c}


C++ explode a string. 



Definition at line 75 of file utilities.\-cpp.


\begin{DoxyCode}
75                                                                   \{
76     std::stringstream ss(s);
77     std::string item;
78     std::vector <std::string> tokens;
79     \textcolor{keywordflow}{while} (std::getline(ss, item, delim)) \{
80         tokens.push\_back(item);
81     \}
82     \textcolor{keywordflow}{return} tokens;
83 \}
\end{DoxyCode}


\subsection{Variable Documentation}
\hypertarget{utilities_8cpp_a3f4e4ea24d5a5c66feae55d1f329c884}{\index{utilities.\-cpp@{utilities.\-cpp}!R\-N\-G\-\_\-\-S\-E\-E\-D@{R\-N\-G\-\_\-\-S\-E\-E\-D}}
\index{R\-N\-G\-\_\-\-S\-E\-E\-D@{R\-N\-G\-\_\-\-S\-E\-E\-D}!utilities.cpp@{utilities.\-cpp}}
\subsubsection[{R\-N\-G\-\_\-\-S\-E\-E\-D}]{\setlength{\rightskip}{0pt plus 5cm}int R\-N\-G\-\_\-\-S\-E\-E\-D = -\/1024}}\label{utilities_8cpp_a3f4e4ea24d5a5c66feae55d1f329c884}


Default R\-N\-G seed. 



Definition at line 3 of file utilities.\-cpp.



Referenced by initialize(), agg\-Vol\-Bias3\-::make(), delete\-Particle\-::make(), translate\-Particle\-::make(), insert\-Particle\-::make(), swap\-Particles\-::make(), moves\-::make\-Move(), random3\-D\-Surface\-Vector(), and quaternion\-::set\-Random\-Rot().

