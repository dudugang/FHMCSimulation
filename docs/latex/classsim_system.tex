\hypertarget{classsim_system}{\section{sim\-System Class Reference}
\label{classsim_system}\index{sim\-System@{sim\-System}}
}


System information for the simulation.  




{\ttfamily \#include $<$system.\-h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classsim_system_a2312059f2775a063d02e5739721f7ece}{sim\-System} ()
\item 
\hyperlink{classsim_system_a1a5ca1d7704d8f26b3cb19ebba57e045}{sim\-System} (const unsigned int \hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{n\-Species}, const double \hyperlink{classsim_system_a3eeec9678902f8d7fce4dad6064aaf4c}{beta}, const std\-::vector$<$ double $>$ \hyperlink{classsim_system_a8bff9dfb95b1b09a0fab2c1c485ade07}{box}, const std\-::vector$<$ double $>$ \hyperlink{classsim_system_af1e3f5320aff976a448647244d5950d1}{mu}, const std\-::vector$<$ int $>$ \hyperlink{classsim_system_a93259b517f449f1ac610d132ac66b551}{max\-Species}, const std\-::vector$<$ int $>$ \hyperlink{classsim_system_afafda4a09ed180ee9c5580d196d8ca9f}{min\-Species}, const int Mtot, const double energy\-Hist\-Delta=10.\-0, const int max\-\_\-order=2)
\begin{DoxyCompactList}\small\item\em Initialize the system. \end{DoxyCompactList}\item 
\hyperlink{classsim_system_abaa6ad6ea00aa437cf0b9ac8034af327}{$\sim$sim\-System} ()
\item 
bool \hyperlink{classsim_system_a09c4ea670168c9f1d549d2a5120eb13c}{add\-K\-E\-Correction} ()
\item 
void \hyperlink{classsim_system_aa5853448f04712e9163174860efadefd}{toggle\-K\-E} ()
\begin{DoxyCompactList}\small\item\em Toggle K\-E adjustment to energy setting. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_a6ad31c08955b80873f865b3069618dcb}{increment\-Energy} (const double d\-U)
\begin{DoxyCompactList}\small\item\em Increment the system's energy. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_a5abdfae81ca00a79f162c0ce2b4307c9}{add\-Potential} (const int spec1, const int spec2, const std\-::string ppot\-\_\-name, const std\-::vector$<$ double $>$ \&params, const bool use\-Cell\-List=false, const std\-::string tab\-File=\char`\"{}\char`\"{})
\begin{DoxyCompactList}\small\item\em Add a pair potential to the system which governs the pair (spec1, spec2). \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_ae3096dc65acdf38cc824e507cca33370}{print\-Snapshot} (std\-::string filename, std\-::string comment, bool overwrite=true)
\begin{DoxyCompactList}\small\item\em Print an X\-Y\-Z file of the instantaneous system configuration. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_a0404e9435cc046d19b6bb990678ee069}{insert\-Atom} (const int type\-Index, \hyperlink{classatom}{atom} $\ast$new\-Atom, bool override=false)
\begin{DoxyCompactList}\small\item\em Insert an atom into the system. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_acabf4fc5b5b90bba62e1449ddb3646c6}{delete\-Atom} (const int type\-Index, const int atom\-Index, bool override=false)
\begin{DoxyCompactList}\small\item\em Delete an atom from the system. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_a22fdaceea44abd6cd021bac1ecd11890}{translate\-Atom} (const int type\-Index, const int atom\-Index, std\-::vector$<$ double $>$ old\-Pos)
\begin{DoxyCompactList}\small\item\em Translate an atom in the system. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_a3161d95bbb800d5d95a732ac5fc32b95}{read\-Config} (std\-::string filename)
\begin{DoxyCompactList}\small\item\em Read an X\-Y\-Z file as the system's initial configuration. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_ab894de5ccd37efa97ae799f1dc1875a1}{set\-E\-U\-B} (const std\-::vector$<$ double $>$ eub)
\begin{DoxyCompactList}\small\item\em Assign energy upper bound from restart. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_a284cf6c00f572db12db0cb263974a78a}{set\-E\-L\-B} (const std\-::vector$<$ double $>$ elb)
\begin{DoxyCompactList}\small\item\em Assign energy lower bound from restart. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_a176b9ff482f1d36bc0638538bcfe0670}{check\-Energy\-Histogram\-Bounds} ()
\begin{DoxyCompactList}\small\item\em Monitor the energy histogram bounds at each Ntot. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_afe05cba714a032b445cfb1a529547833}{refine\-Energy\-Histogram\-Bounds} ()
\begin{DoxyCompactList}\small\item\em Check the histogram entries and trim off zero-\/valued entries and bounds. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_aa0eae4d523b5649be273e0419e9f799f}{record\-Energy\-Histogram} ()
\begin{DoxyCompactList}\small\item\em Record the energy histogram for the system at a given Ntot. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_a861dd81718ef1c069fa7cfb9b7efe83c}{re\-Initialize\-Energy\-Histogram} ()
\begin{DoxyCompactList}\small\item\em Re-\/initialize the energy histogram with internal estimates of bounds. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_a6ef1ba3e08ec44d865436e272cdebc9b}{print\-Energy\-Histogram} (const std\-::string file\-Name, const bool normalize=true)
\begin{DoxyCompactList}\small\item\em Print the (normalized by default) energy histogram for each Ntot. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_ae073008ed44e551f0d008b2f5a0fc06f}{restart\-Energy\-Histogram} (const std\-::string prefix)
\begin{DoxyCompactList}\small\item\em Restart the energy histogram for each Ntot from unnormalized checkpoint. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_a1e462fcb63389d59419ff6135b2d802e}{refine\-Pk\-Histogram\-Bounds} ()
\begin{DoxyCompactList}\small\item\em Check the histogram entries and trim off zero-\/valued entries and bounds. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_a71bbc9d8bdbb5042e4fa817c3e71fe53}{record\-Pk\-Histogram} ()
\begin{DoxyCompactList}\small\item\em Record the particle number histogram for the system at a given Ntot. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_ac29bdd6f7fa6f9526b7eafcf658d70d8}{print\-Pk\-Histogram} (const std\-::string file\-Name, const bool normalize=true)
\begin{DoxyCompactList}\small\item\em Print the (normalized by default) particle number histogram for each Ntot. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_a3239a23e35f30e40eeecf8795386c164}{restart\-Pk\-Histogram} (const std\-::string prefix)
\begin{DoxyCompactList}\small\item\em Restart the particle histogram for each Ntot from unnormalized checkpoint. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_a74ce0ab8151fd0501abf853a16cc8e58}{record\-Ext\-Moments} ()
\begin{DoxyCompactList}\small\item\em Record the extensive moment at a given Ntot. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_a2818b2f0ff79782d5443ca0f191564f8}{print\-Ext\-Moments} (const std\-::string file\-Name, const bool normalize=true)
\begin{DoxyCompactList}\small\item\em Print the (normalized by default) extensive energy histogram for each Ntot. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_a999556fea891765c5ed4d979706665af}{restart\-Ext\-Moments} (const std\-::string prefix, const std\-::vector$<$ double $>$ \&ctr)
\begin{DoxyCompactList}\small\item\em Restart the extensive energy histogram for each Ntot from unnormalized checkpoint. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_a57af66c88ce4dc1aeb6a1cd3f14ff0bb}{start\-W\-A\-L\-A} (const double ln\-F, const double g, const double s, const int Mtot)
\begin{DoxyCompactList}\small\item\em Start using Wang-\/\-Landau and instantiate the bias object. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_ad6febde00f19ae0787771f2d1d9e391b}{stop\-W\-A\-L\-A} ()
\begin{DoxyCompactList}\small\item\em Stop using Wang-\/\-Landau and free the bias object. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_ac689245cd8e9ddfdcd94d3871a5a5d6b}{start\-T\-M\-M\-C} (const long long int \hyperlink{classsim_system_a56e284a361964d0a9ce5c45f41d56ab1}{tmmc\-Sweep\-Size}, const int Mtot)
\begin{DoxyCompactList}\small\item\em Start using T\-M\-M\-C and instantiate the bias object. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_a69edcc2c27db3d4e94002ac5635e9030}{stop\-T\-M\-M\-C} ()
\begin{DoxyCompactList}\small\item\em Stop using T\-M\-M\-C and free the bias object. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_a76b5dc3e179e275e40726c660d8e669b}{set\-Tot\-N\-Bounds} (const std\-::vector$<$ int $>$ \&bounds)
\begin{DoxyCompactList}\small\item\em Set the bounds on the total number of particles in a system. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_a5d61d583a40931ce5643bd6429f510ba}{increment\-M\-State} ()
\begin{DoxyCompactList}\small\item\em Increase the expanded ensemble state of the system by 1. \end{DoxyCompactList}\item 
void \hyperlink{classsim_system_a18e515d42d1d653bcac67d61701983eb}{decrement\-M\-State} ()
\begin{DoxyCompactList}\small\item\em Decrease the expanded ensemble state of the system by 1. \end{DoxyCompactList}\item 
bool \hyperlink{classsim_system_a40af191fae6091e26413ee06ae188ae9}{potential\-Is\-Set} (const int spec1, const int spec2)
\begin{DoxyCompactList}\small\item\em Boolean which returns whether or not a pair has had its potential specified by the user yet. \end{DoxyCompactList}\item 
const int \hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{n\-Species} ()
\begin{DoxyCompactList}\small\item\em Return the number of different species in the system. \end{DoxyCompactList}\item 
const int \hyperlink{classsim_system_a93259b517f449f1ac610d132ac66b551}{max\-Species} (const int index)
\begin{DoxyCompactList}\small\item\em Returns the absolute maximum number of a given species type allowed in the system. \end{DoxyCompactList}\item 
const int \hyperlink{classsim_system_afafda4a09ed180ee9c5580d196d8ca9f}{min\-Species} (const int index)
\begin{DoxyCompactList}\small\item\em Returns the absolute minimum number of a given species type allowed in the system. \end{DoxyCompactList}\item 
const int \hyperlink{classsim_system_aee2c65ecb43a35c0c4d070cdb45f7dc0}{tot\-N\-Max} ()
\begin{DoxyCompactList}\small\item\em Return upper bound on the total number of atoms in the system. \end{DoxyCompactList}\item 
const int \hyperlink{classsim_system_af10842e0eaa638373b8717c87b47e6bc}{tot\-N\-Min} ()
\begin{DoxyCompactList}\small\item\em Return lower bound on the total number of atoms in the system. \end{DoxyCompactList}\item 
const int \hyperlink{classsim_system_a37dd827f4057049763351510147b9f1d}{get\-Tot\-N} ()
\begin{DoxyCompactList}\small\item\em Return a sum of the total number of atoms currently in the system. \end{DoxyCompactList}\item 
const int \hyperlink{classsim_system_afe08187d318113c33bda890c69570c36}{get\-Max\-Order} ()
\begin{DoxyCompactList}\small\item\em Return the max order the extensive moments are being stored out to. \end{DoxyCompactList}\item 
const int \hyperlink{classsim_system_a299fe4372e610b554eaaf5f5957b2dbc}{get\-Current\-M} ()
\begin{DoxyCompactList}\small\item\em Return the system's current expanded ensemble fractional state. \end{DoxyCompactList}\item 
const int \hyperlink{classsim_system_aa4ad1afff101bb530e1590df05035276}{get\-Total\-M} ()
\begin{DoxyCompactList}\small\item\em Return the total number of fractional states available to species in the expanded ensemble. \end{DoxyCompactList}\item 
const int \hyperlink{classsim_system_a0500a9e84eecfbde7a98cf8a34f719d5}{get\-Fractional\-Atom\-Type} ()
\begin{DoxyCompactList}\small\item\em Return the atom type of the fractional atom. \end{DoxyCompactList}\item 
const double \hyperlink{classsim_system_a37b3d15faf56bf31349f5c2aaf02f858}{energy} ()
\begin{DoxyCompactList}\small\item\em Return the system's instantaneous energy. \end{DoxyCompactList}\item 
const double \hyperlink{classsim_system_a51539ed4c3bb4905b32ce428c1c537fe}{scratch\-Energy} ()
\begin{DoxyCompactList}\small\item\em Recalculate the energy of the system from scratch. \end{DoxyCompactList}\item 
const double \hyperlink{classsim_system_a3eeec9678902f8d7fce4dad6064aaf4c}{beta} ()
\begin{DoxyCompactList}\small\item\em Return 1/k\-T. \end{DoxyCompactList}\item 
const double \hyperlink{classsim_system_af1e3f5320aff976a448647244d5950d1}{mu} (const int index)
\begin{DoxyCompactList}\small\item\em Return the chemical potential for a given species' index. \end{DoxyCompactList}\item 
const double \hyperlink{classsim_system_a7c75052458072e1267bc20594b58d8cd}{mass} (const int index)
\begin{DoxyCompactList}\small\item\em Return the mass of a given species' index. \end{DoxyCompactList}\item 
const std\-::vector$<$ double $>$ \hyperlink{classsim_system_a1744c4c22603662081d75985bc30b754}{ext\-Mom\-Counter} ()
\begin{DoxyCompactList}\small\item\em Get counter for extensive moments needed for restarting system from a checkpoint. \end{DoxyCompactList}\item 
const std\-::vector$<$ double $>$ \hyperlink{classsim_system_a8bff9dfb95b1b09a0fab2c1c485ade07}{box} ()
\begin{DoxyCompactList}\small\item\em Return the system box dimensions. \end{DoxyCompactList}\item 
std\-::vector$<$ double $>$ \hyperlink{classsim_system_a610cbb1c6059151e420dbd42dd9da714}{get\-E\-L\-B} ()
\begin{DoxyCompactList}\small\item\em Returns current tally of energy min at each Ntot for checkpointing. \end{DoxyCompactList}\item 
std\-::vector$<$ double $>$ \hyperlink{classsim_system_ae87e0ac03cc11259cd3b44c780a90a06}{get\-E\-U\-B} ()
\begin{DoxyCompactList}\small\item\em Returns current tally of energy max at each Ntot for checkpointing. \end{DoxyCompactList}\item 
std\-::vector$<$ \hyperlink{classatom}{atom} $\ast$ $>$ \hyperlink{classsim_system_a9b3aeefa22c3b50b5913df6eea753bc6}{get\-Neighbor\-Atoms} (const unsigned int type\-Index\-A, const unsigned int type\-Index\-B, \hyperlink{classatom}{atom} $\ast$\-\_\-atom)
\begin{DoxyCompactList}\small\item\em Return the list of neighbors of type A, around a particle of type B which is passed. \end{DoxyCompactList}\item 
\hyperlink{classtmmc}{tmmc} $\ast$ \hyperlink{classsim_system_aa31d40c91cb50f143a9613d362798887}{get\-T\-M\-M\-C\-Bias} ()
\begin{DoxyCompactList}\small\item\em Return pointer to the T\-M\-M\-C bias. \end{DoxyCompactList}\item 
\hyperlink{classwala}{wala} $\ast$ \hyperlink{classsim_system_a7cb5049de8b0988349e89e30e4000407}{get\-W\-A\-L\-A\-Bias} ()
\begin{DoxyCompactList}\small\item\em Return pointer to the Wang-\/\-Landau bias. \end{DoxyCompactList}\item 
\hyperlink{classatom}{atom} $\ast$ \hyperlink{classsim_system_a2ab77377c60e0e3109a6e875690b0ab7}{get\-Fractional\-Atom} ()
\begin{DoxyCompactList}\small\item\em Returns a pointer the atom in the system that is currently only fractionally inserted/deleted. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
bool \hyperlink{classsim_system_aa474a50b6353c8897331b1ab1ce53ab1}{use\-T\-M\-M\-C}
\begin{DoxyCompactList}\small\item\em Logical stating whether or not to use T\-M\-M\-C biasing. \end{DoxyCompactList}\item 
bool \hyperlink{classsim_system_aa83b00006b3919fb6e13f1bdeadece6a}{use\-W\-A\-L\-A}
\begin{DoxyCompactList}\small\item\em Logical stating whether or not to use Wang-\/\-Landau biasing. \end{DoxyCompactList}\item 
bool \hyperlink{classsim_system_a2b168c89742f4d64270583e7e54b2929}{restart\-From\-W\-A\-L\-A}
\item 
bool \hyperlink{classsim_system_a0c81d3b606c070c801f8d86288e44391}{restart\-From\-T\-M\-M\-C}
\begin{DoxyCompactList}\small\item\em Flags to restart from W\-A\-L\-A or T\-M\-M\-C initially. \end{DoxyCompactList}\item 
long long int \hyperlink{classsim_system_a56e284a361964d0a9ce5c45f41d56ab1}{tmmc\-Sweep\-Size}
\begin{DoxyCompactList}\small\item\em Size of a sweep in T\-M\-M\-C. \end{DoxyCompactList}\item 
long long int \hyperlink{classsim_system_a78b107e20bcbf2f818264fa076de5db3}{total\-T\-M\-M\-C\-Sweeps}
\begin{DoxyCompactList}\small\item\em Total number of sweeps to perform during T\-M\-M\-C. \end{DoxyCompactList}\item 
long long int \hyperlink{classsim_system_ae625e1026daee4f99f83fb73881875a1}{wl\-Sweep\-Size}
\begin{DoxyCompactList}\small\item\em Size of Wang-\/\-Landau sweep. \end{DoxyCompactList}\item 
long long int \hyperlink{classsim_system_aa748f651ddd9a2bf6d88bfcab9153905}{n\-Crossover\-Visits}
\begin{DoxyCompactList}\small\item\em Number of crossovers that must occur before switching from W\-A\-L\-A to T\-M\-M\-C. \end{DoxyCompactList}\item 
double \hyperlink{classsim_system_a794334e163fbeb4b4f61bcea676679ce}{ln\-F\-\_\-start}
\item 
double \hyperlink{classsim_system_a3fb5d01fd3abf49f577c050968fba9d1}{ln\-F\-\_\-end}
\begin{DoxyCompactList}\small\item\em Starting and ending ln\-F for Wang-\/\-Landau. \end{DoxyCompactList}\item 
double \hyperlink{classsim_system_aa2e866e69ebe5fa0761894212592175a}{wala\-\_\-g}
\item 
double \hyperlink{classsim_system_a7cc3431bb59acca9165b044dbd07dcdc}{wala\-\_\-s}
\begin{DoxyCompactList}\small\item\em Wang-\/\-Landau g and s factors. \end{DoxyCompactList}\item 
\hyperlink{classtmmc}{tmmc} $\ast$ \hyperlink{classsim_system_a13173f45a1e40a5f5a3552b0ebe15b54}{tmmc\-Bias}
\begin{DoxyCompactList}\small\item\em T\-M\-M\-C biasing function. \end{DoxyCompactList}\item 
\hyperlink{classwala}{wala} $\ast$ \hyperlink{classsim_system_a6dc8d9f89dfcfa247a59bc50889c49e7}{wl\-Bias}
\begin{DoxyCompactList}\small\item\em W\-L biasing function. \end{DoxyCompactList}\item 
std\-::string \hyperlink{classsim_system_afbf0b172dc35572e71ec6d27a018e2fc}{restart\-From\-W\-A\-L\-A\-File}
\item 
std\-::string \hyperlink{classsim_system_a5ccdad82b3767ba21b1e4b1e36362082}{restart\-From\-T\-M\-M\-C\-File}
\begin{DoxyCompactList}\small\item\em Files to restart from W\-A\-L\-A or T\-M\-M\-C initially. \end{DoxyCompactList}\item 
std\-::vector$<$ int $>$ \hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{num\-Species}
\begin{DoxyCompactList}\small\item\em Total number of each type of atom the system contains. \end{DoxyCompactList}\item 
std\-::vector$<$ std\-::vector$<$ \hyperlink{classatom}{atom} $>$ $>$ \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}
\begin{DoxyCompactList}\small\item\em Atoms in a matrix by type, and particle index, respectively that a system C\-A\-N hold but not all are actually \char`\"{}in\char`\"{} the system. \end{DoxyCompactList}\item 
std\-::vector$<$ std\-::vector\\*
$<$ std\-::shared\-\_\-ptr\\*
$<$ \hyperlink{classpair_potential}{pair\-Potential} $>$ $>$ $>$ \hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}
\begin{DoxyCompactList}\small\item\em Matrix of pair potentials for atom types i, j. \end{DoxyCompactList}\item 
std\-::vector$<$ \hyperlink{classcomposite_barrier}{composite\-Barrier} $>$ \hyperlink{classsim_system_a5ae652ff4519f39c3862abae32a9581b}{species\-Barriers}
\begin{DoxyCompactList}\small\item\em Barriers, if any, for each species. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
System information for the simulation. 

Definition at line 26 of file system.\-h.



\subsection{Constructor \& Destructor Documentation}
\hypertarget{classsim_system_a2312059f2775a063d02e5739721f7ece}{\index{sim\-System@{sim\-System}!sim\-System@{sim\-System}}
\index{sim\-System@{sim\-System}!simSystem@{sim\-System}}
\subsubsection[{sim\-System}]{\setlength{\rightskip}{0pt plus 5cm}sim\-System\-::sim\-System (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_a2312059f2775a063d02e5739721f7ece}


Definition at line 28 of file system.\-h.


\begin{DoxyCode}
28 \{;\}
\end{DoxyCode}
\hypertarget{classsim_system_a1a5ca1d7704d8f26b3cb19ebba57e045}{\index{sim\-System@{sim\-System}!sim\-System@{sim\-System}}
\index{sim\-System@{sim\-System}!simSystem@{sim\-System}}
\subsubsection[{sim\-System}]{\setlength{\rightskip}{0pt plus 5cm}sim\-System\-::sim\-System (
\begin{DoxyParamCaption}
\item[{const unsigned int}]{n\-Species, }
\item[{const double}]{beta, }
\item[{const std\-::vector$<$ double $>$}]{box, }
\item[{const std\-::vector$<$ double $>$}]{mu, }
\item[{const std\-::vector$<$ int $>$}]{max\-Species, }
\item[{const std\-::vector$<$ int $>$}]{min\-Species, }
\item[{const int}]{Mtot, }
\item[{const double}]{energy\-Hist\-Delta = {\ttfamily 10.0}, }
\item[{const int}]{max\-\_\-order = {\ttfamily 2}}
\end{DoxyParamCaption}
)}}\label{classsim_system_a1a5ca1d7704d8f26b3cb19ebba57e045}


Initialize the system. 

Sets the use of both W\-L and T\-M\-M\-C biasing to false.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em n\-Species} & Number of unqiue species types to allow in the system \\
\hline
\mbox{\tt in}  & {\em beta} & Inverse temperature (1/k\-T) \\
\hline
\mbox{\tt in}  & {\em box} & Box dimensions \mbox{[}x, y, z\mbox{]} \\
\hline
\mbox{\tt in}  & {\em mu} & Chemical potential of each species \\
\hline
\mbox{\tt in}  & {\em max\-Species} & Maximum number of each species to allow in the system \\
\hline
\mbox{\tt in}  & {\em Mtot} & Total number of expanded ensemble states \\
\hline
\mbox{\tt in}  & {\em energy\-Hist\-Delta} & Bin width of energy histogram at each Ntot (optional, default = 10.\-0) \\
\hline
\mbox{\tt in}  & {\em max\-\_\-order} & Maximum order to record correlations to (default = 2) \\
\hline
\end{DoxyParams}


Definition at line 431 of file system.\-cpp.



References atoms, beta(), box(), ln\-F\-\_\-end, ln\-F\-\_\-start, max\-Species(), min\-Species(), mu(), n\-Crossover\-Visits, n\-Species(), num\-Species, ppot, restart\-From\-T\-M\-M\-C, restart\-From\-T\-M\-M\-C\-File, restart\-From\-W\-A\-L\-A, restart\-From\-W\-A\-L\-A\-File, species\-Barriers, S\-Y\-S\-\_\-\-F\-A\-I\-L\-U\-R\-E, total\-T\-M\-M\-C\-Sweeps, use\-T\-M\-M\-C, use\-W\-A\-L\-A, wala\-\_\-g, wala\-\_\-s, and wl\-Sweep\-Size.


\begin{DoxyCode}
431                                                                                                            
                                                                                                                  
                                                             \{
432     \textcolor{keywordflow}{if} ((\hyperlink{classsim_system_a8bff9dfb95b1b09a0fab2c1c485ade07}{box}.size() != 3) || (\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies} != \hyperlink{classsim_system_af1e3f5320aff976a448647244d5950d1}{mu}.size()) || (\hyperlink{classsim_system_a93259b517f449f1ac610d132ac66b551}{maxSpecies}.size() != 
      \hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies})) \{
433         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Invalid system initialization parameters"});
434         exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
435     \} \textcolor{keywordflow}{else} \{
436         nSpecies\_ = \hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies};
437         maxSpecies\_ = \hyperlink{classsim_system_a93259b517f449f1ac610d132ac66b551}{maxSpecies};
438         minSpecies\_ = \hyperlink{classsim_system_afafda4a09ed180ee9c5580d196d8ca9f}{minSpecies};
439         box\_ = \hyperlink{classsim_system_a8bff9dfb95b1b09a0fab2c1c485ade07}{box};
440         mu\_ = \hyperlink{classsim_system_af1e3f5320aff976a448647244d5950d1}{mu};
441         beta\_ = \hyperlink{classsim_system_a3eeec9678902f8d7fce4dad6064aaf4c}{beta};
442     \}
443 
444     \hyperlink{classsim_system_a794334e163fbeb4b4f61bcea676679ce}{lnF\_start} = 1.0; \textcolor{comment}{// default for lnF\_start}
445     \hyperlink{classsim_system_a3fb5d01fd3abf49f577c050968fba9d1}{lnF\_end} = 2.0e-18; \textcolor{comment}{// default for lnF\_end}
446     toggleKE\_ = \textcolor{keyword}{false}; \textcolor{comment}{//default, do NOT adjust energy by kinetic contribution of 3/2kT per atom (just
       record PE)}
447     \hyperlink{classsim_system_a78b107e20bcbf2f818264fa076de5db3}{totalTMMCSweeps} = 0;
448     \hyperlink{classsim_system_ae625e1026daee4f99f83fb73881875a1}{wlSweepSize} = 0;
449     \hyperlink{classsim_system_aa2e866e69ebe5fa0761894212592175a}{wala\_g} = 0.5;
450     \hyperlink{classsim_system_a7cc3431bb59acca9165b044dbd07dcdc}{wala\_s} = 0.8;
451     \hyperlink{classsim_system_aa748f651ddd9a2bf6d88bfcab9153905}{nCrossoverVisits} = 5;
452 
453     \textcolor{keywordflow}{if} (max\_order < 1)\{
454         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"max\_order must be >= 1"});
455     \}
456     max\_order\_ = max\_order;
457 
458     \textcolor{keywordflow}{if} (energyHistDelta <= 0) \{
459         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"energyHistDelta must be > 0"});
460     \}
461     energyHistDelta\_ = energyHistDelta;
462 
463     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < 3; ++i) \{
464         \textcolor{keywordflow}{if} (box\_[i] <= 0) \{
465             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Box dimensions must be > 0"});
466         \}
467     \}
468 
469     \textcolor{keywordflow}{if} (Mtot < 1) \{
470         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Total fractional states for expanded ensemble must be >= 1"})
      ;
471     \}
472     Mtot\_ = Mtot;
473     Mcurrent\_ = 0; \textcolor{comment}{// always start from fully inserted state}
474 
475     \textcolor{keywordflow}{try} \{
476         \hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}.resize(\hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies});
477     \} \textcolor{keywordflow}{catch} (std::exception &e) \{
478         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (e.what());
479     \}
480     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < \hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}; ++i) \{
481         \textcolor{keywordflow}{try} \{
482             \hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[i].resize(nSpecies);
483         \} \textcolor{keywordflow}{catch} (std::exception &e) \{
484             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (e.what());
485         \}
486     \}
487 
488     \textcolor{keywordflow}{try} \{
489         mass\_.resize(nSpecies, 1.0);
490     \} \textcolor{keywordflow}{catch} (std::exception &e) \{
491         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (e.what());
492     \}
493 
494     \textcolor{keywordflow}{try} \{
495         ppotSet\_.resize(nSpecies);
496     \} \textcolor{keywordflow}{catch} (std::exception &e) \{
497         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (e.what());
498     \}
499     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < \hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}; ++i) \{
500         \textcolor{keywordflow}{try} \{
501             ppotSet\_[i].resize(nSpecies, \textcolor{keyword}{false});
502         \} \textcolor{keywordflow}{catch} (std::exception &e) \{
503             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (e.what());
504         \}
505     \}
506 
507     \textcolor{comment}{// Wall potentials for each species, if there are any?}
508     \textcolor{keywordflow}{try} \{
509         \hyperlink{classsim_system_a5ae652ff4519f39c3862abae32a9581b}{speciesBarriers}.resize(nSpecies);
510     \} \textcolor{keywordflow}{catch} (std::exception &e) \{
511         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (e.what());
512     \}
513 
514     \textcolor{comment}{// Prepare vectors and matrices for cell lists.}
515     \textcolor{comment}{// It is crucial to reserve the correct number of cellLists in advance}
516     \textcolor{comment}{// since cellListsByPairType uses the addresses of cellLists. Otherwise,}
517     \textcolor{comment}{// if dynamic memory reallocation takes place, the pointers do not}
518     \textcolor{comment}{// correspond to initial values anymore, causing the simulation to crash.}
519     cellLists\_.reserve(nSpecies\_*nSpecies\_);
520 
521     \textcolor{keywordflow}{try} \{
522         useCellList\_.resize(nSpecies);
523         cellListsByPairType\_.resize(nSpecies);
524     \} \textcolor{keywordflow}{catch} (std::exception &e) \{
525         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (e.what());
526     \}
527     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < \hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}; ++i) \{
528         \textcolor{keywordflow}{try} \{
529             useCellList\_[i].resize(nSpecies);
530             cellListsByPairType\_[i].assign(nSpecies, NULL);
531         \} \textcolor{keywordflow}{catch} (std::exception &e) \{
532             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (e.what());
533         \}
534     \}
535 
536     totN\_ = 0;
537         \textcolor{keywordflow}{try} \{
538         \hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}.resize(nSpecies, 0);
539     \} \textcolor{keywordflow}{catch} (std::exception &e) \{
540         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (e.what());
541     \}
542 
543     \textcolor{keywordflow}{try} \{
544         \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}.resize(nSpecies);
545     \} \textcolor{keywordflow}{catch} (std::exception &e) \{
546         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (e.what());
547     \}
548     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < \hyperlink{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{nSpecies}; ++i) \{
549         \textcolor{keywordflow}{if} (minSpecies\_[i] < 0) \{
550             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Min species < 0"});
551         \}
552         \textcolor{keywordflow}{if} (maxSpecies\_[i] < minSpecies\_[i]) \{
553             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Max species < Min species"});
554         \}
555         \textcolor{keywordflow}{try} \{
556             \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[i].resize(maxSpecies\_[i], \hyperlink{classatom}{atom}());
557         \} \textcolor{keywordflow}{catch} (std::exception &e) \{
558             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (e.what());
559         \}
560     \}
561 
562     energy\_ = 0.0;
563 
564     \hyperlink{classsim_system_aa474a50b6353c8897331b1ab1ce53ab1}{useTMMC} = \textcolor{keyword}{false};
565     \hyperlink{classsim_system_aa83b00006b3919fb6e13f1bdeadece6a}{useWALA} = \textcolor{keyword}{false};
566 
567     totNBounds\_.resize(2, 0);
568     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < nSpecies\_; ++i) \{
569         totNBounds\_[0] += minSpecies\_[i];
570         totNBounds\_[1] += maxSpecies\_[i];
571     \}
572 
573     \textcolor{comment}{// allocate space for average U storage matrix - Shen and Errington method implies this size is always
       the same for}
574     \textcolor{comment}{// both single and multicomponent mixtures}
575     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} size = totNBounds\_[1] - totNBounds\_[0] + 1;
576     energyHistogram\_lb\_.resize(size, -5.0);
577     energyHistogram\_ub\_.resize(size, 5.0);
578     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < size; ++i) \{
579         energyHistogram\_lb\_[i] = -5.0;
580         energyHistogram\_ub\_[i] = 5.0;
581         \textcolor{keywordflow}{try} \{
582             \hyperlink{classdynamic__one__dim__histogram}{dynamic\_one\_dim\_histogram} dummyHist (energyHistogram\_lb\_[i], 
      energyHistogram\_ub\_[i], energyHistDelta\_);
583             energyHistogram\_.resize(i+1, dummyHist);
584         \} \textcolor{keywordflow}{catch} (std::bad\_alloc &ba) \{
585             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory for energy histogram for each Ntot"});
586         \}
587     \}
588     pkHistogram\_.resize(0);
589     \hyperlink{classdynamic__one__dim__histogram}{dynamic\_one\_dim\_histogram} dummyPkHist (0.0, totNBounds\_[1], 1.0);
590     \textcolor{keywordflow}{try} \{
591         std::vector < dynamic\_one\_dim\_histogram > tmp (totNBounds\_[1]-totNBounds\_[0]+1, dummyPkHist);
592         pkHistogram\_.resize(nSpecies\_, tmp);
593     \} \textcolor{keywordflow}{catch} (std::bad\_alloc &ba) \{
594         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory for particle histogram for each Ntot"});
595     \}
596 
597     \textcolor{comment}{// initialize moments}
598     std::vector < double > lbn (6,0), ubn(6,0);
599     std::vector < long long unsigned int > nbn (6,0);
600     ubn[0] = nSpecies\_-1;
601     ubn[1] = max\_order\_;
602     ubn[2] = nSpecies\_-1;
603     ubn[3] = max\_order\_;
604     ubn[4] = max\_order\_;
605     ubn[5] = totNBounds\_[1]-totNBounds\_[0];
606 
607     nbn[0] = nSpecies\_;
608     nbn[1] = max\_order\_+1;
609     nbn[2] = nSpecies\_;
610     nbn[3] = max\_order\_+1;
611     nbn[4] = max\_order\_+1;
612     nbn[5] = size;
613 
614     \hyperlink{classhistogram}{histogram} hnn (lbn, ubn, nbn);
615     extensive\_moments\_ = hnn;
616 
617     \hyperlink{classsim_system_a2b168c89742f4d64270583e7e54b2929}{restartFromWALA} = \textcolor{keyword}{false};
618     \hyperlink{classsim_system_a0c81d3b606c070c801f8d86288e44391}{restartFromTMMC} = \textcolor{keyword}{false};
619     \hyperlink{classsim_system_afbf0b172dc35572e71ec6d27a018e2fc}{restartFromWALAFile} = \textcolor{stringliteral}{""};
620     \hyperlink{classsim_system_a5ccdad82b3767ba21b1e4b1e36362082}{restartFromTMMCFile} = \textcolor{stringliteral}{""};
621 \}
\end{DoxyCode}
\hypertarget{classsim_system_abaa6ad6ea00aa437cf0b9ac8034af327}{\index{sim\-System@{sim\-System}!$\sim$sim\-System@{$\sim$sim\-System}}
\index{$\sim$sim\-System@{$\sim$sim\-System}!simSystem@{sim\-System}}
\subsubsection[{$\sim$sim\-System}]{\setlength{\rightskip}{0pt plus 5cm}sim\-System\-::$\sim$sim\-System (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classsim_system_abaa6ad6ea00aa437cf0b9ac8034af327}


Definition at line 410 of file system.\-cpp.



References tmmc\-Bias, use\-T\-M\-M\-C, use\-W\-A\-L\-A, and wl\-Bias.


\begin{DoxyCode}
410                        \{
411     \textcolor{keywordflow}{if} (\hyperlink{classsim_system_aa474a50b6353c8897331b1ab1ce53ab1}{useTMMC}) \{
412         \textcolor{keyword}{delete} \hyperlink{classsim_system_a13173f45a1e40a5f5a3552b0ebe15b54}{tmmcBias};
413     \}
414     \textcolor{keywordflow}{if} (\hyperlink{classsim_system_aa83b00006b3919fb6e13f1bdeadece6a}{useWALA}) \{
415         \textcolor{keyword}{delete} \hyperlink{classsim_system_a6dc8d9f89dfcfa247a59bc50889c49e7}{wlBias};
416     \}
417 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\hypertarget{classsim_system_a09c4ea670168c9f1d549d2a5120eb13c}{\index{sim\-System@{sim\-System}!add\-K\-E\-Correction@{add\-K\-E\-Correction}}
\index{add\-K\-E\-Correction@{add\-K\-E\-Correction}!simSystem@{sim\-System}}
\subsubsection[{add\-K\-E\-Correction}]{\setlength{\rightskip}{0pt plus 5cm}bool sim\-System\-::add\-K\-E\-Correction (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_a09c4ea670168c9f1d549d2a5120eb13c}


Definition at line 32 of file system.\-h.



Referenced by initialize(), delete\-Particle\-::make(), insert\-Particle\-::make(), and set\-Config().


\begin{DoxyCode}
32 \{ \textcolor{keywordflow}{return} toggleKE\_; \}
\end{DoxyCode}
\hypertarget{classsim_system_a5abdfae81ca00a79f162c0ce2b4307c9}{\index{sim\-System@{sim\-System}!add\-Potential@{add\-Potential}}
\index{add\-Potential@{add\-Potential}!simSystem@{sim\-System}}
\subsubsection[{add\-Potential}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::add\-Potential (
\begin{DoxyParamCaption}
\item[{const int}]{spec1, }
\item[{const int}]{spec2, }
\item[{const std\-::string}]{ppot\-\_\-name, }
\item[{const std\-::vector$<$ double $>$ \&}]{params, }
\item[{const bool}]{use\-Cell\-List = {\ttfamily false}, }
\item[{const std\-::string}]{tab\-File = {\ttfamily \char`\"{}\char`\"{}}}
\end{DoxyParamCaption}
)}}\label{classsim_system_a5abdfae81ca00a79f162c0ce2b4307c9}


Add a pair potential to the system which governs the pair (spec1, spec2). 

However, it only stores the pointer so the object must be fixed in memory somewhere else throughout the simulation.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em spec1} & Species index 1 ($>$= 0) \\
\hline
\mbox{\tt in}  & {\em spec2} & Species index 2 ($>$= 0) \\
\hline
\mbox{\tt in}  & {\em ppot\-\_\-name} & Name of pair potential \\
\hline
\mbox{\tt in}  & {\em params} & Vector of parameters which define pair potential \\
\hline
\mbox{\tt in}  & {\em bool} & Optional argument of whether or not to build and maintain a cell list for this pair (spec1, spec2) (default=false) \\
\hline
\mbox{\tt in}  & {\em tab\-File} & Optional argument use for tabulated potentials, this is the file to load from (default=\char`\"{}\char`\"{}) \\
\hline
\end{DoxyParams}


Definition at line 1223 of file system.\-cpp.



References num\-To\-Str(), ppot, send\-Err(), and send\-Msg().



Referenced by set\-Pair\-Potentials().


\begin{DoxyCode}
1223                                                                                                            
                                                                         \{
1224     \textcolor{keywordflow}{if} (spec1 >= nSpecies\_ || spec1 < 0) \{
1225         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Trying to define pair potential for species (1) that does
       not exist yet/is invalid"});
1226     \}
1227     \textcolor{keywordflow}{if} (spec2 >= nSpecies\_ || spec2 < 0) \{
1228         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Trying to define pair potential for species (2) that does
       not exist yet/is invalid"});
1229     \}
1230 
1231     \textcolor{keywordflow}{if} (ppot\_name == \textcolor{stringliteral}{"square\_well"}) \{
1232         \textcolor{keywordflow}{try} \{
1233             \textcolor{keyword}{auto} pp1 = std::make\_shared < squareWell > ();
1234             pp1->setParameters(params);
1235             \hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[spec1][spec2] = pp1;
1236             \textcolor{keyword}{auto} pp2 = std::make\_shared < squareWell > ();
1237             pp2->setParameters(params);
1238             \hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[spec2][spec1] = pp2;
1239         \} \textcolor{keywordflow}{catch} (std::exception &ex) \{
1240             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(ex.what());
1241         \}
1242     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ppot\_name == \textcolor{stringliteral}{"lennard\_jones"}) \{
1243         \textcolor{keywordflow}{try} \{
1244             \textcolor{keyword}{auto} pp1 = std::make\_shared < lennardJones > ();
1245             pp1->setParameters(params);
1246             \hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[spec1][spec2] = pp1;
1247             \textcolor{keyword}{auto} pp2 = std::make\_shared < lennardJones > ();
1248             pp2->setParameters(params);
1249             \hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[spec2][spec1] = pp2;
1250         \} \textcolor{keywordflow}{catch} (std::exception &ex) \{
1251             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(ex.what());
1252         \}
1253     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ppot\_name == \textcolor{stringliteral}{"fs\_lennard\_jones"}) \{
1254         \textcolor{keywordflow}{try} \{
1255             \textcolor{keyword}{auto} pp1 = std::make\_shared < fsLennardJones > ();
1256             pp1->setParameters(params);
1257             \hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[spec1][spec2] = pp1;
1258             \textcolor{keyword}{auto} pp2 = std::make\_shared < fsLennardJones > ();
1259             pp2->setParameters(params);
1260             \hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[spec2][spec1] = pp2;
1261         \} \textcolor{keywordflow}{catch} (std::exception &ex) \{
1262             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(ex.what());
1263         \}
1264     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ppot\_name == \textcolor{stringliteral}{"hard\_sphere"}) \{
1265         \textcolor{keywordflow}{try} \{
1266             \textcolor{keyword}{auto} pp1 = std::make\_shared < hardCore > ();
1267             pp1->setParameters(params);
1268             \hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[spec1][spec2] = pp1;
1269             \textcolor{keyword}{auto} pp2 = std::make\_shared < hardCore > ();
1270             pp2->setParameters(params);
1271             \hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[spec2][spec1] = pp2;
1272         \} \textcolor{keywordflow}{catch} (std::exception &ex) \{
1273             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(ex.what());
1274         \}
1275     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (ppot\_name == \textcolor{stringliteral}{"tabulated"}) \{
1276         \textcolor{keywordflow}{try} \{
1277             \textcolor{keyword}{auto} pp1 = std::make\_shared < tabulated > ();
1278             pp1->setParameters(params);
1279             pp1->loadPotential(tabFile);
1280             \hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[spec1][spec2] = pp1;
1281             \textcolor{keyword}{auto} pp2 = std::make\_shared < tabulated > ();
1282             pp2->setParameters(params);
1283             pp2->loadPotential(tabFile);
1284             \hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[spec2][spec1] = pp2;
1285         \} \textcolor{keywordflow}{catch} (std::exception &ex) \{
1286             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(ex.what());
1287         \}
1288     \} \textcolor{keywordflow}{else} \{
1289         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"Unrecognized pair potential name for species "}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(spec1)+\textcolor{stringliteral}{", "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(spec2));
1290     \}
1291 
1292     ppotSet\_[spec1][spec2] = \textcolor{keyword}{true};
1293     ppotSet\_[spec2][spec1] = \textcolor{keyword}{true};
1294 
1295     \textcolor{keywordflow}{if} (useCellList) \{
1296         \hyperlink{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}{sendMsg}(\textcolor{stringliteral}{"Setting up cell list for interactions between type "}+
      \hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(spec1)+\textcolor{stringliteral}{" and "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(spec2));
1297         \textcolor{comment}{// Add creation of cell lists}
1298         \textcolor{keywordflow}{if} ((\hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[spec1][spec2]->rcut() > box\_[0]/3.0) || (\hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[spec1][spec2]->rcut() > box\_[1]/3.0
      ) || (\hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[spec1][spec2] ->rcut() > box\_[2]/3.0)) \{
1299             \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Cutoff ("}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(\hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[spec1][spec2]->rcut())+\textcolor{stringliteral}{") larger than
       1.0/3.0 boxsize, disabling cell lists for this interaction"});
1300             useCellList\_[spec1][spec2] = \textcolor{keyword}{false};
1301             useCellList\_[spec2][spec1] = \textcolor{keyword}{false};
1302         \} \textcolor{keywordflow}{else} \{
1303             \hyperlink{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}{sendMsg}(\textcolor{stringliteral}{"Creating Cell list with r\_cut = "}+\hyperlink{utilities_8h_ae6ed8fadf719af789711a7c0e99f44bc}{numToStr}(
      \hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[spec1][spec2]->rcut()));
1304             useCellList\_[spec1][spec2] = \textcolor{keyword}{true};
1305             useCellList\_[spec2][spec1] = \textcolor{keyword}{true};
1306 
1307             std::vector <atom*> dummyList(0);
1308 
1309             \textcolor{keywordflow}{if} (cellListsByPairType\_[spec1][spec2] == NULL) \{
1310                 cellLists\_.push\_back(\hyperlink{classcell_list}{cellList}(box\_, \hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[spec1][spec2]->rcut(), dummyList));
1311                 cellListsByPairType\_[spec1][spec2] = &cellLists\_[cellLists\_.size()-1];
1312             \}
1313             \textcolor{keywordflow}{if} (cellListsByPairType\_[spec2][spec1] == NULL) \{
1314                 cellLists\_.push\_back(\hyperlink{classcell_list}{cellList}(box\_, \hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[spec2][spec1]->rcut(), dummyList));
1315                 cellListsByPairType\_[spec2][spec1] = &cellLists\_[cellLists\_.size()-1];
1316             \}
1317         \}
1318     \} \textcolor{keywordflow}{else} \{
1319         useCellList\_[spec1][spec2] = \textcolor{keyword}{false};
1320         useCellList\_[spec2][spec1] = \textcolor{keyword}{false};
1321     \}
1322 \}
\end{DoxyCode}
\hypertarget{classsim_system_a3eeec9678902f8d7fce4dad6064aaf4c}{\index{sim\-System@{sim\-System}!beta@{beta}}
\index{beta@{beta}!simSystem@{sim\-System}}
\subsubsection[{beta}]{\setlength{\rightskip}{0pt plus 5cm}const double sim\-System\-::beta (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_a3eeec9678902f8d7fce4dad6064aaf4c}


Return 1/k\-T. 



Definition at line 87 of file system.\-h.



Referenced by agg\-Vol\-Bias3\-::make(), delete\-Particle\-::make(), translate\-Particle\-::make(), swap\-Particles\-::make(), insert\-Particle\-::make(), and sim\-System().

\hypertarget{classsim_system_a8bff9dfb95b1b09a0fab2c1c485ade07}{\index{sim\-System@{sim\-System}!box@{box}}
\index{box@{box}!simSystem@{sim\-System}}
\subsubsection[{box}]{\setlength{\rightskip}{0pt plus 5cm}const std\-::vector$<$ double $>$ sim\-System\-::box (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_a8bff9dfb95b1b09a0fab2c1c485ade07}


Return the system box dimensions. 



Definition at line 104 of file system.\-h.



Referenced by check\-Bounds(), agg\-Vol\-Bias3\-::make(), delete\-Particle\-::make(), translate\-Particle\-::make(), swap\-Particles\-::make(), insert\-Particle\-::make(), set\-Barriers(), set\-Config(), set\-Moves(), and sim\-System().

\hypertarget{classsim_system_a176b9ff482f1d36bc0638538bcfe0670}{\index{sim\-System@{sim\-System}!check\-Energy\-Histogram\-Bounds@{check\-Energy\-Histogram\-Bounds}}
\index{check\-Energy\-Histogram\-Bounds@{check\-Energy\-Histogram\-Bounds}!simSystem@{sim\-System}}
\subsubsection[{check\-Energy\-Histogram\-Bounds}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::check\-Energy\-Histogram\-Bounds (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classsim_system_a176b9ff482f1d36bc0638538bcfe0670}


Monitor the energy histogram bounds at each Ntot. 



Definition at line 854 of file system.\-cpp.



Referenced by perform\-Crossover(), and perform\-W\-A\-L\-A().


\begin{DoxyCode}
854                                             \{
855     \textcolor{keywordflow}{if} (totN\_ >= totNBounds\_[0] && totN\_ <= totNBounds\_[1]) \{
856         \textcolor{keyword}{const} \textcolor{keywordtype}{int} address = totN\_-totNBounds\_[0];
857         energyHistogram\_lb\_[address] = std::min(energyHistogram\_lb\_[address], energy\_);
858         energyHistogram\_ub\_[address] = std::max(energyHistogram\_ub\_[address], energy\_);
859     \}
860 \}
\end{DoxyCode}
\hypertarget{classsim_system_a18e515d42d1d653bcac67d61701983eb}{\index{sim\-System@{sim\-System}!decrement\-M\-State@{decrement\-M\-State}}
\index{decrement\-M\-State@{decrement\-M\-State}!simSystem@{sim\-System}}
\subsubsection[{decrement\-M\-State}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::decrement\-M\-State (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classsim_system_a18e515d42d1d653bcac67d61701983eb}


Decrease the expanded ensemble state of the system by 1. 

Accounts for the periodicity of \mbox{[}0, M) 

Definition at line 16 of file system.\-cpp.


\begin{DoxyCode}
16                                  \{
17     Mcurrent\_--;
18     \textcolor{keywordflow}{if} (Mcurrent\_ < 0) \{
19         Mcurrent\_ += Mtot\_;
20     \}
21 \}
\end{DoxyCode}
\hypertarget{classsim_system_acabf4fc5b5b90bba62e1449ddb3646c6}{\index{sim\-System@{sim\-System}!delete\-Atom@{delete\-Atom}}
\index{delete\-Atom@{delete\-Atom}!simSystem@{sim\-System}}
\subsubsection[{delete\-Atom}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::delete\-Atom (
\begin{DoxyParamCaption}
\item[{const int}]{type\-Index, }
\item[{const int}]{atom\-Index, }
\item[{bool}]{override = {\ttfamily false}}
\end{DoxyParamCaption}
)}}\label{classsim_system_acabf4fc5b5b90bba62e1449ddb3646c6}


Delete an atom from the system. 

Does all the bookkeepping behind the scenes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em type\-Index} & What type the atom is ($>$= 0) \\
\hline
\mbox{\tt in}  & {\em atom\-Index} & Which atom {\itshape index} of type type\-Index to destroy ($>$= 0) \\
\hline
\mbox{\tt in}  & {\em Optional} & override command which allows the system to delete a particle even it goes below the minimum allowed. E.\-g. during a swap move. \\
\hline
\end{DoxyParams}


Definition at line 241 of file system.\-cpp.



References atoms, atom\-::m\-State, num\-Species, and cell\-List\-::swap\-And\-Delete\-Particle().



Referenced by delete\-Particle\-::make(), swap\-Particles\-::make(), and read\-Config().


\begin{DoxyCode}
241                                                                                    \{
242     \textcolor{keywordflow}{if} (typeIndex < nSpecies\_ && typeIndex >= 0) \{
243         \textcolor{keywordflow}{if} ((\hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[typeIndex] > minSpecies\_[typeIndex]) || ((
      \hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[typeIndex] == minSpecies\_[typeIndex]) && (Mcurrent\_ > 0)) || \textcolor{keyword}{override}) \{
244             \textcolor{keywordflow}{if} (\textcolor{keyword}{override}) \{
245                 \textcolor{comment}{// doing a swap move}
246                 \textcolor{keywordflow}{if} (Mtot\_ > 1) \{
247                     \textcolor{comment}{// expanded ensemble and not necessarily deleting the partial atom}
248 
249                     \textcolor{keywordtype}{int} end = \hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[typeIndex] - 1;
250                     \textcolor{keywordflow}{if} (fractionalAtomType\_ == typeIndex && Mcurrent\_ > 0) \{
251                         \textcolor{comment}{// we are deleting a particle which has to watch out for the partial atom}
252                         end++;
253                     \}
254 
255                     \textcolor{keywordflow}{if} (\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][atomIndex].mState == 0) \{
256                         \textcolor{comment}{// if we are removing a "full" particle, have to decrement Ntot, else not}
257                         \hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[typeIndex]--;
258                         totN\_--;
259                     \} \textcolor{keywordflow}{else} \{
260                         \textcolor{comment}{// but if removing the partial particle, M is affected}
261                         Mcurrent\_ = 0; \textcolor{comment}{// regardless of how M was originally, the partial particle is now
       "entirely" gone}
262                     \}
263 
264                     \textcolor{keywordtype}{bool} replace = \textcolor{keyword}{false};
265                     \textcolor{keywordflow}{if} (&\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][end] == fractionalAtom\_) \{
266                         \textcolor{comment}{// then the fractional atom is about to be used to replace a "full" one}
267                         replace = \textcolor{keyword}{true};
268                     \}
269 
270                     \textcolor{comment}{// have to entirely remove the particle}
271                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < nSpecies\_; ++i) \{
272                         \textcolor{keywordflow}{if} (useCellList\_[typeIndex][i]) \{
273                             \hyperlink{classcell_list}{cellList}* cl = cellListsByPairType\_[typeIndex][i];
274                             cl->\hyperlink{classcell_list_a31caca1e8dd05c33215ac7495d55aeea}{swapAndDeleteParticle}(&
      \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][atomIndex], &\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][end]);
275                         \}
276                     \}
277 
278                     \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][atomIndex] = \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][end];    \textcolor{comment}{// "replacement"
       operation}
279 
280                     \textcolor{keywordflow}{if} (replace) \{
281                         fractionalAtom\_ = &\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][atomIndex];    \textcolor{comment}{// update the pointer if
       necessary}
282                     \}
283                 \} \textcolor{keywordflow}{else} \{
284                     \textcolor{comment}{// no expanded ensemble, just delete particle from appropriate cell list}
285                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < nSpecies\_; ++i) \{
286                         \textcolor{keywordflow}{if} (useCellList\_[typeIndex][i]) \{
287                             \hyperlink{classcell_list}{cellList}* cl = cellListsByPairType\_[typeIndex][i];
288                             cl->\hyperlink{classcell_list_a31caca1e8dd05c33215ac7495d55aeea}{swapAndDeleteParticle}(&
      \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][atomIndex], &\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][\hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[typeIndex] - 1]);
289                         \}
290                     \}
291 
292                     \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][atomIndex] = \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][
      \hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[typeIndex] - 1];    \textcolor{comment}{// "replacement" operation}
293                     numSpecies[typeIndex]--;
294                     totN\_--;
295                 \}
296             \} \textcolor{keywordflow}{else} \{
297                 \textcolor{comment}{// not doing a swap move, just a "regular" deletion}
298                 \textcolor{keywordflow}{if} (Mtot\_ > 1) \{
299                     \textcolor{comment}{// expanded ensemble}
300                     \textcolor{keywordflow}{if} (Mcurrent\_ == 1) \{
301                         \textcolor{comment}{// when we delete this atom, it is entirely gone}
302 
303                         \textcolor{comment}{// first ensure the system pointer is correct if currently a partially inserted
       atom}
304                         \textcolor{keywordflow}{if} (fractionalAtom\_ != &\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][atomIndex] || typeIndex != 
      fractionalAtomType\_) \{
305                             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Fractional atom pointer does not point
       to atom belived to be inserted"});
306                         \}
307 
308                         \textcolor{comment}{// decrement expanded state}
309                         fractionalAtom\_->\hyperlink{classatom_a3cb00c0c5b7533657e05af6ff4a42740}{mState} = 0;
310                         Mcurrent\_ = 0;
311 
312                         \textcolor{comment}{// since deleting partial particle, do not update Ntot, etc.}
313                         \textcolor{comment}{// however, do have to remove from cellLists}
314                         \textcolor{keywordtype}{int} end = \hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[typeIndex]; \textcolor{comment}{// includes space for the partially
       inserted one currently in cellList}
315                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < nSpecies\_; ++i) \{
316                             \textcolor{keywordflow}{if} (useCellList\_[typeIndex][i]) \{
317                                 \hyperlink{classcell_list}{cellList}* cl = cellListsByPairType\_[typeIndex][i];
318                                 cl->\hyperlink{classcell_list_a31caca1e8dd05c33215ac7495d55aeea}{swapAndDeleteParticle}(&
      \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][atomIndex], &\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][end]);
319                             \}
320                         \}
321 
322                         \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][atomIndex] = \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][end];    \textcolor{comment}{// "replacement"
       operation}
323 
324                     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (Mcurrent\_ == 0) \{
325                         \textcolor{comment}{// have to decrement Ntot, but keep in cell lists}
326                         \hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[typeIndex]--;
327                         totN\_--;
328 
329                         \textcolor{comment}{// this is a new fractional atom}
330                         fractionalAtom\_ = &\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][atomIndex];
331                         fractionalAtomType\_ = typeIndex;
332 
333                         \textcolor{comment}{// decrement expanded state}
334                         fractionalAtom\_->\hyperlink{classatom_a3cb00c0c5b7533657e05af6ff4a42740}{mState} = Mtot\_-1;
335                         Mcurrent\_ = Mtot\_-1;
336                     \} \textcolor{keywordflow}{else} \{
337                         \textcolor{comment}{// further deleting an atom that already partially exists in the system, but
       remains in cell lists}
338 
339                         \textcolor{comment}{// first ensure the system pointer is correct if currently a partially inserted
       atom}
340                         \textcolor{keywordflow}{if} (fractionalAtom\_ != &\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][atomIndex] || typeIndex != 
      fractionalAtomType\_) \{
341                             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Fractional atom pointer does not point
       to atom belived to be inserted"});
342                         \}
343 
344                         \textcolor{comment}{// decrement expanded state}
345                         fractionalAtom\_->\hyperlink{classatom_a3cb00c0c5b7533657e05af6ff4a42740}{mState} -= 1;
346                         Mcurrent\_ -= 1;
347                     \}
348                 \} \textcolor{keywordflow}{else} \{
349                     \textcolor{comment}{// no expanded ensemble, just delete particle from appropriate cell list}
350                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < nSpecies\_; ++i) \{
351                         \textcolor{keywordflow}{if} (useCellList\_[typeIndex][i]) \{
352                             \hyperlink{classcell_list}{cellList}* cl = cellListsByPairType\_[typeIndex][i];
353                             cl->\hyperlink{classcell_list_a31caca1e8dd05c33215ac7495d55aeea}{swapAndDeleteParticle}(&
      \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][atomIndex], &\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][\hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[typeIndex] - 1]);
354                         \}
355                     \}
356 
357                     \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][atomIndex] = \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][
      \hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[typeIndex] - 1];    \textcolor{comment}{// "replacement" operation}
358                     numSpecies[typeIndex]--;
359                     totN\_--;
360                 \}
361             \}
362         \} \textcolor{keywordflow}{else} \{
363             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"System going below minimum allowable number of atoms,
       cannot delete an atom of type index "}+std::to\_string(typeIndex));
364         \}
365     \} \textcolor{keywordflow}{else} \{
366         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"That species index does not exist, cannot delete an atom"});
367     \}
368 \}
\end{DoxyCode}
\hypertarget{classsim_system_a37b3d15faf56bf31349f5c2aaf02f858}{\index{sim\-System@{sim\-System}!energy@{energy}}
\index{energy@{energy}!simSystem@{sim\-System}}
\subsubsection[{energy}]{\setlength{\rightskip}{0pt plus 5cm}const double sim\-System\-::energy (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_a37b3d15faf56bf31349f5c2aaf02f858}


Return the system's instantaneous energy. 



Definition at line 84 of file system.\-h.



Referenced by sanity\-Checks().

\hypertarget{classsim_system_a1744c4c22603662081d75985bc30b754}{\index{sim\-System@{sim\-System}!ext\-Mom\-Counter@{ext\-Mom\-Counter}}
\index{ext\-Mom\-Counter@{ext\-Mom\-Counter}!simSystem@{sim\-System}}
\subsubsection[{ext\-Mom\-Counter}]{\setlength{\rightskip}{0pt plus 5cm}const std\-::vector$<$ double $>$ sim\-System\-::ext\-Mom\-Counter (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_a1744c4c22603662081d75985bc30b754}


Get counter for extensive moments needed for restarting system from a checkpoint. 



Definition at line 103 of file system.\-h.



References histogram\-::get\-Counter().



Referenced by checkpoint\-::dump().

\hypertarget{classsim_system_a299fe4372e610b554eaaf5f5957b2dbc}{\index{sim\-System@{sim\-System}!get\-Current\-M@{get\-Current\-M}}
\index{get\-Current\-M@{get\-Current\-M}!simSystem@{sim\-System}}
\subsubsection[{get\-Current\-M}]{\setlength{\rightskip}{0pt plus 5cm}const int sim\-System\-::get\-Current\-M (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_a299fe4372e610b554eaaf5f5957b2dbc}


Return the system's current expanded ensemble fractional state. 



Definition at line 80 of file system.\-h.



Referenced by calculate\-Bias(), agg\-Vol\-Bias3\-::make(), translate\-Particle\-::make(), delete\-Particle\-::make(), insert\-Particle\-::make(), swap\-Particles\-::make(), moves\-::make\-Move(), perform\-Crossover(), perform\-T\-M\-M\-C(), perform\-W\-A\-L\-A(), and sanity\-Checks().

\hypertarget{classsim_system_a610cbb1c6059151e420dbd42dd9da714}{\index{sim\-System@{sim\-System}!get\-E\-L\-B@{get\-E\-L\-B}}
\index{get\-E\-L\-B@{get\-E\-L\-B}!simSystem@{sim\-System}}
\subsubsection[{get\-E\-L\-B}]{\setlength{\rightskip}{0pt plus 5cm}std\-::vector$<$ double $>$ sim\-System\-::get\-E\-L\-B (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_a610cbb1c6059151e420dbd42dd9da714}


Returns current tally of energy min at each Ntot for checkpointing. 



Definition at line 105 of file system.\-h.



Referenced by checkpoint\-::dump().

\hypertarget{classsim_system_ae87e0ac03cc11259cd3b44c780a90a06}{\index{sim\-System@{sim\-System}!get\-E\-U\-B@{get\-E\-U\-B}}
\index{get\-E\-U\-B@{get\-E\-U\-B}!simSystem@{sim\-System}}
\subsubsection[{get\-E\-U\-B}]{\setlength{\rightskip}{0pt plus 5cm}std\-::vector$<$ double $>$ sim\-System\-::get\-E\-U\-B (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_ae87e0ac03cc11259cd3b44c780a90a06}


Returns current tally of energy max at each Ntot for checkpointing. 



Definition at line 106 of file system.\-h.



Referenced by checkpoint\-::dump().

\hypertarget{classsim_system_a2ab77377c60e0e3109a6e875690b0ab7}{\index{sim\-System@{sim\-System}!get\-Fractional\-Atom@{get\-Fractional\-Atom}}
\index{get\-Fractional\-Atom@{get\-Fractional\-Atom}!simSystem@{sim\-System}}
\subsubsection[{get\-Fractional\-Atom}]{\setlength{\rightskip}{0pt plus 5cm}{\bf atom}$\ast$ sim\-System\-::get\-Fractional\-Atom (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_a2ab77377c60e0e3109a6e875690b0ab7}


Returns a pointer the atom in the system that is currently only fractionally inserted/deleted. 



Definition at line 110 of file system.\-h.



Referenced by delete\-Particle\-::make(), translate\-Particle\-::make(), swap\-Particles\-::make(), insert\-Particle\-::make(), and sanity\-Checks().

\hypertarget{classsim_system_a0500a9e84eecfbde7a98cf8a34f719d5}{\index{sim\-System@{sim\-System}!get\-Fractional\-Atom\-Type@{get\-Fractional\-Atom\-Type}}
\index{get\-Fractional\-Atom\-Type@{get\-Fractional\-Atom\-Type}!simSystem@{sim\-System}}
\subsubsection[{get\-Fractional\-Atom\-Type}]{\setlength{\rightskip}{0pt plus 5cm}const int sim\-System\-::get\-Fractional\-Atom\-Type (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_a0500a9e84eecfbde7a98cf8a34f719d5}


Return the atom type of the fractional atom. 



Definition at line 82 of file system.\-h.



Referenced by agg\-Vol\-Bias3\-::make(), translate\-Particle\-::make(), swap\-Particles\-::make(), moves\-::make\-Move(), and sanity\-Checks().

\hypertarget{classsim_system_afe08187d318113c33bda890c69570c36}{\index{sim\-System@{sim\-System}!get\-Max\-Order@{get\-Max\-Order}}
\index{get\-Max\-Order@{get\-Max\-Order}!simSystem@{sim\-System}}
\subsubsection[{get\-Max\-Order}]{\setlength{\rightskip}{0pt plus 5cm}const int sim\-System\-::get\-Max\-Order (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_afe08187d318113c33bda890c69570c36}


Return the max order the extensive moments are being stored out to. 



Definition at line 78 of file system.\-h.



Referenced by restart\-Ext\-Moments(), and set\-Config().

\hypertarget{classsim_system_a9b3aeefa22c3b50b5913df6eea753bc6}{\index{sim\-System@{sim\-System}!get\-Neighbor\-Atoms@{get\-Neighbor\-Atoms}}
\index{get\-Neighbor\-Atoms@{get\-Neighbor\-Atoms}!simSystem@{sim\-System}}
\subsubsection[{get\-Neighbor\-Atoms}]{\setlength{\rightskip}{0pt plus 5cm}std\-::vector$<$ {\bf atom} $\ast$ $>$ sim\-System\-::get\-Neighbor\-Atoms (
\begin{DoxyParamCaption}
\item[{const unsigned int}]{type\-Index\-A, }
\item[{const unsigned int}]{type\-Index\-B, }
\item[{{\bf atom} $\ast$}]{\-\_\-atom}
\end{DoxyParamCaption}
)}}\label{classsim_system_a9b3aeefa22c3b50b5913df6eea753bc6}


Return the list of neighbors of type A, around a particle of type B which is passed. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em type\-Index\-A} & Index of first atom type \\
\hline
\mbox{\tt in}  & {\em type\-Index\-B} & Index of second atom type \\
\hline
\mbox{\tt in}  & {\em atom} & Pointer to atom to find neighbors around\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
neighbor\-\_\-list 
\end{DoxyReturn}


Definition at line 1498 of file system.\-cpp.



References atoms, cell\-List\-::calc\-Index(), cell\-List\-::cells, cell\-List\-::neighbours, num\-Species, and atom\-::pos.



Referenced by delete\-Particle\-::make(), translate\-Particle\-::make(), swap\-Particles\-::make(), and insert\-Particle\-::make().


\begin{DoxyCode}
1498                                                                                                            
                    \{
1499     std::vector < atom* > neighbors;
1500 
1501     \textcolor{keywordtype}{int} end = \hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[typeIndexA];
1502     \textcolor{keywordflow}{if} (Mcurrent\_ > 0 && typeIndexA == fractionalAtomType\_) \{
1503         \textcolor{comment}{// account for partial atom too}
1504         end++;
1505     \}
1506     neighbors.reserve(end);
1507 
1508     \textcolor{comment}{// if no cell lists are defined for this interaction, return all particles}
1509     \textcolor{keywordflow}{if} (!useCellList\_[typeIndexA][typeIndexB]) \{
1510         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < end; ++i) \{
1511             \textcolor{keywordflow}{if} (\_atom != &\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndexA][i]) \{ \textcolor{comment}{// watch out for self in case typeA = typeB}
1512                 neighbors.push\_back(&\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndexA][i]);
1513             \}
1514         \}
1515     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (useCellList\_[typeIndexA][typeIndexB]) \{
1516         \hyperlink{classcell_list}{cellList}* cl = cellListsByPairType\_[typeIndexA][typeIndexB];
1517         \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} cellIndex = cl->\hyperlink{classcell_list_aa6b843131cd487164a137571c7343cab}{calcIndex}(\_atom->\hyperlink{classatom_a3ae5f4880e7831d8b2c9fda72b4eb24a}{pos}[0], \_atom->
      \hyperlink{classatom_a3ae5f4880e7831d8b2c9fda72b4eb24a}{pos}[1], \_atom->\hyperlink{classatom_a3ae5f4880e7831d8b2c9fda72b4eb24a}{pos}[2]);
1518 
1519         \textcolor{comment}{// loop over own cell}
1520         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < cl->\hyperlink{classcell_list_a10bc0c3ae819293b1e88bc7d1bfdb2aa}{cells}[cellIndex].size(); ++i) \{
1521             \textcolor{keywordflow}{if} (\_atom != cl->\hyperlink{classcell_list_a10bc0c3ae819293b1e88bc7d1bfdb2aa}{cells}[cellIndex][i]) \{
1522                 neighbors.push\_back(cl->\hyperlink{classcell_list_a10bc0c3ae819293b1e88bc7d1bfdb2aa}{cells}[cellIndex][i]);
1523             \}
1524         \}
1525 
1526         \textcolor{comment}{// loop over neighboring cells}
1527         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < cl->\hyperlink{classcell_list_ada607886d0e5a20d710dde694d6d989f}{neighbours}[cellIndex].size(); ++i) \{
1528             \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} neighborCellIndex = cl->\hyperlink{classcell_list_ada607886d0e5a20d710dde694d6d989f}{neighbours}[cellIndex][i];
1529             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < cl->\hyperlink{classcell_list_a10bc0c3ae819293b1e88bc7d1bfdb2aa}{cells}[neighborCellIndex].size(); ++j) \{
1530                 \textcolor{keywordflow}{if} (\_atom != cl->\hyperlink{classcell_list_a10bc0c3ae819293b1e88bc7d1bfdb2aa}{cells}[neighborCellIndex][j]) \{
1531                     neighbors.push\_back(cl->\hyperlink{classcell_list_a10bc0c3ae819293b1e88bc7d1bfdb2aa}{cells}[neighborCellIndex][j]);
1532                 \}
1533             \}
1534         \}
1535     \}
1536 
1537     \textcolor{keywordflow}{return} neighbors;
1538 \}
\end{DoxyCode}
\hypertarget{classsim_system_aa31d40c91cb50f143a9613d362798887}{\index{sim\-System@{sim\-System}!get\-T\-M\-M\-C\-Bias@{get\-T\-M\-M\-C\-Bias}}
\index{get\-T\-M\-M\-C\-Bias@{get\-T\-M\-M\-C\-Bias}!simSystem@{sim\-System}}
\subsubsection[{get\-T\-M\-M\-C\-Bias}]{\setlength{\rightskip}{0pt plus 5cm}{\bf tmmc} $\ast$ sim\-System\-::get\-T\-M\-M\-C\-Bias (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classsim_system_aa31d40c91cb50f143a9613d362798887}


Return pointer to the T\-M\-M\-C bias. 

Return a pointer to the T\-M\-M\-C biasing object, if using T\-M\-M\-C, else throws an exception.

\begin{DoxyReturn}{Returns}
tmmc Pointer to T\-M\-M\-C biasing object being used. 
\end{DoxyReturn}


Definition at line 1688 of file system.\-cpp.



References tmmc\-Bias, and use\-T\-M\-M\-C.



Referenced by checkpoint\-::dump(), checkpoint\-::load(), perform\-Crossover(), and perform\-T\-M\-M\-C().


\begin{DoxyCode}
1688                               \{
1689     \textcolor{keywordflow}{if} (\hyperlink{classsim_system_aa474a50b6353c8897331b1ab1ce53ab1}{useTMMC} == \textcolor{keyword}{true}) \{
1690         \textcolor{keywordflow}{return} \hyperlink{classsim_system_a13173f45a1e40a5f5a3552b0ebe15b54}{tmmcBias};
1691     \} \textcolor{keywordflow}{else} \{
1692         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Not using TMMC"});
1693     \}
1694 \}
\end{DoxyCode}
\hypertarget{classsim_system_aa4ad1afff101bb530e1590df05035276}{\index{sim\-System@{sim\-System}!get\-Total\-M@{get\-Total\-M}}
\index{get\-Total\-M@{get\-Total\-M}!simSystem@{sim\-System}}
\subsubsection[{get\-Total\-M}]{\setlength{\rightskip}{0pt plus 5cm}const int sim\-System\-::get\-Total\-M (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_aa4ad1afff101bb530e1590df05035276}


Return the total number of fractional states available to species in the expanded ensemble. 



Definition at line 81 of file system.\-h.



Referenced by checkpoint\-::load(), delete\-Particle\-::make(), insert\-Particle\-::make(), moves\-::make\-Move(), perform\-Crossover(), perform\-T\-M\-M\-C(), perform\-W\-A\-L\-A(), sanity\-Checks(), set\-Barriers(), set\-Config(), and set\-Moves().

\hypertarget{classsim_system_a37dd827f4057049763351510147b9f1d}{\index{sim\-System@{sim\-System}!get\-Tot\-N@{get\-Tot\-N}}
\index{get\-Tot\-N@{get\-Tot\-N}!simSystem@{sim\-System}}
\subsubsection[{get\-Tot\-N}]{\setlength{\rightskip}{0pt plus 5cm}const int sim\-System\-::get\-Tot\-N (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_a37dd827f4057049763351510147b9f1d}


Return a sum of the total number of atoms currently in the system. 



Definition at line 77 of file system.\-h.



Referenced by calculate\-Bias(), agg\-Vol\-Bias3\-::make(), delete\-Particle\-::make(), translate\-Particle\-::make(), insert\-Particle\-::make(), swap\-Particles\-::make(), and sanity\-Checks().

\hypertarget{classsim_system_a7cb5049de8b0988349e89e30e4000407}{\index{sim\-System@{sim\-System}!get\-W\-A\-L\-A\-Bias@{get\-W\-A\-L\-A\-Bias}}
\index{get\-W\-A\-L\-A\-Bias@{get\-W\-A\-L\-A\-Bias}!simSystem@{sim\-System}}
\subsubsection[{get\-W\-A\-L\-A\-Bias}]{\setlength{\rightskip}{0pt plus 5cm}{\bf wala} $\ast$ sim\-System\-::get\-W\-A\-L\-A\-Bias (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classsim_system_a7cb5049de8b0988349e89e30e4000407}


Return pointer to the Wang-\/\-Landau bias. 

Return a pointer to the T\-M\-M\-C biasing object, if using T\-M\-M\-C, else throws an exception.

\begin{DoxyReturn}{Returns}
wala Pointer to W\-A\-L\-A biasing object being used. 
\end{DoxyReturn}


Definition at line 1701 of file system.\-cpp.



References use\-W\-A\-L\-A, and wl\-Bias.



Referenced by checkpoint\-::dump(), checkpoint\-::load(), agg\-Vol\-Bias3\-::make(), translate\-Particle\-::make(), delete\-Particle\-::make(), swap\-Particles\-::make(), insert\-Particle\-::make(), perform\-Crossover(), and perform\-W\-A\-L\-A().


\begin{DoxyCode}
1701                               \{
1702     \textcolor{keywordflow}{if} (\hyperlink{classsim_system_aa83b00006b3919fb6e13f1bdeadece6a}{useWALA} == \textcolor{keyword}{true}) \{
1703         \textcolor{keywordflow}{return} \hyperlink{classsim_system_a6dc8d9f89dfcfa247a59bc50889c49e7}{wlBias};
1704     \} \textcolor{keywordflow}{else} \{
1705         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Not using WALA"});
1706     \}
1707 \}
\end{DoxyCode}
\hypertarget{classsim_system_a6ad31c08955b80873f865b3069618dcb}{\index{sim\-System@{sim\-System}!increment\-Energy@{increment\-Energy}}
\index{increment\-Energy@{increment\-Energy}!simSystem@{sim\-System}}
\subsubsection[{increment\-Energy}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::increment\-Energy (
\begin{DoxyParamCaption}
\item[{const double}]{d\-U}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_a6ad31c08955b80873f865b3069618dcb}


Increment the system's energy. 



Definition at line 34 of file system.\-h.



Referenced by agg\-Vol\-Bias3\-::make(), translate\-Particle\-::make(), delete\-Particle\-::make(), insert\-Particle\-::make(), and swap\-Particles\-::make().

\hypertarget{classsim_system_a5d61d583a40931ce5643bd6429f510ba}{\index{sim\-System@{sim\-System}!increment\-M\-State@{increment\-M\-State}}
\index{increment\-M\-State@{increment\-M\-State}!simSystem@{sim\-System}}
\subsubsection[{increment\-M\-State}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::increment\-M\-State (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classsim_system_a5d61d583a40931ce5643bd6429f510ba}


Increase the expanded ensemble state of the system by 1. 

Accounts for the periodicity of \mbox{[}0, M) 

Definition at line 6 of file system.\-cpp.


\begin{DoxyCode}
6                                  \{
7     Mcurrent\_++;
8     \textcolor{keywordflow}{if} (Mcurrent\_ == Mtot\_) \{
9         Mcurrent\_ = 0;
10     \}
11 \}
\end{DoxyCode}
\hypertarget{classsim_system_a0404e9435cc046d19b6bb990678ee069}{\index{sim\-System@{sim\-System}!insert\-Atom@{insert\-Atom}}
\index{insert\-Atom@{insert\-Atom}!simSystem@{sim\-System}}
\subsubsection[{insert\-Atom}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::insert\-Atom (
\begin{DoxyParamCaption}
\item[{const int}]{type\-Index, }
\item[{{\bf atom} $\ast$}]{new\-Atom, }
\item[{bool}]{override = {\ttfamily false}}
\end{DoxyParamCaption}
)}}\label{classsim_system_a0404e9435cc046d19b6bb990678ee069}


Insert an atom into the system. 

Does all the bookkeepping behind the scenes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em type\-Index} & What type the atom is ($>$= 0) \\
\hline
\mbox{\tt in}  & {\em new\-Atom} & Pointer to new atom. A copy is stored in the system so the original may be destroyed. \\
\hline
\mbox{\tt in}  & {\em override} & Override command that prevents the expanded ensemble state from being changed. Used during swap moves where \char`\"{}insertions\char`\"{} are temporary. \\
\hline
\end{DoxyParams}


Definition at line 140 of file system.\-cpp.



References atoms, cell\-List\-::insert\-Particle(), atom\-::m\-State, and num\-Species.



Referenced by insert\-Particle\-::make(), swap\-Particles\-::make(), and read\-Config().


\begin{DoxyCode}
140                                                                              \{
141     \textcolor{keywordflow}{if} (typeIndex < nSpecies\_ && typeIndex >= 0) \{
142         \textcolor{keywordflow}{if} (\hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[typeIndex] < maxSpecies\_[typeIndex]) \{
143             \textcolor{keywordflow}{if} (Mtot\_ > 1 && !\textcolor{keyword}{override}) \{
144                 \textcolor{comment}{// expanded ensemble behavior, "normal" insertion and deletion}
145                 \textcolor{keywordflow}{if} (Mcurrent\_ > 0) \{ \textcolor{comment}{// further inserting an atom that already partially exists in the
       system}
146                     \textcolor{comment}{// ensure the system pointer is correct if currently a partially inserted atom}
147                     \textcolor{keywordflow}{if} (fractionalAtom\_ != newAtom || typeIndex != fractionalAtomType\_) \{
148                         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Fractional atom pointer does not point to
       atom believed to be inserted"});
149                     \}
150 
151                     \textcolor{comment}{// increment expanded state}
152                     fractionalAtom\_->\hyperlink{classatom_a3cb00c0c5b7533657e05af6ff4a42740}{mState}++;
153                     Mcurrent\_++;
154 
155                     \textcolor{comment}{// check if now fully inserted}
156                     \textcolor{keywordflow}{if} (fractionalAtom\_->\hyperlink{classatom_a3cb00c0c5b7533657e05af6ff4a42740}{mState} == Mtot\_) \{
157                         fractionalAtom\_->\hyperlink{classatom_a3cb00c0c5b7533657e05af6ff4a42740}{mState} = 0;
158                         Mcurrent\_ = 0;
159                         totN\_++;
160                         \hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[typeIndex]++;
161                     \}
162                 \} \textcolor{keywordflow}{else} \{
163                     \textcolor{comment}{// inserting a new atom for the first time}
164                     \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][\hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[typeIndex]] = (*newAtom);
165 
166                     \textcolor{comment}{// assign fractional atom}
167                     fractionalAtom\_ = &\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][numSpecies[typeIndex]];
168                     fractionalAtomType\_ = typeIndex;
169 
170                     \textcolor{comment}{// increment expanded state}
171                     fractionalAtom\_->\hyperlink{classatom_a3cb00c0c5b7533657e05af6ff4a42740}{mState} = 1;
172                     Mcurrent\_ = 1;
173 
174                     \textcolor{comment}{// add particle into appropriate cell lists}
175                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < nSpecies\_; ++i) \{
176                         \textcolor{keywordflow}{if} (useCellList\_[typeIndex][i]) \{
177                             \hyperlink{classcell_list}{cellList}* cl = cellListsByPairType\_[typeIndex][i];
178                             cl->\hyperlink{classcell_list_a56c0012eed483e47248f9065bfc70fce}{insertParticle}(&\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][numSpecies[typeIndex]])
      ; \textcolor{comment}{// numSpecies[typeIndex] is the number of fully inserted ones, this partially inserted one comes after
       that}
179                         \}
180                     \}
181                 \}
182             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (Mtot\_ > 1 && \textcolor{keyword}{override}) \{
183                 \textcolor{comment}{// expanded ensemble behavior, but now amidst a "swap move" rather than an actual insertion
       or deletion.}
184                 \textcolor{comment}{// for this, insertions involve just putting the atom "back" into the system / cellLists
       after being artificially completely removed}
185 
186                 \textcolor{comment}{// ensure we insert at the proper "end"}
187                 \textcolor{keywordtype}{int} end = numSpecies[typeIndex];
188                 \textcolor{keywordflow}{if} (Mcurrent\_ > 0 && typeIndex == fractionalAtomType\_ && newAtom->
      \hyperlink{classatom_a3cb00c0c5b7533657e05af6ff4a42740}{mState} == 0) \{
189                     end++; \textcolor{comment}{// insert after the partially inserted one since newAtom is NOT the partial one}
190                 \}
191                 \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][end] = (*newAtom);
192 
193                 \textcolor{comment}{// if we just added a partially inserted/deleted particle back to the system, need to
       update the pointer}
194                 \textcolor{keywordflow}{if} (\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][end].mState != 0) \{
195                     fractionalAtom\_ = &\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][end];
196                     fractionalAtomType\_ = typeIndex;
197 
198                     \textcolor{comment}{// set the system's mState back to that of the atom just inserted, iff it was the
       partial one}
199                     Mcurrent\_ = \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][end].mState;
200                 \} \textcolor{keywordflow}{else} \{
201                     totN\_++; \textcolor{comment}{// we just added a "full" atom}
202                     numSpecies[typeIndex]++; \textcolor{comment}{// we just added a "full" atom}
203                 \}
204 
205                 \textcolor{comment}{// put newAtom into the cell lists whatever its state}
206                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < nSpecies\_; ++i) \{
207                     \textcolor{keywordflow}{if} (useCellList\_[typeIndex][i]) \{
208                         \hyperlink{classcell_list}{cellList}* cl = cellListsByPairType\_[typeIndex][i];
209                         cl->\hyperlink{classcell_list_a56c0012eed483e47248f9065bfc70fce}{insertParticle}(&\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][end]);
210                     \}
211                 \}
212             \} \textcolor{keywordflow}{else} \{
213                 \textcolor{comment}{// direct insertion (no expanded ensemble)}
214                 \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][numSpecies[typeIndex]] = (*newAtom);
215                 numSpecies[typeIndex]++;
216                 totN\_++;
217 
218                 \textcolor{comment}{// add particle into appropriate cell lists}
219                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < nSpecies\_; ++i) \{
220                     \textcolor{keywordflow}{if} (useCellList\_[typeIndex][i]) \{
221                         \hyperlink{classcell_list}{cellList}* cl = cellListsByPairType\_[typeIndex][i];
222                         cl->\hyperlink{classcell_list_a56c0012eed483e47248f9065bfc70fce}{insertParticle}(&\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][numSpecies[typeIndex] - 1])
      ;
223                     \}
224                 \}
225             \}
226         \} \textcolor{keywordflow}{else} \{
227             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Reached upper bound, cannot insert an atom of type index
       "}+std::to\_string(typeIndex));
228         \}
229     \} \textcolor{keywordflow}{else} \{
230         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"That species index does not exist, cannot insert an atom"});
231     \}
232 \}
\end{DoxyCode}
\hypertarget{classsim_system_a7c75052458072e1267bc20594b58d8cd}{\index{sim\-System@{sim\-System}!mass@{mass}}
\index{mass@{mass}!simSystem@{sim\-System}}
\subsubsection[{mass}]{\setlength{\rightskip}{0pt plus 5cm}const double sim\-System\-::mass (
\begin{DoxyParamCaption}
\item[{const int}]{index}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_a7c75052458072e1267bc20594b58d8cd}


Return the mass of a given species' index. 



Definition at line 89 of file system.\-h.



Referenced by delete\-Particle\-::make(), and insert\-Particle\-::make().

\hypertarget{classsim_system_a93259b517f449f1ac610d132ac66b551}{\index{sim\-System@{sim\-System}!max\-Species@{max\-Species}}
\index{max\-Species@{max\-Species}!simSystem@{sim\-System}}
\subsubsection[{max\-Species}]{\setlength{\rightskip}{0pt plus 5cm}const int sim\-System\-::max\-Species (
\begin{DoxyParamCaption}
\item[{const int}]{index}
\end{DoxyParamCaption}
)}}\label{classsim_system_a93259b517f449f1ac610d132ac66b551}


Returns the absolute maximum number of a given species type allowed in the system. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em index} & Species index to query\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
max\-Species Maximum number of them allowed 
\end{DoxyReturn}


Definition at line 1654 of file system.\-cpp.



Referenced by insert\-Particle\-::make(), and sim\-System().


\begin{DoxyCode}
1654                                                 \{
1655     \textcolor{keywordflow}{if} (maxSpecies\_.begin() == maxSpecies\_.end()) \{
1656             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"No species in the system, cannot report a maximum"});
1657         \}
1658         \textcolor{keywordflow}{if} (maxSpecies\_.size() <= index) \{
1659             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"System does not contain that species, cannot report a
       maximum"});
1660         \} \textcolor{keywordflow}{else}  \{
1661             \textcolor{keywordflow}{return} maxSpecies\_[index];
1662         \}
1663 \}
\end{DoxyCode}
\hypertarget{classsim_system_afafda4a09ed180ee9c5580d196d8ca9f}{\index{sim\-System@{sim\-System}!min\-Species@{min\-Species}}
\index{min\-Species@{min\-Species}!simSystem@{sim\-System}}
\subsubsection[{min\-Species}]{\setlength{\rightskip}{0pt plus 5cm}const int sim\-System\-::min\-Species (
\begin{DoxyParamCaption}
\item[{const int}]{index}
\end{DoxyParamCaption}
)}}\label{classsim_system_afafda4a09ed180ee9c5580d196d8ca9f}


Returns the absolute minimum number of a given species type allowed in the system. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em index} & Species index to query\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
min\-Species Minimum number of them allowed 
\end{DoxyReturn}


Definition at line 1672 of file system.\-cpp.



Referenced by delete\-Particle\-::make(), and sim\-System().


\begin{DoxyCode}
1672                                                 \{
1673     \textcolor{keywordflow}{if} (minSpecies\_.begin() == minSpecies\_.end()) \{
1674             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"No species in the system, cannot report a minimum"});
1675         \}
1676         \textcolor{keywordflow}{if} (minSpecies\_.size() <= index) \{
1677             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"System does not contain that species, cannot report a
       minimum"});
1678         \} \textcolor{keywordflow}{else}  \{
1679             \textcolor{keywordflow}{return} minSpecies\_[index];
1680         \}
1681 \}
\end{DoxyCode}
\hypertarget{classsim_system_af1e3f5320aff976a448647244d5950d1}{\index{sim\-System@{sim\-System}!mu@{mu}}
\index{mu@{mu}!simSystem@{sim\-System}}
\subsubsection[{mu}]{\setlength{\rightskip}{0pt plus 5cm}const double sim\-System\-::mu (
\begin{DoxyParamCaption}
\item[{const int}]{index}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_af1e3f5320aff976a448647244d5950d1}


Return the chemical potential for a given species' index. 



Definition at line 88 of file system.\-h.



Referenced by delete\-Particle\-::make(), insert\-Particle\-::make(), and sim\-System().

\hypertarget{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}{\index{sim\-System@{sim\-System}!n\-Species@{n\-Species}}
\index{n\-Species@{n\-Species}!simSystem@{sim\-System}}
\subsubsection[{n\-Species}]{\setlength{\rightskip}{0pt plus 5cm}const int sim\-System\-::n\-Species (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_ab5e2e9b6204de15520302fe1d51688dd}


Return the number of different species in the system. 



Definition at line 72 of file system.\-h.



Referenced by check\-Bounds(), agg\-Vol\-Bias3\-::make(), delete\-Particle\-::make(), translate\-Particle\-::make(), insert\-Particle\-::make(), swap\-Particles\-::make(), sanity\-Checks(), set\-Barriers(), set\-Config(), set\-Moves(), set\-Pair\-Potentials(), and sim\-System().

\hypertarget{classsim_system_a40af191fae6091e26413ee06ae188ae9}{\index{sim\-System@{sim\-System}!potential\-Is\-Set@{potential\-Is\-Set}}
\index{potential\-Is\-Set@{potential\-Is\-Set}!simSystem@{sim\-System}}
\subsubsection[{potential\-Is\-Set}]{\setlength{\rightskip}{0pt plus 5cm}bool sim\-System\-::potential\-Is\-Set (
\begin{DoxyParamCaption}
\item[{const int}]{spec1, }
\item[{const int}]{spec2}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_a40af191fae6091e26413ee06ae188ae9}


Boolean which returns whether or not a pair has had its potential specified by the user yet. 



Definition at line 70 of file system.\-h.



Referenced by check\-Bounds(), and read\-Config().

\hypertarget{classsim_system_a6ef1ba3e08ec44d865436e272cdebc9b}{\index{sim\-System@{sim\-System}!print\-Energy\-Histogram@{print\-Energy\-Histogram}}
\index{print\-Energy\-Histogram@{print\-Energy\-Histogram}!simSystem@{sim\-System}}
\subsubsection[{print\-Energy\-Histogram}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::print\-Energy\-Histogram (
\begin{DoxyParamCaption}
\item[{const std\-::string}]{file\-Name, }
\item[{const bool}]{normalize = {\ttfamily true}}
\end{DoxyParamCaption}
)}}\label{classsim_system_a6ef1ba3e08ec44d865436e272cdebc9b}


Print the (normalized by default) energy histogram for each Ntot. 

Refines bounds before each print.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em file\-Name} & Prefix of the filename to load from \\
\hline
\mbox{\tt in}  & {\em normalize} & Whether or not to normalize the histogram (default=true) \\
\hline
\end{DoxyParams}


Definition at line 912 of file system.\-cpp.



Referenced by checkpoint\-::dump(), and perform\-T\-M\-M\-C().


\begin{DoxyCode}
912                                                                                     \{
913     std::ofstream of;
914     std::string name = fileName+\textcolor{stringliteral}{".dat"};
915     of.open(name.c\_str(), std::ofstream::out);
916     of << \textcolor{stringliteral}{"# <P(U)> as a function of N\_tot."} << std::endl;
917     of << \textcolor{stringliteral}{"# number\_of\_species: "} << nSpecies\_ << std::endl;
918     of << \textcolor{stringliteral}{"# species\_total\_upper\_bound: "} << totNBounds\_[1] << std::endl;
919     of << \textcolor{stringliteral}{"# species\_total\_lower\_bound: "} << totNBounds\_[0] << std::endl;
920     \textcolor{keywordtype}{double} V = box\_[0]*box\_[1]*box\_[2];
921     of << \textcolor{stringliteral}{"# volume: "} << std::setprecision(15) << V << std::endl;
922     of << \textcolor{stringliteral}{"# Bin widths for each"} << std::endl;
923     \textcolor{keywordflow}{for} (std::vector < dynamic\_one\_dim\_histogram >::iterator it = energyHistogram\_.begin(); it != 
      energyHistogram\_.end(); ++it) \{
924         of << it->get\_delta() << \textcolor{stringliteral}{"\(\backslash\)t"};
925     \}
926     of << std::endl;
927     of << \textcolor{stringliteral}{"# Bin lower bound for each"} << std::endl;
928     \textcolor{keywordflow}{for} (std::vector < dynamic\_one\_dim\_histogram >::iterator it = energyHistogram\_.begin(); it != 
      energyHistogram\_.end(); ++it) \{
929         of << it->get\_lb() << \textcolor{stringliteral}{"\(\backslash\)t"};
930     \}
931     of << std::endl;
932     of << \textcolor{stringliteral}{"# Bin upper bound for each"} << std::endl;
933     \textcolor{keywordflow}{for} (std::vector < dynamic\_one\_dim\_histogram >::iterator it = energyHistogram\_.begin(); it != 
      energyHistogram\_.end(); ++it) \{
934         of << it->get\_ub() << \textcolor{stringliteral}{"\(\backslash\)t"};
935     \}
936     of << std::endl;
937     \textcolor{keywordflow}{if} (normalize) \{
938         of << \textcolor{stringliteral}{"# Normalized histogram for each"} << std::endl;
939         \textcolor{keywordflow}{for} (std::vector < dynamic\_one\_dim\_histogram >::iterator it = energyHistogram\_.begin(); it != 
      energyHistogram\_.end(); ++it) \{
940             std::deque <double> h = it->get\_hist();
941             \textcolor{keywordtype}{double} sum = 0.0;
942             \textcolor{keywordflow}{for} (std::deque <double>::iterator it2 = h.begin(); it2 != h.end(); ++it2) \{
943                 sum += *it2;
944             \}
945             \textcolor{keywordflow}{for} (std::deque <double>::iterator it2 = h.begin(); it2 != h.end(); ++it2) \{
946                 of << std::setprecision(15) << *it2/sum << \textcolor{stringliteral}{"\(\backslash\)t"};
947             \}
948             of << std::endl;
949         \}
950     \} \textcolor{keywordflow}{else} \{
951         of << \textcolor{stringliteral}{"# Unnormalized histogram for each"} << std::endl;
952         \textcolor{keywordflow}{for} (std::vector < dynamic\_one\_dim\_histogram >::iterator it = energyHistogram\_.begin(); it != 
      energyHistogram\_.end(); ++it) \{
953             std::deque <double> h = it->get\_hist();
954             \textcolor{keywordflow}{for} (std::deque <double>::iterator it2 = h.begin(); it2 != h.end(); ++it2) \{
955                 of << std::setprecision(15) << *it2 << \textcolor{stringliteral}{"\(\backslash\)t"};
956             \}
957             of << std::endl;
958         \}
959     \}
960     of.close();
961 \}
\end{DoxyCode}
\hypertarget{classsim_system_a2818b2f0ff79782d5443ca0f191564f8}{\index{sim\-System@{sim\-System}!print\-Ext\-Moments@{print\-Ext\-Moments}}
\index{print\-Ext\-Moments@{print\-Ext\-Moments}!simSystem@{sim\-System}}
\subsubsection[{print\-Ext\-Moments}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::print\-Ext\-Moments (
\begin{DoxyParamCaption}
\item[{const std\-::string}]{file\-Name, }
\item[{const bool}]{normalize = {\ttfamily true}}
\end{DoxyParamCaption}
)}}\label{classsim_system_a2818b2f0ff79782d5443ca0f191564f8}


Print the (normalized by default) extensive energy histogram for each Ntot. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em file\-Name} & Name of the file to print to \\
\hline
\mbox{\tt in}  & {\em normalize} & Whether or not to normalize the histogram (default=true) \\
\hline
\end{DoxyParams}


Definition at line 658 of file system.\-cpp.



References histogram\-::get\-Address(), histogram\-::get\-Counter(), and histogram\-::get\-Raw\-Histogram().



Referenced by checkpoint\-::dump(), and perform\-T\-M\-M\-C().


\begin{DoxyCode}
658                                                                                \{
659     std::ofstream of;
660     std::string name = fileName+\textcolor{stringliteral}{".dat"};
661     of.open(name.c\_str(), std::ofstream::out);
662     of << \textcolor{stringliteral}{"# <N\_i^j*N\_k^m*U^p> as a function of N\_tot."} << std::endl;
663     of << \textcolor{stringliteral}{"# number\_of\_species: "} << nSpecies\_ << std::endl;
664     of << \textcolor{stringliteral}{"# max\_order: "} << max\_order\_ << std::endl;
665     of << \textcolor{stringliteral}{"# species\_total\_upper\_bound: "} << totNBounds\_[1] << std::endl;
666     of << \textcolor{stringliteral}{"# species\_total\_lower\_bound: "} << totNBounds\_[0] << std::endl;
667     \textcolor{keywordtype}{double} V = box\_[0]*box\_[1]*box\_[2];
668     of << \textcolor{stringliteral}{"# volume: "} << std::setprecision(15) << V << std::endl;
669     of << \textcolor{stringliteral}{"#\(\backslash\)tN\_tot\(\backslash\)t"};
670     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < nSpecies\_; ++i) \{
671         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j <= max\_order\_; ++j) \{
672             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} k = 0; k < nSpecies\_; ++k) \{
673                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} m = 0; m <= max\_order\_; ++m) \{
674                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} p = 0; p <= max\_order\_; ++p) \{
675                         of << \textcolor{stringliteral}{"N\_"}+std::to\_string(i+1)+\textcolor{stringliteral}{"^"}+std::to\_string(j)+\textcolor{stringliteral}{"*N\_"}+std::to\_string(k+1)+\textcolor{stringliteral}{"^"}+
      std::to\_string(m)+\textcolor{stringliteral}{"*U^"}+std::to\_string(p)+\textcolor{stringliteral}{"\(\backslash\)t"};
676                     \}
677                 \}
678             \}
679         \}
680     \}
681     of << std::endl;
682     std::vector <double> h = extensive\_moments\_.\hyperlink{classhistogram_a3a75adbce72057f3a4db805d9efc3c9c}{getRawHistogram} ();
683     std::vector <double> ctr = extensive\_moments\_.\hyperlink{classhistogram_a8417c827c4653055b370786916c901cf}{getCounter} ();
684     std::vector <double> coords (6,0);
685     \textcolor{keywordtype}{long} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} idx = 0;
686     \textcolor{keywordflow}{if} (normalize) \{
687         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} n = 0; n < totNBounds\_[1]-totNBounds\_[0]+1; ++n) \{
688             of << n+totNBounds\_[0] << \textcolor{stringliteral}{"\(\backslash\)t"};
689             coords[5] = n;
690             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < nSpecies\_; ++i) \{
691                 coords[0] = i;
692                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j <= max\_order\_; ++j) \{
693                     coords[1] = j;
694                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} k = 0; k < nSpecies\_; ++k) \{
695                         coords[2] = k;
696                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} m = 0; m <= max\_order\_; ++m) \{
697                             coords[3] = m;
698                             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} p = 0; p <= max\_order\_; ++p) \{
699                                 coords[4] = p;
700                                 idx = extensive\_moments\_.\hyperlink{classhistogram_ae52fa58934b56e05846a66e43c3184bd}{getAddress}(coords);
701                                 of << std::setprecision(15) << h[idx]/ctr[idx] << \textcolor{stringliteral}{"\(\backslash\)t"};
702                             \}
703                         \}
704                     \}
705                 \}
706             \}
707             of << std::endl;
708         \}
709     \} \textcolor{keywordflow}{else} \{
710         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} n = 0; n < totNBounds\_[1]-totNBounds\_[0]+1; ++n) \{
711             of << n+totNBounds\_[0] << \textcolor{stringliteral}{"\(\backslash\)t"};
712             coords[5] = n;
713             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < nSpecies\_; ++i) \{
714                 coords[0] = i;
715                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j <= max\_order\_; ++j) \{
716                     coords[1] = j;
717                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} k = 0; k < nSpecies\_; ++k) \{
718                         coords[2] = k;
719                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} m = 0; m <= max\_order\_; ++m) \{
720                             coords[3] = m;
721                             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} p = 0; p <= max\_order\_; ++p) \{
722                                 coords[4] = p;
723                                 idx = extensive\_moments\_.\hyperlink{classhistogram_ae52fa58934b56e05846a66e43c3184bd}{getAddress}(coords);
724                                 of << std::setprecision(15) << h[idx] << \textcolor{stringliteral}{"\(\backslash\)t"};
725                             \}
726                         \}
727                     \}
728                 \}
729             \}
730             of << std::endl;
731         \}
732     \}
733     of.close();
734 \}
\end{DoxyCode}
\hypertarget{classsim_system_ac29bdd6f7fa6f9526b7eafcf658d70d8}{\index{sim\-System@{sim\-System}!print\-Pk\-Histogram@{print\-Pk\-Histogram}}
\index{print\-Pk\-Histogram@{print\-Pk\-Histogram}!simSystem@{sim\-System}}
\subsubsection[{print\-Pk\-Histogram}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::print\-Pk\-Histogram (
\begin{DoxyParamCaption}
\item[{const std\-::string}]{file\-Name, }
\item[{const bool}]{normalize = {\ttfamily true}}
\end{DoxyParamCaption}
)}}\label{classsim_system_ac29bdd6f7fa6f9526b7eafcf658d70d8}


Print the (normalized by default) particle number histogram for each Ntot. 

Refines histograms before each print.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em file\-Name} & Prefix of filename to print to \\
\hline
\mbox{\tt in}  & {\em normalize} & Whether or not to normalize the histogram (default=true) \\
\hline
\end{DoxyParams}


Definition at line 1078 of file system.\-cpp.



Referenced by checkpoint\-::dump(), and perform\-T\-M\-M\-C().


\begin{DoxyCode}
1078                                                                                 \{
1079     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < nSpecies\_; ++i) \{
1080         std::ofstream of;
1081         std::string name = fileName+\textcolor{stringliteral}{"\_"}+std::to\_string(i+1)+\textcolor{stringliteral}{".dat"};
1082         of.open(name.c\_str(), std::ofstream::out);
1083         of << \textcolor{stringliteral}{"# <P(N\_"} << i+1 << \textcolor{stringliteral}{")> as a function of N\_tot."} << std::endl;
1084         of << \textcolor{stringliteral}{"# number\_of\_species: "} << nSpecies\_ << std::endl;
1085         of << \textcolor{stringliteral}{"# species\_total\_upper\_bound: "} << totNBounds\_[1] << std::endl;
1086         of << \textcolor{stringliteral}{"# species\_total\_lower\_bound: "} << totNBounds\_[0] << std::endl;
1087         \textcolor{keywordtype}{double} V = box\_[0]*box\_[1]*box\_[2];
1088         of << \textcolor{stringliteral}{"# volume: "} << std::setprecision(15) << V << std::endl;
1089         of << \textcolor{stringliteral}{"# Bin widths for each species index "} << std::endl;
1090         \textcolor{keywordflow}{for} (std::vector < dynamic\_one\_dim\_histogram >::iterator it = pkHistogram\_[i].begin(); it != 
      pkHistogram\_[i].end(); ++it) \{
1091             of << it->get\_delta() << \textcolor{stringliteral}{"\(\backslash\)t"};
1092         \}
1093         of << std::endl;
1094         of << \textcolor{stringliteral}{"# Bin lower bound for each species index "} << std::endl;
1095         \textcolor{keywordflow}{for} (std::vector < dynamic\_one\_dim\_histogram >::iterator it = pkHistogram\_[i].begin(); it != 
      pkHistogram\_[i].end(); ++it) \{
1096             of << it->get\_lb() << \textcolor{stringliteral}{"\(\backslash\)t"};
1097         \}
1098         of << std::endl;
1099         of << \textcolor{stringliteral}{"# Bin upper bound for each species index "} << std::endl;
1100         \textcolor{keywordflow}{for} (std::vector < dynamic\_one\_dim\_histogram >::iterator it = pkHistogram\_[i].begin(); it != 
      pkHistogram\_[i].end(); ++it) \{
1101             of << it->get\_ub() << \textcolor{stringliteral}{"\(\backslash\)t"};
1102         \}
1103         of << std::endl;
1104         \textcolor{keywordflow}{if} (normalize) \{
1105             of << \textcolor{stringliteral}{"# Normalized histogram for each species index "} << std::endl;
1106             \textcolor{keywordflow}{for} (std::vector < dynamic\_one\_dim\_histogram >::iterator it = pkHistogram\_[i].begin(); it != 
      pkHistogram\_[i].end(); ++it) \{
1107                 std::deque <double> h = it->get\_hist();
1108                 \textcolor{keywordtype}{double} sum = 0.0;
1109                 \textcolor{keywordflow}{for} (std::deque <double>::iterator it2 = h.begin(); it2 != h.end(); ++it2) \{
1110                     sum += *it2;
1111                 \}
1112                 \textcolor{keywordflow}{for} (std::deque <double>::iterator it2 = h.begin(); it2 != h.end(); ++it2) \{
1113                     of << std::setprecision(15) << *it2/sum << \textcolor{stringliteral}{"\(\backslash\)t"};
1114                 \}
1115                 of << std::endl;
1116             \}
1117         \} \textcolor{keywordflow}{else} \{
1118             of << \textcolor{stringliteral}{"# Unnormalized histogram for each species index "} << std::endl;
1119             \textcolor{keywordflow}{for} (std::vector < dynamic\_one\_dim\_histogram >::iterator it = pkHistogram\_[i].begin(); it != 
      pkHistogram\_[i].end(); ++it) \{
1120                 std::deque <double> h = it->get\_hist();
1121                 \textcolor{keywordflow}{for} (std::deque <double>::iterator it2 = h.begin(); it2 != h.end(); ++it2) \{
1122                     of << std::setprecision(15) << *it2 << \textcolor{stringliteral}{"\(\backslash\)t"};
1123                 \}
1124                 of << std::endl;
1125             \}
1126         \}
1127         of.close();
1128     \}
1129 \}
\end{DoxyCode}
\hypertarget{classsim_system_ae3096dc65acdf38cc824e507cca33370}{\index{sim\-System@{sim\-System}!print\-Snapshot@{print\-Snapshot}}
\index{print\-Snapshot@{print\-Snapshot}!simSystem@{sim\-System}}
\subsubsection[{print\-Snapshot}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::print\-Snapshot (
\begin{DoxyParamCaption}
\item[{std\-::string}]{filename, }
\item[{std\-::string}]{comment, }
\item[{bool}]{overwrite = {\ttfamily true}}
\end{DoxyParamCaption}
)}}\label{classsim_system_ae3096dc65acdf38cc824e507cca33370}


Print an X\-Y\-Z file of the instantaneous system configuration. 

This can be read in at a later time via estart() function.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em filename} & File to store X\-Y\-Z coordinates to \\
\hline
\mbox{\tt in}  & {\em comment} & Comment line for the file \\
\hline
\mbox{\tt in}  & {\em overwrite} & Flag to overwrite file if it already exists or to append (default = true, overwrite) \\
\hline
\end{DoxyParams}


Definition at line 1331 of file system.\-cpp.



References atoms, and num\-Species.



Referenced by checkpoint\-::dump(), perform\-T\-M\-M\-C(), and set\-Config().


\begin{DoxyCode}
1331                                                                                     \{
1332     \textcolor{keywordflow}{if} (overwrite) \{
1333         std::ofstream outfile (filename.c\_str(), std::ofstream::trunc);
1334         \textcolor{keywordtype}{int} tot = 0;
1335         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < nSpecies\_; ++j) \{
1336             tot += \hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[j]; \textcolor{comment}{// only count fully inserted species}
1337         \}
1338 
1339         outfile << tot << std::endl;
1340         outfile << comment << std::endl;
1341 
1342         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < nSpecies\_; ++j) \{
1343             \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} num = \hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[j];
1344             \textcolor{keywordflow}{if} (Mcurrent\_ > 1 && fractionalAtomType\_ == j) \{
1345                 num += 1; \textcolor{comment}{// account for partially inserted atom}
1346             \}
1347             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < num; ++i) \{
1348                 \textcolor{keywordflow}{if} (\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[j][i].mState == 0) \{ \textcolor{comment}{// only print fully inserted atoms}
1349                     outfile << j << \textcolor{stringliteral}{"\(\backslash\)t"} <<  std::setprecision(15) << \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[j][i].pos[0] << \textcolor{stringliteral}{"\(\backslash\)t"} << 
      std::setprecision(15) << \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[j][i].pos[1] << \textcolor{stringliteral}{"\(\backslash\)t"} << std::setprecision(15) << 
      \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[j][i].pos[2] << std::endl;
1350                 \}
1351             \}
1352         \}
1353 
1354         outfile.close();
1355     \} \textcolor{keywordflow}{else} \{
1356         std::ofstream outfile (filename.c\_str(), std::ofstream::out | std::ofstream::app);
1357         \textcolor{keywordtype}{int} tot = 0;
1358         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < nSpecies\_; ++j) \{
1359             tot += \hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[j]; \textcolor{comment}{// only count fully inserted species}
1360         \}
1361 
1362         outfile << tot << std::endl;
1363         outfile << comment << std::endl;
1364 
1365         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < nSpecies\_; ++j) \{
1366             \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} num = \hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[j];
1367             \textcolor{keywordflow}{if} (Mcurrent\_ > 1 && fractionalAtomType\_ == j) \{
1368                 num += 1; \textcolor{comment}{// account for partially inserted atom}
1369             \}
1370             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < num; ++i) \{
1371                 \textcolor{keywordflow}{if} (\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[j][i].mState == 0) \{ \textcolor{comment}{// only print fully inserted atoms}
1372                     outfile << j << \textcolor{stringliteral}{"\(\backslash\)t"} <<  std::setprecision(15) << \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[j][i].pos[0] << \textcolor{stringliteral}{"\(\backslash\)t"} << 
      std::setprecision(15) << \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[j][i].pos[1] << \textcolor{stringliteral}{"\(\backslash\)t"} << std::setprecision(15) << 
      \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[j][i].pos[2] << std::endl;
1373                 \}
1374             \}
1375         \}
1376 
1377         outfile.close();
1378     \}
1379 \}
\end{DoxyCode}
\hypertarget{classsim_system_a3161d95bbb800d5d95a732ac5fc32b95}{\index{sim\-System@{sim\-System}!read\-Config@{read\-Config}}
\index{read\-Config@{read\-Config}!simSystem@{sim\-System}}
\subsubsection[{read\-Config}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::read\-Config (
\begin{DoxyParamCaption}
\item[{std\-::string}]{filename}
\end{DoxyParamCaption}
)}}\label{classsim_system_a3161d95bbb800d5d95a732ac5fc32b95}


Read an X\-Y\-Z file as the system's initial configuration. 

Note that the number of species, etc. must already be specified in the constructor. Will also reset and calculate the energy from scratch so these potentials should be set before reading in a restart file.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em filename} & File to read X\-Y\-Z coordinates from \\
\hline
\end{DoxyParams}


Definition at line 1387 of file system.\-cpp.



References delete\-Atom(), insert\-Atom(), num\-Species, potential\-Is\-Set(), scratch\-Energy(), send\-Err(), send\-Msg(), S\-Y\-S\-\_\-\-F\-A\-I\-L\-U\-R\-E, and custom\-Exception\-::what().



Referenced by checkpoint\-::load(), and set\-Config().


\begin{DoxyCode}
1387                                               \{
1388     \hyperlink{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}{sendMsg}(\textcolor{stringliteral}{"Reading initial configuration from "}+filename);
1389 
1390     std::ifstream infile (filename.c\_str());
1391     \textcolor{keywordflow}{if} (!infile.is\_open()) \{
1392         \hyperlink{utilities_8cpp_a6dacf3c3c19aa1e13a4d5a148fe5114e}{sendErr}(\textcolor{stringliteral}{"Cannot open "}+filename);
1393         exit(\hyperlink{global_8h_a428dfe1ef0a6ff4b1fdebf275f6aff2e}{SYS\_FAILURE});
1394     \}
1395 
1396     std::string line;
1397     std::vector < atom > sysatoms;
1398     std::vector < int > index;
1399     \textcolor{keywordtype}{int} natoms = 0;
1400     \textcolor{keywordtype}{int} lineIndex = 0;
1401     \textcolor{keywordflow}{while}(std::getline(infile,line)) \{
1402         std::stringstream lineStream(line);
1403         \textcolor{keywordflow}{if} (lineIndex == 0) \{
1404             lineStream >> natoms;
1405             index.resize(natoms);
1406             sysatoms.resize(natoms);
1407         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (lineIndex > 1) \{
1408             lineStream >> index[lineIndex-2] >> sysatoms[lineIndex-2].pos[0] >> sysatoms[lineIndex-2].pos[1
      ] >> sysatoms[lineIndex-2].pos[2];
1409         \}
1410         lineIndex++;
1411     \}
1412     infile.close();
1413 
1414     \textcolor{comment}{// check if within global bounds}
1415     \textcolor{keywordflow}{if} (sysatoms.size() > totNBounds\_[1] || sysatoms.size() < totNBounds\_[0]) \{
1416         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Number of particles ("}+std::to\_string(sysatoms.size())+\textcolor{stringliteral}{") in
       the restart file out of target range ["}+std::to\_string(totNBounds\_[0])+\textcolor{stringliteral}{", "}+std::to\_string(totNBounds\_[1])+\textcolor{stringliteral}{
      "]"});
1417     \}
1418 
1419     \textcolor{comment}{// sort by type}
1420     std::map < int, int > types;
1421     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < natoms; ++j) \{
1422         \textcolor{keywordflow}{if} (types.find(index[j]) != types.end()) \{
1423             types[index[j]] += 1;
1424         \} \textcolor{keywordflow}{else} \{
1425             types[index[j]] = 1;
1426         \}
1427     \}
1428 
1429     \textcolor{keywordtype}{int} maxType = -1;
1430     \textcolor{keywordflow}{for} (std::map < int, int >::iterator it = types.begin(); it != types.end(); ++it) \{
1431         maxType = std::max(maxType, it->first);
1432         \textcolor{keywordflow}{if} (it->first < 0 || it->first >= nSpecies\_) \{
1433             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Restart file corrupted, types out of range"});
1434         \}
1435     \}
1436 
1437     \textcolor{comment}{// check that pair potentials exist so energy can be calculated}
1438     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < nSpecies\_; ++i) \{
1439         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < nSpecies\_; ++j) \{
1440             \textcolor{keywordflow}{if} (!\hyperlink{classsim_system_a40af191fae6091e26413ee06ae188ae9}{potentialIsSet}(i, j)) \{
1441                 \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException}(\textcolor{stringliteral}{"Not all pair potentials are set, so cannot initial
       from file"});
1442             \}
1443         \}
1444     \}
1445 
1446     \textcolor{comment}{// empty out the system before adding new atoms in - all atoms "fully inserted" so no partial ones to
       worry about}
1447     \textcolor{keywordflow}{if} (Mcurrent\_ != 0) \{
1448         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"System cannot be restarted from "}+filename+\textcolor{stringliteral}{", for some
       reason current expanded state != 0"});
1449     \}
1450     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < nSpecies\_; ++i) \{
1451         \textcolor{keyword}{const} \textcolor{keywordtype}{int} ns = \hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[i];
1452         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = ns-1; j >=0; --j) \{
1453             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < Mtot\_; ++k) \{
1454                 \hyperlink{classsim_system_acabf4fc5b5b90bba62e1449ddb3646c6}{deleteAtom} (i, j, \textcolor{keyword}{true});
1455             \}
1456         \}
1457     \}
1458     \textcolor{keywordflow}{if} (totN\_ != 0) \{
1459         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"total N = "}+std::to\_string(totN\_)+\textcolor{stringliteral}{" != 0 after system
       supposedly emptied"});
1460     \}
1461     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < nSpecies\_; ++i) \{
1462         \textcolor{keywordflow}{if} (\hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[i] != 0) \{
1463             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Number of molecules of species #"}+std::to\_string(i+1)+\textcolor{stringliteral}{"
       = "}+std::to\_string(\hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[i])+\textcolor{stringliteral}{" != 0 after system supposedly emptied"});
1464         \}
1465     \}
1466     \textcolor{keywordflow}{if} (Mcurrent\_ != 0) \{
1467         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"M state != 0 after system supposedly emptied"});
1468     \}
1469 
1470     energy\_ = 0.0;
1471     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < sysatoms.size(); ++j) \{
1472         \textcolor{keywordflow}{try} \{
1473             \textcolor{comment}{// "partially" insert each atom so it goes through all the stages}
1474             \hyperlink{classsim_system_a0404e9435cc046d19b6bb990678ee069}{insertAtom} (index[j], &sysatoms[j]);
1475             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} k = 1; k < Mtot\_; ++k) \{
1476                 \hyperlink{classsim_system_a0404e9435cc046d19b6bb990678ee069}{insertAtom} (index[j], fractionalAtom\_); \textcolor{comment}{// this will check that within each
       species own max and min, global bounds handled above}
1477             \}
1478         \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
1479             std::string a = \textcolor{stringliteral}{"Could not initialize system from restart file, "}, b = ce.
      \hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}();
1480             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (a+b);
1481         \}
1482     \}
1483 
1484     \textcolor{comment}{// recalculate system's initial energy}
1485     energy\_ = \hyperlink{classsim_system_a51539ed4c3bb4905b32ce428c1c537fe}{scratchEnergy}();
1486     \hyperlink{utilities_8cpp_a08974c73a5b36c28b8ad1ef47fca77b0}{sendMsg}(\textcolor{stringliteral}{"Successfully loaded initial configuration from "}+filename);
1487 \}
\end{DoxyCode}
\hypertarget{classsim_system_aa0eae4d523b5649be273e0419e9f799f}{\index{sim\-System@{sim\-System}!record\-Energy\-Histogram@{record\-Energy\-Histogram}}
\index{record\-Energy\-Histogram@{record\-Energy\-Histogram}!simSystem@{sim\-System}}
\subsubsection[{record\-Energy\-Histogram}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::record\-Energy\-Histogram (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classsim_system_aa0eae4d523b5649be273e0419e9f799f}


Record the energy histogram for the system at a given Ntot. 

Only records values when N\-\_\-tot in range of \mbox{[}min, max\mbox{]}. 

Definition at line 843 of file system.\-cpp.



Referenced by perform\-T\-M\-M\-C().


\begin{DoxyCode}
843                                        \{
844     \textcolor{comment}{// only record if in range (removes equilibration stage to get in this range, if there was any)}
845     \textcolor{keywordflow}{if} (totN\_ >= totNBounds\_[0] && totN\_ <= totNBounds\_[1]) \{
846         \textcolor{keyword}{const} \textcolor{keywordtype}{int} address = totN\_-totNBounds\_[0];
847         energyHistogram\_[address].record(energy\_);
848     \}
849 \}
\end{DoxyCode}
\hypertarget{classsim_system_a74ce0ab8151fd0501abf853a16cc8e58}{\index{sim\-System@{sim\-System}!record\-Ext\-Moments@{record\-Ext\-Moments}}
\index{record\-Ext\-Moments@{record\-Ext\-Moments}!simSystem@{sim\-System}}
\subsubsection[{record\-Ext\-Moments}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::record\-Ext\-Moments (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classsim_system_a74ce0ab8151fd0501abf853a16cc8e58}


Record the extensive moment at a given Ntot. 



Definition at line 626 of file system.\-cpp.



References histogram\-::increment(), and num\-Species.



Referenced by perform\-T\-M\-M\-C().


\begin{DoxyCode}
626                                   \{
627     \textcolor{comment}{// only record if in range (removes equilibration stage to get in this range, if there was any)}
628     \textcolor{keywordflow}{if} (totN\_ >= totNBounds\_[0] && totN\_ <= totNBounds\_[1]) \{
629         \textcolor{keywordtype}{double} val = 0.0;
630         std::vector < double > coords (6,0);
631         coords[5] = totN\_-totNBounds\_[0];
632         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < nSpecies\_; ++i) \{
633             coords[0] = i;
634             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j <= max\_order\_; ++j) \{
635                 coords[1] = j;
636                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} k = 0; k < nSpecies\_; ++k) \{
637                     coords[2] = k;
638                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} m = 0; m <= max\_order\_; ++m) \{
639                         coords[3] = m;
640                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} p = 0; p <= max\_order\_; ++p) \{
641                             coords[4] = p;
642                             val = pow(\hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[i], j)*pow(\hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[k], m)*pow(
      energy\_, p);
643                             extensive\_moments\_.\hyperlink{classhistogram_a665e7f6c052d4b306c6fe7d0c600f1c8}{increment} (coords, val);
644                         \}
645                     \}
646                 \}
647             \}
648         \}
649     \}
650 \}
\end{DoxyCode}
\hypertarget{classsim_system_a71bbc9d8bdbb5042e4fa817c3e71fe53}{\index{sim\-System@{sim\-System}!record\-Pk\-Histogram@{record\-Pk\-Histogram}}
\index{record\-Pk\-Histogram@{record\-Pk\-Histogram}!simSystem@{sim\-System}}
\subsubsection[{record\-Pk\-Histogram}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::record\-Pk\-Histogram (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classsim_system_a71bbc9d8bdbb5042e4fa817c3e71fe53}


Record the particle number histogram for the system at a given Ntot. 

Only records values when N\-\_\-tot in range of \mbox{[}min, max\mbox{]}. 

Definition at line 1047 of file system.\-cpp.



References num\-Species.



Referenced by perform\-T\-M\-M\-C().


\begin{DoxyCode}
1047                                    \{
1048     \textcolor{comment}{// only record if in range (removes equilibration stage to get in this range, if there was any)}
1049     \textcolor{keywordflow}{if} (totN\_ >= totNBounds\_[0] && totN\_ <= totNBounds\_[1]) \{
1050         \textcolor{keyword}{const} \textcolor{keywordtype}{int} address = totN\_-totNBounds\_[0];
1051         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < nSpecies\_; ++i) \{
1052             pkHistogram\_[i][address].record(\hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[i]);
1053         \}
1054     \}
1055 \}
\end{DoxyCode}
\hypertarget{classsim_system_afe05cba714a032b445cfb1a529547833}{\index{sim\-System@{sim\-System}!refine\-Energy\-Histogram\-Bounds@{refine\-Energy\-Histogram\-Bounds}}
\index{refine\-Energy\-Histogram\-Bounds@{refine\-Energy\-Histogram\-Bounds}!simSystem@{sim\-System}}
\subsubsection[{refine\-Energy\-Histogram\-Bounds}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::refine\-Energy\-Histogram\-Bounds (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classsim_system_afe05cba714a032b445cfb1a529547833}


Check the histogram entries and trim off zero-\/valued entries and bounds. 



Definition at line 865 of file system.\-cpp.



References custom\-Exception\-::what().



Referenced by checkpoint\-::dump(), and perform\-T\-M\-M\-C().


\begin{DoxyCode}
865                                              \{
866     \textcolor{keywordflow}{for} (std::vector < dynamic\_one\_dim\_histogram >::iterator it = energyHistogram\_.begin(); it != 
      energyHistogram\_.end(); ++it) \{
867         \textcolor{keywordflow}{try} \{
868             it->trim\_edges();
869         \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
870             std::string a = \textcolor{stringliteral}{"Unable to trim edges in energyHistogram at each Ntot: "}, b = ce.
      \hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}();
871             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (a+b);
872         \}
873     \}
874 \}
\end{DoxyCode}
\hypertarget{classsim_system_a1e462fcb63389d59419ff6135b2d802e}{\index{sim\-System@{sim\-System}!refine\-Pk\-Histogram\-Bounds@{refine\-Pk\-Histogram\-Bounds}}
\index{refine\-Pk\-Histogram\-Bounds@{refine\-Pk\-Histogram\-Bounds}!simSystem@{sim\-System}}
\subsubsection[{refine\-Pk\-Histogram\-Bounds}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::refine\-Pk\-Histogram\-Bounds (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classsim_system_a1e462fcb63389d59419ff6135b2d802e}


Check the histogram entries and trim off zero-\/valued entries and bounds. 



Definition at line 1060 of file system.\-cpp.



Referenced by checkpoint\-::dump(), and perform\-T\-M\-M\-C().


\begin{DoxyCode}
1060                                          \{
1061     \textcolor{keywordflow}{for} (std::vector < std::vector < dynamic\_one\_dim\_histogram > >::iterator it = pkHistogram\_.begin(); it 
      != pkHistogram\_.end(); ++it) \{
1062         \textcolor{keywordflow}{for} (std::vector < dynamic\_one\_dim\_histogram >::iterator it2 = it->begin(); it2 != it->end(); ++it2
      ) \{
1063             \textcolor{keywordflow}{try} \{
1064                 it2->trim\_edges();
1065             \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
1066                 \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Unable to trim edges in pkHistogram at each Ntot"});
1067             \}
1068         \}
1069     \}
1070 \}
\end{DoxyCode}
\hypertarget{classsim_system_a861dd81718ef1c069fa7cfb9b7efe83c}{\index{sim\-System@{sim\-System}!re\-Initialize\-Energy\-Histogram@{re\-Initialize\-Energy\-Histogram}}
\index{re\-Initialize\-Energy\-Histogram@{re\-Initialize\-Energy\-Histogram}!simSystem@{sim\-System}}
\subsubsection[{re\-Initialize\-Energy\-Histogram}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::re\-Initialize\-Energy\-Histogram (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classsim_system_a861dd81718ef1c069fa7cfb9b7efe83c}


Re-\/initialize the energy histogram with internal estimates of bounds. 

Intended to be used at crossover stage before T\-M\-M\-C. 

Definition at line 879 of file system.\-cpp.



References tot\-N\-Max(), and tot\-N\-Min().



Referenced by perform\-Crossover().


\begin{DoxyCode}
879                                              \{
880     \textcolor{keywordtype}{double} lb = 0.0, ub = 0.0;
881     \textcolor{keywordflow}{if} (energyHistogram\_lb\_.size() != energyHistogram\_ub\_.size()) \{
882         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Bad energy histogram bound sizes"});
883     \}
884     \textcolor{keywordflow}{if} (energyHistogram\_lb\_.size() != \hyperlink{classsim_system_aee2c65ecb43a35c0c4d070cdb45f7dc0}{totNMax}() - \hyperlink{classsim_system_af10842e0eaa638373b8717c87b47e6bc}{totNMin}() + 1) \{
885         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Bad energy histogram bound sizes"});
886     \}
887     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < \hyperlink{classsim_system_aee2c65ecb43a35c0c4d070cdb45f7dc0}{totNMax}() - \hyperlink{classsim_system_af10842e0eaa638373b8717c87b47e6bc}{totNMin}() + 1; ++i) \{
888         \textcolor{keywordflow}{if} (energyHistogram\_lb\_[i] > energyHistogram\_ub\_[i]) \{
889             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Bad energy histogram bound sizes"});
890         \}
891         \textcolor{comment}{// "Standardize" the bounds against U = 0 for to "align" the bins, already done for pkHistogram.}
892         \textcolor{comment}{// This allows overlapping windows to be merged, otherwise they are not "aligned".}
893         \textcolor{comment}{// Rounding does not account for rare edge cases where energy falls exactly on the border between
       bins, but does not matter since this will be automatically handled.}
894         \textcolor{comment}{// This is just to give the system a good "guess" to conserve memory.}
895         lb = round((energyHistogram\_lb\_[i] - 0.0)/energyHistDelta\_)*energyHistDelta\_;
896         ub = round((energyHistogram\_ub\_[i] - 0.0)/energyHistDelta\_)*energyHistDelta\_;
897 
898         \textcolor{keywordflow}{try} \{
899             energyHistogram\_[i].reinitialize(lb,ub,energyHistDelta\_);
900         \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
901             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Unable to reinitialize the energyHistogram"});
902         \}
903     \}
904 \}
\end{DoxyCode}
\hypertarget{classsim_system_ae073008ed44e551f0d008b2f5a0fc06f}{\index{sim\-System@{sim\-System}!restart\-Energy\-Histogram@{restart\-Energy\-Histogram}}
\index{restart\-Energy\-Histogram@{restart\-Energy\-Histogram}!simSystem@{sim\-System}}
\subsubsection[{restart\-Energy\-Histogram}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::restart\-Energy\-Histogram (
\begin{DoxyParamCaption}
\item[{const std\-::string}]{prefix}
\end{DoxyParamCaption}
)}}\label{classsim_system_ae073008ed44e551f0d008b2f5a0fc06f}


Restart the energy histogram for each Ntot from unnormalized checkpoint. 

This will check for \char`\"{}alignment\char`\"{} of energy bins to 0. So \char`\"{}manually\char`\"{} prepared files are likely to fail, but this is intended to restart from system-\/generated files anyway.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em prefix} & Prefix of the filename to load from \\
\hline
\end{DoxyParams}


Definition at line 969 of file system.\-cpp.



References tot\-N\-Max(), and tot\-N\-Min().



Referenced by checkpoint\-::load().


\begin{DoxyCode}
969                                                               \{
970     \textcolor{keywordtype}{int} minBound = 0, maxBound = \hyperlink{classsim_system_aee2c65ecb43a35c0c4d070cdb45f7dc0}{totNMax}() - \hyperlink{classsim_system_af10842e0eaa638373b8717c87b47e6bc}{totNMin}() + 1;
971     std::vector < double > lb(maxBound - minBound, 0), ub(maxBound - minBound, 0), delta(maxBound - 
      minBound, 0);
972     std::string fileName = prefix+\textcolor{stringliteral}{".dat"};
973 
974     std::ifstream infile (fileName.c\_str());
975     \textcolor{keywordflow}{if} (!infile.is\_open()) \{
976         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Cannot load energyHistogram from "}+fileName);
977     \}
978 
979     std::string line, tmp = \textcolor{stringliteral}{""};
980     \textcolor{keywordtype}{int} lineIndex = 0;
981     \textcolor{keywordflow}{while}(std::getline(infile,line)) \{
982         std::stringstream lineStream(line);
983         \textcolor{keywordflow}{if} (lineIndex == 2) \{
984             \textcolor{comment}{// get upper bound}
985             std::getline(lineStream, tmp, \textcolor{charliteral}{':'});
986             std::getline(lineStream, tmp, \textcolor{charliteral}{':'});
987             \textcolor{keywordtype}{int} high = atoi(tmp.c\_str());
988             \textcolor{keywordflow}{if} (high != \hyperlink{classsim_system_aee2c65ecb43a35c0c4d070cdb45f7dc0}{totNMax}()) \{
989                 \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Max bound ("}+ std::to\_string(high)+\textcolor{stringliteral}{") is not Nmax("}+
      std::to\_string(\hyperlink{classsim_system_aee2c65ecb43a35c0c4d070cdb45f7dc0}{totNMax}())+\textcolor{stringliteral}{"), cannot restart energy histogram from "}+fileName);
990             \}
991         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (lineIndex == 3) \{
992             \textcolor{comment}{// get lower bound}
993             std::getline(lineStream, tmp, \textcolor{charliteral}{':'});
994             std::getline(lineStream, tmp, \textcolor{charliteral}{':'});
995             \textcolor{keywordtype}{int} low = atoi(tmp.c\_str());
996             \textcolor{keywordflow}{if} (low != \hyperlink{classsim_system_af10842e0eaa638373b8717c87b47e6bc}{totNMin}()) \{
997                 \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Min bound ("}+ std::to\_string(low)+\textcolor{stringliteral}{") is not Nmin("}+
      std::to\_string(\hyperlink{classsim_system_af10842e0eaa638373b8717c87b47e6bc}{totNMin}())+\textcolor{stringliteral}{"), cannot restart energy histogram from "}+fileName);
998             \}
999         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (lineIndex == 6) \{
1000             \textcolor{comment}{// delta}
1001             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < maxBound-minBound; ++i) \{
1002                 lineStream >> delta[i];
1003             \}
1004         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (lineIndex == 8) \{
1005             \textcolor{comment}{// lower bound}
1006             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < maxBound-minBound; ++i) \{
1007                 lineStream >> lb[i];
1008             \}
1009             \textcolor{comment}{// check that system "aligned" the lower bounds so that a bin falls centered at U = 0}
1010             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < maxBound-minBound; ++i) \{
1011                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} x = (lb[i] - 0.0)/delta[i];
1012                 \textcolor{keyword}{const} \textcolor{keywordtype}{double} err = fabs(round(x) - x);
1013                 \textcolor{keywordflow}{if} (err >= 1.0e-6) \{
1014                     \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Energy bins not aligned to U = 0, cannot restart
       energy histogram from "}+fileName+\textcolor{stringliteral}{" (err, "}+std::to\_string(i)+\textcolor{stringliteral}{") = "}+std::to\_string(err));
1015                 \}
1016             \}
1017         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (lineIndex == 10) \{
1018             \textcolor{comment}{// upper bound}
1019             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < maxBound-minBound; ++i) \{
1020                 lineStream >> ub[i];
1021             \}
1022             \textcolor{comment}{// now can reinitialize the histogram}
1023             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = minBound; i < maxBound; ++i) \{
1024                 \textcolor{keywordflow}{try} \{
1025                     energyHistogram\_[i-minBound].reinitialize(lb[i-minBound], ub[i-minBound], delta[i-
      minBound]);
1026                 \} \textcolor{keywordflow}{catch} (...) \{
1027                     \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Unable to restart energy histogram from "}+
      fileName);
1028                 \}
1029             \}
1030         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (lineIndex >= 12) \{
1031             \textcolor{comment}{// histogram itself}
1032             std::deque <double> h = energyHistogram\_[lineIndex-12].get\_hist();
1033             \textcolor{keywordflow}{for} (std::deque <double>::iterator it = h.begin(); it != h.end(); ++it) \{
1034                 lineStream >> *it;
1035             \}
1036             energyHistogram\_[lineIndex-12].set\_hist(h);
1037         \}
1038         lineIndex++;
1039     \}
1040     infile.close();
1041 \}
\end{DoxyCode}
\hypertarget{classsim_system_a999556fea891765c5ed4d979706665af}{\index{sim\-System@{sim\-System}!restart\-Ext\-Moments@{restart\-Ext\-Moments}}
\index{restart\-Ext\-Moments@{restart\-Ext\-Moments}!simSystem@{sim\-System}}
\subsubsection[{restart\-Ext\-Moments}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::restart\-Ext\-Moments (
\begin{DoxyParamCaption}
\item[{const std\-::string}]{prefix, }
\item[{const std\-::vector$<$ double $>$ \&}]{ctr}
\end{DoxyParamCaption}
)}}\label{classsim_system_a999556fea891765c5ed4d979706665af}


Restart the extensive energy histogram for each Ntot from unnormalized checkpoint. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em file\-Name} & Name of the file to load from \\
\hline
\mbox{\tt in}  & {\em ctr} & Counter for each point in the histogram \\
\hline
\end{DoxyParams}


Definition at line 742 of file system.\-cpp.



References histogram\-::get\-Address(), get\-Max\-Order(), histogram\-::get\-Raw\-Histogram(), histogram\-::set(), tot\-N\-Max(), tot\-N\-Min(), and custom\-Exception\-::what().



Referenced by checkpoint\-::load().


\begin{DoxyCode}
742                                                                                          \{
743     std::string fileName = prefix+\textcolor{stringliteral}{".dat"};
744 
745     std::ifstream infile (fileName.c\_str());
746     \textcolor{keywordflow}{if} (!infile.is\_open()) \{
747         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Cannot load extMoments from "}+fileName);
748     \}
749 
750     std::string line, tmp = \textcolor{stringliteral}{""};
751     \textcolor{keywordtype}{int} lineIndex = 0, dummy;
752     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} idx;
753     std::vector < double > h = extensive\_moments\_.\hyperlink{classhistogram_a3a75adbce72057f3a4db805d9efc3c9c}{getRawHistogram} (), coords (6, 0);
754 
755     \textcolor{keywordflow}{while}(std::getline(infile,line)) \{
756         std::stringstream lineStream(line);
757         \textcolor{keywordflow}{if} (lineIndex == 1) \{
758             std::getline(lineStream, tmp, \textcolor{charliteral}{':'});
759             std::getline(lineStream, tmp, \textcolor{charliteral}{':'});
760             \textcolor{keywordtype}{int} ns = atoi(tmp.c\_str());
761             \textcolor{keywordflow}{if} (ns != nSpecies\_) \{
762                 \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Number of speces in restart file ("}+ std::to\_string(
      ns)+\textcolor{stringliteral}{") is not the same as provided in input ("}+std::to\_string(nSpecies\_)+\textcolor{stringliteral}{"), cannot restart extMom from "}+
      fileName);
763             \}
764         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (lineIndex == 2) \{
765             std::getline(lineStream, tmp, \textcolor{charliteral}{':'});
766             std::getline(lineStream, tmp, \textcolor{charliteral}{':'});
767             \textcolor{keywordtype}{int} mo = atoi(tmp.c\_str());
768             \textcolor{keywordflow}{if} (mo != \hyperlink{classsim_system_afe08187d318113c33bda890c69570c36}{getMaxOrder}()) \{
769                 \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Max order ("}+ std::to\_string(mo)+\textcolor{stringliteral}{") is not the same
       as provided in input ("}+std::to\_string(\hyperlink{classsim_system_afe08187d318113c33bda890c69570c36}{getMaxOrder}())+\textcolor{stringliteral}{"), cannot restart extMom from "}+fileName);
770             \}
771         \} \textcolor{keywordflow}{if} (lineIndex == 3) \{
772             std::getline(lineStream, tmp, \textcolor{charliteral}{':'});
773             std::getline(lineStream, tmp, \textcolor{charliteral}{':'});
774             \textcolor{keywordtype}{int} high = atoi(tmp.c\_str());
775             \textcolor{keywordflow}{if} (high != \hyperlink{classsim_system_aee2c65ecb43a35c0c4d070cdb45f7dc0}{totNMax}()) \{
776                 \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Max bound ("}+ std::to\_string(high)+\textcolor{stringliteral}{") is not Nmax ("}
      +std::to\_string(\hyperlink{classsim_system_aee2c65ecb43a35c0c4d070cdb45f7dc0}{totNMax}())+\textcolor{stringliteral}{"), cannot restart extMom from "}+fileName);
777             \}
778         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (lineIndex == 4) \{
779             std::getline(lineStream, tmp, \textcolor{charliteral}{':'});
780             std::getline(lineStream, tmp, \textcolor{charliteral}{':'});
781             \textcolor{keywordtype}{int} low = atoi(tmp.c\_str());
782             \textcolor{keywordflow}{if} (low != \hyperlink{classsim_system_af10842e0eaa638373b8717c87b47e6bc}{totNMin}()) \{
783                 \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Min bound ("}+ std::to\_string(low)+\textcolor{stringliteral}{") is not Nmin ("}+
      std::to\_string(\hyperlink{classsim_system_af10842e0eaa638373b8717c87b47e6bc}{totNMin}())+\textcolor{stringliteral}{"), cannot restart extMom from "}+fileName);
784             \}
785 
786             \textcolor{comment}{// now reinstantiate the histogram}
787             std::vector < double > lbn (6,0), ubn(6,0);
788             std::vector < long long unsigned int > nbn (6,0);
789             ubn[0] = nSpecies\_-1;
790             ubn[1] = max\_order\_;
791             ubn[2] = nSpecies\_-1;
792             ubn[3] = max\_order\_;
793             ubn[4] = max\_order\_;
794             ubn[5] = \hyperlink{classsim_system_aee2c65ecb43a35c0c4d070cdb45f7dc0}{totNMax}()-\hyperlink{classsim_system_af10842e0eaa638373b8717c87b47e6bc}{totNMin}();
795 
796             nbn[0] = nSpecies\_;
797             nbn[1] = max\_order\_+1;
798             nbn[2] = nSpecies\_;
799             nbn[3] = max\_order\_+1;
800             nbn[4] = max\_order\_+1;
801             nbn[5] = \hyperlink{classsim_system_aee2c65ecb43a35c0c4d070cdb45f7dc0}{totNMax}()-\hyperlink{classsim_system_af10842e0eaa638373b8717c87b47e6bc}{totNMin}()+1;
802 
803             \hyperlink{classhistogram}{histogram} hnn (lbn, ubn, nbn);
804             extensive\_moments\_ = hnn;
805         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (lineIndex >= 7) \{
806             \textcolor{comment}{// histogram itself}
807             lineStream >> dummy;
808             coords[5] = lineIndex-7;
809             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < nSpecies\_; ++i) \{
810                 coords[0] = i;
811                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j <= max\_order\_; ++j) \{
812                     coords[1] = j;
813                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} k = 0; k < nSpecies\_; ++k) \{
814                         coords[2] = k;
815                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} m = 0; m <= max\_order\_; ++m) \{
816                             coords[3] = m;
817                             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} p = 0; p <= max\_order\_; ++p) \{
818                                 coords[4] = p;
819                                 idx = extensive\_moments\_.\hyperlink{classhistogram_ae52fa58934b56e05846a66e43c3184bd}{getAddress}(coords);
820                                 lineStream >> h[idx];
821                             \}
822                         \}
823                     \}
824                 \}
825             \}
826         \}
827         lineIndex++;
828     \}
829     infile.close();
830 
831     \textcolor{keywordflow}{try} \{
832         \textcolor{comment}{// this checks h and ctr same size, and by extension that h from file has same size as h in system}
833         extensive\_moments\_.\hyperlink{classhistogram_aab27615593d020ca4de29c586c92af37}{set}(h, ctr);
834     \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
835         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Unable to restart extMom from "}+fileName+\textcolor{stringliteral}{" : "}+ce.
      \hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}());
836     \}
837 \}
\end{DoxyCode}
\hypertarget{classsim_system_a3239a23e35f30e40eeecf8795386c164}{\index{sim\-System@{sim\-System}!restart\-Pk\-Histogram@{restart\-Pk\-Histogram}}
\index{restart\-Pk\-Histogram@{restart\-Pk\-Histogram}!simSystem@{sim\-System}}
\subsubsection[{restart\-Pk\-Histogram}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::restart\-Pk\-Histogram (
\begin{DoxyParamCaption}
\item[{const std\-::string}]{prefix}
\end{DoxyParamCaption}
)}}\label{classsim_system_a3239a23e35f30e40eeecf8795386c164}


Restart the particle histogram for each Ntot from unnormalized checkpoint. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em prefix} & Prefix of the filename to load from \\
\hline
\end{DoxyParams}


Definition at line 1136 of file system.\-cpp.



References tot\-N\-Max(), and tot\-N\-Min().



Referenced by checkpoint\-::load().


\begin{DoxyCode}
1136                                                           \{
1137     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} spec = 0; spec < nSpecies\_; ++spec) \{
1138         \textcolor{keywordtype}{int} minBound = 0, maxBound = \hyperlink{classsim_system_aee2c65ecb43a35c0c4d070cdb45f7dc0}{totNMax}() - \hyperlink{classsim_system_af10842e0eaa638373b8717c87b47e6bc}{totNMin}() + 1;
1139         std::vector < double > lb(maxBound - minBound, 0), ub(maxBound - minBound, 0), delta(maxBound - 
      minBound, 0);
1140         std::string fileName = prefix+\textcolor{stringliteral}{"\_"}+std::to\_string(spec+1)+\textcolor{stringliteral}{".dat"};
1141 
1142         std::ifstream infile (fileName.c\_str());
1143         \textcolor{keywordflow}{if} (!infile.is\_open()) \{
1144             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Cannot load pkHistogram from "}+fileName);
1145         \}
1146 
1147         std::string line, tmp = \textcolor{stringliteral}{""};
1148         \textcolor{keywordtype}{int} lineIndex = 0;
1149         \textcolor{keywordflow}{while}(std::getline(infile,line)) \{
1150             std::stringstream lineStream(line);
1151             \textcolor{keywordflow}{if} (lineIndex == 2) \{
1152                 \textcolor{comment}{// get upper bound}
1153                 std::getline(lineStream, tmp, \textcolor{charliteral}{':'});
1154                 std::getline(lineStream, tmp, \textcolor{charliteral}{':'});
1155                 \textcolor{keywordtype}{int} high = atoi(tmp.c\_str());
1156                 \textcolor{keywordflow}{if} (high != \hyperlink{classsim_system_aee2c65ecb43a35c0c4d070cdb45f7dc0}{totNMax}()) \{
1157                     \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Max bound ("}+ std::to\_string(high)+\textcolor{stringliteral}{") is not
       Nmax("}+std::to\_string(\hyperlink{classsim_system_aee2c65ecb43a35c0c4d070cdb45f7dc0}{totNMax}())+\textcolor{stringliteral}{"), cannot restart particle histogram from "}+fileName);
1158                 \}
1159             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (lineIndex == 3) \{
1160                 \textcolor{comment}{// get lower bound}
1161                 std::getline(lineStream, tmp, \textcolor{charliteral}{':'});
1162                 std::getline(lineStream, tmp, \textcolor{charliteral}{':'});
1163                 \textcolor{keywordtype}{int} low = atoi(tmp.c\_str());
1164                 \textcolor{keywordflow}{if} (low != \hyperlink{classsim_system_af10842e0eaa638373b8717c87b47e6bc}{totNMin}()) \{
1165                     \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Min bound ("}+ std::to\_string(low)+\textcolor{stringliteral}{") is not
       Nmin("}+std::to\_string(\hyperlink{classsim_system_af10842e0eaa638373b8717c87b47e6bc}{totNMin}())+\textcolor{stringliteral}{"), cannot restart particle histogram from "}+fileName);
1166                 \}
1167             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (lineIndex == 1) \{
1168                 \textcolor{comment}{// check the number of species is correct}
1169                 std::getline(lineStream, tmp, \textcolor{charliteral}{':'});
1170                 std::getline(lineStream, tmp, \textcolor{charliteral}{':'});
1171                 \textcolor{keywordtype}{int} ns = atoi(tmp.c\_str());
1172                 \textcolor{keywordflow}{if} (ns != nSpecies\_) \{
1173                     \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Number of speces in restart file ("}+ 
      std::to\_string(ns)+\textcolor{stringliteral}{") is not the same as provided in input ("}+std::to\_string(nSpecies\_)+\textcolor{stringliteral}{"), cannot restart particle
       histogram from "}+fileName);
1174                 \}
1175             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (lineIndex == 6) \{
1176                 \textcolor{comment}{// delta}
1177                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < maxBound-minBound; ++i) \{
1178                     lineStream >> delta[i];
1179                 \}
1180             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (lineIndex == 8) \{
1181                 \textcolor{comment}{// lower bound}
1182                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < maxBound-minBound; ++i) \{
1183                     lineStream >> lb[i];
1184                 \}
1185             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (lineIndex == 10) \{
1186                 \textcolor{comment}{// upper bound}
1187                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < maxBound-minBound; ++i) \{
1188                     lineStream >> ub[i];
1189                 \}
1190                 \textcolor{comment}{// now can reinitialize the histogram}
1191                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = minBound; i < maxBound; ++i) \{
1192                     \textcolor{keywordflow}{try} \{
1193                         pkHistogram\_[spec][i-minBound].reinitialize(lb[i-minBound], ub[i-minBound], delta[i
      -minBound]);
1194                     \} \textcolor{keywordflow}{catch} (...) \{
1195                         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Unable to restart particle histogram from "}+
      fileName);
1196                     \}
1197                 \}
1198             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (lineIndex >= 12) \{
1199                 \textcolor{comment}{// histogram itself}
1200                 std::deque <double> h = pkHistogram\_[spec][lineIndex-12].get\_hist();
1201                 \textcolor{keywordflow}{for} (std::deque <double>::iterator it = h.begin(); it != h.end(); ++it) \{
1202                     lineStream >> *it;
1203                 \}
1204                 pkHistogram\_[spec][lineIndex-12].set\_hist(h);
1205             \}
1206             lineIndex++;
1207         \}
1208         infile.close();
1209     \}
1210 \}
\end{DoxyCode}
\hypertarget{classsim_system_a51539ed4c3bb4905b32ce428c1c537fe}{\index{sim\-System@{sim\-System}!scratch\-Energy@{scratch\-Energy}}
\index{scratch\-Energy@{scratch\-Energy}!simSystem@{sim\-System}}
\subsubsection[{scratch\-Energy}]{\setlength{\rightskip}{0pt plus 5cm}const double sim\-System\-::scratch\-Energy (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classsim_system_a51539ed4c3bb4905b32ce428c1c537fe}


Recalculate the energy of the system from scratch. 

\begin{DoxyReturn}{Returns}
tot\-U Total energy of the system 
\end{DoxyReturn}


Definition at line 1545 of file system.\-cpp.



References atoms, N\-U\-M\-\_\-\-I\-N\-F\-I\-N\-I\-T\-Y, num\-Species, ppot, species\-Barriers, and custom\-Exception\-::what().



Referenced by read\-Config(), and sanity\-Checks().


\begin{DoxyCode}
1545                                        \{
1546     \textcolor{keywordtype}{double} totU = 0.0;
1547     \textcolor{keywordtype}{double} V = 1.0;
1548 
1549     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < box\_.size(); ++i) \{
1550         V *= box\_[i];
1551     \}
1552 
1553     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} spec1 = 0; spec1 < nSpecies\_; ++spec1) \{
1554         \textcolor{keywordtype}{int} num1 = 0, adj1 = 0;
1555         \textcolor{keywordflow}{try} \{
1556             num1 = \hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[spec1];
1557         \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
1558             std::string a = \textcolor{stringliteral}{"Cannot recalculate energy from scratch: "}, b = ce.
      \hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}();
1559             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (a+b);
1560         \}
1561 
1562         \textcolor{comment}{// Possibly have fractionally inserted atom}
1563         \textcolor{keywordflow}{if} (fractionalAtomType\_ == spec1 && Mcurrent\_ > 0) \{
1564             adj1 = 1;
1565         \}
1566 
1567         \textcolor{comment}{// Wall/barrier interactions}
1568         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < num1+adj1; ++j) \{
1569             \textcolor{keywordtype}{double} dU = 0.0;
1570             \textcolor{keywordflow}{try} \{
1571                 dU = \hyperlink{classsim_system_a5ae652ff4519f39c3862abae32a9581b}{speciesBarriers}[spec1].energy(&\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[spec1][j], box\_);
1572             \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
1573                 std::string a = \textcolor{stringliteral}{"Cannot recalculate energy from scratch: "}, b = ce.
      \hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}();
1574                 \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (a+b);
1575             \}
1576             \textcolor{keywordflow}{if} (dU == \hyperlink{potentials_8h_ab94ab1d09e2291d03fe92a0e24a9d33b}{NUM\_INFINITY}) \{
1577                 \textcolor{keywordflow}{return} \hyperlink{potentials_8h_ab94ab1d09e2291d03fe92a0e24a9d33b}{NUM\_INFINITY};
1578             \} \textcolor{keywordflow}{else} \{
1579                 totU += dU;
1580             \}
1581         \}
1582 
1583         \textcolor{comment}{// Interactions with same type}
1584         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < num1+adj1; ++j) \{
1585             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} k = j+1; k < num1+adj1; ++k) \{
1586                 \textcolor{keywordflow}{try} \{
1587                     totU += \hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[spec1][spec1]->energy(&\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[spec1][j], &
      \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[spec1][k], box\_);
1588                 \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
1589                     std::string a = \textcolor{stringliteral}{"Cannot recalculate energy from scratch: "}, b = ce.
      \hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}();
1590                     \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (a+b);
1591                 \}
1592             \}
1593         \}
1594 
1595         \textcolor{comment}{// Add tail correction to potential energy but only for atoms fully inserted}
1596 \textcolor{preprocessor}{#ifdef FLUID\_PHASE\_SIMULATIONS}
1597 \textcolor{preprocessor}{}        \textcolor{keywordflow}{if} ((\hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[spec1][spec1]->useTailCorrection) && (num1 > 1)) \{
1598             totU += (num1)*0.5*\hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[spec1][spec1]->tailCorrection((num1-1)/V);
1599         \}
1600 \textcolor{preprocessor}{#endif}
1601 \textcolor{preprocessor}{}
1602         \textcolor{comment}{// Interactions with other unique types}
1603         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} spec2 = spec1+1; spec2 < nSpecies\_; ++spec2) \{
1604             \textcolor{keywordtype}{int} num2 = 0, adj2 = 0;
1605             \textcolor{keywordflow}{try} \{
1606                 num2 = \hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[spec2];
1607             \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
1608                 std::string a = \textcolor{stringliteral}{"Cannot recalculate energy from scratch: "}, b = ce.
      \hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}();
1609                 \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (a+b);
1610             \}
1611 
1612             \textcolor{keywordflow}{if} (fractionalAtomType\_ == spec2 && Mcurrent\_ > 0) \{
1613                 adj2 = 1;
1614             \}
1615 
1616             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < num1+adj1; ++j) \{
1617                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} k = 0; k < num2+adj2; ++k) \{
1618                     \textcolor{keywordflow}{try} \{
1619                         totU += \hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[spec1][spec2]->energy(&\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[spec1][j], &
      \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[spec2][k], box\_);
1620                     \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException} &ce) \{
1621                         std::string a = \textcolor{stringliteral}{"Cannot recalculate energy from scratch: "}, b = ce.
      \hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}();
1622                         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (a+b);
1623                     \}
1624                 \}
1625             \}
1626 
1627             \textcolor{comment}{// Add tail correction to potential energy but only bewteen fully inserted species}
1628 \textcolor{preprocessor}{#ifdef FLUID\_PHASE\_SIMULATIONS}
1629 \textcolor{preprocessor}{}            \textcolor{keywordflow}{if} ((\hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[spec1][spec2]->useTailCorrection) && (num2 > 0) && (num1 > 0)) \{
1630                 totU += (num1)*\hyperlink{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{ppot}[spec1][spec2]->tailCorrection(num2/V);
1631             \}
1632 \textcolor{preprocessor}{#endif}
1633 \textcolor{preprocessor}{}        \}
1634     \}
1635 
1636     \textcolor{keywordflow}{if} (toggleKE\_ == \textcolor{keyword}{true}) \{
1637         \textcolor{keywordtype}{double} ns = 0.0;
1638         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < nSpecies\_; ++i) \{
1639             ns += \hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[i];
1640         \}
1641         totU += 1.5/beta\_*ns; \textcolor{comment}{// Only adjust for FULLY-INSERTED ATOMS}
1642     \}
1643 
1644     \textcolor{keywordflow}{return} totU;
1645 \}
\end{DoxyCode}
\hypertarget{classsim_system_a284cf6c00f572db12db0cb263974a78a}{\index{sim\-System@{sim\-System}!set\-E\-L\-B@{set\-E\-L\-B}}
\index{set\-E\-L\-B@{set\-E\-L\-B}!simSystem@{sim\-System}}
\subsubsection[{set\-E\-L\-B}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::set\-E\-L\-B (
\begin{DoxyParamCaption}
\item[{const std\-::vector$<$ double $>$}]{elb}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_a284cf6c00f572db12db0cb263974a78a}


Assign energy lower bound from restart. 



Definition at line 43 of file system.\-h.



Referenced by checkpoint\-::load().

\hypertarget{classsim_system_ab894de5ccd37efa97ae799f1dc1875a1}{\index{sim\-System@{sim\-System}!set\-E\-U\-B@{set\-E\-U\-B}}
\index{set\-E\-U\-B@{set\-E\-U\-B}!simSystem@{sim\-System}}
\subsubsection[{set\-E\-U\-B}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::set\-E\-U\-B (
\begin{DoxyParamCaption}
\item[{const std\-::vector$<$ double $>$}]{eub}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_ab894de5ccd37efa97ae799f1dc1875a1}


Assign energy upper bound from restart. 



Definition at line 42 of file system.\-h.



Referenced by checkpoint\-::load().

\hypertarget{classsim_system_a76b5dc3e179e275e40726c660d8e669b}{\index{sim\-System@{sim\-System}!set\-Tot\-N\-Bounds@{set\-Tot\-N\-Bounds}}
\index{set\-Tot\-N\-Bounds@{set\-Tot\-N\-Bounds}!simSystem@{sim\-System}}
\subsubsection[{set\-Tot\-N\-Bounds}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::set\-Tot\-N\-Bounds (
\begin{DoxyParamCaption}
\item[{const std\-::vector$<$ int $>$ \&}]{bounds}
\end{DoxyParamCaption}
)}}\label{classsim_system_a76b5dc3e179e275e40726c660d8e669b}


Set the bounds on the total number of particles in a system. 

If not set manually, this defaults to the sum of the bounds given for each individual species in the system. Therefore, for single component simulations, this is identical to \mbox{[}min\-Species(0), max\-Species(0)\mbox{]} unless otherwise set. These bounds are intended to be used to create \char`\"{}windows\char`\"{} so that specific simulations can sample subregions of \mbox{[}min\-Species(0), max\-Species(0)\mbox{]} and be stitched together with histogram reweighting later.

However, this routine will A\-L\-S\-O cause the system to reevaluate its bounds. If these total bounds are outside any individual bound for each atom type, nothing will change. However, if the upper bound for total atoms is less than an upper bound for a specific species, that species will have its bounds changed to match the total maximum. As a result sys.\-atoms can change so this routine should be called at the beginning of a simulation, never during. The total minimum will also be checked. That is, if the sum of the minimum for all species is still higher than this, an exception will be throw since the system will never reach such a low density anyway. Most likely the user has made a mistake.

Be sure to initialize other objects, such as biases, A\-F\-T\-E\-R this routine has been called since it will adjust the allowable number of particles in the system.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em bounds} & Vector of \mbox{[}min, max\mbox{]} \\
\hline
\end{DoxyParams}


Definition at line 41 of file system.\-cpp.



References atoms, and num\-Species.



Referenced by initialize().


\begin{DoxyCode}
41                                                               \{
42     \textcolor{keywordflow}{if} (bounds.size() != 2) \{
43         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Bounds on total N must supplied as vector of <minN, maxN>"});
44     \}
45     \textcolor{keywordflow}{if} (bounds[0] < 0) \{
46         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Lower bound on total particles must be > 0"});
47     \}
48     \textcolor{keywordflow}{if} (bounds[0] > bounds[1]) \{
49         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Upper bound must be greater than lower bound for total
       number of particles in the system"});
50     \}
51     totNBounds\_ = bounds;
52 
53     \textcolor{keywordtype}{int} totMin = 0;
54     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < nSpecies\_; ++i) \{
55         \textcolor{keywordflow}{if} (maxSpecies\_[i] > totNBounds\_[1]) \{
56             maxSpecies\_[i] = totNBounds\_[1];
57         \}
58         \textcolor{keywordflow}{if} (maxSpecies\_[i] < totNBounds\_[1]) \{
59             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Upper bound for species "}+std::to\_string(i+1)+\textcolor{stringliteral}{" is lower
       than overall max, so cannot realize possibility of system being full of this species"});
60         \}
61         totMin += minSpecies\_[i];
62     \}
63     \textcolor{keywordflow}{if} (totMin > totNBounds\_[0]) \{
64         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Lower total N bound is lower than the sum of all individual
       lower bounds, region cannot be completely sampled"});
65     \}
66 
67     \textcolor{comment}{// recheck bounds and possibly resize}
68     \textcolor{keywordtype}{int} tmpTot = 0;
69     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < nSpecies\_; ++i) \{
70         \textcolor{keywordflow}{if} (maxSpecies\_[i] < minSpecies\_[i]) \{
71             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Max species < Min species"});
72         \}
73         \textcolor{keywordflow}{try} \{
74             \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[i].resize(maxSpecies\_[i], \hyperlink{classatom}{atom}());
75         \} \textcolor{keywordflow}{catch} (std::exception &e) \{
76             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (e.what());
77         \}
78         \textcolor{comment}{// if numSpecies[i] above maxSpecies\_[i] for some reason, destroy the atoms beyond bound}
79         \textcolor{keywordflow}{if} (\hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[i] > (\textcolor{keywordtype}{int})\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[i].size()) \{
80             \hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[i] = \hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[i].size();
81         \}
82         tmpTot += \hyperlink{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{numSpecies}[i];
83     \}
84     totN\_ = tmpTot;
85 
86     \textcolor{comment}{// Allocate space for energy matrix - this will only be recorded when the system is within the specific
       window we are looking for}
87     \textcolor{comment}{// Because of implementation of Shen and Errington method, this syntax is the same for single and
       multicomponent systems}
88     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} size = totNBounds\_[1] - totNBounds\_[0] + 1;
89 
90     energyHistogram\_.resize(0);
91     energyHistogram\_lb\_.resize(size, -5.0);
92     energyHistogram\_ub\_.resize(size, 5.0);
93 
94     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < size; ++i) \{
95         \textcolor{keywordflow}{try} \{
96             \hyperlink{classdynamic__one__dim__histogram}{dynamic\_one\_dim\_histogram} dummyHist (energyHistogram\_lb\_[i], 
      energyHistogram\_ub\_[i], energyHistDelta\_);
97             energyHistogram\_.resize(i+1, dummyHist);
98         \} \textcolor{keywordflow}{catch} (std::bad\_alloc &ba) \{
99             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory for energy histogram for each Ntot"});
100         \}
101     \}
102 
103     pkHistogram\_.resize(0);
104     \hyperlink{classdynamic__one__dim__histogram}{dynamic\_one\_dim\_histogram} dummyPkHist (0.0, totNBounds\_[1], 1.0);
105     \textcolor{keywordflow}{try} \{
106         std::vector < dynamic\_one\_dim\_histogram > tmp (totNBounds\_[1]-totNBounds\_[0]+1, dummyPkHist);
107         pkHistogram\_.resize(nSpecies\_, tmp);
108     \} \textcolor{keywordflow}{catch} (std::bad\_alloc &ba) \{
109         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Out of memory for particle histogram for each Ntot"});
110     \}
111 
112     \textcolor{comment}{// initialize moments}
113     std::vector < double > lbn (6,0), ubn(6,0);
114     std::vector < long long unsigned int > nbn (6,0);
115     ubn[0] = nSpecies\_-1;
116     ubn[1] = max\_order\_;
117     ubn[2] = nSpecies\_-1;
118     ubn[3] = max\_order\_;
119     ubn[4] = max\_order\_;
120     ubn[5] = totNBounds\_[1]-totNBounds\_[0];
121 
122     nbn[0] = nSpecies\_;
123     nbn[1] = max\_order\_+1;
124     nbn[2] = nSpecies\_;
125     nbn[3] = max\_order\_+1;
126     nbn[4] = max\_order\_+1;
127     nbn[5] = size;
128 
129     \hyperlink{classhistogram}{histogram} hnn (lbn, ubn, nbn);
130     extensive\_moments\_ = hnn;
131 \}
\end{DoxyCode}
\hypertarget{classsim_system_ac689245cd8e9ddfdcd94d3871a5a5d6b}{\index{sim\-System@{sim\-System}!start\-T\-M\-M\-C@{start\-T\-M\-M\-C}}
\index{start\-T\-M\-M\-C@{start\-T\-M\-M\-C}!simSystem@{sim\-System}}
\subsubsection[{start\-T\-M\-M\-C}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::start\-T\-M\-M\-C (
\begin{DoxyParamCaption}
\item[{const long long int}]{tmmc\-Sweep\-Size, }
\item[{const int}]{Mtot}
\end{DoxyParamCaption}
)}}\label{classsim_system_ac689245cd8e9ddfdcd94d3871a5a5d6b}


Start using T\-M\-M\-C and instantiate the bias object. 

Start using a transition-\/matrix in the simulation.

Throws an exception if input values are illegal or there is another problem (e.\-g. memory).


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em tmmc\-Sweep\-Size} & Number of times each transition in the collection matrix must be visited for a \char`\"{}sweep\char`\"{} to be completed \\
\hline
\mbox{\tt in}  & {\em Mtot} & Total number of expanded ensemble state allowed within the system \\
\hline
\end{DoxyParams}


Definition at line 1734 of file system.\-cpp.



References tmmc\-Bias, use\-T\-M\-M\-C, and custom\-Exception\-::what().



Referenced by checkpoint\-::load(), perform\-Crossover(), and perform\-T\-M\-M\-C().


\begin{DoxyCode}
1734                                                                             \{
1735     \textcolor{comment}{// initialize the tmmc object}
1736     \textcolor{keywordflow}{try} \{
1737         \hyperlink{classsim_system_a13173f45a1e40a5f5a3552b0ebe15b54}{tmmcBias} = \textcolor{keyword}{new} \hyperlink{classtmmc}{tmmc} (totNBounds\_[1], totNBounds\_[0], Mtot, 
      \hyperlink{classsim_system_a56e284a361964d0a9ce5c45f41d56ab1}{tmmcSweepSize}, box\_);
1738     \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException}& ce) \{
1739         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Cannot start TMMC biasing in system: "}+std::to\_string(*ce.
      \hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}()));
1740     \}
1741 
1742     \hyperlink{classsim_system_aa474a50b6353c8897331b1ab1ce53ab1}{useTMMC} = \textcolor{keyword}{true};
1743 \}
\end{DoxyCode}
\hypertarget{classsim_system_a57af66c88ce4dc1aeb6a1cd3f14ff0bb}{\index{sim\-System@{sim\-System}!start\-W\-A\-L\-A@{start\-W\-A\-L\-A}}
\index{start\-W\-A\-L\-A@{start\-W\-A\-L\-A}!simSystem@{sim\-System}}
\subsubsection[{start\-W\-A\-L\-A}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::start\-W\-A\-L\-A (
\begin{DoxyParamCaption}
\item[{const double}]{ln\-F, }
\item[{const double}]{g, }
\item[{const double}]{s, }
\item[{const int}]{Mtot}
\end{DoxyParamCaption}
)}}\label{classsim_system_a57af66c88ce4dc1aeb6a1cd3f14ff0bb}


Start using Wang-\/\-Landau and instantiate the bias object. 



Definition at line 1717 of file system.\-cpp.



References use\-W\-A\-L\-A, custom\-Exception\-::what(), and wl\-Bias.



Referenced by checkpoint\-::load(), and perform\-W\-A\-L\-A().


\begin{DoxyCode}
1717                                                                                            \{
1718     \textcolor{comment}{// initialize the wala object}
1719     \textcolor{keywordflow}{try} \{
1720         \hyperlink{classsim_system_a6dc8d9f89dfcfa247a59bc50889c49e7}{wlBias} = \textcolor{keyword}{new} \hyperlink{classwala}{wala} (lnF, g, s, totNBounds\_[1], totNBounds\_[0], Mtot, box\_);
1721     \} \textcolor{keywordflow}{catch} (\hyperlink{classcustom_exception}{customException}& ce) \{
1722         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Cannot start Wang-Landau biasing in system: "}+std::to\_string
      (*ce.\hyperlink{classcustom_exception_aeb6ab5848b038adfc68fde86a512f691}{what}()));
1723     \}
1724 
1725     \hyperlink{classsim_system_aa83b00006b3919fb6e13f1bdeadece6a}{useWALA} = \textcolor{keyword}{true};
1726 \}
\end{DoxyCode}
\hypertarget{classsim_system_a69edcc2c27db3d4e94002ac5635e9030}{\index{sim\-System@{sim\-System}!stop\-T\-M\-M\-C@{stop\-T\-M\-M\-C}}
\index{stop\-T\-M\-M\-C@{stop\-T\-M\-M\-C}!simSystem@{sim\-System}}
\subsubsection[{stop\-T\-M\-M\-C}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::stop\-T\-M\-M\-C (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_a69edcc2c27db3d4e94002ac5635e9030}


Stop using T\-M\-M\-C and free the bias object. 



Definition at line 63 of file system.\-h.



References tmmc\-Bias, and use\-T\-M\-M\-C.



Referenced by perform\-T\-M\-M\-C().

\hypertarget{classsim_system_ad6febde00f19ae0787771f2d1d9e391b}{\index{sim\-System@{sim\-System}!stop\-W\-A\-L\-A@{stop\-W\-A\-L\-A}}
\index{stop\-W\-A\-L\-A@{stop\-W\-A\-L\-A}!simSystem@{sim\-System}}
\subsubsection[{stop\-W\-A\-L\-A}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::stop\-W\-A\-L\-A (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_ad6febde00f19ae0787771f2d1d9e391b}


Stop using Wang-\/\-Landau and free the bias object. 



Definition at line 61 of file system.\-h.



References use\-W\-A\-L\-A, and wl\-Bias.



Referenced by perform\-Crossover().

\hypertarget{classsim_system_aa5853448f04712e9163174860efadefd}{\index{sim\-System@{sim\-System}!toggle\-K\-E@{toggle\-K\-E}}
\index{toggle\-K\-E@{toggle\-K\-E}!simSystem@{sim\-System}}
\subsubsection[{toggle\-K\-E}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::toggle\-K\-E (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{classsim_system_aa5853448f04712e9163174860efadefd}


Toggle K\-E adjustment to energy setting. 



Definition at line 399 of file system.\-cpp.



Referenced by initialize(), and set\-Config().


\begin{DoxyCode}
399                          \{
400     \textcolor{keywordflow}{if} (toggleKE\_ == \textcolor{keyword}{false}) \{
401         toggleKE\_ = \textcolor{keyword}{true};
402     \} \textcolor{keywordflow}{else} \{
403         toggleKE\_ = \textcolor{keyword}{false};
404     \}
405 \}
\end{DoxyCode}
\hypertarget{classsim_system_aee2c65ecb43a35c0c4d070cdb45f7dc0}{\index{sim\-System@{sim\-System}!tot\-N\-Max@{tot\-N\-Max}}
\index{tot\-N\-Max@{tot\-N\-Max}!simSystem@{sim\-System}}
\subsubsection[{tot\-N\-Max}]{\setlength{\rightskip}{0pt plus 5cm}const int sim\-System\-::tot\-N\-Max (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_aee2c65ecb43a35c0c4d070cdb45f7dc0}


Return upper bound on the total number of atoms in the system. 



Definition at line 75 of file system.\-h.



Referenced by insert\-Particle\-::make(), perform\-T\-M\-M\-C(), re\-Initialize\-Energy\-Histogram(), restart\-Energy\-Histogram(), restart\-Ext\-Moments(), and restart\-Pk\-Histogram().

\hypertarget{classsim_system_af10842e0eaa638373b8717c87b47e6bc}{\index{sim\-System@{sim\-System}!tot\-N\-Min@{tot\-N\-Min}}
\index{tot\-N\-Min@{tot\-N\-Min}!simSystem@{sim\-System}}
\subsubsection[{tot\-N\-Min}]{\setlength{\rightskip}{0pt plus 5cm}const int sim\-System\-::tot\-N\-Min (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classsim_system_af10842e0eaa638373b8717c87b47e6bc}


Return lower bound on the total number of atoms in the system. 



Definition at line 76 of file system.\-h.



Referenced by delete\-Particle\-::make(), perform\-T\-M\-M\-C(), re\-Initialize\-Energy\-Histogram(), restart\-Energy\-Histogram(), restart\-Ext\-Moments(), restart\-Pk\-Histogram(), and set\-Config().

\hypertarget{classsim_system_a22fdaceea44abd6cd021bac1ecd11890}{\index{sim\-System@{sim\-System}!translate\-Atom@{translate\-Atom}}
\index{translate\-Atom@{translate\-Atom}!simSystem@{sim\-System}}
\subsubsection[{translate\-Atom}]{\setlength{\rightskip}{0pt plus 5cm}void sim\-System\-::translate\-Atom (
\begin{DoxyParamCaption}
\item[{const int}]{type\-Index, }
\item[{const int}]{atom\-Index, }
\item[{std\-::vector$<$ double $>$}]{old\-Pos}
\end{DoxyParamCaption}
)}}\label{classsim_system_a22fdaceea44abd6cd021bac1ecd11890}


Translate an atom in the system. 

Does all the bookkeeping behind the scenes. Do nothing if there is no cell list defined for the type


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em type\-Index} & What type the atom is ($>$= 0) \\
\hline
\mbox{\tt in}  & {\em atom\-Index} & Which atom {\itshape index} of type type\-Index to translate ($>$= 0) \\
\hline
\mbox{\tt in}  & {\em old\-Pos} & Old position of the atom. The current/new position should already be stored in the atom at sys.\-atoms\mbox{[}type\-Index\mbox{]}\mbox{[}atom\-Index\mbox{]} \\
\hline
\end{DoxyParams}


Definition at line 378 of file system.\-cpp.



References atoms, and cell\-List\-::translate\-Particle().



Referenced by agg\-Vol\-Bias3\-::make(), and translate\-Particle\-::make().


\begin{DoxyCode}
378                                                                                                  \{
379     \textcolor{keywordflow}{if} (typeIndex < nSpecies\_ && typeIndex >= 0) \{
380         \textcolor{keywordflow}{if} (atomIndex >= 0) \{
381             \textcolor{comment}{// delete particle from appropriate cell list, move to new one}
382             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i=0; i<nSpecies\_; i++) \{
383                 \textcolor{keywordflow}{if} (useCellList\_[typeIndex][i]) \{
384                     \hyperlink{classcell_list}{cellList}* cl = cellListsByPairType\_[typeIndex][i];
385                     cl->\hyperlink{classcell_list_a0d77368abdd5a4665ca2302b9a20509b}{translateParticle}(&\hyperlink{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{atoms}[typeIndex][atomIndex], oldPos);
386                 \}
387             \}
388         \} \textcolor{keywordflow}{else} \{
389             \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"Number of those atoms in system is out of bounds, cannot
       translate an atom of type index "}+std::to\_string(typeIndex));
390         \}
391     \} \textcolor{keywordflow}{else} \{
392         \textcolor{keywordflow}{throw} \hyperlink{classcustom_exception}{customException} (\textcolor{stringliteral}{"That species index does not exist, cannot translate the atom
      "});
393     \}
394 \}
\end{DoxyCode}


\subsection{Field Documentation}
\hypertarget{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}{\index{sim\-System@{sim\-System}!atoms@{atoms}}
\index{atoms@{atoms}!simSystem@{sim\-System}}
\subsubsection[{atoms}]{\setlength{\rightskip}{0pt plus 5cm}std\-::vector$<$ std\-::vector $<$ {\bf atom} $>$ $>$ sim\-System\-::atoms}}\label{classsim_system_a90421b19082f7fb8fc23b7264b1161e4}


Atoms in a matrix by type, and particle index, respectively that a system C\-A\-N hold but not all are actually \char`\"{}in\char`\"{} the system. 



Definition at line 118 of file system.\-h.



Referenced by delete\-Atom(), get\-Neighbor\-Atoms(), insert\-Atom(), agg\-Vol\-Bias3\-::make(), delete\-Particle\-::make(), translate\-Particle\-::make(), swap\-Particles\-::make(), print\-Snapshot(), sanity\-Checks(), scratch\-Energy(), set\-Tot\-N\-Bounds(), sim\-System(), and translate\-Atom().

\hypertarget{classsim_system_a3fb5d01fd3abf49f577c050968fba9d1}{\index{sim\-System@{sim\-System}!ln\-F\-\_\-end@{ln\-F\-\_\-end}}
\index{ln\-F\-\_\-end@{ln\-F\-\_\-end}!simSystem@{sim\-System}}
\subsubsection[{ln\-F\-\_\-end}]{\setlength{\rightskip}{0pt plus 5cm}double sim\-System\-::ln\-F\-\_\-end}}\label{classsim_system_a3fb5d01fd3abf49f577c050968fba9d1}


Starting and ending ln\-F for Wang-\/\-Landau. 



Definition at line 100 of file system.\-h.



Referenced by initialize(), perform\-W\-A\-L\-A(), and sim\-System().

\hypertarget{classsim_system_a794334e163fbeb4b4f61bcea676679ce}{\index{sim\-System@{sim\-System}!ln\-F\-\_\-start@{ln\-F\-\_\-start}}
\index{ln\-F\-\_\-start@{ln\-F\-\_\-start}!simSystem@{sim\-System}}
\subsubsection[{ln\-F\-\_\-start}]{\setlength{\rightskip}{0pt plus 5cm}double sim\-System\-::ln\-F\-\_\-start}}\label{classsim_system_a794334e163fbeb4b4f61bcea676679ce}


Definition at line 100 of file system.\-h.



Referenced by initialize(), perform\-W\-A\-L\-A(), and sim\-System().

\hypertarget{classsim_system_aa748f651ddd9a2bf6d88bfcab9153905}{\index{sim\-System@{sim\-System}!n\-Crossover\-Visits@{n\-Crossover\-Visits}}
\index{n\-Crossover\-Visits@{n\-Crossover\-Visits}!simSystem@{sim\-System}}
\subsubsection[{n\-Crossover\-Visits}]{\setlength{\rightskip}{0pt plus 5cm}long long int sim\-System\-::n\-Crossover\-Visits}}\label{classsim_system_aa748f651ddd9a2bf6d88bfcab9153905}


Number of crossovers that must occur before switching from W\-A\-L\-A to T\-M\-M\-C. 



Definition at line 98 of file system.\-h.



Referenced by initialize(), perform\-Crossover(), and sim\-System().

\hypertarget{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}{\index{sim\-System@{sim\-System}!num\-Species@{num\-Species}}
\index{num\-Species@{num\-Species}!simSystem@{sim\-System}}
\subsubsection[{num\-Species}]{\setlength{\rightskip}{0pt plus 5cm}std\-::vector$<$ int $>$ sim\-System\-::num\-Species}}\label{classsim_system_a9eea865e6dc1cff377b1e79c4d9c23f0}


Total number of each type of atom the system contains. 



Definition at line 117 of file system.\-h.



Referenced by delete\-Atom(), get\-Neighbor\-Atoms(), insert\-Atom(), agg\-Vol\-Bias3\-::make(), translate\-Particle\-::make(), delete\-Particle\-::make(), insert\-Particle\-::make(), swap\-Particles\-::make(), print\-Snapshot(), read\-Config(), record\-Ext\-Moments(), record\-Pk\-Histogram(), sanity\-Checks(), scratch\-Energy(), set\-Config(), set\-Tot\-N\-Bounds(), and sim\-System().

\hypertarget{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}{\index{sim\-System@{sim\-System}!ppot@{ppot}}
\index{ppot@{ppot}!simSystem@{sim\-System}}
\subsubsection[{ppot}]{\setlength{\rightskip}{0pt plus 5cm}std\-::vector$<$ std\-::vector $<$ std\-::shared\-\_\-ptr $<$ {\bf pair\-Potential} $>$ $>$ $>$ sim\-System\-::ppot}}\label{classsim_system_ad2e290b5963f132e6a3a56cee35c8e9f}


Matrix of pair potentials for atom types i, j. 



Definition at line 119 of file system.\-h.



Referenced by add\-Potential(), check\-Bounds(), delete\-Particle\-::make(), translate\-Particle\-::make(), swap\-Particles\-::make(), insert\-Particle\-::make(), scratch\-Energy(), set\-Pair\-Potentials(), and sim\-System().

\hypertarget{classsim_system_a0c81d3b606c070c801f8d86288e44391}{\index{sim\-System@{sim\-System}!restart\-From\-T\-M\-M\-C@{restart\-From\-T\-M\-M\-C}}
\index{restart\-From\-T\-M\-M\-C@{restart\-From\-T\-M\-M\-C}!simSystem@{sim\-System}}
\subsubsection[{restart\-From\-T\-M\-M\-C}]{\setlength{\rightskip}{0pt plus 5cm}bool sim\-System\-::restart\-From\-T\-M\-M\-C}}\label{classsim_system_a0c81d3b606c070c801f8d86288e44391}


Flags to restart from W\-A\-L\-A or T\-M\-M\-C initially. 



Definition at line 93 of file system.\-h.



Referenced by checkpoint\-::checkpoint(), initialize(), perform\-T\-M\-M\-C(), and sim\-System().

\hypertarget{classsim_system_a5ccdad82b3767ba21b1e4b1e36362082}{\index{sim\-System@{sim\-System}!restart\-From\-T\-M\-M\-C\-File@{restart\-From\-T\-M\-M\-C\-File}}
\index{restart\-From\-T\-M\-M\-C\-File@{restart\-From\-T\-M\-M\-C\-File}!simSystem@{sim\-System}}
\subsubsection[{restart\-From\-T\-M\-M\-C\-File}]{\setlength{\rightskip}{0pt plus 5cm}std\-::string sim\-System\-::restart\-From\-T\-M\-M\-C\-File}}\label{classsim_system_a5ccdad82b3767ba21b1e4b1e36362082}


Files to restart from W\-A\-L\-A or T\-M\-M\-C initially. 



Definition at line 115 of file system.\-h.



Referenced by initialize(), perform\-T\-M\-M\-C(), and sim\-System().

\hypertarget{classsim_system_a2b168c89742f4d64270583e7e54b2929}{\index{sim\-System@{sim\-System}!restart\-From\-W\-A\-L\-A@{restart\-From\-W\-A\-L\-A}}
\index{restart\-From\-W\-A\-L\-A@{restart\-From\-W\-A\-L\-A}!simSystem@{sim\-System}}
\subsubsection[{restart\-From\-W\-A\-L\-A}]{\setlength{\rightskip}{0pt plus 5cm}bool sim\-System\-::restart\-From\-W\-A\-L\-A}}\label{classsim_system_a2b168c89742f4d64270583e7e54b2929}


Definition at line 93 of file system.\-h.



Referenced by initialize(), perform\-W\-A\-L\-A(), and sim\-System().

\hypertarget{classsim_system_afbf0b172dc35572e71ec6d27a018e2fc}{\index{sim\-System@{sim\-System}!restart\-From\-W\-A\-L\-A\-File@{restart\-From\-W\-A\-L\-A\-File}}
\index{restart\-From\-W\-A\-L\-A\-File@{restart\-From\-W\-A\-L\-A\-File}!simSystem@{sim\-System}}
\subsubsection[{restart\-From\-W\-A\-L\-A\-File}]{\setlength{\rightskip}{0pt plus 5cm}std\-::string sim\-System\-::restart\-From\-W\-A\-L\-A\-File}}\label{classsim_system_afbf0b172dc35572e71ec6d27a018e2fc}


Definition at line 115 of file system.\-h.



Referenced by initialize(), perform\-W\-A\-L\-A(), and sim\-System().

\hypertarget{classsim_system_a5ae652ff4519f39c3862abae32a9581b}{\index{sim\-System@{sim\-System}!species\-Barriers@{species\-Barriers}}
\index{species\-Barriers@{species\-Barriers}!simSystem@{sim\-System}}
\subsubsection[{species\-Barriers}]{\setlength{\rightskip}{0pt plus 5cm}std\-::vector$<$ {\bf composite\-Barrier} $>$ sim\-System\-::species\-Barriers}}\label{classsim_system_a5ae652ff4519f39c3862abae32a9581b}


Barriers, if any, for each species. 



Definition at line 120 of file system.\-h.



Referenced by delete\-Particle\-::make(), translate\-Particle\-::make(), swap\-Particles\-::make(), insert\-Particle\-::make(), scratch\-Energy(), set\-Barriers(), and sim\-System().

\hypertarget{classsim_system_a13173f45a1e40a5f5a3552b0ebe15b54}{\index{sim\-System@{sim\-System}!tmmc\-Bias@{tmmc\-Bias}}
\index{tmmc\-Bias@{tmmc\-Bias}!simSystem@{sim\-System}}
\subsubsection[{tmmc\-Bias}]{\setlength{\rightskip}{0pt plus 5cm}{\bf tmmc}$\ast$ sim\-System\-::tmmc\-Bias}}\label{classsim_system_a13173f45a1e40a5f5a3552b0ebe15b54}


T\-M\-M\-C biasing function. 



Definition at line 112 of file system.\-h.



Referenced by calculate\-Bias(), get\-T\-M\-M\-C\-Bias(), agg\-Vol\-Bias3\-::make(), delete\-Particle\-::make(), translate\-Particle\-::make(), swap\-Particles\-::make(), insert\-Particle\-::make(), start\-T\-M\-M\-C(), stop\-T\-M\-M\-C(), and $\sim$sim\-System().

\hypertarget{classsim_system_a56e284a361964d0a9ce5c45f41d56ab1}{\index{sim\-System@{sim\-System}!tmmc\-Sweep\-Size@{tmmc\-Sweep\-Size}}
\index{tmmc\-Sweep\-Size@{tmmc\-Sweep\-Size}!simSystem@{sim\-System}}
\subsubsection[{tmmc\-Sweep\-Size}]{\setlength{\rightskip}{0pt plus 5cm}long long int sim\-System\-::tmmc\-Sweep\-Size}}\label{classsim_system_a56e284a361964d0a9ce5c45f41d56ab1}


Size of a sweep in T\-M\-M\-C. 



Definition at line 95 of file system.\-h.



Referenced by initialize(), checkpoint\-::load(), perform\-Crossover(), and perform\-T\-M\-M\-C().

\hypertarget{classsim_system_a78b107e20bcbf2f818264fa076de5db3}{\index{sim\-System@{sim\-System}!total\-T\-M\-M\-C\-Sweeps@{total\-T\-M\-M\-C\-Sweeps}}
\index{total\-T\-M\-M\-C\-Sweeps@{total\-T\-M\-M\-C\-Sweeps}!simSystem@{sim\-System}}
\subsubsection[{total\-T\-M\-M\-C\-Sweeps}]{\setlength{\rightskip}{0pt plus 5cm}long long int sim\-System\-::total\-T\-M\-M\-C\-Sweeps}}\label{classsim_system_a78b107e20bcbf2f818264fa076de5db3}


Total number of sweeps to perform during T\-M\-M\-C. 



Definition at line 96 of file system.\-h.



Referenced by initialize(), perform\-T\-M\-M\-C(), and sim\-System().

\hypertarget{classsim_system_aa474a50b6353c8897331b1ab1ce53ab1}{\index{sim\-System@{sim\-System}!use\-T\-M\-M\-C@{use\-T\-M\-M\-C}}
\index{use\-T\-M\-M\-C@{use\-T\-M\-M\-C}!simSystem@{sim\-System}}
\subsubsection[{use\-T\-M\-M\-C}]{\setlength{\rightskip}{0pt plus 5cm}bool sim\-System\-::use\-T\-M\-M\-C}}\label{classsim_system_aa474a50b6353c8897331b1ab1ce53ab1}


Logical stating whether or not to use T\-M\-M\-C biasing. 



Definition at line 91 of file system.\-h.



Referenced by calculate\-Bias(), get\-T\-M\-M\-C\-Bias(), agg\-Vol\-Bias3\-::make(), delete\-Particle\-::make(), translate\-Particle\-::make(), swap\-Particles\-::make(), insert\-Particle\-::make(), perform\-T\-M\-M\-C(), perform\-W\-A\-L\-A(), sim\-System(), start\-T\-M\-M\-C(), stop\-T\-M\-M\-C(), and $\sim$sim\-System().

\hypertarget{classsim_system_aa83b00006b3919fb6e13f1bdeadece6a}{\index{sim\-System@{sim\-System}!use\-W\-A\-L\-A@{use\-W\-A\-L\-A}}
\index{use\-W\-A\-L\-A@{use\-W\-A\-L\-A}!simSystem@{sim\-System}}
\subsubsection[{use\-W\-A\-L\-A}]{\setlength{\rightskip}{0pt plus 5cm}bool sim\-System\-::use\-W\-A\-L\-A}}\label{classsim_system_aa83b00006b3919fb6e13f1bdeadece6a}


Logical stating whether or not to use Wang-\/\-Landau biasing. 



Definition at line 92 of file system.\-h.



Referenced by calculate\-Bias(), get\-W\-A\-L\-A\-Bias(), agg\-Vol\-Bias3\-::make(), delete\-Particle\-::make(), translate\-Particle\-::make(), insert\-Particle\-::make(), swap\-Particles\-::make(), perform\-Crossover(), perform\-T\-M\-M\-C(), perform\-W\-A\-L\-A(), sim\-System(), start\-W\-A\-L\-A(), stop\-W\-A\-L\-A(), and $\sim$sim\-System().

\hypertarget{classsim_system_aa2e866e69ebe5fa0761894212592175a}{\index{sim\-System@{sim\-System}!wala\-\_\-g@{wala\-\_\-g}}
\index{wala\-\_\-g@{wala\-\_\-g}!simSystem@{sim\-System}}
\subsubsection[{wala\-\_\-g}]{\setlength{\rightskip}{0pt plus 5cm}double sim\-System\-::wala\-\_\-g}}\label{classsim_system_aa2e866e69ebe5fa0761894212592175a}


Definition at line 101 of file system.\-h.



Referenced by initialize(), checkpoint\-::load(), perform\-W\-A\-L\-A(), and sim\-System().

\hypertarget{classsim_system_a7cc3431bb59acca9165b044dbd07dcdc}{\index{sim\-System@{sim\-System}!wala\-\_\-s@{wala\-\_\-s}}
\index{wala\-\_\-s@{wala\-\_\-s}!simSystem@{sim\-System}}
\subsubsection[{wala\-\_\-s}]{\setlength{\rightskip}{0pt plus 5cm}double sim\-System\-::wala\-\_\-s}}\label{classsim_system_a7cc3431bb59acca9165b044dbd07dcdc}


Wang-\/\-Landau g and s factors. 



Definition at line 101 of file system.\-h.



Referenced by initialize(), checkpoint\-::load(), perform\-W\-A\-L\-A(), and sim\-System().

\hypertarget{classsim_system_a6dc8d9f89dfcfa247a59bc50889c49e7}{\index{sim\-System@{sim\-System}!wl\-Bias@{wl\-Bias}}
\index{wl\-Bias@{wl\-Bias}!simSystem@{sim\-System}}
\subsubsection[{wl\-Bias}]{\setlength{\rightskip}{0pt plus 5cm}{\bf wala}$\ast$ sim\-System\-::wl\-Bias}}\label{classsim_system_a6dc8d9f89dfcfa247a59bc50889c49e7}


W\-L biasing function. 



Definition at line 113 of file system.\-h.



Referenced by calculate\-Bias(), get\-W\-A\-L\-A\-Bias(), start\-W\-A\-L\-A(), stop\-W\-A\-L\-A(), and $\sim$sim\-System().

\hypertarget{classsim_system_ae625e1026daee4f99f83fb73881875a1}{\index{sim\-System@{sim\-System}!wl\-Sweep\-Size@{wl\-Sweep\-Size}}
\index{wl\-Sweep\-Size@{wl\-Sweep\-Size}!simSystem@{sim\-System}}
\subsubsection[{wl\-Sweep\-Size}]{\setlength{\rightskip}{0pt plus 5cm}long long int sim\-System\-::wl\-Sweep\-Size}}\label{classsim_system_ae625e1026daee4f99f83fb73881875a1}


Size of Wang-\/\-Landau sweep. 



Definition at line 97 of file system.\-h.



Referenced by initialize(), perform\-Crossover(), perform\-W\-A\-L\-A(), and sim\-System().



The documentation for this class was generated from the following files\-:\begin{DoxyCompactItemize}
\item 
/home/nam4/\-Desktop/sandbox/\-F\-H\-M\-C\-Simulation/src/\hyperlink{system_8h}{system.\-h}\item 
/home/nam4/\-Desktop/sandbox/\-F\-H\-M\-C\-Simulation/src/\hyperlink{system_8cpp}{system.\-cpp}\end{DoxyCompactItemize}
