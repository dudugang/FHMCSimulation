<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Flat-Histogram Monte Carlo Simulation: simSystem Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Flat-Histogram Monte Carlo Simulation
   &#160;<span id="projectnumber">v0.1.0</span>
   </div>
   <div id="projectbrief">Extensible Flat-Histogram MC code for Simple 3D Fluids</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="classes.html"><span>Data&#160;Structure&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle">
<div class="title">simSystem Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>System information for the simulation.  
 <a href="classsim_system.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="system_8h_source.html">system.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a2312059f2775a063d02e5739721f7ece"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a2312059f2775a063d02e5739721f7ece">simSystem</a> ()</td></tr>
<tr class="separator:a2312059f2775a063d02e5739721f7ece"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a5ca1d7704d8f26b3cb19ebba57e045"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a1a5ca1d7704d8f26b3cb19ebba57e045">simSystem</a> (const unsigned int <a class="el" href="classsim_system.html#ab5e2e9b6204de15520302fe1d51688dd">nSpecies</a>, const double <a class="el" href="classsim_system.html#a3eeec9678902f8d7fce4dad6064aaf4c">beta</a>, const std::vector&lt; double &gt; <a class="el" href="classsim_system.html#a8bff9dfb95b1b09a0fab2c1c485ade07">box</a>, const std::vector&lt; double &gt; <a class="el" href="classsim_system.html#af1e3f5320aff976a448647244d5950d1">mu</a>, const std::vector&lt; int &gt; <a class="el" href="classsim_system.html#a93259b517f449f1ac610d132ac66b551">maxSpecies</a>, const std::vector&lt; int &gt; <a class="el" href="classsim_system.html#afafda4a09ed180ee9c5580d196d8ca9f">minSpecies</a>, const int Mtot, const double energyHistDelta=10.0, const int max_order=2)</td></tr>
<tr class="memdesc:a1a5ca1d7704d8f26b3cb19ebba57e045"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the system.  <a href="#a1a5ca1d7704d8f26b3cb19ebba57e045">More...</a><br/></td></tr>
<tr class="separator:a1a5ca1d7704d8f26b3cb19ebba57e045"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abaa6ad6ea00aa437cf0b9ac8034af327"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#abaa6ad6ea00aa437cf0b9ac8034af327">~simSystem</a> ()</td></tr>
<tr class="separator:abaa6ad6ea00aa437cf0b9ac8034af327"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09c4ea670168c9f1d549d2a5120eb13c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a09c4ea670168c9f1d549d2a5120eb13c">addKECorrection</a> ()</td></tr>
<tr class="separator:a09c4ea670168c9f1d549d2a5120eb13c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5853448f04712e9163174860efadefd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#aa5853448f04712e9163174860efadefd">toggleKE</a> ()</td></tr>
<tr class="memdesc:aa5853448f04712e9163174860efadefd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Toggle KE adjustment to energy setting.  <a href="#aa5853448f04712e9163174860efadefd">More...</a><br/></td></tr>
<tr class="separator:aa5853448f04712e9163174860efadefd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ad31c08955b80873f865b3069618dcb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a6ad31c08955b80873f865b3069618dcb">incrementEnergy</a> (const double dU)</td></tr>
<tr class="memdesc:a6ad31c08955b80873f865b3069618dcb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Increment the system's energy.  <a href="#a6ad31c08955b80873f865b3069618dcb">More...</a><br/></td></tr>
<tr class="separator:a6ad31c08955b80873f865b3069618dcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5abdfae81ca00a79f162c0ce2b4307c9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a5abdfae81ca00a79f162c0ce2b4307c9">addPotential</a> (const int spec1, const int spec2, const std::string ppot_name, const std::vector&lt; double &gt; &amp;params, const bool useCellList=false, const std::string tabFile=&quot;&quot;)</td></tr>
<tr class="memdesc:a5abdfae81ca00a79f162c0ce2b4307c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a pair potential to the system which governs the pair (spec1, spec2).  <a href="#a5abdfae81ca00a79f162c0ce2b4307c9">More...</a><br/></td></tr>
<tr class="separator:a5abdfae81ca00a79f162c0ce2b4307c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3096dc65acdf38cc824e507cca33370"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#ae3096dc65acdf38cc824e507cca33370">printSnapshot</a> (std::string filename, std::string comment, bool overwrite=true)</td></tr>
<tr class="memdesc:ae3096dc65acdf38cc824e507cca33370"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print an XYZ file of the instantaneous system configuration.  <a href="#ae3096dc65acdf38cc824e507cca33370">More...</a><br/></td></tr>
<tr class="separator:ae3096dc65acdf38cc824e507cca33370"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0404e9435cc046d19b6bb990678ee069"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a0404e9435cc046d19b6bb990678ee069">insertAtom</a> (const int typeIndex, <a class="el" href="classatom.html">atom</a> *newAtom, bool override=false)</td></tr>
<tr class="memdesc:a0404e9435cc046d19b6bb990678ee069"><td class="mdescLeft">&#160;</td><td class="mdescRight">Insert an atom into the system.  <a href="#a0404e9435cc046d19b6bb990678ee069">More...</a><br/></td></tr>
<tr class="separator:a0404e9435cc046d19b6bb990678ee069"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acabf4fc5b5b90bba62e1449ddb3646c6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#acabf4fc5b5b90bba62e1449ddb3646c6">deleteAtom</a> (const int typeIndex, const int atomIndex, bool override=false)</td></tr>
<tr class="memdesc:acabf4fc5b5b90bba62e1449ddb3646c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete an atom from the system.  <a href="#acabf4fc5b5b90bba62e1449ddb3646c6">More...</a><br/></td></tr>
<tr class="separator:acabf4fc5b5b90bba62e1449ddb3646c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22fdaceea44abd6cd021bac1ecd11890"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a22fdaceea44abd6cd021bac1ecd11890">translateAtom</a> (const int typeIndex, const int atomIndex, std::vector&lt; double &gt; oldPos)</td></tr>
<tr class="memdesc:a22fdaceea44abd6cd021bac1ecd11890"><td class="mdescLeft">&#160;</td><td class="mdescRight">Translate an atom in the system.  <a href="#a22fdaceea44abd6cd021bac1ecd11890">More...</a><br/></td></tr>
<tr class="separator:a22fdaceea44abd6cd021bac1ecd11890"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3161d95bbb800d5d95a732ac5fc32b95"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a3161d95bbb800d5d95a732ac5fc32b95">readConfig</a> (std::string filename)</td></tr>
<tr class="memdesc:a3161d95bbb800d5d95a732ac5fc32b95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read an XYZ file as the system's initial configuration.  <a href="#a3161d95bbb800d5d95a732ac5fc32b95">More...</a><br/></td></tr>
<tr class="separator:a3161d95bbb800d5d95a732ac5fc32b95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab894de5ccd37efa97ae799f1dc1875a1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#ab894de5ccd37efa97ae799f1dc1875a1">setEUB</a> (const std::vector&lt; double &gt; eub)</td></tr>
<tr class="memdesc:ab894de5ccd37efa97ae799f1dc1875a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assign energy upper bound from restart.  <a href="#ab894de5ccd37efa97ae799f1dc1875a1">More...</a><br/></td></tr>
<tr class="separator:ab894de5ccd37efa97ae799f1dc1875a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a284cf6c00f572db12db0cb263974a78a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a284cf6c00f572db12db0cb263974a78a">setELB</a> (const std::vector&lt; double &gt; elb)</td></tr>
<tr class="memdesc:a284cf6c00f572db12db0cb263974a78a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assign energy lower bound from restart.  <a href="#a284cf6c00f572db12db0cb263974a78a">More...</a><br/></td></tr>
<tr class="separator:a284cf6c00f572db12db0cb263974a78a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a176b9ff482f1d36bc0638538bcfe0670"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a176b9ff482f1d36bc0638538bcfe0670">checkEnergyHistogramBounds</a> ()</td></tr>
<tr class="memdesc:a176b9ff482f1d36bc0638538bcfe0670"><td class="mdescLeft">&#160;</td><td class="mdescRight">Monitor the energy histogram bounds at each Ntot.  <a href="#a176b9ff482f1d36bc0638538bcfe0670">More...</a><br/></td></tr>
<tr class="separator:a176b9ff482f1d36bc0638538bcfe0670"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe05cba714a032b445cfb1a529547833"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#afe05cba714a032b445cfb1a529547833">refineEnergyHistogramBounds</a> ()</td></tr>
<tr class="memdesc:afe05cba714a032b445cfb1a529547833"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check the histogram entries and trim off zero-valued entries and bounds.  <a href="#afe05cba714a032b445cfb1a529547833">More...</a><br/></td></tr>
<tr class="separator:afe05cba714a032b445cfb1a529547833"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0eae4d523b5649be273e0419e9f799f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#aa0eae4d523b5649be273e0419e9f799f">recordEnergyHistogram</a> ()</td></tr>
<tr class="memdesc:aa0eae4d523b5649be273e0419e9f799f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Record the energy histogram for the system at a given Ntot.  <a href="#aa0eae4d523b5649be273e0419e9f799f">More...</a><br/></td></tr>
<tr class="separator:aa0eae4d523b5649be273e0419e9f799f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a861dd81718ef1c069fa7cfb9b7efe83c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a861dd81718ef1c069fa7cfb9b7efe83c">reInitializeEnergyHistogram</a> ()</td></tr>
<tr class="memdesc:a861dd81718ef1c069fa7cfb9b7efe83c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Re-initialize the energy histogram with internal estimates of bounds.  <a href="#a861dd81718ef1c069fa7cfb9b7efe83c">More...</a><br/></td></tr>
<tr class="separator:a861dd81718ef1c069fa7cfb9b7efe83c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ef1ba3e08ec44d865436e272cdebc9b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a6ef1ba3e08ec44d865436e272cdebc9b">printEnergyHistogram</a> (const std::string fileName, const bool normalize=true)</td></tr>
<tr class="memdesc:a6ef1ba3e08ec44d865436e272cdebc9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the (normalized by default) energy histogram for each Ntot.  <a href="#a6ef1ba3e08ec44d865436e272cdebc9b">More...</a><br/></td></tr>
<tr class="separator:a6ef1ba3e08ec44d865436e272cdebc9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae073008ed44e551f0d008b2f5a0fc06f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#ae073008ed44e551f0d008b2f5a0fc06f">restartEnergyHistogram</a> (const std::string prefix)</td></tr>
<tr class="memdesc:ae073008ed44e551f0d008b2f5a0fc06f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Restart the energy histogram for each Ntot from unnormalized checkpoint.  <a href="#ae073008ed44e551f0d008b2f5a0fc06f">More...</a><br/></td></tr>
<tr class="separator:ae073008ed44e551f0d008b2f5a0fc06f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e462fcb63389d59419ff6135b2d802e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a1e462fcb63389d59419ff6135b2d802e">refinePkHistogramBounds</a> ()</td></tr>
<tr class="memdesc:a1e462fcb63389d59419ff6135b2d802e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check the histogram entries and trim off zero-valued entries and bounds.  <a href="#a1e462fcb63389d59419ff6135b2d802e">More...</a><br/></td></tr>
<tr class="separator:a1e462fcb63389d59419ff6135b2d802e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71bbc9d8bdbb5042e4fa817c3e71fe53"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a71bbc9d8bdbb5042e4fa817c3e71fe53">recordPkHistogram</a> ()</td></tr>
<tr class="memdesc:a71bbc9d8bdbb5042e4fa817c3e71fe53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Record the particle number histogram for the system at a given Ntot.  <a href="#a71bbc9d8bdbb5042e4fa817c3e71fe53">More...</a><br/></td></tr>
<tr class="separator:a71bbc9d8bdbb5042e4fa817c3e71fe53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac29bdd6f7fa6f9526b7eafcf658d70d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#ac29bdd6f7fa6f9526b7eafcf658d70d8">printPkHistogram</a> (const std::string fileName, const bool normalize=true)</td></tr>
<tr class="memdesc:ac29bdd6f7fa6f9526b7eafcf658d70d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the (normalized by default) particle number histogram for each Ntot.  <a href="#ac29bdd6f7fa6f9526b7eafcf658d70d8">More...</a><br/></td></tr>
<tr class="separator:ac29bdd6f7fa6f9526b7eafcf658d70d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3239a23e35f30e40eeecf8795386c164"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a3239a23e35f30e40eeecf8795386c164">restartPkHistogram</a> (const std::string prefix)</td></tr>
<tr class="memdesc:a3239a23e35f30e40eeecf8795386c164"><td class="mdescLeft">&#160;</td><td class="mdescRight">Restart the particle histogram for each Ntot from unnormalized checkpoint.  <a href="#a3239a23e35f30e40eeecf8795386c164">More...</a><br/></td></tr>
<tr class="separator:a3239a23e35f30e40eeecf8795386c164"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74ce0ab8151fd0501abf853a16cc8e58"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a74ce0ab8151fd0501abf853a16cc8e58">recordExtMoments</a> ()</td></tr>
<tr class="memdesc:a74ce0ab8151fd0501abf853a16cc8e58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Record the extensive moment at a given Ntot.  <a href="#a74ce0ab8151fd0501abf853a16cc8e58">More...</a><br/></td></tr>
<tr class="separator:a74ce0ab8151fd0501abf853a16cc8e58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2818b2f0ff79782d5443ca0f191564f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a2818b2f0ff79782d5443ca0f191564f8">printExtMoments</a> (const std::string fileName, const bool normalize=true)</td></tr>
<tr class="memdesc:a2818b2f0ff79782d5443ca0f191564f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the (normalized by default) extensive energy histogram for each Ntot.  <a href="#a2818b2f0ff79782d5443ca0f191564f8">More...</a><br/></td></tr>
<tr class="separator:a2818b2f0ff79782d5443ca0f191564f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a999556fea891765c5ed4d979706665af"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a999556fea891765c5ed4d979706665af">restartExtMoments</a> (const std::string prefix, const std::vector&lt; double &gt; &amp;ctr)</td></tr>
<tr class="memdesc:a999556fea891765c5ed4d979706665af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Restart the extensive energy histogram for each Ntot from unnormalized checkpoint.  <a href="#a999556fea891765c5ed4d979706665af">More...</a><br/></td></tr>
<tr class="separator:a999556fea891765c5ed4d979706665af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57af66c88ce4dc1aeb6a1cd3f14ff0bb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a57af66c88ce4dc1aeb6a1cd3f14ff0bb">startWALA</a> (const double lnF, const double g, const double s, const int Mtot)</td></tr>
<tr class="memdesc:a57af66c88ce4dc1aeb6a1cd3f14ff0bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start using Wang-Landau and instantiate the bias object.  <a href="#a57af66c88ce4dc1aeb6a1cd3f14ff0bb">More...</a><br/></td></tr>
<tr class="separator:a57af66c88ce4dc1aeb6a1cd3f14ff0bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6febde00f19ae0787771f2d1d9e391b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#ad6febde00f19ae0787771f2d1d9e391b">stopWALA</a> ()</td></tr>
<tr class="memdesc:ad6febde00f19ae0787771f2d1d9e391b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop using Wang-Landau and free the bias object.  <a href="#ad6febde00f19ae0787771f2d1d9e391b">More...</a><br/></td></tr>
<tr class="separator:ad6febde00f19ae0787771f2d1d9e391b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac689245cd8e9ddfdcd94d3871a5a5d6b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#ac689245cd8e9ddfdcd94d3871a5a5d6b">startTMMC</a> (const long long int <a class="el" href="classsim_system.html#a56e284a361964d0a9ce5c45f41d56ab1">tmmcSweepSize</a>, const int Mtot)</td></tr>
<tr class="memdesc:ac689245cd8e9ddfdcd94d3871a5a5d6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start using TMMC and instantiate the bias object.  <a href="#ac689245cd8e9ddfdcd94d3871a5a5d6b">More...</a><br/></td></tr>
<tr class="separator:ac689245cd8e9ddfdcd94d3871a5a5d6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69edcc2c27db3d4e94002ac5635e9030"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a69edcc2c27db3d4e94002ac5635e9030">stopTMMC</a> ()</td></tr>
<tr class="memdesc:a69edcc2c27db3d4e94002ac5635e9030"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop using TMMC and free the bias object.  <a href="#a69edcc2c27db3d4e94002ac5635e9030">More...</a><br/></td></tr>
<tr class="separator:a69edcc2c27db3d4e94002ac5635e9030"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76b5dc3e179e275e40726c660d8e669b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a76b5dc3e179e275e40726c660d8e669b">setTotNBounds</a> (const std::vector&lt; int &gt; &amp;bounds)</td></tr>
<tr class="memdesc:a76b5dc3e179e275e40726c660d8e669b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the bounds on the total number of particles in a system.  <a href="#a76b5dc3e179e275e40726c660d8e669b">More...</a><br/></td></tr>
<tr class="separator:a76b5dc3e179e275e40726c660d8e669b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d61d583a40931ce5643bd6429f510ba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a5d61d583a40931ce5643bd6429f510ba">incrementMState</a> ()</td></tr>
<tr class="memdesc:a5d61d583a40931ce5643bd6429f510ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Increase the expanded ensemble state of the system by 1.  <a href="#a5d61d583a40931ce5643bd6429f510ba">More...</a><br/></td></tr>
<tr class="separator:a5d61d583a40931ce5643bd6429f510ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18e515d42d1d653bcac67d61701983eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a18e515d42d1d653bcac67d61701983eb">decrementMState</a> ()</td></tr>
<tr class="memdesc:a18e515d42d1d653bcac67d61701983eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrease the expanded ensemble state of the system by 1.  <a href="#a18e515d42d1d653bcac67d61701983eb">More...</a><br/></td></tr>
<tr class="separator:a18e515d42d1d653bcac67d61701983eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40af191fae6091e26413ee06ae188ae9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a40af191fae6091e26413ee06ae188ae9">potentialIsSet</a> (const int spec1, const int spec2)</td></tr>
<tr class="memdesc:a40af191fae6091e26413ee06ae188ae9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boolean which returns whether or not a pair has had its potential specified by the user yet.  <a href="#a40af191fae6091e26413ee06ae188ae9">More...</a><br/></td></tr>
<tr class="separator:a40af191fae6091e26413ee06ae188ae9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5e2e9b6204de15520302fe1d51688dd"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#ab5e2e9b6204de15520302fe1d51688dd">nSpecies</a> ()</td></tr>
<tr class="memdesc:ab5e2e9b6204de15520302fe1d51688dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the number of different species in the system.  <a href="#ab5e2e9b6204de15520302fe1d51688dd">More...</a><br/></td></tr>
<tr class="separator:ab5e2e9b6204de15520302fe1d51688dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93259b517f449f1ac610d132ac66b551"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a93259b517f449f1ac610d132ac66b551">maxSpecies</a> (const int index)</td></tr>
<tr class="memdesc:a93259b517f449f1ac610d132ac66b551"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the absolute maximum number of a given species type allowed in the system.  <a href="#a93259b517f449f1ac610d132ac66b551">More...</a><br/></td></tr>
<tr class="separator:a93259b517f449f1ac610d132ac66b551"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afafda4a09ed180ee9c5580d196d8ca9f"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#afafda4a09ed180ee9c5580d196d8ca9f">minSpecies</a> (const int index)</td></tr>
<tr class="memdesc:afafda4a09ed180ee9c5580d196d8ca9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the absolute minimum number of a given species type allowed in the system.  <a href="#afafda4a09ed180ee9c5580d196d8ca9f">More...</a><br/></td></tr>
<tr class="separator:afafda4a09ed180ee9c5580d196d8ca9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee2c65ecb43a35c0c4d070cdb45f7dc0"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#aee2c65ecb43a35c0c4d070cdb45f7dc0">totNMax</a> ()</td></tr>
<tr class="memdesc:aee2c65ecb43a35c0c4d070cdb45f7dc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return upper bound on the total number of atoms in the system.  <a href="#aee2c65ecb43a35c0c4d070cdb45f7dc0">More...</a><br/></td></tr>
<tr class="separator:aee2c65ecb43a35c0c4d070cdb45f7dc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af10842e0eaa638373b8717c87b47e6bc"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#af10842e0eaa638373b8717c87b47e6bc">totNMin</a> ()</td></tr>
<tr class="memdesc:af10842e0eaa638373b8717c87b47e6bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return lower bound on the total number of atoms in the system.  <a href="#af10842e0eaa638373b8717c87b47e6bc">More...</a><br/></td></tr>
<tr class="separator:af10842e0eaa638373b8717c87b47e6bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37dd827f4057049763351510147b9f1d"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a37dd827f4057049763351510147b9f1d">getTotN</a> ()</td></tr>
<tr class="memdesc:a37dd827f4057049763351510147b9f1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a sum of the total number of atoms currently in the system.  <a href="#a37dd827f4057049763351510147b9f1d">More...</a><br/></td></tr>
<tr class="separator:a37dd827f4057049763351510147b9f1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe08187d318113c33bda890c69570c36"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#afe08187d318113c33bda890c69570c36">getMaxOrder</a> ()</td></tr>
<tr class="memdesc:afe08187d318113c33bda890c69570c36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the max order the extensive moments are being stored out to.  <a href="#afe08187d318113c33bda890c69570c36">More...</a><br/></td></tr>
<tr class="separator:afe08187d318113c33bda890c69570c36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a299fe4372e610b554eaaf5f5957b2dbc"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a299fe4372e610b554eaaf5f5957b2dbc">getCurrentM</a> ()</td></tr>
<tr class="memdesc:a299fe4372e610b554eaaf5f5957b2dbc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the system's current expanded ensemble fractional state.  <a href="#a299fe4372e610b554eaaf5f5957b2dbc">More...</a><br/></td></tr>
<tr class="separator:a299fe4372e610b554eaaf5f5957b2dbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4ad1afff101bb530e1590df05035276"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#aa4ad1afff101bb530e1590df05035276">getTotalM</a> ()</td></tr>
<tr class="memdesc:aa4ad1afff101bb530e1590df05035276"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the total number of fractional states available to species in the expanded ensemble.  <a href="#aa4ad1afff101bb530e1590df05035276">More...</a><br/></td></tr>
<tr class="separator:aa4ad1afff101bb530e1590df05035276"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0500a9e84eecfbde7a98cf8a34f719d5"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a0500a9e84eecfbde7a98cf8a34f719d5">getFractionalAtomType</a> ()</td></tr>
<tr class="memdesc:a0500a9e84eecfbde7a98cf8a34f719d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the atom type of the fractional atom.  <a href="#a0500a9e84eecfbde7a98cf8a34f719d5">More...</a><br/></td></tr>
<tr class="separator:a0500a9e84eecfbde7a98cf8a34f719d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37b3d15faf56bf31349f5c2aaf02f858"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a37b3d15faf56bf31349f5c2aaf02f858">energy</a> ()</td></tr>
<tr class="memdesc:a37b3d15faf56bf31349f5c2aaf02f858"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the system's instantaneous energy.  <a href="#a37b3d15faf56bf31349f5c2aaf02f858">More...</a><br/></td></tr>
<tr class="separator:a37b3d15faf56bf31349f5c2aaf02f858"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51539ed4c3bb4905b32ce428c1c537fe"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a51539ed4c3bb4905b32ce428c1c537fe">scratchEnergy</a> ()</td></tr>
<tr class="memdesc:a51539ed4c3bb4905b32ce428c1c537fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recalculate the energy of the system from scratch.  <a href="#a51539ed4c3bb4905b32ce428c1c537fe">More...</a><br/></td></tr>
<tr class="separator:a51539ed4c3bb4905b32ce428c1c537fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3eeec9678902f8d7fce4dad6064aaf4c"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a3eeec9678902f8d7fce4dad6064aaf4c">beta</a> ()</td></tr>
<tr class="memdesc:a3eeec9678902f8d7fce4dad6064aaf4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return 1/kT.  <a href="#a3eeec9678902f8d7fce4dad6064aaf4c">More...</a><br/></td></tr>
<tr class="separator:a3eeec9678902f8d7fce4dad6064aaf4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1e3f5320aff976a448647244d5950d1"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#af1e3f5320aff976a448647244d5950d1">mu</a> (const int index)</td></tr>
<tr class="memdesc:af1e3f5320aff976a448647244d5950d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the chemical potential for a given species' index.  <a href="#af1e3f5320aff976a448647244d5950d1">More...</a><br/></td></tr>
<tr class="separator:af1e3f5320aff976a448647244d5950d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c75052458072e1267bc20594b58d8cd"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a7c75052458072e1267bc20594b58d8cd">mass</a> (const int index)</td></tr>
<tr class="memdesc:a7c75052458072e1267bc20594b58d8cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the mass of a given species' index.  <a href="#a7c75052458072e1267bc20594b58d8cd">More...</a><br/></td></tr>
<tr class="separator:a7c75052458072e1267bc20594b58d8cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1744c4c22603662081d75985bc30b754"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a1744c4c22603662081d75985bc30b754">extMomCounter</a> ()</td></tr>
<tr class="memdesc:a1744c4c22603662081d75985bc30b754"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get counter for extensive moments needed for restarting system from a checkpoint.  <a href="#a1744c4c22603662081d75985bc30b754">More...</a><br/></td></tr>
<tr class="separator:a1744c4c22603662081d75985bc30b754"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bff9dfb95b1b09a0fab2c1c485ade07"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a8bff9dfb95b1b09a0fab2c1c485ade07">box</a> ()</td></tr>
<tr class="memdesc:a8bff9dfb95b1b09a0fab2c1c485ade07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the system box dimensions.  <a href="#a8bff9dfb95b1b09a0fab2c1c485ade07">More...</a><br/></td></tr>
<tr class="separator:a8bff9dfb95b1b09a0fab2c1c485ade07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a610cbb1c6059151e420dbd42dd9da714"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a610cbb1c6059151e420dbd42dd9da714">getELB</a> ()</td></tr>
<tr class="memdesc:a610cbb1c6059151e420dbd42dd9da714"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns current tally of energy min at each Ntot for checkpointing.  <a href="#a610cbb1c6059151e420dbd42dd9da714">More...</a><br/></td></tr>
<tr class="separator:a610cbb1c6059151e420dbd42dd9da714"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae87e0ac03cc11259cd3b44c780a90a06"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#ae87e0ac03cc11259cd3b44c780a90a06">getEUB</a> ()</td></tr>
<tr class="memdesc:ae87e0ac03cc11259cd3b44c780a90a06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns current tally of energy max at each Ntot for checkpointing.  <a href="#ae87e0ac03cc11259cd3b44c780a90a06">More...</a><br/></td></tr>
<tr class="separator:ae87e0ac03cc11259cd3b44c780a90a06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b3aeefa22c3b50b5913df6eea753bc6"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classatom.html">atom</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a9b3aeefa22c3b50b5913df6eea753bc6">getNeighborAtoms</a> (const unsigned int typeIndexA, const unsigned int typeIndexB, <a class="el" href="classatom.html">atom</a> *_atom)</td></tr>
<tr class="memdesc:a9b3aeefa22c3b50b5913df6eea753bc6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the list of neighbors of type A, around a particle of type B which is passed.  <a href="#a9b3aeefa22c3b50b5913df6eea753bc6">More...</a><br/></td></tr>
<tr class="separator:a9b3aeefa22c3b50b5913df6eea753bc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa31d40c91cb50f143a9613d362798887"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtmmc.html">tmmc</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#aa31d40c91cb50f143a9613d362798887">getTMMCBias</a> ()</td></tr>
<tr class="memdesc:aa31d40c91cb50f143a9613d362798887"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to the TMMC bias.  <a href="#aa31d40c91cb50f143a9613d362798887">More...</a><br/></td></tr>
<tr class="separator:aa31d40c91cb50f143a9613d362798887"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cb5049de8b0988349e89e30e4000407"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classwala.html">wala</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a7cb5049de8b0988349e89e30e4000407">getWALABias</a> ()</td></tr>
<tr class="memdesc:a7cb5049de8b0988349e89e30e4000407"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to the Wang-Landau bias.  <a href="#a7cb5049de8b0988349e89e30e4000407">More...</a><br/></td></tr>
<tr class="separator:a7cb5049de8b0988349e89e30e4000407"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ab77377c60e0e3109a6e875690b0ab7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classatom.html">atom</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a2ab77377c60e0e3109a6e875690b0ab7">getFractionalAtom</a> ()</td></tr>
<tr class="memdesc:a2ab77377c60e0e3109a6e875690b0ab7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a pointer the atom in the system that is currently only fractionally inserted/deleted.  <a href="#a2ab77377c60e0e3109a6e875690b0ab7">More...</a><br/></td></tr>
<tr class="separator:a2ab77377c60e0e3109a6e875690b0ab7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:aa474a50b6353c8897331b1ab1ce53ab1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#aa474a50b6353c8897331b1ab1ce53ab1">useTMMC</a></td></tr>
<tr class="memdesc:aa474a50b6353c8897331b1ab1ce53ab1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Logical stating whether or not to use TMMC biasing.  <a href="#aa474a50b6353c8897331b1ab1ce53ab1">More...</a><br/></td></tr>
<tr class="separator:aa474a50b6353c8897331b1ab1ce53ab1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa83b00006b3919fb6e13f1bdeadece6a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#aa83b00006b3919fb6e13f1bdeadece6a">useWALA</a></td></tr>
<tr class="memdesc:aa83b00006b3919fb6e13f1bdeadece6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Logical stating whether or not to use Wang-Landau biasing.  <a href="#aa83b00006b3919fb6e13f1bdeadece6a">More...</a><br/></td></tr>
<tr class="separator:aa83b00006b3919fb6e13f1bdeadece6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b168c89742f4d64270583e7e54b2929"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a2b168c89742f4d64270583e7e54b2929">restartFromWALA</a></td></tr>
<tr class="separator:a2b168c89742f4d64270583e7e54b2929"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c81d3b606c070c801f8d86288e44391"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a0c81d3b606c070c801f8d86288e44391">restartFromTMMC</a></td></tr>
<tr class="memdesc:a0c81d3b606c070c801f8d86288e44391"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flags to restart from WALA or TMMC initially.  <a href="#a0c81d3b606c070c801f8d86288e44391">More...</a><br/></td></tr>
<tr class="separator:a0c81d3b606c070c801f8d86288e44391"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56e284a361964d0a9ce5c45f41d56ab1"><td class="memItemLeft" align="right" valign="top">long long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a56e284a361964d0a9ce5c45f41d56ab1">tmmcSweepSize</a></td></tr>
<tr class="memdesc:a56e284a361964d0a9ce5c45f41d56ab1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of a sweep in TMMC.  <a href="#a56e284a361964d0a9ce5c45f41d56ab1">More...</a><br/></td></tr>
<tr class="separator:a56e284a361964d0a9ce5c45f41d56ab1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78b107e20bcbf2f818264fa076de5db3"><td class="memItemLeft" align="right" valign="top">long long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a78b107e20bcbf2f818264fa076de5db3">totalTMMCSweeps</a></td></tr>
<tr class="memdesc:a78b107e20bcbf2f818264fa076de5db3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of sweeps to perform during TMMC.  <a href="#a78b107e20bcbf2f818264fa076de5db3">More...</a><br/></td></tr>
<tr class="separator:a78b107e20bcbf2f818264fa076de5db3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae625e1026daee4f99f83fb73881875a1"><td class="memItemLeft" align="right" valign="top">long long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#ae625e1026daee4f99f83fb73881875a1">wlSweepSize</a></td></tr>
<tr class="memdesc:ae625e1026daee4f99f83fb73881875a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of Wang-Landau sweep.  <a href="#ae625e1026daee4f99f83fb73881875a1">More...</a><br/></td></tr>
<tr class="separator:ae625e1026daee4f99f83fb73881875a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa748f651ddd9a2bf6d88bfcab9153905"><td class="memItemLeft" align="right" valign="top">long long int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#aa748f651ddd9a2bf6d88bfcab9153905">nCrossoverVisits</a></td></tr>
<tr class="memdesc:aa748f651ddd9a2bf6d88bfcab9153905"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of crossovers that must occur before switching from WALA to TMMC.  <a href="#aa748f651ddd9a2bf6d88bfcab9153905">More...</a><br/></td></tr>
<tr class="separator:aa748f651ddd9a2bf6d88bfcab9153905"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a794334e163fbeb4b4f61bcea676679ce"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a794334e163fbeb4b4f61bcea676679ce">lnF_start</a></td></tr>
<tr class="separator:a794334e163fbeb4b4f61bcea676679ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fb5d01fd3abf49f577c050968fba9d1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a3fb5d01fd3abf49f577c050968fba9d1">lnF_end</a></td></tr>
<tr class="memdesc:a3fb5d01fd3abf49f577c050968fba9d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Starting and ending lnF for Wang-Landau.  <a href="#a3fb5d01fd3abf49f577c050968fba9d1">More...</a><br/></td></tr>
<tr class="separator:a3fb5d01fd3abf49f577c050968fba9d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2e866e69ebe5fa0761894212592175a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#aa2e866e69ebe5fa0761894212592175a">wala_g</a></td></tr>
<tr class="separator:aa2e866e69ebe5fa0761894212592175a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cc3431bb59acca9165b044dbd07dcdc"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a7cc3431bb59acca9165b044dbd07dcdc">wala_s</a></td></tr>
<tr class="memdesc:a7cc3431bb59acca9165b044dbd07dcdc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wang-Landau g and s factors.  <a href="#a7cc3431bb59acca9165b044dbd07dcdc">More...</a><br/></td></tr>
<tr class="separator:a7cc3431bb59acca9165b044dbd07dcdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13173f45a1e40a5f5a3552b0ebe15b54"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtmmc.html">tmmc</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a13173f45a1e40a5f5a3552b0ebe15b54">tmmcBias</a></td></tr>
<tr class="memdesc:a13173f45a1e40a5f5a3552b0ebe15b54"><td class="mdescLeft">&#160;</td><td class="mdescRight">TMMC biasing function.  <a href="#a13173f45a1e40a5f5a3552b0ebe15b54">More...</a><br/></td></tr>
<tr class="separator:a13173f45a1e40a5f5a3552b0ebe15b54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dc8d9f89dfcfa247a59bc50889c49e7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classwala.html">wala</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a6dc8d9f89dfcfa247a59bc50889c49e7">wlBias</a></td></tr>
<tr class="memdesc:a6dc8d9f89dfcfa247a59bc50889c49e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">WL biasing function.  <a href="#a6dc8d9f89dfcfa247a59bc50889c49e7">More...</a><br/></td></tr>
<tr class="separator:a6dc8d9f89dfcfa247a59bc50889c49e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbf0b172dc35572e71ec6d27a018e2fc"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#afbf0b172dc35572e71ec6d27a018e2fc">restartFromWALAFile</a></td></tr>
<tr class="separator:afbf0b172dc35572e71ec6d27a018e2fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ccdad82b3767ba21b1e4b1e36362082"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a5ccdad82b3767ba21b1e4b1e36362082">restartFromTMMCFile</a></td></tr>
<tr class="memdesc:a5ccdad82b3767ba21b1e4b1e36362082"><td class="mdescLeft">&#160;</td><td class="mdescRight">Files to restart from WALA or TMMC initially.  <a href="#a5ccdad82b3767ba21b1e4b1e36362082">More...</a><br/></td></tr>
<tr class="separator:a5ccdad82b3767ba21b1e4b1e36362082"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9eea865e6dc1cff377b1e79c4d9c23f0"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a></td></tr>
<tr class="memdesc:a9eea865e6dc1cff377b1e79c4d9c23f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of each type of atom the system contains.  <a href="#a9eea865e6dc1cff377b1e79c4d9c23f0">More...</a><br/></td></tr>
<tr class="separator:a9eea865e6dc1cff377b1e79c4d9c23f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90421b19082f7fb8fc23b7264b1161e4"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; <a class="el" href="classatom.html">atom</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a></td></tr>
<tr class="memdesc:a90421b19082f7fb8fc23b7264b1161e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Atoms in a matrix by type, and particle index, respectively that a system CAN hold but not all are actually "in" the system.  <a href="#a90421b19082f7fb8fc23b7264b1161e4">More...</a><br/></td></tr>
<tr class="separator:a90421b19082f7fb8fc23b7264b1161e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2e290b5963f132e6a3a56cee35c8e9f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak"/>
&lt; std::shared_ptr<br class="typebreak"/>
&lt; <a class="el" href="classpair_potential.html">pairPotential</a> &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a></td></tr>
<tr class="memdesc:ad2e290b5963f132e6a3a56cee35c8e9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Matrix of pair potentials for atom types i, j.  <a href="#ad2e290b5963f132e6a3a56cee35c8e9f">More...</a><br/></td></tr>
<tr class="separator:ad2e290b5963f132e6a3a56cee35c8e9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ae652ff4519f39c3862abae32a9581b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classcomposite_barrier.html">compositeBarrier</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsim_system.html#a5ae652ff4519f39c3862abae32a9581b">speciesBarriers</a></td></tr>
<tr class="memdesc:a5ae652ff4519f39c3862abae32a9581b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Barriers, if any, for each species.  <a href="#a5ae652ff4519f39c3862abae32a9581b">More...</a><br/></td></tr>
<tr class="separator:a5ae652ff4519f39c3862abae32a9581b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>System information for the simulation. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00026">26</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a2312059f2775a063d02e5739721f7ece"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simSystem::simSystem </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="system_8h_source.html#l00028">28</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;{;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1a5ca1d7704d8f26b3cb19ebba57e045"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">simSystem::simSystem </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>nSpecies</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>box</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>mu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt;&#160;</td>
          <td class="paramname"><em>maxSpecies</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt;&#160;</td>
          <td class="paramname"><em>minSpecies</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Mtot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>energyHistDelta</em> = <code>10.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>max_order</em> = <code>2</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the system. </p>
<p>Sets the use of both WL and TMMC biasing to false.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nSpecies</td><td>Number of unqiue species types to allow in the system </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">beta</td><td>Inverse temperature (1/kT) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">box</td><td>Box dimensions [x, y, z] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mu</td><td>Chemical potential of each species </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxSpecies</td><td>Maximum number of each species to allow in the system </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Mtot</td><td>Total number of expanded ensemble states </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">energyHistDelta</td><td>Bin width of energy histogram at each Ntot (optional, default = 10.0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">max_order</td><td>Maximum order to record correlations to (default = 2) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l00431">431</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>References <a class="el" href="system_8h_source.html#l00118">atoms</a>, <a class="el" href="system_8h_source.html#l00087">beta()</a>, <a class="el" href="system_8h_source.html#l00104">box()</a>, <a class="el" href="system_8h_source.html#l00100">lnF_end</a>, <a class="el" href="system_8h_source.html#l00100">lnF_start</a>, <a class="el" href="system_8cpp_source.html#l01654">maxSpecies()</a>, <a class="el" href="system_8cpp_source.html#l01672">minSpecies()</a>, <a class="el" href="system_8h_source.html#l00088">mu()</a>, <a class="el" href="system_8h_source.html#l00098">nCrossoverVisits</a>, <a class="el" href="system_8h_source.html#l00072">nSpecies()</a>, <a class="el" href="system_8h_source.html#l00117">numSpecies</a>, <a class="el" href="system_8h_source.html#l00119">ppot</a>, <a class="el" href="system_8h_source.html#l00093">restartFromTMMC</a>, <a class="el" href="system_8h_source.html#l00115">restartFromTMMCFile</a>, <a class="el" href="system_8h_source.html#l00093">restartFromWALA</a>, <a class="el" href="system_8h_source.html#l00115">restartFromWALAFile</a>, <a class="el" href="system_8h_source.html#l00120">speciesBarriers</a>, <a class="el" href="global_8h_source.html#l00158">SYS_FAILURE</a>, <a class="el" href="system_8h_source.html#l00096">totalTMMCSweeps</a>, <a class="el" href="system_8h_source.html#l00091">useTMMC</a>, <a class="el" href="system_8h_source.html#l00092">useWALA</a>, <a class="el" href="system_8h_source.html#l00101">wala_g</a>, <a class="el" href="system_8h_source.html#l00101">wala_s</a>, and <a class="el" href="system_8h_source.html#l00097">wlSweepSize</a>.</p>
<div class="fragment"><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                                                                                                                                                                                                                                                                              {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="classsim_system.html#a8bff9dfb95b1b09a0fab2c1c485ade07">box</a>.size() != 3) || (<a class="code" href="classsim_system.html#ab5e2e9b6204de15520302fe1d51688dd">nSpecies</a> != <a class="code" href="classsim_system.html#af1e3f5320aff976a448647244d5950d1">mu</a>.size()) || (<a class="code" href="classsim_system.html#a93259b517f449f1ac610d132ac66b551">maxSpecies</a>.size() != <a class="code" href="classsim_system.html#ab5e2e9b6204de15520302fe1d51688dd">nSpecies</a>)) {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Invalid system initialization parameters&quot;</span>);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        exit(<a class="code" href="global_8h.html#a428dfe1ef0a6ff4b1fdebf275f6aff2e">SYS_FAILURE</a>);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        nSpecies_ = <a class="code" href="classsim_system.html#ab5e2e9b6204de15520302fe1d51688dd">nSpecies</a>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        maxSpecies_ = <a class="code" href="classsim_system.html#a93259b517f449f1ac610d132ac66b551">maxSpecies</a>;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        minSpecies_ = <a class="code" href="classsim_system.html#afafda4a09ed180ee9c5580d196d8ca9f">minSpecies</a>;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        box_ = <a class="code" href="classsim_system.html#a8bff9dfb95b1b09a0fab2c1c485ade07">box</a>;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        mu_ = <a class="code" href="classsim_system.html#af1e3f5320aff976a448647244d5950d1">mu</a>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        beta_ = <a class="code" href="classsim_system.html#a3eeec9678902f8d7fce4dad6064aaf4c">beta</a>;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    }</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <a class="code" href="classsim_system.html#a794334e163fbeb4b4f61bcea676679ce">lnF_start</a> = 1.0; <span class="comment">// default for lnF_start</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <a class="code" href="classsim_system.html#a3fb5d01fd3abf49f577c050968fba9d1">lnF_end</a> = 2.0e-18; <span class="comment">// default for lnF_end</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    toggleKE_ = <span class="keyword">false</span>; <span class="comment">//default, do NOT adjust energy by kinetic contribution of 3/2kT per atom (just record PE)</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <a class="code" href="classsim_system.html#a78b107e20bcbf2f818264fa076de5db3">totalTMMCSweeps</a> = 0;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <a class="code" href="classsim_system.html#ae625e1026daee4f99f83fb73881875a1">wlSweepSize</a> = 0;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <a class="code" href="classsim_system.html#aa2e866e69ebe5fa0761894212592175a">wala_g</a> = 0.5;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="classsim_system.html#a7cc3431bb59acca9165b044dbd07dcdc">wala_s</a> = 0.8;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <a class="code" href="classsim_system.html#aa748f651ddd9a2bf6d88bfcab9153905">nCrossoverVisits</a> = 5;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">if</span> (max_order &lt; 1){</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;max_order must be &gt;= 1&quot;</span>);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    max_order_ = max_order;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">if</span> (energyHistDelta &lt;= 0) {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;energyHistDelta must be &gt; 0&quot;</span>);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    energyHistDelta_ = energyHistDelta;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; 3; ++i) {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="keywordflow">if</span> (box_[i] &lt;= 0) {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Box dimensions must be &gt; 0&quot;</span>);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">if</span> (Mtot &lt; 1) {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Total fractional states for expanded ensemble must be &gt;= 1&quot;</span>);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    Mtot_ = Mtot;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    Mcurrent_ = 0; <span class="comment">// always start from fully inserted state</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>.resize(<a class="code" href="classsim_system.html#ab5e2e9b6204de15520302fe1d51688dd">nSpecies</a>);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    } <span class="keywordflow">catch</span> (std::exception &amp;e) {</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (e.what());</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classsim_system.html#ab5e2e9b6204de15520302fe1d51688dd">nSpecies</a>; ++i) {</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            <a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>[i].resize(nSpecies);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        } <span class="keywordflow">catch</span> (std::exception &amp;e) {</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (e.what());</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        }</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    }</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        mass_.resize(nSpecies, 1.0);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    } <span class="keywordflow">catch</span> (std::exception &amp;e) {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (e.what());</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    }</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        ppotSet_.resize(nSpecies);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    } <span class="keywordflow">catch</span> (std::exception &amp;e) {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (e.what());</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classsim_system.html#ab5e2e9b6204de15520302fe1d51688dd">nSpecies</a>; ++i) {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            ppotSet_[i].resize(nSpecies, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        } <span class="keywordflow">catch</span> (std::exception &amp;e) {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (e.what());</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        }</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    }</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">// Wall potentials for each species, if there are any?</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <a class="code" href="classsim_system.html#a5ae652ff4519f39c3862abae32a9581b">speciesBarriers</a>.resize(nSpecies);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    } <span class="keywordflow">catch</span> (std::exception &amp;e) {</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (e.what());</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="comment">// Prepare vectors and matrices for cell lists.</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="comment">// It is crucial to reserve the correct number of cellLists in advance</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="comment">// since cellListsByPairType uses the addresses of cellLists. Otherwise,</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="comment">// if dynamic memory reallocation takes place, the pointers do not</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="comment">// correspond to initial values anymore, causing the simulation to crash.</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    cellLists_.reserve(nSpecies_*nSpecies_);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        useCellList_.resize(nSpecies);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        cellListsByPairType_.resize(nSpecies);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    } <span class="keywordflow">catch</span> (std::exception &amp;e) {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (e.what());</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classsim_system.html#ab5e2e9b6204de15520302fe1d51688dd">nSpecies</a>; ++i) {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            useCellList_[i].resize(nSpecies);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            cellListsByPairType_[i].assign(nSpecies, NULL);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        } <span class="keywordflow">catch</span> (std::exception &amp;e) {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (e.what());</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    }</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    totN_ = 0;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>.resize(nSpecies, 0);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    } <span class="keywordflow">catch</span> (std::exception &amp;e) {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (e.what());</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>.resize(nSpecies);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    } <span class="keywordflow">catch</span> (std::exception &amp;e) {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (e.what());</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classsim_system.html#ab5e2e9b6204de15520302fe1d51688dd">nSpecies</a>; ++i) {</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="keywordflow">if</span> (minSpecies_[i] &lt; 0) {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Min species &lt; 0&quot;</span>);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        }</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="keywordflow">if</span> (maxSpecies_[i] &lt; minSpecies_[i]) {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Max species &lt; Min species&quot;</span>);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        }</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            <a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[i].resize(maxSpecies_[i], <a class="code" href="classatom.html">atom</a>());</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        } <span class="keywordflow">catch</span> (std::exception &amp;e) {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (e.what());</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        }</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    energy_ = 0.0;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <a class="code" href="classsim_system.html#aa474a50b6353c8897331b1ab1ce53ab1">useTMMC</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <a class="code" href="classsim_system.html#aa83b00006b3919fb6e13f1bdeadece6a">useWALA</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    totNBounds_.resize(2, 0);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nSpecies_; ++i) {</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        totNBounds_[0] += minSpecies_[i];</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        totNBounds_[1] += maxSpecies_[i];</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    }</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="comment">// allocate space for average U storage matrix - Shen and Errington method implies this size is always the same for</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="comment">// both single and multicomponent mixtures</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> size = totNBounds_[1] - totNBounds_[0] + 1;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    energyHistogram_lb_.resize(size, -5.0);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    energyHistogram_ub_.resize(size, 5.0);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; size; ++i) {</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        energyHistogram_lb_[i] = -5.0;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        energyHistogram_ub_[i] = 5.0;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <a class="code" href="classdynamic__one__dim__histogram.html">dynamic_one_dim_histogram</a> dummyHist (energyHistogram_lb_[i], energyHistogram_ub_[i], energyHistDelta_);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            energyHistogram_.resize(i+1, dummyHist);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        } <span class="keywordflow">catch</span> (std::bad_alloc &amp;ba) {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Out of memory for energy histogram for each Ntot&quot;</span>);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    }</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    pkHistogram_.resize(0);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <a class="code" href="classdynamic__one__dim__histogram.html">dynamic_one_dim_histogram</a> dummyPkHist (0.0, totNBounds_[1], 1.0);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        std::vector &lt; dynamic_one_dim_histogram &gt; tmp (totNBounds_[1]-totNBounds_[0]+1, dummyPkHist);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        pkHistogram_.resize(nSpecies_, tmp);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    } <span class="keywordflow">catch</span> (std::bad_alloc &amp;ba) {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Out of memory for particle histogram for each Ntot&quot;</span>);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="comment">// initialize moments</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    std::vector &lt; double &gt; lbn (6,0), ubn(6,0);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    std::vector &lt; long long unsigned int &gt; nbn (6,0);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    ubn[0] = nSpecies_-1;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    ubn[1] = max_order_;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    ubn[2] = nSpecies_-1;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    ubn[3] = max_order_;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    ubn[4] = max_order_;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    ubn[5] = totNBounds_[1]-totNBounds_[0];</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    nbn[0] = nSpecies_;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    nbn[1] = max_order_+1;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    nbn[2] = nSpecies_;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    nbn[3] = max_order_+1;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    nbn[4] = max_order_+1;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    nbn[5] = size;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <a class="code" href="classhistogram.html">histogram</a> hnn (lbn, ubn, nbn);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    extensive_moments_ = hnn;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <a class="code" href="classsim_system.html#a2b168c89742f4d64270583e7e54b2929">restartFromWALA</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <a class="code" href="classsim_system.html#a0c81d3b606c070c801f8d86288e44391">restartFromTMMC</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <a class="code" href="classsim_system.html#afbf0b172dc35572e71ec6d27a018e2fc">restartFromWALAFile</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <a class="code" href="classsim_system.html#a5ccdad82b3767ba21b1e4b1e36362082">restartFromTMMCFile</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;}</div>
<div class="ttc" id="classsim_system_html_a0c81d3b606c070c801f8d86288e44391"><div class="ttname"><a href="classsim_system.html#a0c81d3b606c070c801f8d86288e44391">simSystem::restartFromTMMC</a></div><div class="ttdeci">bool restartFromTMMC</div><div class="ttdoc">Flags to restart from WALA or TMMC initially. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00093">system.h:93</a></div></div>
<div class="ttc" id="classsim_system_html_ad2e290b5963f132e6a3a56cee35c8e9f"><div class="ttname"><a href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">simSystem::ppot</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::shared_ptr&lt; pairPotential &gt; &gt; &gt; ppot</div><div class="ttdoc">Matrix of pair potentials for atom types i, j. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00119">system.h:119</a></div></div>
<div class="ttc" id="classsim_system_html_a7cc3431bb59acca9165b044dbd07dcdc"><div class="ttname"><a href="classsim_system.html#a7cc3431bb59acca9165b044dbd07dcdc">simSystem::wala_s</a></div><div class="ttdeci">double wala_s</div><div class="ttdoc">Wang-Landau g and s factors. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00101">system.h:101</a></div></div>
<div class="ttc" id="classdynamic__one__dim__histogram_html"><div class="ttname"><a href="classdynamic__one__dim__histogram.html">dynamic_one_dim_histogram</a></div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00041">histogram.h:41</a></div></div>
<div class="ttc" id="classsim_system_html_a3fb5d01fd3abf49f577c050968fba9d1"><div class="ttname"><a href="classsim_system.html#a3fb5d01fd3abf49f577c050968fba9d1">simSystem::lnF_end</a></div><div class="ttdeci">double lnF_end</div><div class="ttdoc">Starting and ending lnF for Wang-Landau. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00100">system.h:100</a></div></div>
<div class="ttc" id="classsim_system_html_a2b168c89742f4d64270583e7e54b2929"><div class="ttname"><a href="classsim_system.html#a2b168c89742f4d64270583e7e54b2929">simSystem::restartFromWALA</a></div><div class="ttdeci">bool restartFromWALA</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00093">system.h:93</a></div></div>
<div class="ttc" id="global_8h_html_a428dfe1ef0a6ff4b1fdebf275f6aff2e"><div class="ttname"><a href="global_8h.html#a428dfe1ef0a6ff4b1fdebf275f6aff2e">SYS_FAILURE</a></div><div class="ttdeci">#define SYS_FAILURE</div><div class="ttdoc">Returned from main the simualtion encountered a major error. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00158">global.h:158</a></div></div>
<div class="ttc" id="classsim_system_html_a9eea865e6dc1cff377b1e79c4d9c23f0"><div class="ttname"><a href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">simSystem::numSpecies</a></div><div class="ttdeci">std::vector&lt; int &gt; numSpecies</div><div class="ttdoc">Total number of each type of atom the system contains. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00117">system.h:117</a></div></div>
<div class="ttc" id="classsim_system_html_a93259b517f449f1ac610d132ac66b551"><div class="ttname"><a href="classsim_system.html#a93259b517f449f1ac610d132ac66b551">simSystem::maxSpecies</a></div><div class="ttdeci">const int maxSpecies(const int index)</div><div class="ttdoc">Returns the absolute maximum number of a given species type allowed in the system. </div><div class="ttdef"><b>Definition:</b> <a href="system_8cpp_source.html#l01654">system.cpp:1654</a></div></div>
<div class="ttc" id="classsim_system_html_a5ae652ff4519f39c3862abae32a9581b"><div class="ttname"><a href="classsim_system.html#a5ae652ff4519f39c3862abae32a9581b">simSystem::speciesBarriers</a></div><div class="ttdeci">std::vector&lt; compositeBarrier &gt; speciesBarriers</div><div class="ttdoc">Barriers, if any, for each species. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00120">system.h:120</a></div></div>
<div class="ttc" id="classsim_system_html_a90421b19082f7fb8fc23b7264b1161e4"><div class="ttname"><a href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">simSystem::atoms</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; atom &gt; &gt; atoms</div><div class="ttdoc">Atoms in a matrix by type, and particle index, respectively that a system CAN hold but not all are ac...</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00118">system.h:118</a></div></div>
<div class="ttc" id="classsim_system_html_aa83b00006b3919fb6e13f1bdeadece6a"><div class="ttname"><a href="classsim_system.html#aa83b00006b3919fb6e13f1bdeadece6a">simSystem::useWALA</a></div><div class="ttdeci">bool useWALA</div><div class="ttdoc">Logical stating whether or not to use Wang-Landau biasing. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00092">system.h:92</a></div></div>
<div class="ttc" id="classsim_system_html_aa474a50b6353c8897331b1ab1ce53ab1"><div class="ttname"><a href="classsim_system.html#aa474a50b6353c8897331b1ab1ce53ab1">simSystem::useTMMC</a></div><div class="ttdeci">bool useTMMC</div><div class="ttdoc">Logical stating whether or not to use TMMC biasing. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00091">system.h:91</a></div></div>
<div class="ttc" id="classsim_system_html_a8bff9dfb95b1b09a0fab2c1c485ade07"><div class="ttname"><a href="classsim_system.html#a8bff9dfb95b1b09a0fab2c1c485ade07">simSystem::box</a></div><div class="ttdeci">const std::vector&lt; double &gt; box()</div><div class="ttdoc">Return the system box dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00104">system.h:104</a></div></div>
<div class="ttc" id="classsim_system_html_a794334e163fbeb4b4f61bcea676679ce"><div class="ttname"><a href="classsim_system.html#a794334e163fbeb4b4f61bcea676679ce">simSystem::lnF_start</a></div><div class="ttdeci">double lnF_start</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00100">system.h:100</a></div></div>
<div class="ttc" id="classsim_system_html_aa748f651ddd9a2bf6d88bfcab9153905"><div class="ttname"><a href="classsim_system.html#aa748f651ddd9a2bf6d88bfcab9153905">simSystem::nCrossoverVisits</a></div><div class="ttdeci">long long int nCrossoverVisits</div><div class="ttdoc">Number of crossovers that must occur before switching from WALA to TMMC. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00098">system.h:98</a></div></div>
<div class="ttc" id="classsim_system_html_a5ccdad82b3767ba21b1e4b1e36362082"><div class="ttname"><a href="classsim_system.html#a5ccdad82b3767ba21b1e4b1e36362082">simSystem::restartFromTMMCFile</a></div><div class="ttdeci">std::string restartFromTMMCFile</div><div class="ttdoc">Files to restart from WALA or TMMC initially. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00115">system.h:115</a></div></div>
<div class="ttc" id="classsim_system_html_afbf0b172dc35572e71ec6d27a018e2fc"><div class="ttname"><a href="classsim_system.html#afbf0b172dc35572e71ec6d27a018e2fc">simSystem::restartFromWALAFile</a></div><div class="ttdeci">std::string restartFromWALAFile</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00115">system.h:115</a></div></div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
<div class="ttc" id="classatom_html"><div class="ttname"><a href="classatom.html">atom</a></div><div class="ttdoc">Atom class with rigid internal degrees of freedom besides its center of mass. </div><div class="ttdef"><b>Definition:</b> <a href="atom_8h_source.html#l00012">atom.h:12</a></div></div>
<div class="ttc" id="classsim_system_html_af1e3f5320aff976a448647244d5950d1"><div class="ttname"><a href="classsim_system.html#af1e3f5320aff976a448647244d5950d1">simSystem::mu</a></div><div class="ttdeci">const double mu(const int index)</div><div class="ttdoc">Return the chemical potential for a given species&#39; index. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00088">system.h:88</a></div></div>
<div class="ttc" id="classsim_system_html_afafda4a09ed180ee9c5580d196d8ca9f"><div class="ttname"><a href="classsim_system.html#afafda4a09ed180ee9c5580d196d8ca9f">simSystem::minSpecies</a></div><div class="ttdeci">const int minSpecies(const int index)</div><div class="ttdoc">Returns the absolute minimum number of a given species type allowed in the system. </div><div class="ttdef"><b>Definition:</b> <a href="system_8cpp_source.html#l01672">system.cpp:1672</a></div></div>
<div class="ttc" id="classsim_system_html_ae625e1026daee4f99f83fb73881875a1"><div class="ttname"><a href="classsim_system.html#ae625e1026daee4f99f83fb73881875a1">simSystem::wlSweepSize</a></div><div class="ttdeci">long long int wlSweepSize</div><div class="ttdoc">Size of Wang-Landau sweep. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00097">system.h:97</a></div></div>
<div class="ttc" id="classsim_system_html_aa2e866e69ebe5fa0761894212592175a"><div class="ttname"><a href="classsim_system.html#aa2e866e69ebe5fa0761894212592175a">simSystem::wala_g</a></div><div class="ttdeci">double wala_g</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00101">system.h:101</a></div></div>
<div class="ttc" id="classsim_system_html_a3eeec9678902f8d7fce4dad6064aaf4c"><div class="ttname"><a href="classsim_system.html#a3eeec9678902f8d7fce4dad6064aaf4c">simSystem::beta</a></div><div class="ttdeci">const double beta()</div><div class="ttdoc">Return 1/kT. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00087">system.h:87</a></div></div>
<div class="ttc" id="classsim_system_html_a78b107e20bcbf2f818264fa076de5db3"><div class="ttname"><a href="classsim_system.html#a78b107e20bcbf2f818264fa076de5db3">simSystem::totalTMMCSweeps</a></div><div class="ttdeci">long long int totalTMMCSweeps</div><div class="ttdoc">Total number of sweeps to perform during TMMC. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00096">system.h:96</a></div></div>
<div class="ttc" id="classhistogram_html"><div class="ttname"><a href="classhistogram.html">histogram</a></div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00014">histogram.h:14</a></div></div>
<div class="ttc" id="classsim_system_html_ab5e2e9b6204de15520302fe1d51688dd"><div class="ttname"><a href="classsim_system.html#ab5e2e9b6204de15520302fe1d51688dd">simSystem::nSpecies</a></div><div class="ttdeci">const int nSpecies()</div><div class="ttdoc">Return the number of different species in the system. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00072">system.h:72</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abaa6ad6ea00aa437cf0b9ac8034af327"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">simSystem::~simSystem </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="system_8cpp_source.html#l00410">410</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>References <a class="el" href="system_8h_source.html#l00112">tmmcBias</a>, <a class="el" href="system_8h_source.html#l00091">useTMMC</a>, <a class="el" href="system_8h_source.html#l00092">useWALA</a>, and <a class="el" href="system_8h_source.html#l00113">wlBias</a>.</p>
<div class="fragment"><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                       {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classsim_system.html#aa474a50b6353c8897331b1ab1ce53ab1">useTMMC</a>) {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="keyword">delete</span> <a class="code" href="classsim_system.html#a13173f45a1e40a5f5a3552b0ebe15b54">tmmcBias</a>;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classsim_system.html#aa83b00006b3919fb6e13f1bdeadece6a">useWALA</a>) {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="keyword">delete</span> <a class="code" href="classsim_system.html#a6dc8d9f89dfcfa247a59bc50889c49e7">wlBias</a>;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;}</div>
<div class="ttc" id="classsim_system_html_aa83b00006b3919fb6e13f1bdeadece6a"><div class="ttname"><a href="classsim_system.html#aa83b00006b3919fb6e13f1bdeadece6a">simSystem::useWALA</a></div><div class="ttdeci">bool useWALA</div><div class="ttdoc">Logical stating whether or not to use Wang-Landau biasing. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00092">system.h:92</a></div></div>
<div class="ttc" id="classsim_system_html_aa474a50b6353c8897331b1ab1ce53ab1"><div class="ttname"><a href="classsim_system.html#aa474a50b6353c8897331b1ab1ce53ab1">simSystem::useTMMC</a></div><div class="ttdeci">bool useTMMC</div><div class="ttdoc">Logical stating whether or not to use TMMC biasing. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00091">system.h:91</a></div></div>
<div class="ttc" id="classsim_system_html_a6dc8d9f89dfcfa247a59bc50889c49e7"><div class="ttname"><a href="classsim_system.html#a6dc8d9f89dfcfa247a59bc50889c49e7">simSystem::wlBias</a></div><div class="ttdeci">wala * wlBias</div><div class="ttdoc">WL biasing function. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00113">system.h:113</a></div></div>
<div class="ttc" id="classsim_system_html_a13173f45a1e40a5f5a3552b0ebe15b54"><div class="ttname"><a href="classsim_system.html#a13173f45a1e40a5f5a3552b0ebe15b54">simSystem::tmmcBias</a></div><div class="ttdeci">tmmc * tmmcBias</div><div class="ttdoc">TMMC biasing function. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00112">system.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a09c4ea670168c9f1d549d2a5120eb13c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool simSystem::addKECorrection </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="system_8h_source.html#l00032">32</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="input_8cpp_source.html#l00037">initialize()</a>, <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>, and <a class="el" href="input_8cpp_source.html#l00457">setConfig()</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;{ <span class="keywordflow">return</span> toggleKE_; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5abdfae81ca00a79f162c0ce2b4307c9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::addPotential </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>spec1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>spec2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>ppot_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>useCellList</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>tabFile</em> = <code>&quot;&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a pair potential to the system which governs the pair (spec1, spec2). </p>
<p>However, it only stores the pointer so the object must be fixed in memory somewhere else throughout the simulation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">spec1</td><td>Species index 1 (&gt;= 0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">spec2</td><td>Species index 2 (&gt;= 0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ppot_name</td><td>Name of pair potential </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">params</td><td>Vector of parameters which define pair potential </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bool</td><td>Optional argument of whether or not to build and maintain a cell list for this pair (spec1, spec2) (default=false) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tabFile</td><td>Optional argument use for tabulated potentials, this is the file to load from (default="") </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l01223">1223</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>References <a class="el" href="utilities_8h_source.html#l00044">numToStr()</a>, <a class="el" href="system_8h_source.html#l00119">ppot</a>, <a class="el" href="utilities_8cpp_source.html#l00035">sendErr()</a>, and <a class="el" href="utilities_8cpp_source.html#l00026">sendMsg()</a>.</p>

<p>Referenced by <a class="el" href="input_8cpp_source.html#l00322">setPairPotentials()</a>.</p>
<div class="fragment"><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                                                                                                                                                                              {</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordflow">if</span> (spec1 &gt;= nSpecies_ || spec1 &lt; 0) {</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Trying to define pair potential for species (1) that does not exist yet/is invalid&quot;</span>);</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    }</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordflow">if</span> (spec2 &gt;= nSpecies_ || spec2 &lt; 0) {</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Trying to define pair potential for species (2) that does not exist yet/is invalid&quot;</span>);</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    }</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="keywordflow">if</span> (ppot_name == <span class="stringliteral">&quot;square_well&quot;</span>) {</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;            <span class="keyword">auto</span> pp1 = std::make_shared &lt; squareWell &gt; ();</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;            pp1-&gt;setParameters(params);</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;            <a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>[spec1][spec2] = pp1;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;            <span class="keyword">auto</span> pp2 = std::make_shared &lt; squareWell &gt; ();</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;            pp2-&gt;setParameters(params);</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;            <a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>[spec2][spec1] = pp2;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        } <span class="keywordflow">catch</span> (std::exception &amp;ex) {</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a>(ex.what());</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        }</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ppot_name == <span class="stringliteral">&quot;lennard_jones&quot;</span>) {</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;            <span class="keyword">auto</span> pp1 = std::make_shared &lt; lennardJones &gt; ();</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;            pp1-&gt;setParameters(params);</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;            <a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>[spec1][spec2] = pp1;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;            <span class="keyword">auto</span> pp2 = std::make_shared &lt; lennardJones &gt; ();</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;            pp2-&gt;setParameters(params);</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;            <a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>[spec2][spec1] = pp2;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        } <span class="keywordflow">catch</span> (std::exception &amp;ex) {</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a>(ex.what());</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        }</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ppot_name == <span class="stringliteral">&quot;fs_lennard_jones&quot;</span>) {</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            <span class="keyword">auto</span> pp1 = std::make_shared &lt; fsLennardJones &gt; ();</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;            pp1-&gt;setParameters(params);</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;            <a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>[spec1][spec2] = pp1;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;            <span class="keyword">auto</span> pp2 = std::make_shared &lt; fsLennardJones &gt; ();</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;            pp2-&gt;setParameters(params);</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;            <a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>[spec2][spec1] = pp2;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        } <span class="keywordflow">catch</span> (std::exception &amp;ex) {</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a>(ex.what());</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        }</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ppot_name == <span class="stringliteral">&quot;hard_sphere&quot;</span>) {</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;            <span class="keyword">auto</span> pp1 = std::make_shared &lt; hardCore &gt; ();</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;            pp1-&gt;setParameters(params);</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            <a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>[spec1][spec2] = pp1;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;            <span class="keyword">auto</span> pp2 = std::make_shared &lt; hardCore &gt; ();</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;            pp2-&gt;setParameters(params);</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;            <a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>[spec2][spec1] = pp2;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        } <span class="keywordflow">catch</span> (std::exception &amp;ex) {</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a>(ex.what());</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        }</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ppot_name == <span class="stringliteral">&quot;tabulated&quot;</span>) {</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;            <span class="keyword">auto</span> pp1 = std::make_shared &lt; tabulated &gt; ();</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;            pp1-&gt;setParameters(params);</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;            pp1-&gt;loadPotential(tabFile);</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;            <a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>[spec1][spec2] = pp1;</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;            <span class="keyword">auto</span> pp2 = std::make_shared &lt; tabulated &gt; ();</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;            pp2-&gt;setParameters(params);</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;            pp2-&gt;loadPotential(tabFile);</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;            <a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>[spec2][spec1] = pp2;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;        } <span class="keywordflow">catch</span> (std::exception &amp;ex) {</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a>(ex.what());</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        }</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a>(<span class="stringliteral">&quot;Unrecognized pair potential name for species &quot;</span>+<a class="code" href="utilities_8h.html#ae6ed8fadf719af789711a7c0e99f44bc">numToStr</a>(spec1)+<span class="stringliteral">&quot;, &quot;</span>+<a class="code" href="utilities_8h.html#ae6ed8fadf719af789711a7c0e99f44bc">numToStr</a>(spec2));</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    }</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    ppotSet_[spec1][spec2] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    ppotSet_[spec2][spec1] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keywordflow">if</span> (useCellList) {</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        <a class="code" href="utilities_8cpp.html#a08974c73a5b36c28b8ad1ef47fca77b0">sendMsg</a>(<span class="stringliteral">&quot;Setting up cell list for interactions between type &quot;</span>+<a class="code" href="utilities_8h.html#ae6ed8fadf719af789711a7c0e99f44bc">numToStr</a>(spec1)+<span class="stringliteral">&quot; and &quot;</span>+<a class="code" href="utilities_8h.html#ae6ed8fadf719af789711a7c0e99f44bc">numToStr</a>(spec2));</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;        <span class="comment">// Add creation of cell lists</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>[spec1][spec2]-&gt;rcut() &gt; box_[0]/3.0) || (<a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>[spec1][spec2]-&gt;rcut() &gt; box_[1]/3.0) || (<a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>[spec1][spec2] -&gt;rcut() &gt; box_[2]/3.0)) {</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;            <a class="code" href="utilities_8cpp.html#a6dacf3c3c19aa1e13a4d5a148fe5114e">sendErr</a>(<span class="stringliteral">&quot;Cutoff (&quot;</span>+<a class="code" href="utilities_8h.html#ae6ed8fadf719af789711a7c0e99f44bc">numToStr</a>(<a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>[spec1][spec2]-&gt;rcut())+<span class="stringliteral">&quot;) larger than 1.0/3.0 boxsize, disabling cell lists for this interaction&quot;</span>);</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;            useCellList_[spec1][spec2] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;            useCellList_[spec2][spec1] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;            <a class="code" href="utilities_8cpp.html#a08974c73a5b36c28b8ad1ef47fca77b0">sendMsg</a>(<span class="stringliteral">&quot;Creating Cell list with r_cut = &quot;</span>+<a class="code" href="utilities_8h.html#ae6ed8fadf719af789711a7c0e99f44bc">numToStr</a>(<a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>[spec1][spec2]-&gt;rcut()));</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;            useCellList_[spec1][spec2] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;            useCellList_[spec2][spec1] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;            std::vector &lt;atom*&gt; dummyList(0);</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;            <span class="keywordflow">if</span> (cellListsByPairType_[spec1][spec2] == NULL) {</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                cellLists_.push_back(<a class="code" href="classcell_list.html">cellList</a>(box_, <a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>[spec1][spec2]-&gt;rcut(), dummyList));</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                cellListsByPairType_[spec1][spec2] = &amp;cellLists_[cellLists_.size()-1];</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;            }</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;            <span class="keywordflow">if</span> (cellListsByPairType_[spec2][spec1] == NULL) {</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                cellLists_.push_back(<a class="code" href="classcell_list.html">cellList</a>(box_, <a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>[spec2][spec1]-&gt;rcut(), dummyList));</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                cellListsByPairType_[spec2][spec1] = &amp;cellLists_[cellLists_.size()-1];</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;            }</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        }</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        useCellList_[spec1][spec2] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        useCellList_[spec2][spec1] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    }</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;}</div>
<div class="ttc" id="classsim_system_html_ad2e290b5963f132e6a3a56cee35c8e9f"><div class="ttname"><a href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">simSystem::ppot</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::shared_ptr&lt; pairPotential &gt; &gt; &gt; ppot</div><div class="ttdoc">Matrix of pair potentials for atom types i, j. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00119">system.h:119</a></div></div>
<div class="ttc" id="classcell_list_html"><div class="ttname"><a href="classcell_list.html">cellList</a></div><div class="ttdoc">cellList class. </div><div class="ttdef"><b>Definition:</b> <a href="cell_list_8h_source.html#l00015">cellList.h:15</a></div></div>
<div class="ttc" id="utilities_8cpp_html_a6dacf3c3c19aa1e13a4d5a148fe5114e"><div class="ttname"><a href="utilities_8cpp.html#a6dacf3c3c19aa1e13a4d5a148fe5114e">sendErr</a></div><div class="ttdeci">void sendErr(const std::string msg)</div><div class="ttdoc">Send a message to std::cerr. </div><div class="ttdef"><b>Definition:</b> <a href="utilities_8cpp_source.html#l00035">utilities.cpp:35</a></div></div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
<div class="ttc" id="utilities_8h_html_ae6ed8fadf719af789711a7c0e99f44bc"><div class="ttname"><a href="utilities_8h.html#ae6ed8fadf719af789711a7c0e99f44bc">numToStr</a></div><div class="ttdeci">std::string numToStr(const T &amp;val)</div><div class="ttdoc">Convert a number to a string with 15 digits of precision. </div><div class="ttdef"><b>Definition:</b> <a href="utilities_8h_source.html#l00044">utilities.h:44</a></div></div>
<div class="ttc" id="utilities_8cpp_html_a08974c73a5b36c28b8ad1ef47fca77b0"><div class="ttname"><a href="utilities_8cpp.html#a08974c73a5b36c28b8ad1ef47fca77b0">sendMsg</a></div><div class="ttdeci">void sendMsg(const std::string msg)</div><div class="ttdoc">Send a message to std::cout. </div><div class="ttdef"><b>Definition:</b> <a href="utilities_8cpp_source.html#l00026">utilities.cpp:26</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3eeec9678902f8d7fce4dad6064aaf4c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double simSystem::beta </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return 1/kT. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00087">87</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="aggvolbias_8cpp_source.html#l00142">aggVolBias3::make()</a>, <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, <a class="el" href="translate_8cpp_source.html#l00010">translateParticle::make()</a>, <a class="el" href="swap_8cpp_source.html#l00010">swapParticles::make()</a>, <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>, and <a class="el" href="system_8cpp_source.html#l00431">simSystem()</a>.</p>

</div>
</div>
<a class="anchor" id="a8bff9dfb95b1b09a0fab2c1c485ade07"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; double &gt; simSystem::box </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the system box dimensions. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00104">104</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="input_8cpp_source.html#l00010">checkBounds()</a>, <a class="el" href="aggvolbias_8cpp_source.html#l00142">aggVolBias3::make()</a>, <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, <a class="el" href="translate_8cpp_source.html#l00010">translateParticle::make()</a>, <a class="el" href="swap_8cpp_source.html#l00010">swapParticles::make()</a>, <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>, <a class="el" href="input_8cpp_source.html#l00616">setBarriers()</a>, <a class="el" href="input_8cpp_source.html#l00457">setConfig()</a>, <a class="el" href="input_8cpp_source.html#l00236">setMoves()</a>, and <a class="el" href="system_8cpp_source.html#l00431">simSystem()</a>.</p>

</div>
</div>
<a class="anchor" id="a176b9ff482f1d36bc0638538bcfe0670"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::checkEnergyHistogramBounds </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Monitor the energy histogram bounds at each Ntot. </p>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l00854">854</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>Referenced by <a class="el" href="crossover_8cpp_source.html#l00010">performCrossover()</a>, and <a class="el" href="wala_8cpp_source.html#l00010">performWALA()</a>.</p>
<div class="fragment"><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                                            {</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="keywordflow">if</span> (totN_ &gt;= totNBounds_[0] &amp;&amp; totN_ &lt;= totNBounds_[1]) {</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> address = totN_-totNBounds_[0];</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        energyHistogram_lb_[address] = std::min(energyHistogram_lb_[address], energy_);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        energyHistogram_ub_[address] = std::max(energyHistogram_ub_[address], energy_);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    }</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a18e515d42d1d653bcac67d61701983eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::decrementMState </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrease the expanded ensemble state of the system by 1. </p>
<p>Accounts for the periodicity of [0, M) </p>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l00016">16</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;                                 {</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    Mcurrent_--;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keywordflow">if</span> (Mcurrent_ &lt; 0) {</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        Mcurrent_ += Mtot_;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    }</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acabf4fc5b5b90bba62e1449ddb3646c6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::deleteAtom </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>typeIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>atomIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>override</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delete an atom from the system. </p>
<p>Does all the bookkeepping behind the scenes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">typeIndex</td><td>What type the atom is (&gt;= 0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atomIndex</td><td>Which atom <em>index</em> of type typeIndex to destroy (&gt;= 0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Optional</td><td>override command which allows the system to delete a particle even it goes below the minimum allowed. E.g. during a swap move. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l00241">241</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>References <a class="el" href="system_8h_source.html#l00118">atoms</a>, <a class="el" href="atom_8h_source.html#l00020">atom::mState</a>, <a class="el" href="system_8h_source.html#l00117">numSpecies</a>, and <a class="el" href="cell_list_8cpp_source.html#l00100">cellList::swapAndDeleteParticle()</a>.</p>

<p>Referenced by <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, <a class="el" href="swap_8cpp_source.html#l00010">swapParticles::make()</a>, and <a class="el" href="system_8cpp_source.html#l01387">readConfig()</a>.</p>
<div class="fragment"><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                                                                                   {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">if</span> (typeIndex &lt; nSpecies_ &amp;&amp; typeIndex &gt;= 0) {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[typeIndex] &gt; minSpecies_[typeIndex]) || ((<a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[typeIndex] == minSpecies_[typeIndex]) &amp;&amp; (Mcurrent_ &gt; 0)) || <span class="keyword">override</span>) {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">override</span>) {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                <span class="comment">// doing a swap move</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                <span class="keywordflow">if</span> (Mtot_ &gt; 1) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                    <span class="comment">// expanded ensemble and not necessarily deleting the partial atom</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                    <span class="keywordtype">int</span> end = <a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[typeIndex] - 1;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                    <span class="keywordflow">if</span> (fractionalAtomType_ == typeIndex &amp;&amp; Mcurrent_ &gt; 0) {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                        <span class="comment">// we are deleting a particle which has to watch out for the partial atom</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                        end++;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                    }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][atomIndex].mState == 0) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                        <span class="comment">// if we are removing a &quot;full&quot; particle, have to decrement Ntot, else not</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                        <a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[typeIndex]--;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                        totN_--;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                        <span class="comment">// but if removing the partial particle, M is affected</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                        Mcurrent_ = 0; <span class="comment">// regardless of how M was originally, the partial particle is now &quot;entirely&quot; gone</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                    }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                    <span class="keywordtype">bool</span> replace = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                    <span class="keywordflow">if</span> (&amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][end] == fractionalAtom_) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                        <span class="comment">// then the fractional atom is about to be used to replace a &quot;full&quot; one</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                        replace = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                    }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                    <span class="comment">// have to entirely remove the particle</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nSpecies_; ++i) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                        <span class="keywordflow">if</span> (useCellList_[typeIndex][i]) {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                            <a class="code" href="classcell_list.html">cellList</a>* cl = cellListsByPairType_[typeIndex][i];</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                            cl-&gt;<a class="code" href="classcell_list.html#a31caca1e8dd05c33215ac7495d55aeea">swapAndDeleteParticle</a>(&amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][atomIndex], &amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][end]);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                        }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                    }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                    <a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][atomIndex] = <a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][end];    <span class="comment">// &quot;replacement&quot; operation</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                    <span class="keywordflow">if</span> (replace) {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                        fractionalAtom_ = &amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][atomIndex]; <span class="comment">// update the pointer if necessary</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                    }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                    <span class="comment">// no expanded ensemble, just delete particle from appropriate cell list</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nSpecies_; ++i) {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                        <span class="keywordflow">if</span> (useCellList_[typeIndex][i]) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                            <a class="code" href="classcell_list.html">cellList</a>* cl = cellListsByPairType_[typeIndex][i];</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                            cl-&gt;<a class="code" href="classcell_list.html#a31caca1e8dd05c33215ac7495d55aeea">swapAndDeleteParticle</a>(&amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][atomIndex], &amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][<a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[typeIndex] - 1]);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                        }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                    }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                    <a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][atomIndex] = <a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][<a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[typeIndex] - 1];    <span class="comment">// &quot;replacement&quot; operation</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                    numSpecies[typeIndex]--;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                    totN_--;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                <span class="comment">// not doing a swap move, just a &quot;regular&quot; deletion</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                <span class="keywordflow">if</span> (Mtot_ &gt; 1) {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                    <span class="comment">// expanded ensemble</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                    <span class="keywordflow">if</span> (Mcurrent_ == 1) {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                        <span class="comment">// when we delete this atom, it is entirely gone</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                        <span class="comment">// first ensure the system pointer is correct if currently a partially inserted atom</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                        <span class="keywordflow">if</span> (fractionalAtom_ != &amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][atomIndex] || typeIndex != fractionalAtomType_) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Fractional atom pointer does not point to atom belived to be inserted&quot;</span>);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                        }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                        <span class="comment">// decrement expanded state</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                        fractionalAtom_-&gt;<a class="code" href="classatom.html#a3cb00c0c5b7533657e05af6ff4a42740">mState</a> = 0;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                        Mcurrent_ = 0;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                        <span class="comment">// since deleting partial particle, do not update Ntot, etc.</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                        <span class="comment">// however, do have to remove from cellLists</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                        <span class="keywordtype">int</span> end = <a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[typeIndex]; <span class="comment">// includes space for the partially inserted one currently in cellList</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nSpecies_; ++i) {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                            <span class="keywordflow">if</span> (useCellList_[typeIndex][i]) {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                                <a class="code" href="classcell_list.html">cellList</a>* cl = cellListsByPairType_[typeIndex][i];</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                                cl-&gt;<a class="code" href="classcell_list.html#a31caca1e8dd05c33215ac7495d55aeea">swapAndDeleteParticle</a>(&amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][atomIndex], &amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][end]);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                            }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                        }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                        <a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][atomIndex] = <a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][end];    <span class="comment">// &quot;replacement&quot; operation</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Mcurrent_ == 0) {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                        <span class="comment">// have to decrement Ntot, but keep in cell lists</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                        <a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[typeIndex]--;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                        totN_--;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                        <span class="comment">// this is a new fractional atom</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                        fractionalAtom_ = &amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][atomIndex];</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                        fractionalAtomType_ = typeIndex;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                        <span class="comment">// decrement expanded state</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                        fractionalAtom_-&gt;<a class="code" href="classatom.html#a3cb00c0c5b7533657e05af6ff4a42740">mState</a> = Mtot_-1;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                        Mcurrent_ = Mtot_-1;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                        <span class="comment">// further deleting an atom that already partially exists in the system, but remains in cell lists</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                        <span class="comment">// first ensure the system pointer is correct if currently a partially inserted atom</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                        <span class="keywordflow">if</span> (fractionalAtom_ != &amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][atomIndex] || typeIndex != fractionalAtomType_) {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Fractional atom pointer does not point to atom belived to be inserted&quot;</span>);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                        }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                        <span class="comment">// decrement expanded state</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                        fractionalAtom_-&gt;<a class="code" href="classatom.html#a3cb00c0c5b7533657e05af6ff4a42740">mState</a> -= 1;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                        Mcurrent_ -= 1;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                    }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                    <span class="comment">// no expanded ensemble, just delete particle from appropriate cell list</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nSpecies_; ++i) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                        <span class="keywordflow">if</span> (useCellList_[typeIndex][i]) {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                            <a class="code" href="classcell_list.html">cellList</a>* cl = cellListsByPairType_[typeIndex][i];</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                            cl-&gt;<a class="code" href="classcell_list.html#a31caca1e8dd05c33215ac7495d55aeea">swapAndDeleteParticle</a>(&amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][atomIndex], &amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][<a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[typeIndex] - 1]);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                        }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                    }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                    <a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][atomIndex] = <a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][<a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[typeIndex] - 1];    <span class="comment">// &quot;replacement&quot; operation</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                    numSpecies[typeIndex]--;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                    totN_--;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;System going below minimum allowable number of atoms, cannot delete an atom of type index &quot;</span>+std::to_string(typeIndex));</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;That species index does not exist, cannot delete an atom&quot;</span>);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;}</div>
<div class="ttc" id="classsim_system_html_a9eea865e6dc1cff377b1e79c4d9c23f0"><div class="ttname"><a href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">simSystem::numSpecies</a></div><div class="ttdeci">std::vector&lt; int &gt; numSpecies</div><div class="ttdoc">Total number of each type of atom the system contains. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00117">system.h:117</a></div></div>
<div class="ttc" id="classsim_system_html_a90421b19082f7fb8fc23b7264b1161e4"><div class="ttname"><a href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">simSystem::atoms</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; atom &gt; &gt; atoms</div><div class="ttdoc">Atoms in a matrix by type, and particle index, respectively that a system CAN hold but not all are ac...</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00118">system.h:118</a></div></div>
<div class="ttc" id="classcell_list_html"><div class="ttname"><a href="classcell_list.html">cellList</a></div><div class="ttdoc">cellList class. </div><div class="ttdef"><b>Definition:</b> <a href="cell_list_8h_source.html#l00015">cellList.h:15</a></div></div>
<div class="ttc" id="classcell_list_html_a31caca1e8dd05c33215ac7495d55aeea"><div class="ttname"><a href="classcell_list.html#a31caca1e8dd05c33215ac7495d55aeea">cellList::swapAndDeleteParticle</a></div><div class="ttdeci">void swapAndDeleteParticle(atom *, atom *)</div><div class="ttdef"><b>Definition:</b> <a href="cell_list_8cpp_source.html#l00100">cellList.cpp:100</a></div></div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
<div class="ttc" id="classatom_html_a3cb00c0c5b7533657e05af6ff4a42740"><div class="ttname"><a href="classatom.html#a3cb00c0c5b7533657e05af6ff4a42740">atom::mState</a></div><div class="ttdeci">int mState</div><div class="ttdoc">State of fraction insertion of the atom in the expanded ensemble, 0 = fully inserted. </div><div class="ttdef"><b>Definition:</b> <a href="atom_8h_source.html#l00020">atom.h:20</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a37b3d15faf56bf31349f5c2aaf02f858"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double simSystem::energy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the system's instantaneous energy. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00084">84</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="sanity_8cpp_source.html#l00008">sanityChecks()</a>.</p>

</div>
</div>
<a class="anchor" id="a1744c4c22603662081d75985bc30b754"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; double &gt; simSystem::extMomCounter </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get counter for extensive moments needed for restarting system from a checkpoint. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00103">103</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>References <a class="el" href="histogram_8h_source.html#l00027">histogram::getCounter()</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00159">checkpoint::dump()</a>.</p>

</div>
</div>
<a class="anchor" id="a299fe4372e610b554eaaf5f5957b2dbc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int simSystem::getCurrentM </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the system's current expanded ensemble fractional state. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00080">80</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="system_8cpp_source.html#l01755">calculateBias()</a>, <a class="el" href="aggvolbias_8cpp_source.html#l00142">aggVolBias3::make()</a>, <a class="el" href="translate_8cpp_source.html#l00010">translateParticle::make()</a>, <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>, <a class="el" href="swap_8cpp_source.html#l00010">swapParticles::make()</a>, <a class="el" href="mover_8cpp_source.html#l00191">moves::makeMove()</a>, <a class="el" href="crossover_8cpp_source.html#l00010">performCrossover()</a>, <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>, <a class="el" href="wala_8cpp_source.html#l00010">performWALA()</a>, and <a class="el" href="sanity_8cpp_source.html#l00008">sanityChecks()</a>.</p>

</div>
</div>
<a class="anchor" id="a610cbb1c6059151e420dbd42dd9da714"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; simSystem::getELB </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns current tally of energy min at each Ntot for checkpointing. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00105">105</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00159">checkpoint::dump()</a>.</p>

</div>
</div>
<a class="anchor" id="ae87e0ac03cc11259cd3b44c780a90a06"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; double &gt; simSystem::getEUB </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns current tally of energy max at each Ntot for checkpointing. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00106">106</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00159">checkpoint::dump()</a>.</p>

</div>
</div>
<a class="anchor" id="a2ab77377c60e0e3109a6e875690b0ab7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classatom.html">atom</a>* simSystem::getFractionalAtom </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns a pointer the atom in the system that is currently only fractionally inserted/deleted. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00110">110</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, <a class="el" href="translate_8cpp_source.html#l00010">translateParticle::make()</a>, <a class="el" href="swap_8cpp_source.html#l00010">swapParticles::make()</a>, <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>, and <a class="el" href="sanity_8cpp_source.html#l00008">sanityChecks()</a>.</p>

</div>
</div>
<a class="anchor" id="a0500a9e84eecfbde7a98cf8a34f719d5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int simSystem::getFractionalAtomType </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the atom type of the fractional atom. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00082">82</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="aggvolbias_8cpp_source.html#l00142">aggVolBias3::make()</a>, <a class="el" href="translate_8cpp_source.html#l00010">translateParticle::make()</a>, <a class="el" href="swap_8cpp_source.html#l00010">swapParticles::make()</a>, <a class="el" href="mover_8cpp_source.html#l00191">moves::makeMove()</a>, and <a class="el" href="sanity_8cpp_source.html#l00008">sanityChecks()</a>.</p>

</div>
</div>
<a class="anchor" id="afe08187d318113c33bda890c69570c36"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int simSystem::getMaxOrder </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the max order the extensive moments are being stored out to. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00078">78</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="system_8cpp_source.html#l00742">restartExtMoments()</a>, and <a class="el" href="input_8cpp_source.html#l00457">setConfig()</a>.</p>

</div>
</div>
<a class="anchor" id="a9b3aeefa22c3b50b5913df6eea753bc6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classatom.html">atom</a> * &gt; simSystem::getNeighborAtoms </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>typeIndexA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>typeIndexB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classatom.html">atom</a> *&#160;</td>
          <td class="paramname"><em>_atom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the list of neighbors of type A, around a particle of type B which is passed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">typeIndexA</td><td>Index of first atom type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">typeIndexB</td><td>Index of second atom type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atom</td><td>Pointer to atom to find neighbors around</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>neighbor_list </dd></dl>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l01498">1498</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>References <a class="el" href="system_8h_source.html#l00118">atoms</a>, <a class="el" href="cell_list_8h_source.html#l00041">cellList::calcIndex()</a>, <a class="el" href="cell_list_8h_source.html#l00037">cellList::cells</a>, <a class="el" href="cell_list_8h_source.html#l00038">cellList::neighbours</a>, <a class="el" href="system_8h_source.html#l00117">numSpecies</a>, and <a class="el" href="atom_8h_source.html#l00021">atom::pos</a>.</p>

<p>Referenced by <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, <a class="el" href="translate_8cpp_source.html#l00010">translateParticle::make()</a>, <a class="el" href="swap_8cpp_source.html#l00010">swapParticles::make()</a>, and <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>.</p>
<div class="fragment"><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                                                                                                                         {</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    std::vector &lt; atom* &gt; neighbors;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <span class="keywordtype">int</span> end = <a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[typeIndexA];</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    <span class="keywordflow">if</span> (Mcurrent_ &gt; 0 &amp;&amp; typeIndexA == fractionalAtomType_) {</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;        <span class="comment">// account for partial atom too</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        end++;</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    }</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    neighbors.reserve(end);</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    <span class="comment">// if no cell lists are defined for this interaction, return all particles</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <span class="keywordflow">if</span> (!useCellList_[typeIndexA][typeIndexB]) {</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; end; ++i) {</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;            <span class="keywordflow">if</span> (_atom != &amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndexA][i]) { <span class="comment">// watch out for self in case typeA = typeB</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                neighbors.push_back(&amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndexA][i]);</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;            }</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        }</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (useCellList_[typeIndexA][typeIndexB]) {</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;        <a class="code" href="classcell_list.html">cellList</a>* cl = cellListsByPairType_[typeIndexA][typeIndexB];</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cellIndex = cl-&gt;<a class="code" href="classcell_list.html#aa6b843131cd487164a137571c7343cab">calcIndex</a>(_atom-&gt;<a class="code" href="classatom.html#a3ae5f4880e7831d8b2c9fda72b4eb24a">pos</a>[0], _atom-&gt;<a class="code" href="classatom.html#a3ae5f4880e7831d8b2c9fda72b4eb24a">pos</a>[1], _atom-&gt;<a class="code" href="classatom.html#a3ae5f4880e7831d8b2c9fda72b4eb24a">pos</a>[2]);</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        <span class="comment">// loop over own cell</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; cl-&gt;<a class="code" href="classcell_list.html#a10bc0c3ae819293b1e88bc7d1bfdb2aa">cells</a>[cellIndex].size(); ++i) {</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;            <span class="keywordflow">if</span> (_atom != cl-&gt;<a class="code" href="classcell_list.html#a10bc0c3ae819293b1e88bc7d1bfdb2aa">cells</a>[cellIndex][i]) {</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                neighbors.push_back(cl-&gt;<a class="code" href="classcell_list.html#a10bc0c3ae819293b1e88bc7d1bfdb2aa">cells</a>[cellIndex][i]);</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;            }</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        }</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        <span class="comment">// loop over neighboring cells</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; cl-&gt;<a class="code" href="classcell_list.html#ada607886d0e5a20d710dde694d6d989f">neighbours</a>[cellIndex].size(); ++i) {</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> neighborCellIndex = cl-&gt;<a class="code" href="classcell_list.html#ada607886d0e5a20d710dde694d6d989f">neighbours</a>[cellIndex][i];</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; cl-&gt;<a class="code" href="classcell_list.html#a10bc0c3ae819293b1e88bc7d1bfdb2aa">cells</a>[neighborCellIndex].size(); ++j) {</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                <span class="keywordflow">if</span> (_atom != cl-&gt;<a class="code" href="classcell_list.html#a10bc0c3ae819293b1e88bc7d1bfdb2aa">cells</a>[neighborCellIndex][j]) {</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                    neighbors.push_back(cl-&gt;<a class="code" href="classcell_list.html#a10bc0c3ae819293b1e88bc7d1bfdb2aa">cells</a>[neighborCellIndex][j]);</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                }</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            }</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        }</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    }</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="keywordflow">return</span> neighbors;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;}</div>
<div class="ttc" id="classcell_list_html_aa6b843131cd487164a137571c7343cab"><div class="ttname"><a href="classcell_list.html#aa6b843131cd487164a137571c7343cab">cellList::calcIndex</a></div><div class="ttdeci">int calcIndex(int, int, int)</div><div class="ttdef"><b>Definition:</b> <a href="cell_list_8h_source.html#l00041">cellList.h:41</a></div></div>
<div class="ttc" id="classsim_system_html_a9eea865e6dc1cff377b1e79c4d9c23f0"><div class="ttname"><a href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">simSystem::numSpecies</a></div><div class="ttdeci">std::vector&lt; int &gt; numSpecies</div><div class="ttdoc">Total number of each type of atom the system contains. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00117">system.h:117</a></div></div>
<div class="ttc" id="classsim_system_html_a90421b19082f7fb8fc23b7264b1161e4"><div class="ttname"><a href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">simSystem::atoms</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; atom &gt; &gt; atoms</div><div class="ttdoc">Atoms in a matrix by type, and particle index, respectively that a system CAN hold but not all are ac...</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00118">system.h:118</a></div></div>
<div class="ttc" id="classcell_list_html"><div class="ttname"><a href="classcell_list.html">cellList</a></div><div class="ttdoc">cellList class. </div><div class="ttdef"><b>Definition:</b> <a href="cell_list_8h_source.html#l00015">cellList.h:15</a></div></div>
<div class="ttc" id="classatom_html_a3ae5f4880e7831d8b2c9fda72b4eb24a"><div class="ttname"><a href="classatom.html#a3ae5f4880e7831d8b2c9fda72b4eb24a">atom::pos</a></div><div class="ttdeci">std::vector&lt; double &gt; pos</div><div class="ttdoc">3D position </div><div class="ttdef"><b>Definition:</b> <a href="atom_8h_source.html#l00021">atom.h:21</a></div></div>
<div class="ttc" id="classcell_list_html_ada607886d0e5a20d710dde694d6d989f"><div class="ttname"><a href="classcell_list.html#ada607886d0e5a20d710dde694d6d989f">cellList::neighbours</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; unsigned int &gt; &gt; neighbours</div><div class="ttdef"><b>Definition:</b> <a href="cell_list_8h_source.html#l00038">cellList.h:38</a></div></div>
<div class="ttc" id="classcell_list_html_a10bc0c3ae819293b1e88bc7d1bfdb2aa"><div class="ttname"><a href="classcell_list.html#a10bc0c3ae819293b1e88bc7d1bfdb2aa">cellList::cells</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; atom * &gt; &gt; cells</div><div class="ttdef"><b>Definition:</b> <a href="cell_list_8h_source.html#l00037">cellList.h:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa31d40c91cb50f143a9613d362798887"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtmmc.html">tmmc</a> * simSystem::getTMMCBias </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return pointer to the TMMC bias. </p>
<p>Return a pointer to the TMMC biasing object, if using TMMC, else throws an exception.</p>
<dl class="section return"><dt>Returns</dt><dd>tmmc Pointer to TMMC biasing object being used. </dd></dl>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l01688">1688</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>References <a class="el" href="system_8h_source.html#l00112">tmmcBias</a>, and <a class="el" href="system_8h_source.html#l00091">useTMMC</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00159">checkpoint::dump()</a>, <a class="el" href="checkpoint_8cpp_source.html#l00054">checkpoint::load()</a>, <a class="el" href="crossover_8cpp_source.html#l00010">performCrossover()</a>, and <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>.</p>
<div class="fragment"><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                              {</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classsim_system.html#aa474a50b6353c8897331b1ab1ce53ab1">useTMMC</a> == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classsim_system.html#a13173f45a1e40a5f5a3552b0ebe15b54">tmmcBias</a>;</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Not using TMMC&quot;</span>);</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    }</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;}</div>
<div class="ttc" id="classsim_system_html_aa474a50b6353c8897331b1ab1ce53ab1"><div class="ttname"><a href="classsim_system.html#aa474a50b6353c8897331b1ab1ce53ab1">simSystem::useTMMC</a></div><div class="ttdeci">bool useTMMC</div><div class="ttdoc">Logical stating whether or not to use TMMC biasing. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00091">system.h:91</a></div></div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
<div class="ttc" id="classsim_system_html_a13173f45a1e40a5f5a3552b0ebe15b54"><div class="ttname"><a href="classsim_system.html#a13173f45a1e40a5f5a3552b0ebe15b54">simSystem::tmmcBias</a></div><div class="ttdeci">tmmc * tmmcBias</div><div class="ttdoc">TMMC biasing function. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00112">system.h:112</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa4ad1afff101bb530e1590df05035276"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int simSystem::getTotalM </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the total number of fractional states available to species in the expanded ensemble. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00081">81</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00054">checkpoint::load()</a>, <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>, <a class="el" href="mover_8cpp_source.html#l00191">moves::makeMove()</a>, <a class="el" href="crossover_8cpp_source.html#l00010">performCrossover()</a>, <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>, <a class="el" href="wala_8cpp_source.html#l00010">performWALA()</a>, <a class="el" href="sanity_8cpp_source.html#l00008">sanityChecks()</a>, <a class="el" href="input_8cpp_source.html#l00616">setBarriers()</a>, <a class="el" href="input_8cpp_source.html#l00457">setConfig()</a>, and <a class="el" href="input_8cpp_source.html#l00236">setMoves()</a>.</p>

</div>
</div>
<a class="anchor" id="a37dd827f4057049763351510147b9f1d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int simSystem::getTotN </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return a sum of the total number of atoms currently in the system. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00077">77</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="system_8cpp_source.html#l01755">calculateBias()</a>, <a class="el" href="aggvolbias_8cpp_source.html#l00142">aggVolBias3::make()</a>, <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, <a class="el" href="translate_8cpp_source.html#l00010">translateParticle::make()</a>, <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>, <a class="el" href="swap_8cpp_source.html#l00010">swapParticles::make()</a>, and <a class="el" href="sanity_8cpp_source.html#l00008">sanityChecks()</a>.</p>

</div>
</div>
<a class="anchor" id="a7cb5049de8b0988349e89e30e4000407"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classwala.html">wala</a> * simSystem::getWALABias </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return pointer to the Wang-Landau bias. </p>
<p>Return a pointer to the TMMC biasing object, if using TMMC, else throws an exception.</p>
<dl class="section return"><dt>Returns</dt><dd>wala Pointer to WALA biasing object being used. </dd></dl>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l01701">1701</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>References <a class="el" href="system_8h_source.html#l00092">useWALA</a>, and <a class="el" href="system_8h_source.html#l00113">wlBias</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00159">checkpoint::dump()</a>, <a class="el" href="checkpoint_8cpp_source.html#l00054">checkpoint::load()</a>, <a class="el" href="aggvolbias_8cpp_source.html#l00142">aggVolBias3::make()</a>, <a class="el" href="translate_8cpp_source.html#l00010">translateParticle::make()</a>, <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, <a class="el" href="swap_8cpp_source.html#l00010">swapParticles::make()</a>, <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>, <a class="el" href="crossover_8cpp_source.html#l00010">performCrossover()</a>, and <a class="el" href="wala_8cpp_source.html#l00010">performWALA()</a>.</p>
<div class="fragment"><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;                              {</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classsim_system.html#aa83b00006b3919fb6e13f1bdeadece6a">useWALA</a> == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classsim_system.html#a6dc8d9f89dfcfa247a59bc50889c49e7">wlBias</a>;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Not using WALA&quot;</span>);</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    }</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;}</div>
<div class="ttc" id="classsim_system_html_aa83b00006b3919fb6e13f1bdeadece6a"><div class="ttname"><a href="classsim_system.html#aa83b00006b3919fb6e13f1bdeadece6a">simSystem::useWALA</a></div><div class="ttdeci">bool useWALA</div><div class="ttdoc">Logical stating whether or not to use Wang-Landau biasing. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00092">system.h:92</a></div></div>
<div class="ttc" id="classsim_system_html_a6dc8d9f89dfcfa247a59bc50889c49e7"><div class="ttname"><a href="classsim_system.html#a6dc8d9f89dfcfa247a59bc50889c49e7">simSystem::wlBias</a></div><div class="ttdeci">wala * wlBias</div><div class="ttdoc">WL biasing function. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00113">system.h:113</a></div></div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6ad31c08955b80873f865b3069618dcb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::incrementEnergy </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>dU</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Increment the system's energy. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00034">34</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="aggvolbias_8cpp_source.html#l00142">aggVolBias3::make()</a>, <a class="el" href="translate_8cpp_source.html#l00010">translateParticle::make()</a>, <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>, and <a class="el" href="swap_8cpp_source.html#l00010">swapParticles::make()</a>.</p>

</div>
</div>
<a class="anchor" id="a5d61d583a40931ce5643bd6429f510ba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::incrementMState </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Increase the expanded ensemble state of the system by 1. </p>
<p>Accounts for the periodicity of [0, M) </p>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l00006">6</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;                                 {</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    Mcurrent_++;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    <span class="keywordflow">if</span> (Mcurrent_ == Mtot_) {</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;        Mcurrent_ = 0;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    }</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0404e9435cc046d19b6bb990678ee069"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::insertAtom </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>typeIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classatom.html">atom</a> *&#160;</td>
          <td class="paramname"><em>newAtom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>override</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Insert an atom into the system. </p>
<p>Does all the bookkeepping behind the scenes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">typeIndex</td><td>What type the atom is (&gt;= 0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">newAtom</td><td>Pointer to new atom. A copy is stored in the system so the original may be destroyed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">override</td><td>Override command that prevents the expanded ensemble state from being changed. Used during swap moves where "insertions" are temporary. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l00140">140</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>References <a class="el" href="system_8h_source.html#l00118">atoms</a>, <a class="el" href="cell_list_8cpp_source.html#l00093">cellList::insertParticle()</a>, <a class="el" href="atom_8h_source.html#l00020">atom::mState</a>, and <a class="el" href="system_8h_source.html#l00117">numSpecies</a>.</p>

<p>Referenced by <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>, <a class="el" href="swap_8cpp_source.html#l00010">swapParticles::make()</a>, and <a class="el" href="system_8cpp_source.html#l01387">readConfig()</a>.</p>
<div class="fragment"><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                                                                             {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">if</span> (typeIndex &lt; nSpecies_ &amp;&amp; typeIndex &gt;= 0) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[typeIndex] &lt; maxSpecies_[typeIndex]) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <span class="keywordflow">if</span> (Mtot_ &gt; 1 &amp;&amp; !<span class="keyword">override</span>) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                <span class="comment">// expanded ensemble behavior, &quot;normal&quot; insertion and deletion</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                <span class="keywordflow">if</span> (Mcurrent_ &gt; 0) { <span class="comment">// further inserting an atom that already partially exists in the system</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                    <span class="comment">// ensure the system pointer is correct if currently a partially inserted atom</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                    <span class="keywordflow">if</span> (fractionalAtom_ != newAtom || typeIndex != fractionalAtomType_) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Fractional atom pointer does not point to atom believed to be inserted&quot;</span>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                    }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                    <span class="comment">// increment expanded state</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                    fractionalAtom_-&gt;<a class="code" href="classatom.html#a3cb00c0c5b7533657e05af6ff4a42740">mState</a>++;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                    Mcurrent_++;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                    <span class="comment">// check if now fully inserted</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                    <span class="keywordflow">if</span> (fractionalAtom_-&gt;<a class="code" href="classatom.html#a3cb00c0c5b7533657e05af6ff4a42740">mState</a> == Mtot_) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                        fractionalAtom_-&gt;<a class="code" href="classatom.html#a3cb00c0c5b7533657e05af6ff4a42740">mState</a> = 0;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                        Mcurrent_ = 0;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                        totN_++;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                        <a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[typeIndex]++;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                    }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                    <span class="comment">// inserting a new atom for the first time</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                    <a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][<a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[typeIndex]] = (*newAtom);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                    <span class="comment">// assign fractional atom</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                    fractionalAtom_ = &amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][numSpecies[typeIndex]];</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                    fractionalAtomType_ = typeIndex;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                    <span class="comment">// increment expanded state</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                    fractionalAtom_-&gt;<a class="code" href="classatom.html#a3cb00c0c5b7533657e05af6ff4a42740">mState</a> = 1;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                    Mcurrent_ = 1;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                    <span class="comment">// add particle into appropriate cell lists</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nSpecies_; ++i) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                        <span class="keywordflow">if</span> (useCellList_[typeIndex][i]) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                            <a class="code" href="classcell_list.html">cellList</a>* cl = cellListsByPairType_[typeIndex][i];</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                            cl-&gt;<a class="code" href="classcell_list.html#a56c0012eed483e47248f9065bfc70fce">insertParticle</a>(&amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][numSpecies[typeIndex]]); <span class="comment">// numSpecies[typeIndex] is the number of fully inserted ones, this partially inserted one comes after that</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                        }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                    }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Mtot_ &gt; 1 &amp;&amp; <span class="keyword">override</span>) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                <span class="comment">// expanded ensemble behavior, but now amidst a &quot;swap move&quot; rather than an actual insertion or deletion.</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                <span class="comment">// for this, insertions involve just putting the atom &quot;back&quot; into the system / cellLists after being artificially completely removed</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                <span class="comment">// ensure we insert at the proper &quot;end&quot;</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                <span class="keywordtype">int</span> end = numSpecies[typeIndex];</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                <span class="keywordflow">if</span> (Mcurrent_ &gt; 0 &amp;&amp; typeIndex == fractionalAtomType_ &amp;&amp; newAtom-&gt;<a class="code" href="classatom.html#a3cb00c0c5b7533657e05af6ff4a42740">mState</a> == 0) {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                    end++; <span class="comment">// insert after the partially inserted one since newAtom is NOT the partial one</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                <a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][end] = (*newAtom);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                <span class="comment">// if we just added a partially inserted/deleted particle back to the system, need to update the pointer</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][end].mState != 0) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                    fractionalAtom_ = &amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][end];</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                    fractionalAtomType_ = typeIndex;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                    <span class="comment">// set the system&#39;s mState back to that of the atom just inserted, iff it was the partial one</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                    Mcurrent_ = <a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][end].mState;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                    totN_++; <span class="comment">// we just added a &quot;full&quot; atom</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                    numSpecies[typeIndex]++; <span class="comment">// we just added a &quot;full&quot; atom</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                <span class="comment">// put newAtom into the cell lists whatever its state</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nSpecies_; ++i) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                    <span class="keywordflow">if</span> (useCellList_[typeIndex][i]) {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                        <a class="code" href="classcell_list.html">cellList</a>* cl = cellListsByPairType_[typeIndex][i];</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                        cl-&gt;<a class="code" href="classcell_list.html#a56c0012eed483e47248f9065bfc70fce">insertParticle</a>(&amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][end]);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                    }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                <span class="comment">// direct insertion (no expanded ensemble)</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                <a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][numSpecies[typeIndex]] = (*newAtom);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                numSpecies[typeIndex]++;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                totN_++;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                <span class="comment">// add particle into appropriate cell lists</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nSpecies_; ++i) {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                    <span class="keywordflow">if</span> (useCellList_[typeIndex][i]) {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                        <a class="code" href="classcell_list.html">cellList</a>* cl = cellListsByPairType_[typeIndex][i];</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                        cl-&gt;<a class="code" href="classcell_list.html#a56c0012eed483e47248f9065bfc70fce">insertParticle</a>(&amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][numSpecies[typeIndex] - 1]);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                    }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Reached upper bound, cannot insert an atom of type index &quot;</span>+std::to_string(typeIndex));</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;That species index does not exist, cannot insert an atom&quot;</span>);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;}</div>
<div class="ttc" id="classsim_system_html_a9eea865e6dc1cff377b1e79c4d9c23f0"><div class="ttname"><a href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">simSystem::numSpecies</a></div><div class="ttdeci">std::vector&lt; int &gt; numSpecies</div><div class="ttdoc">Total number of each type of atom the system contains. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00117">system.h:117</a></div></div>
<div class="ttc" id="classsim_system_html_a90421b19082f7fb8fc23b7264b1161e4"><div class="ttname"><a href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">simSystem::atoms</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; atom &gt; &gt; atoms</div><div class="ttdoc">Atoms in a matrix by type, and particle index, respectively that a system CAN hold but not all are ac...</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00118">system.h:118</a></div></div>
<div class="ttc" id="classcell_list_html_a56c0012eed483e47248f9065bfc70fce"><div class="ttname"><a href="classcell_list.html#a56c0012eed483e47248f9065bfc70fce">cellList::insertParticle</a></div><div class="ttdeci">void insertParticle(atom *)</div><div class="ttdef"><b>Definition:</b> <a href="cell_list_8cpp_source.html#l00093">cellList.cpp:93</a></div></div>
<div class="ttc" id="classcell_list_html"><div class="ttname"><a href="classcell_list.html">cellList</a></div><div class="ttdoc">cellList class. </div><div class="ttdef"><b>Definition:</b> <a href="cell_list_8h_source.html#l00015">cellList.h:15</a></div></div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
<div class="ttc" id="classatom_html_a3cb00c0c5b7533657e05af6ff4a42740"><div class="ttname"><a href="classatom.html#a3cb00c0c5b7533657e05af6ff4a42740">atom::mState</a></div><div class="ttdeci">int mState</div><div class="ttdoc">State of fraction insertion of the atom in the expanded ensemble, 0 = fully inserted. </div><div class="ttdef"><b>Definition:</b> <a href="atom_8h_source.html#l00020">atom.h:20</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7c75052458072e1267bc20594b58d8cd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double simSystem::mass </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the mass of a given species' index. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00089">89</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, and <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>.</p>

</div>
</div>
<a class="anchor" id="a93259b517f449f1ac610d132ac66b551"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int simSystem::maxSpecies </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the absolute maximum number of a given species type allowed in the system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Species index to query</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>maxSpecies Maximum number of them allowed </dd></dl>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l01654">1654</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>Referenced by <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>, and <a class="el" href="system_8cpp_source.html#l00431">simSystem()</a>.</p>
<div class="fragment"><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                                                {</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <span class="keywordflow">if</span> (maxSpecies_.begin() == maxSpecies_.end()) {</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;No species in the system, cannot report a maximum&quot;</span>);</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        }</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;        <span class="keywordflow">if</span> (maxSpecies_.size() &lt;= index) {</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;System does not contain that species, cannot report a maximum&quot;</span>);</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;        } <span class="keywordflow">else</span>  {</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;            <span class="keywordflow">return</span> maxSpecies_[index];</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;        }</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;}</div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afafda4a09ed180ee9c5580d196d8ca9f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int simSystem::minSpecies </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the absolute minimum number of a given species type allowed in the system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">index</td><td>Species index to query</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>minSpecies Minimum number of them allowed </dd></dl>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l01672">1672</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>Referenced by <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, and <a class="el" href="system_8cpp_source.html#l00431">simSystem()</a>.</p>
<div class="fragment"><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;                                                {</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="keywordflow">if</span> (minSpecies_.begin() == minSpecies_.end()) {</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;No species in the system, cannot report a minimum&quot;</span>);</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;        }</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;        <span class="keywordflow">if</span> (minSpecies_.size() &lt;= index) {</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;System does not contain that species, cannot report a minimum&quot;</span>);</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        } <span class="keywordflow">else</span>  {</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;            <span class="keywordflow">return</span> minSpecies_[index];</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;        }</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;}</div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af1e3f5320aff976a448647244d5950d1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double simSystem::mu </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the chemical potential for a given species' index. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00088">88</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>, and <a class="el" href="system_8cpp_source.html#l00431">simSystem()</a>.</p>

</div>
</div>
<a class="anchor" id="ab5e2e9b6204de15520302fe1d51688dd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int simSystem::nSpecies </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the number of different species in the system. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00072">72</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="input_8cpp_source.html#l00010">checkBounds()</a>, <a class="el" href="aggvolbias_8cpp_source.html#l00142">aggVolBias3::make()</a>, <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, <a class="el" href="translate_8cpp_source.html#l00010">translateParticle::make()</a>, <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>, <a class="el" href="swap_8cpp_source.html#l00010">swapParticles::make()</a>, <a class="el" href="sanity_8cpp_source.html#l00008">sanityChecks()</a>, <a class="el" href="input_8cpp_source.html#l00616">setBarriers()</a>, <a class="el" href="input_8cpp_source.html#l00457">setConfig()</a>, <a class="el" href="input_8cpp_source.html#l00236">setMoves()</a>, <a class="el" href="input_8cpp_source.html#l00322">setPairPotentials()</a>, and <a class="el" href="system_8cpp_source.html#l00431">simSystem()</a>.</p>

</div>
</div>
<a class="anchor" id="a40af191fae6091e26413ee06ae188ae9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool simSystem::potentialIsSet </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>spec1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>spec2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Boolean which returns whether or not a pair has had its potential specified by the user yet. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00070">70</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="input_8cpp_source.html#l00010">checkBounds()</a>, and <a class="el" href="system_8cpp_source.html#l01387">readConfig()</a>.</p>

</div>
</div>
<a class="anchor" id="a6ef1ba3e08ec44d865436e272cdebc9b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::printEnergyHistogram </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>fileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>normalize</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print the (normalized by default) energy histogram for each Ntot. </p>
<p>Refines bounds before each print.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>Prefix of the filename to load from </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">normalize</td><td>Whether or not to normalize the histogram (default=true) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l00912">912</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00159">checkpoint::dump()</a>, and <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>.</p>
<div class="fragment"><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                                                                                    {</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    std::ofstream of;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    std::string name = fileName+<span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    of.open(name.c_str(), std::ofstream::out);</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# &lt;P(U)&gt; as a function of N_tot.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# number_of_species: &quot;</span> &lt;&lt; nSpecies_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# species_total_upper_bound: &quot;</span> &lt;&lt; totNBounds_[1] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# species_total_lower_bound: &quot;</span> &lt;&lt; totNBounds_[0] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="keywordtype">double</span> V = box_[0]*box_[1]*box_[2];</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# volume: &quot;</span> &lt;&lt; std::setprecision(15) &lt;&lt; V &lt;&lt; std::endl;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# Bin widths for each&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="keywordflow">for</span> (std::vector &lt; dynamic_one_dim_histogram &gt;::iterator it = energyHistogram_.begin(); it != energyHistogram_.end(); ++it) {</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        of &lt;&lt; it-&gt;get_delta() &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    }</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    of &lt;&lt; std::endl;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# Bin lower bound for each&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="keywordflow">for</span> (std::vector &lt; dynamic_one_dim_histogram &gt;::iterator it = energyHistogram_.begin(); it != energyHistogram_.end(); ++it) {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        of &lt;&lt; it-&gt;get_lb() &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    }</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    of &lt;&lt; std::endl;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# Bin upper bound for each&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="keywordflow">for</span> (std::vector &lt; dynamic_one_dim_histogram &gt;::iterator it = energyHistogram_.begin(); it != energyHistogram_.end(); ++it) {</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        of &lt;&lt; it-&gt;get_ub() &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    }</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    of &lt;&lt; std::endl;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="keywordflow">if</span> (normalize) {</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        of &lt;&lt; <span class="stringliteral">&quot;# Normalized histogram for each&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        <span class="keywordflow">for</span> (std::vector &lt; dynamic_one_dim_histogram &gt;::iterator it = energyHistogram_.begin(); it != energyHistogram_.end(); ++it) {</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            std::deque &lt;double&gt; h = it-&gt;get_hist();</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            <span class="keywordtype">double</span> sum = 0.0;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            <span class="keywordflow">for</span> (std::deque &lt;double&gt;::iterator it2 = h.begin(); it2 != h.end(); ++it2) {</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                sum += *it2;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;            }</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            <span class="keywordflow">for</span> (std::deque &lt;double&gt;::iterator it2 = h.begin(); it2 != h.end(); ++it2) {</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                of &lt;&lt; std::setprecision(15) &lt;&lt; *it2/sum &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;            }</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            of &lt;&lt; std::endl;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        }</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        of &lt;&lt; <span class="stringliteral">&quot;# Unnormalized histogram for each&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        <span class="keywordflow">for</span> (std::vector &lt; dynamic_one_dim_histogram &gt;::iterator it = energyHistogram_.begin(); it != energyHistogram_.end(); ++it) {</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;            std::deque &lt;double&gt; h = it-&gt;get_hist();</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;            <span class="keywordflow">for</span> (std::deque &lt;double&gt;::iterator it2 = h.begin(); it2 != h.end(); ++it2) {</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                of &lt;&lt; std::setprecision(15) &lt;&lt; *it2 &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            }</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;            of &lt;&lt; std::endl;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        }</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    }</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    of.close();</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2818b2f0ff79782d5443ca0f191564f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::printExtMoments </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>fileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>normalize</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print the (normalized by default) extensive energy histogram for each Ntot. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>Name of the file to print to </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">normalize</td><td>Whether or not to normalize the histogram (default=true) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l00658">658</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>References <a class="el" href="histogram_8cpp_source.html#l00298">histogram::getAddress()</a>, <a class="el" href="histogram_8h_source.html#l00027">histogram::getCounter()</a>, and <a class="el" href="histogram_8h_source.html#l00026">histogram::getRawHistogram()</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00159">checkpoint::dump()</a>, and <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>.</p>
<div class="fragment"><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                                                                               {</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    std::ofstream of;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    std::string name = fileName+<span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    of.open(name.c_str(), std::ofstream::out);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# &lt;N_i^j*N_k^m*U^p&gt; as a function of N_tot.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# number_of_species: &quot;</span> &lt;&lt; nSpecies_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# max_order: &quot;</span> &lt;&lt; max_order_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# species_total_upper_bound: &quot;</span> &lt;&lt; totNBounds_[1] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# species_total_lower_bound: &quot;</span> &lt;&lt; totNBounds_[0] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keywordtype">double</span> V = box_[0]*box_[1]*box_[2];</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# volume: &quot;</span> &lt;&lt; std::setprecision(15) &lt;&lt; V &lt;&lt; std::endl;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;#\tN_tot\t&quot;</span>;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nSpecies_; ++i) {</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt;= max_order_; ++j) {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; nSpecies_; ++k) {</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m = 0; m &lt;= max_order_; ++m) {</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> p = 0; p &lt;= max_order_; ++p) {</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                        of &lt;&lt; <span class="stringliteral">&quot;N_&quot;</span>+std::to_string(i+1)+<span class="stringliteral">&quot;^&quot;</span>+std::to_string(j)+<span class="stringliteral">&quot;*N_&quot;</span>+std::to_string(k+1)+<span class="stringliteral">&quot;^&quot;</span>+std::to_string(m)+<span class="stringliteral">&quot;*U^&quot;</span>+std::to_string(p)+<span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                    }</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                }</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            }</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        }</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    of &lt;&lt; std::endl;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    std::vector &lt;double&gt; h = extensive_moments_.<a class="code" href="classhistogram.html#a3a75adbce72057f3a4db805d9efc3c9c">getRawHistogram</a> ();</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    std::vector &lt;double&gt; ctr = extensive_moments_.<a class="code" href="classhistogram.html#a8417c827c4653055b370786916c901cf">getCounter</a> ();</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    std::vector &lt;double&gt; coords (6,0);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idx = 0;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordflow">if</span> (normalize) {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n &lt; totNBounds_[1]-totNBounds_[0]+1; ++n) {</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            of &lt;&lt; n+totNBounds_[0] &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            coords[5] = n;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nSpecies_; ++i) {</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                coords[0] = i;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt;= max_order_; ++j) {</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                    coords[1] = j;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; nSpecies_; ++k) {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                        coords[2] = k;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m = 0; m &lt;= max_order_; ++m) {</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                            coords[3] = m;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> p = 0; p &lt;= max_order_; ++p) {</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                                coords[4] = p;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                                idx = extensive_moments_.<a class="code" href="classhistogram.html#ae52fa58934b56e05846a66e43c3184bd">getAddress</a>(coords);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                                of &lt;&lt; std::setprecision(15) &lt;&lt; h[idx]/ctr[idx] &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                            }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                        }</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                    }</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                }</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            }</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            of &lt;&lt; std::endl;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        }</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n &lt; totNBounds_[1]-totNBounds_[0]+1; ++n) {</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            of &lt;&lt; n+totNBounds_[0] &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            coords[5] = n;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nSpecies_; ++i) {</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                coords[0] = i;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt;= max_order_; ++j) {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                    coords[1] = j;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; nSpecies_; ++k) {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                        coords[2] = k;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m = 0; m &lt;= max_order_; ++m) {</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                            coords[3] = m;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> p = 0; p &lt;= max_order_; ++p) {</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                                coords[4] = p;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                                idx = extensive_moments_.<a class="code" href="classhistogram.html#ae52fa58934b56e05846a66e43c3184bd">getAddress</a>(coords);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                                of &lt;&lt; std::setprecision(15) &lt;&lt; h[idx] &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                            }</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                        }</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                    }</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                }</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            }</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            of &lt;&lt; std::endl;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        }</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    }</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    of.close();</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;}</div>
<div class="ttc" id="classhistogram_html_ae52fa58934b56e05846a66e43c3184bd"><div class="ttname"><a href="classhistogram.html#ae52fa58934b56e05846a66e43c3184bd">histogram::getAddress</a></div><div class="ttdeci">const long long unsigned int getAddress(const std::vector&lt; double &gt; &amp;coords)</div><div class="ttdoc">Get the linear address of the multidimensional coordinate. </div><div class="ttdef"><b>Definition:</b> <a href="histogram_8cpp_source.html#l00298">histogram.cpp:298</a></div></div>
<div class="ttc" id="classhistogram_html_a8417c827c4653055b370786916c901cf"><div class="ttname"><a href="classhistogram.html#a8417c827c4653055b370786916c901cf">histogram::getCounter</a></div><div class="ttdeci">std::vector&lt; double &gt; getCounter()</div><div class="ttdoc">Return the current histogram counter. </div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00027">histogram.h:27</a></div></div>
<div class="ttc" id="classhistogram_html_a3a75adbce72057f3a4db805d9efc3c9c"><div class="ttname"><a href="classhistogram.html#a3a75adbce72057f3a4db805d9efc3c9c">histogram::getRawHistogram</a></div><div class="ttdeci">std::vector&lt; double &gt; getRawHistogram()</div><div class="ttdoc">Return the current histogram. </div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00026">histogram.h:26</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac29bdd6f7fa6f9526b7eafcf658d70d8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::printPkHistogram </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>fileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>normalize</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print the (normalized by default) particle number histogram for each Ntot. </p>
<p>Refines histograms before each print.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>Prefix of filename to print to </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">normalize</td><td>Whether or not to normalize the histogram (default=true) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l01078">1078</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00159">checkpoint::dump()</a>, and <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>.</p>
<div class="fragment"><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                                                                                {</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nSpecies_; ++i) {</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        std::ofstream of;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        std::string name = fileName+<span class="stringliteral">&quot;_&quot;</span>+std::to_string(i+1)+<span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        of.open(name.c_str(), std::ofstream::out);</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        of &lt;&lt; <span class="stringliteral">&quot;# &lt;P(N_&quot;</span> &lt;&lt; i+1 &lt;&lt; <span class="stringliteral">&quot;)&gt; as a function of N_tot.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        of &lt;&lt; <span class="stringliteral">&quot;# number_of_species: &quot;</span> &lt;&lt; nSpecies_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        of &lt;&lt; <span class="stringliteral">&quot;# species_total_upper_bound: &quot;</span> &lt;&lt; totNBounds_[1] &lt;&lt; std::endl;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        of &lt;&lt; <span class="stringliteral">&quot;# species_total_lower_bound: &quot;</span> &lt;&lt; totNBounds_[0] &lt;&lt; std::endl;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        <span class="keywordtype">double</span> V = box_[0]*box_[1]*box_[2];</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        of &lt;&lt; <span class="stringliteral">&quot;# volume: &quot;</span> &lt;&lt; std::setprecision(15) &lt;&lt; V &lt;&lt; std::endl;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        of &lt;&lt; <span class="stringliteral">&quot;# Bin widths for each species index &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        <span class="keywordflow">for</span> (std::vector &lt; dynamic_one_dim_histogram &gt;::iterator it = pkHistogram_[i].begin(); it != pkHistogram_[i].end(); ++it) {</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            of &lt;&lt; it-&gt;get_delta() &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        }</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        of &lt;&lt; std::endl;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        of &lt;&lt; <span class="stringliteral">&quot;# Bin lower bound for each species index &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        <span class="keywordflow">for</span> (std::vector &lt; dynamic_one_dim_histogram &gt;::iterator it = pkHistogram_[i].begin(); it != pkHistogram_[i].end(); ++it) {</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            of &lt;&lt; it-&gt;get_lb() &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        }</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        of &lt;&lt; std::endl;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        of &lt;&lt; <span class="stringliteral">&quot;# Bin upper bound for each species index &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        <span class="keywordflow">for</span> (std::vector &lt; dynamic_one_dim_histogram &gt;::iterator it = pkHistogram_[i].begin(); it != pkHistogram_[i].end(); ++it) {</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            of &lt;&lt; it-&gt;get_ub() &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        }</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        of &lt;&lt; std::endl;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        <span class="keywordflow">if</span> (normalize) {</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;            of &lt;&lt; <span class="stringliteral">&quot;# Normalized histogram for each species index &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            <span class="keywordflow">for</span> (std::vector &lt; dynamic_one_dim_histogram &gt;::iterator it = pkHistogram_[i].begin(); it != pkHistogram_[i].end(); ++it) {</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                std::deque &lt;double&gt; h = it-&gt;get_hist();</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                <span class="keywordtype">double</span> sum = 0.0;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                <span class="keywordflow">for</span> (std::deque &lt;double&gt;::iterator it2 = h.begin(); it2 != h.end(); ++it2) {</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                    sum += *it2;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                }</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                <span class="keywordflow">for</span> (std::deque &lt;double&gt;::iterator it2 = h.begin(); it2 != h.end(); ++it2) {</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                    of &lt;&lt; std::setprecision(15) &lt;&lt; *it2/sum &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                }</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                of &lt;&lt; std::endl;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;            }</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            of &lt;&lt; <span class="stringliteral">&quot;# Unnormalized histogram for each species index &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;            <span class="keywordflow">for</span> (std::vector &lt; dynamic_one_dim_histogram &gt;::iterator it = pkHistogram_[i].begin(); it != pkHistogram_[i].end(); ++it) {</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                std::deque &lt;double&gt; h = it-&gt;get_hist();</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                <span class="keywordflow">for</span> (std::deque &lt;double&gt;::iterator it2 = h.begin(); it2 != h.end(); ++it2) {</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                    of &lt;&lt; std::setprecision(15) &lt;&lt; *it2 &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                }</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                of &lt;&lt; std::endl;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            }</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        }</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        of.close();</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    }</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae3096dc65acdf38cc824e507cca33370"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::printSnapshot </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>comment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>overwrite</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print an XYZ file of the instantaneous system configuration. </p>
<p>This can be read in at a later time via estart() function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>File to store XYZ coordinates to </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">comment</td><td>Comment line for the file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">overwrite</td><td>Flag to overwrite file if it already exists or to append (default = true, overwrite) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l01331">1331</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>References <a class="el" href="system_8h_source.html#l00118">atoms</a>, and <a class="el" href="system_8h_source.html#l00117">numSpecies</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00159">checkpoint::dump()</a>, <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>, and <a class="el" href="input_8cpp_source.html#l00457">setConfig()</a>.</p>
<div class="fragment"><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                                                                                    {</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <span class="keywordflow">if</span> (overwrite) {</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        std::ofstream outfile (filename.c_str(), std::ofstream::trunc);</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        <span class="keywordtype">int</span> tot = 0;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; nSpecies_; ++j) {</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            tot += <a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[j]; <span class="comment">// only count fully inserted species</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        }</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        outfile &lt;&lt; tot &lt;&lt; std::endl;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;        outfile &lt;&lt; comment &lt;&lt; std::endl;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; nSpecies_; ++j) {</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;            <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> num = <a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[j];</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;            <span class="keywordflow">if</span> (Mcurrent_ &gt; 1 &amp;&amp; fractionalAtomType_ == j) {</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                num += 1; <span class="comment">// account for partially inserted atom</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;            }</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; num; ++i) {</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[j][i].mState == 0) { <span class="comment">// only print fully inserted atoms</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                    outfile &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt;  std::setprecision(15) &lt;&lt; <a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[j][i].pos[0] &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; std::setprecision(15) &lt;&lt; <a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[j][i].pos[1] &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; std::setprecision(15) &lt;&lt; <a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[j][i].pos[2] &lt;&lt; std::endl;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                }</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;            }</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        }</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;        outfile.close();</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;        std::ofstream outfile (filename.c_str(), std::ofstream::out | std::ofstream::app);</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;        <span class="keywordtype">int</span> tot = 0;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; nSpecies_; ++j) {</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;            tot += <a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[j]; <span class="comment">// only count fully inserted species</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;        }</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        outfile &lt;&lt; tot &lt;&lt; std::endl;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;        outfile &lt;&lt; comment &lt;&lt; std::endl;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; nSpecies_; ++j) {</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;            <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> num = <a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[j];</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;            <span class="keywordflow">if</span> (Mcurrent_ &gt; 1 &amp;&amp; fractionalAtomType_ == j) {</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                num += 1; <span class="comment">// account for partially inserted atom</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;            }</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; num; ++i) {</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[j][i].mState == 0) { <span class="comment">// only print fully inserted atoms</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                    outfile &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt;  std::setprecision(15) &lt;&lt; <a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[j][i].pos[0] &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; std::setprecision(15) &lt;&lt; <a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[j][i].pos[1] &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; std::setprecision(15) &lt;&lt; <a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[j][i].pos[2] &lt;&lt; std::endl;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                }</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;            }</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        }</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        outfile.close();</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    }</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;}</div>
<div class="ttc" id="classsim_system_html_a9eea865e6dc1cff377b1e79c4d9c23f0"><div class="ttname"><a href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">simSystem::numSpecies</a></div><div class="ttdeci">std::vector&lt; int &gt; numSpecies</div><div class="ttdoc">Total number of each type of atom the system contains. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00117">system.h:117</a></div></div>
<div class="ttc" id="classsim_system_html_a90421b19082f7fb8fc23b7264b1161e4"><div class="ttname"><a href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">simSystem::atoms</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; atom &gt; &gt; atoms</div><div class="ttdoc">Atoms in a matrix by type, and particle index, respectively that a system CAN hold but not all are ac...</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00118">system.h:118</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3161d95bbb800d5d95a732ac5fc32b95"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::readConfig </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>filename</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read an XYZ file as the system's initial configuration. </p>
<p>Note that the number of species, etc. must already be specified in the constructor. Will also reset and calculate the energy from scratch so these potentials should be set before reading in a restart file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>File to read XYZ coordinates from </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l01387">1387</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>References <a class="el" href="system_8cpp_source.html#l00241">deleteAtom()</a>, <a class="el" href="system_8cpp_source.html#l00140">insertAtom()</a>, <a class="el" href="system_8h_source.html#l00117">numSpecies</a>, <a class="el" href="system_8h_source.html#l00070">potentialIsSet()</a>, <a class="el" href="system_8cpp_source.html#l01545">scratchEnergy()</a>, <a class="el" href="utilities_8cpp_source.html#l00035">sendErr()</a>, <a class="el" href="utilities_8cpp_source.html#l00026">sendMsg()</a>, <a class="el" href="global_8h_source.html#l00158">SYS_FAILURE</a>, and <a class="el" href="global_8h_source.html#l00170">customException::what()</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00054">checkpoint::load()</a>, and <a class="el" href="input_8cpp_source.html#l00457">setConfig()</a>.</p>
<div class="fragment"><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                                              {</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <a class="code" href="utilities_8cpp.html#a08974c73a5b36c28b8ad1ef47fca77b0">sendMsg</a>(<span class="stringliteral">&quot;Reading initial configuration from &quot;</span>+filename);</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    std::ifstream infile (filename.c_str());</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <span class="keywordflow">if</span> (!infile.is_open()) {</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;        <a class="code" href="utilities_8cpp.html#a6dacf3c3c19aa1e13a4d5a148fe5114e">sendErr</a>(<span class="stringliteral">&quot;Cannot open &quot;</span>+filename);</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        exit(<a class="code" href="global_8h.html#a428dfe1ef0a6ff4b1fdebf275f6aff2e">SYS_FAILURE</a>);</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    }</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    std::string line;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    std::vector &lt; atom &gt; sysatoms;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    std::vector &lt; int &gt; index;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="keywordtype">int</span> natoms = 0;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    <span class="keywordtype">int</span> lineIndex = 0;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="keywordflow">while</span>(std::getline(infile,line)) {</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;        std::stringstream lineStream(line);</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;        <span class="keywordflow">if</span> (lineIndex == 0) {</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;            lineStream &gt;&gt; natoms;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;            index.resize(natoms);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;            sysatoms.resize(natoms);</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lineIndex &gt; 1) {</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;            lineStream &gt;&gt; index[lineIndex-2] &gt;&gt; sysatoms[lineIndex-2].pos[0] &gt;&gt; sysatoms[lineIndex-2].pos[1] &gt;&gt; sysatoms[lineIndex-2].pos[2];</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;        }</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;        lineIndex++;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    }</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    infile.close();</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <span class="comment">// check if within global bounds</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="keywordflow">if</span> (sysatoms.size() &gt; totNBounds_[1] || sysatoms.size() &lt; totNBounds_[0]) {</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Number of particles (&quot;</span>+std::to_string(sysatoms.size())+<span class="stringliteral">&quot;) in the restart file out of target range [&quot;</span>+std::to_string(totNBounds_[0])+<span class="stringliteral">&quot;, &quot;</span>+std::to_string(totNBounds_[1])+<span class="stringliteral">&quot;]&quot;</span>);</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    }</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    <span class="comment">// sort by type</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    std::map &lt; int, int &gt; types;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; natoms; ++j) {</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        <span class="keywordflow">if</span> (types.find(index[j]) != types.end()) {</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;            types[index[j]] += 1;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;            types[index[j]] = 1;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        }</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    }</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    <span class="keywordtype">int</span> maxType = -1;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="keywordflow">for</span> (std::map &lt; int, int &gt;::iterator it = types.begin(); it != types.end(); ++it) {</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        maxType = std::max(maxType, it-&gt;first);</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        <span class="keywordflow">if</span> (it-&gt;first &lt; 0 || it-&gt;first &gt;= nSpecies_) {</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Restart file corrupted, types out of range&quot;</span>);</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        }</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    }</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <span class="comment">// check that pair potentials exist so energy can be calculated</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nSpecies_; ++i) {</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; nSpecies_; ++j) {</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classsim_system.html#a40af191fae6091e26413ee06ae188ae9">potentialIsSet</a>(i, j)) {</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a>(<span class="stringliteral">&quot;Not all pair potentials are set, so cannot initial from file&quot;</span>);</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;            }</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        }</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    }</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <span class="comment">// empty out the system before adding new atoms in - all atoms &quot;fully inserted&quot; so no partial ones to worry about</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="keywordflow">if</span> (Mcurrent_ != 0) {</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;System cannot be restarted from &quot;</span>+filename+<span class="stringliteral">&quot;, for some reason current expanded state != 0&quot;</span>);</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    }</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nSpecies_; ++i) {</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> ns = <a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[i];</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = ns-1; j &gt;=0; --j) {</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; Mtot_; ++k) {</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                <a class="code" href="classsim_system.html#acabf4fc5b5b90bba62e1449ddb3646c6">deleteAtom</a> (i, j, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;            }</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;        }</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    }</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <span class="keywordflow">if</span> (totN_ != 0) {</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;total N = &quot;</span>+std::to_string(totN_)+<span class="stringliteral">&quot; != 0 after system supposedly emptied&quot;</span>);</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    }</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nSpecies_; ++i) {</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[i] != 0) {</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Number of molecules of species #&quot;</span>+std::to_string(i+1)+<span class="stringliteral">&quot; = &quot;</span>+std::to_string(<a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[i])+<span class="stringliteral">&quot; != 0 after system supposedly emptied&quot;</span>);</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        }</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    }</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <span class="keywordflow">if</span> (Mcurrent_ != 0) {</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;M state != 0 after system supposedly emptied&quot;</span>);</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    }</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    energy_ = 0.0;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; sysatoms.size(); ++j) {</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;            <span class="comment">// &quot;partially&quot; insert each atom so it goes through all the stages</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;            <a class="code" href="classsim_system.html#a0404e9435cc046d19b6bb990678ee069">insertAtom</a> (index[j], &amp;sysatoms[j]);</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 1; k &lt; Mtot_; ++k) {</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                <a class="code" href="classsim_system.html#a0404e9435cc046d19b6bb990678ee069">insertAtom</a> (index[j], fractionalAtom_); <span class="comment">// this will check that within each species own max and min, global bounds handled above</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;            }</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        } <span class="keywordflow">catch</span> (<a class="code" href="classcustom_exception.html">customException</a> &amp;ce) {</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;            std::string a = <span class="stringliteral">&quot;Could not initialize system from restart file, &quot;</span>, b = ce.<a class="code" href="classcustom_exception.html#aeb6ab5848b038adfc68fde86a512f691">what</a>();</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (a+b);</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;        }</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    }</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="comment">// recalculate system&#39;s initial energy</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    energy_ = <a class="code" href="classsim_system.html#a51539ed4c3bb4905b32ce428c1c537fe">scratchEnergy</a>();</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    <a class="code" href="utilities_8cpp.html#a08974c73a5b36c28b8ad1ef47fca77b0">sendMsg</a>(<span class="stringliteral">&quot;Successfully loaded initial configuration from &quot;</span>+filename);</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;}</div>
<div class="ttc" id="classcustom_exception_html_aeb6ab5848b038adfc68fde86a512f691"><div class="ttname"><a href="classcustom_exception.html#aeb6ab5848b038adfc68fde86a512f691">customException::what</a></div><div class="ttdeci">const char * what() const </div><div class="ttdoc">Return the user&#39;s message. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00170">global.h:170</a></div></div>
<div class="ttc" id="global_8h_html_a428dfe1ef0a6ff4b1fdebf275f6aff2e"><div class="ttname"><a href="global_8h.html#a428dfe1ef0a6ff4b1fdebf275f6aff2e">SYS_FAILURE</a></div><div class="ttdeci">#define SYS_FAILURE</div><div class="ttdoc">Returned from main the simualtion encountered a major error. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00158">global.h:158</a></div></div>
<div class="ttc" id="classsim_system_html_a9eea865e6dc1cff377b1e79c4d9c23f0"><div class="ttname"><a href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">simSystem::numSpecies</a></div><div class="ttdeci">std::vector&lt; int &gt; numSpecies</div><div class="ttdoc">Total number of each type of atom the system contains. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00117">system.h:117</a></div></div>
<div class="ttc" id="classsim_system_html_a0404e9435cc046d19b6bb990678ee069"><div class="ttname"><a href="classsim_system.html#a0404e9435cc046d19b6bb990678ee069">simSystem::insertAtom</a></div><div class="ttdeci">void insertAtom(const int typeIndex, atom *newAtom, bool override=false)</div><div class="ttdoc">Insert an atom into the system. </div><div class="ttdef"><b>Definition:</b> <a href="system_8cpp_source.html#l00140">system.cpp:140</a></div></div>
<div class="ttc" id="classsim_system_html_a51539ed4c3bb4905b32ce428c1c537fe"><div class="ttname"><a href="classsim_system.html#a51539ed4c3bb4905b32ce428c1c537fe">simSystem::scratchEnergy</a></div><div class="ttdeci">const double scratchEnergy()</div><div class="ttdoc">Recalculate the energy of the system from scratch. </div><div class="ttdef"><b>Definition:</b> <a href="system_8cpp_source.html#l01545">system.cpp:1545</a></div></div>
<div class="ttc" id="utilities_8cpp_html_a6dacf3c3c19aa1e13a4d5a148fe5114e"><div class="ttname"><a href="utilities_8cpp.html#a6dacf3c3c19aa1e13a4d5a148fe5114e">sendErr</a></div><div class="ttdeci">void sendErr(const std::string msg)</div><div class="ttdoc">Send a message to std::cerr. </div><div class="ttdef"><b>Definition:</b> <a href="utilities_8cpp_source.html#l00035">utilities.cpp:35</a></div></div>
<div class="ttc" id="classsim_system_html_a40af191fae6091e26413ee06ae188ae9"><div class="ttname"><a href="classsim_system.html#a40af191fae6091e26413ee06ae188ae9">simSystem::potentialIsSet</a></div><div class="ttdeci">bool potentialIsSet(const int spec1, const int spec2)</div><div class="ttdoc">Boolean which returns whether or not a pair has had its potential specified by the user yet...</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00070">system.h:70</a></div></div>
<div class="ttc" id="classsim_system_html_acabf4fc5b5b90bba62e1449ddb3646c6"><div class="ttname"><a href="classsim_system.html#acabf4fc5b5b90bba62e1449ddb3646c6">simSystem::deleteAtom</a></div><div class="ttdeci">void deleteAtom(const int typeIndex, const int atomIndex, bool override=false)</div><div class="ttdoc">Delete an atom from the system. </div><div class="ttdef"><b>Definition:</b> <a href="system_8cpp_source.html#l00241">system.cpp:241</a></div></div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
<div class="ttc" id="utilities_8cpp_html_a08974c73a5b36c28b8ad1ef47fca77b0"><div class="ttname"><a href="utilities_8cpp.html#a08974c73a5b36c28b8ad1ef47fca77b0">sendMsg</a></div><div class="ttdeci">void sendMsg(const std::string msg)</div><div class="ttdoc">Send a message to std::cout. </div><div class="ttdef"><b>Definition:</b> <a href="utilities_8cpp_source.html#l00026">utilities.cpp:26</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa0eae4d523b5649be273e0419e9f799f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::recordEnergyHistogram </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Record the energy histogram for the system at a given Ntot. </p>
<p>Only records values when N_tot in range of [min, max]. </p>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l00843">843</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>Referenced by <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>.</p>
<div class="fragment"><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                                       {</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="comment">// only record if in range (removes equilibration stage to get in this range, if there was any)</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="keywordflow">if</span> (totN_ &gt;= totNBounds_[0] &amp;&amp; totN_ &lt;= totNBounds_[1]) {</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> address = totN_-totNBounds_[0];</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        energyHistogram_[address].record(energy_);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    }</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a74ce0ab8151fd0501abf853a16cc8e58"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::recordExtMoments </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Record the extensive moment at a given Ntot. </p>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l00626">626</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>References <a class="el" href="histogram_8cpp_source.html#l00267">histogram::increment()</a>, and <a class="el" href="system_8h_source.html#l00117">numSpecies</a>.</p>

<p>Referenced by <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>.</p>
<div class="fragment"><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                                  {</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="comment">// only record if in range (removes equilibration stage to get in this range, if there was any)</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordflow">if</span> (totN_ &gt;= totNBounds_[0] &amp;&amp; totN_ &lt;= totNBounds_[1]) {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <span class="keywordtype">double</span> val = 0.0;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        std::vector &lt; double &gt; coords (6,0);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        coords[5] = totN_-totNBounds_[0];</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nSpecies_; ++i) {</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            coords[0] = i;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt;= max_order_; ++j) {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                coords[1] = j;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; nSpecies_; ++k) {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                    coords[2] = k;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m = 0; m &lt;= max_order_; ++m) {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                        coords[3] = m;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> p = 0; p &lt;= max_order_; ++p) {</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                            coords[4] = p;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                            val = pow(<a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[i], j)*pow(<a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[k], m)*pow(energy_, p);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                            extensive_moments_.<a class="code" href="classhistogram.html#a665e7f6c052d4b306c6fe7d0c600f1c8">increment</a> (coords, val);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                        }</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                    }</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                }</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            }</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        }</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;}</div>
<div class="ttc" id="classsim_system_html_a9eea865e6dc1cff377b1e79c4d9c23f0"><div class="ttname"><a href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">simSystem::numSpecies</a></div><div class="ttdeci">std::vector&lt; int &gt; numSpecies</div><div class="ttdoc">Total number of each type of atom the system contains. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00117">system.h:117</a></div></div>
<div class="ttc" id="classhistogram_html_a665e7f6c052d4b306c6fe7d0c600f1c8"><div class="ttname"><a href="classhistogram.html#a665e7f6c052d4b306c6fe7d0c600f1c8">histogram::increment</a></div><div class="ttdeci">void increment(const long long unsigned int address, const double val)</div><div class="ttdoc">Increment the histogram by a given value at a given address. </div><div class="ttdef"><b>Definition:</b> <a href="histogram_8cpp_source.html#l00267">histogram.cpp:267</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a71bbc9d8bdbb5042e4fa817c3e71fe53"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::recordPkHistogram </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Record the particle number histogram for the system at a given Ntot. </p>
<p>Only records values when N_tot in range of [min, max]. </p>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l01047">1047</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>References <a class="el" href="system_8h_source.html#l00117">numSpecies</a>.</p>

<p>Referenced by <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>.</p>
<div class="fragment"><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                                   {</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="comment">// only record if in range (removes equilibration stage to get in this range, if there was any)</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="keywordflow">if</span> (totN_ &gt;= totNBounds_[0] &amp;&amp; totN_ &lt;= totNBounds_[1]) {</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> address = totN_-totNBounds_[0];</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nSpecies_; ++i) {</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;            pkHistogram_[i][address].record(<a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[i]);</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        }</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    }</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;}</div>
<div class="ttc" id="classsim_system_html_a9eea865e6dc1cff377b1e79c4d9c23f0"><div class="ttname"><a href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">simSystem::numSpecies</a></div><div class="ttdeci">std::vector&lt; int &gt; numSpecies</div><div class="ttdoc">Total number of each type of atom the system contains. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00117">system.h:117</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afe05cba714a032b445cfb1a529547833"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::refineEnergyHistogramBounds </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check the histogram entries and trim off zero-valued entries and bounds. </p>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l00865">865</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>References <a class="el" href="global_8h_source.html#l00170">customException::what()</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00159">checkpoint::dump()</a>, and <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>.</p>
<div class="fragment"><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                                             {</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keywordflow">for</span> (std::vector &lt; dynamic_one_dim_histogram &gt;::iterator it = energyHistogram_.begin(); it != energyHistogram_.end(); ++it) {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            it-&gt;trim_edges();</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        } <span class="keywordflow">catch</span> (<a class="code" href="classcustom_exception.html">customException</a> &amp;ce) {</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            std::string a = <span class="stringliteral">&quot;Unable to trim edges in energyHistogram at each Ntot: &quot;</span>, b = ce.<a class="code" href="classcustom_exception.html#aeb6ab5848b038adfc68fde86a512f691">what</a>();</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (a+b);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        }</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    }</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;}</div>
<div class="ttc" id="classcustom_exception_html_aeb6ab5848b038adfc68fde86a512f691"><div class="ttname"><a href="classcustom_exception.html#aeb6ab5848b038adfc68fde86a512f691">customException::what</a></div><div class="ttdeci">const char * what() const </div><div class="ttdoc">Return the user&#39;s message. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00170">global.h:170</a></div></div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1e462fcb63389d59419ff6135b2d802e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::refinePkHistogramBounds </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check the histogram entries and trim off zero-valued entries and bounds. </p>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l01060">1060</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00159">checkpoint::dump()</a>, and <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>.</p>
<div class="fragment"><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                                         {</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keywordflow">for</span> (std::vector &lt; std::vector &lt; dynamic_one_dim_histogram &gt; &gt;::iterator it = pkHistogram_.begin(); it != pkHistogram_.end(); ++it) {</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <span class="keywordflow">for</span> (std::vector &lt; dynamic_one_dim_histogram &gt;::iterator it2 = it-&gt;begin(); it2 != it-&gt;end(); ++it2) {</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                it2-&gt;trim_edges();</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            } <span class="keywordflow">catch</span> (<a class="code" href="classcustom_exception.html">customException</a> &amp;ce) {</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Unable to trim edges in pkHistogram at each Ntot&quot;</span>);</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;            }</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        }</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    }</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;}</div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a861dd81718ef1c069fa7cfb9b7efe83c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::reInitializeEnergyHistogram </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Re-initialize the energy histogram with internal estimates of bounds. </p>
<p>Intended to be used at crossover stage before TMMC. </p>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l00879">879</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>References <a class="el" href="system_8h_source.html#l00075">totNMax()</a>, and <a class="el" href="system_8h_source.html#l00076">totNMin()</a>.</p>

<p>Referenced by <a class="el" href="crossover_8cpp_source.html#l00010">performCrossover()</a>.</p>
<div class="fragment"><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                                             {</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordtype">double</span> lb = 0.0, ub = 0.0;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="keywordflow">if</span> (energyHistogram_lb_.size() != energyHistogram_ub_.size()) {</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Bad energy histogram bound sizes&quot;</span>);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    }</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="keywordflow">if</span> (energyHistogram_lb_.size() != <a class="code" href="classsim_system.html#aee2c65ecb43a35c0c4d070cdb45f7dc0">totNMax</a>() - <a class="code" href="classsim_system.html#af10842e0eaa638373b8717c87b47e6bc">totNMin</a>() + 1) {</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Bad energy histogram bound sizes&quot;</span>);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    }</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classsim_system.html#aee2c65ecb43a35c0c4d070cdb45f7dc0">totNMax</a>() - <a class="code" href="classsim_system.html#af10842e0eaa638373b8717c87b47e6bc">totNMin</a>() + 1; ++i) {</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <span class="keywordflow">if</span> (energyHistogram_lb_[i] &gt; energyHistogram_ub_[i]) {</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Bad energy histogram bound sizes&quot;</span>);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        }</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <span class="comment">// &quot;Standardize&quot; the bounds against U = 0 for to &quot;align&quot; the bins, already done for pkHistogram.</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        <span class="comment">// This allows overlapping windows to be merged, otherwise they are not &quot;aligned&quot;.</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        <span class="comment">// Rounding does not account for rare edge cases where energy falls exactly on the border between bins, but does not matter since this will be automatically handled.</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="comment">// This is just to give the system a good &quot;guess&quot; to conserve memory.</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        lb = round((energyHistogram_lb_[i] - 0.0)/energyHistDelta_)*energyHistDelta_;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        ub = round((energyHistogram_ub_[i] - 0.0)/energyHistDelta_)*energyHistDelta_;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            energyHistogram_[i].reinitialize(lb,ub,energyHistDelta_);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        } <span class="keywordflow">catch</span> (<a class="code" href="classcustom_exception.html">customException</a> &amp;ce) {</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Unable to reinitialize the energyHistogram&quot;</span>);</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        }</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    }</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;}</div>
<div class="ttc" id="classsim_system_html_af10842e0eaa638373b8717c87b47e6bc"><div class="ttname"><a href="classsim_system.html#af10842e0eaa638373b8717c87b47e6bc">simSystem::totNMin</a></div><div class="ttdeci">const int totNMin()</div><div class="ttdoc">Return lower bound on the total number of atoms in the system. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00076">system.h:76</a></div></div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
<div class="ttc" id="classsim_system_html_aee2c65ecb43a35c0c4d070cdb45f7dc0"><div class="ttname"><a href="classsim_system.html#aee2c65ecb43a35c0c4d070cdb45f7dc0">simSystem::totNMax</a></div><div class="ttdeci">const int totNMax()</div><div class="ttdoc">Return upper bound on the total number of atoms in the system. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00075">system.h:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae073008ed44e551f0d008b2f5a0fc06f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::restartEnergyHistogram </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>prefix</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Restart the energy histogram for each Ntot from unnormalized checkpoint. </p>
<p>This will check for "alignment" of energy bins to 0. So "manually" prepared files are likely to fail, but this is intended to restart from system-generated files anyway.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">prefix</td><td>Prefix of the filename to load from </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l00969">969</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>References <a class="el" href="system_8h_source.html#l00075">totNMax()</a>, and <a class="el" href="system_8h_source.html#l00076">totNMin()</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00054">checkpoint::load()</a>.</p>
<div class="fragment"><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                                                              {</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="keywordtype">int</span> minBound = 0, maxBound = <a class="code" href="classsim_system.html#aee2c65ecb43a35c0c4d070cdb45f7dc0">totNMax</a>() - <a class="code" href="classsim_system.html#af10842e0eaa638373b8717c87b47e6bc">totNMin</a>() + 1;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    std::vector &lt; double &gt; lb(maxBound - minBound, 0), ub(maxBound - minBound, 0), delta(maxBound - minBound, 0);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    std::string fileName = prefix+<span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    std::ifstream infile (fileName.c_str());</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordflow">if</span> (!infile.is_open()) {</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Cannot load energyHistogram from &quot;</span>+fileName);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    }</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    std::string line, tmp = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="keywordtype">int</span> lineIndex = 0;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="keywordflow">while</span>(std::getline(infile,line)) {</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        std::stringstream lineStream(line);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="keywordflow">if</span> (lineIndex == 2) {</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            <span class="comment">// get upper bound</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            std::getline(lineStream, tmp, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            std::getline(lineStream, tmp, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            <span class="keywordtype">int</span> high = atoi(tmp.c_str());</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            <span class="keywordflow">if</span> (high != <a class="code" href="classsim_system.html#aee2c65ecb43a35c0c4d070cdb45f7dc0">totNMax</a>()) {</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Max bound (&quot;</span>+ std::to_string(high)+<span class="stringliteral">&quot;) is not Nmax(&quot;</span>+std::to_string(<a class="code" href="classsim_system.html#aee2c65ecb43a35c0c4d070cdb45f7dc0">totNMax</a>())+<span class="stringliteral">&quot;), cannot restart energy histogram from &quot;</span>+fileName);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            }</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lineIndex == 3) {</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            <span class="comment">// get lower bound</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            std::getline(lineStream, tmp, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            std::getline(lineStream, tmp, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            <span class="keywordtype">int</span> low = atoi(tmp.c_str());</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            <span class="keywordflow">if</span> (low != <a class="code" href="classsim_system.html#af10842e0eaa638373b8717c87b47e6bc">totNMin</a>()) {</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Min bound (&quot;</span>+ std::to_string(low)+<span class="stringliteral">&quot;) is not Nmin(&quot;</span>+std::to_string(<a class="code" href="classsim_system.html#af10842e0eaa638373b8717c87b47e6bc">totNMin</a>())+<span class="stringliteral">&quot;), cannot restart energy histogram from &quot;</span>+fileName);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            }</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lineIndex == 6) {</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;            <span class="comment">// delta</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; maxBound-minBound; ++i) {</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                lineStream &gt;&gt; delta[i];</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            }</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lineIndex == 8) {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            <span class="comment">// lower bound</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; maxBound-minBound; ++i) {</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                lineStream &gt;&gt; lb[i];</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;            }</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;            <span class="comment">// check that system &quot;aligned&quot; the lower bounds so that a bin falls centered at U = 0</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; maxBound-minBound; ++i) {</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> x = (lb[i] - 0.0)/delta[i];</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> err = fabs(round(x) - x);</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                <span class="keywordflow">if</span> (err &gt;= 1.0e-6) {</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                    <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Energy bins not aligned to U = 0, cannot restart energy histogram from &quot;</span>+fileName+<span class="stringliteral">&quot; (err, &quot;</span>+std::to_string(i)+<span class="stringliteral">&quot;) = &quot;</span>+std::to_string(err));</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                }</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;            }</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lineIndex == 10) {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;            <span class="comment">// upper bound</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; maxBound-minBound; ++i) {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                lineStream &gt;&gt; ub[i];</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            }</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;            <span class="comment">// now can reinitialize the histogram</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = minBound; i &lt; maxBound; ++i) {</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                    energyHistogram_[i-minBound].reinitialize(lb[i-minBound], ub[i-minBound], delta[i-minBound]);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                    <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Unable to restart energy histogram from &quot;</span>+fileName);</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                }</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;            }</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lineIndex &gt;= 12) {</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            <span class="comment">// histogram itself</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;            std::deque &lt;double&gt; h = energyHistogram_[lineIndex-12].get_hist();</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            <span class="keywordflow">for</span> (std::deque &lt;double&gt;::iterator it = h.begin(); it != h.end(); ++it) {</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                lineStream &gt;&gt; *it;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;            }</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;            energyHistogram_[lineIndex-12].set_hist(h);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        }</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        lineIndex++;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    }</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    infile.close();</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;}</div>
<div class="ttc" id="classsim_system_html_af10842e0eaa638373b8717c87b47e6bc"><div class="ttname"><a href="classsim_system.html#af10842e0eaa638373b8717c87b47e6bc">simSystem::totNMin</a></div><div class="ttdeci">const int totNMin()</div><div class="ttdoc">Return lower bound on the total number of atoms in the system. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00076">system.h:76</a></div></div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
<div class="ttc" id="classsim_system_html_aee2c65ecb43a35c0c4d070cdb45f7dc0"><div class="ttname"><a href="classsim_system.html#aee2c65ecb43a35c0c4d070cdb45f7dc0">simSystem::totNMax</a></div><div class="ttdeci">const int totNMax()</div><div class="ttdoc">Return upper bound on the total number of atoms in the system. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00075">system.h:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a999556fea891765c5ed4d979706665af"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::restartExtMoments </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>prefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>ctr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Restart the extensive energy histogram for each Ntot from unnormalized checkpoint. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>Name of the file to load from </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctr</td><td>Counter for each point in the histogram </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l00742">742</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>References <a class="el" href="histogram_8cpp_source.html#l00298">histogram::getAddress()</a>, <a class="el" href="system_8h_source.html#l00078">getMaxOrder()</a>, <a class="el" href="histogram_8h_source.html#l00026">histogram::getRawHistogram()</a>, <a class="el" href="histogram_8cpp_source.html#l00360">histogram::set()</a>, <a class="el" href="system_8h_source.html#l00075">totNMax()</a>, <a class="el" href="system_8h_source.html#l00076">totNMin()</a>, and <a class="el" href="global_8h_source.html#l00170">customException::what()</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00054">checkpoint::load()</a>.</p>
<div class="fragment"><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                                                                                         {</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    std::string fileName = prefix+<span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    std::ifstream infile (fileName.c_str());</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keywordflow">if</span> (!infile.is_open()) {</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Cannot load extMoments from &quot;</span>+fileName);</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    }</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    std::string line, tmp = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="keywordtype">int</span> lineIndex = 0, dummy;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idx;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    std::vector &lt; double &gt; h = extensive_moments_.<a class="code" href="classhistogram.html#a3a75adbce72057f3a4db805d9efc3c9c">getRawHistogram</a> (), coords (6, 0);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="keywordflow">while</span>(std::getline(infile,line)) {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        std::stringstream lineStream(line);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <span class="keywordflow">if</span> (lineIndex == 1) {</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            std::getline(lineStream, tmp, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            std::getline(lineStream, tmp, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            <span class="keywordtype">int</span> ns = atoi(tmp.c_str());</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            <span class="keywordflow">if</span> (ns != nSpecies_) {</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Number of speces in restart file (&quot;</span>+ std::to_string(ns)+<span class="stringliteral">&quot;) is not the same as provided in input (&quot;</span>+std::to_string(nSpecies_)+<span class="stringliteral">&quot;), cannot restart extMom from &quot;</span>+fileName);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            }</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lineIndex == 2) {</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            std::getline(lineStream, tmp, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            std::getline(lineStream, tmp, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            <span class="keywordtype">int</span> mo = atoi(tmp.c_str());</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            <span class="keywordflow">if</span> (mo != <a class="code" href="classsim_system.html#afe08187d318113c33bda890c69570c36">getMaxOrder</a>()) {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Max order (&quot;</span>+ std::to_string(mo)+<span class="stringliteral">&quot;) is not the same as provided in input (&quot;</span>+std::to_string(<a class="code" href="classsim_system.html#afe08187d318113c33bda890c69570c36">getMaxOrder</a>())+<span class="stringliteral">&quot;), cannot restart extMom from &quot;</span>+fileName);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            }</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        } <span class="keywordflow">if</span> (lineIndex == 3) {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            std::getline(lineStream, tmp, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            std::getline(lineStream, tmp, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            <span class="keywordtype">int</span> high = atoi(tmp.c_str());</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            <span class="keywordflow">if</span> (high != <a class="code" href="classsim_system.html#aee2c65ecb43a35c0c4d070cdb45f7dc0">totNMax</a>()) {</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Max bound (&quot;</span>+ std::to_string(high)+<span class="stringliteral">&quot;) is not Nmax (&quot;</span>+std::to_string(<a class="code" href="classsim_system.html#aee2c65ecb43a35c0c4d070cdb45f7dc0">totNMax</a>())+<span class="stringliteral">&quot;), cannot restart extMom from &quot;</span>+fileName);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            }</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lineIndex == 4) {</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            std::getline(lineStream, tmp, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            std::getline(lineStream, tmp, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            <span class="keywordtype">int</span> low = atoi(tmp.c_str());</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            <span class="keywordflow">if</span> (low != <a class="code" href="classsim_system.html#af10842e0eaa638373b8717c87b47e6bc">totNMin</a>()) {</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Min bound (&quot;</span>+ std::to_string(low)+<span class="stringliteral">&quot;) is not Nmin (&quot;</span>+std::to_string(<a class="code" href="classsim_system.html#af10842e0eaa638373b8717c87b47e6bc">totNMin</a>())+<span class="stringliteral">&quot;), cannot restart extMom from &quot;</span>+fileName);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            <span class="comment">// now reinstantiate the histogram</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            std::vector &lt; double &gt; lbn (6,0), ubn(6,0);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;            std::vector &lt; long long unsigned int &gt; nbn (6,0);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            ubn[0] = nSpecies_-1;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            ubn[1] = max_order_;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            ubn[2] = nSpecies_-1;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            ubn[3] = max_order_;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            ubn[4] = max_order_;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            ubn[5] = <a class="code" href="classsim_system.html#aee2c65ecb43a35c0c4d070cdb45f7dc0">totNMax</a>()-<a class="code" href="classsim_system.html#af10842e0eaa638373b8717c87b47e6bc">totNMin</a>();</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            nbn[0] = nSpecies_;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            nbn[1] = max_order_+1;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            nbn[2] = nSpecies_;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            nbn[3] = max_order_+1;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            nbn[4] = max_order_+1;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            nbn[5] = <a class="code" href="classsim_system.html#aee2c65ecb43a35c0c4d070cdb45f7dc0">totNMax</a>()-<a class="code" href="classsim_system.html#af10842e0eaa638373b8717c87b47e6bc">totNMin</a>()+1;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            <a class="code" href="classhistogram.html">histogram</a> hnn (lbn, ubn, nbn);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            extensive_moments_ = hnn;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lineIndex &gt;= 7) {</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            <span class="comment">// histogram itself</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            lineStream &gt;&gt; dummy;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            coords[5] = lineIndex-7;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nSpecies_; ++i) {</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                coords[0] = i;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt;= max_order_; ++j) {</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                    coords[1] = j;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; nSpecies_; ++k) {</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                        coords[2] = k;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> m = 0; m &lt;= max_order_; ++m) {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                            coords[3] = m;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> p = 0; p &lt;= max_order_; ++p) {</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                                coords[4] = p;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                                idx = extensive_moments_.<a class="code" href="classhistogram.html#ae52fa58934b56e05846a66e43c3184bd">getAddress</a>(coords);</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                                lineStream &gt;&gt; h[idx];</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                            }</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                        }</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                    }</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                }</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            }</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        }</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        lineIndex++;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    }</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    infile.close();</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        <span class="comment">// this checks h and ctr same size, and by extension that h from file has same size as h in system</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        extensive_moments_.<a class="code" href="classhistogram.html#aab27615593d020ca4de29c586c92af37">set</a>(h, ctr);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    } <span class="keywordflow">catch</span> (<a class="code" href="classcustom_exception.html">customException</a> &amp;ce) {</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Unable to restart extMom from &quot;</span>+fileName+<span class="stringliteral">&quot; : &quot;</span>+ce.<a class="code" href="classcustom_exception.html#aeb6ab5848b038adfc68fde86a512f691">what</a>());</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    }</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;}</div>
<div class="ttc" id="classcustom_exception_html_aeb6ab5848b038adfc68fde86a512f691"><div class="ttname"><a href="classcustom_exception.html#aeb6ab5848b038adfc68fde86a512f691">customException::what</a></div><div class="ttdeci">const char * what() const </div><div class="ttdoc">Return the user&#39;s message. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00170">global.h:170</a></div></div>
<div class="ttc" id="classsim_system_html_af10842e0eaa638373b8717c87b47e6bc"><div class="ttname"><a href="classsim_system.html#af10842e0eaa638373b8717c87b47e6bc">simSystem::totNMin</a></div><div class="ttdeci">const int totNMin()</div><div class="ttdoc">Return lower bound on the total number of atoms in the system. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00076">system.h:76</a></div></div>
<div class="ttc" id="classhistogram_html_aab27615593d020ca4de29c586c92af37"><div class="ttname"><a href="classhistogram.html#aab27615593d020ca4de29c586c92af37">histogram::set</a></div><div class="ttdeci">void set(const std::vector&lt; double &gt; &amp;h, const std::vector&lt; double &gt; &amp;ctr)</div><div class="ttdoc">Assign the histogram and its corresponding counter. </div><div class="ttdef"><b>Definition:</b> <a href="histogram_8cpp_source.html#l00360">histogram.cpp:360</a></div></div>
<div class="ttc" id="classhistogram_html_ae52fa58934b56e05846a66e43c3184bd"><div class="ttname"><a href="classhistogram.html#ae52fa58934b56e05846a66e43c3184bd">histogram::getAddress</a></div><div class="ttdeci">const long long unsigned int getAddress(const std::vector&lt; double &gt; &amp;coords)</div><div class="ttdoc">Get the linear address of the multidimensional coordinate. </div><div class="ttdef"><b>Definition:</b> <a href="histogram_8cpp_source.html#l00298">histogram.cpp:298</a></div></div>
<div class="ttc" id="classsim_system_html_afe08187d318113c33bda890c69570c36"><div class="ttname"><a href="classsim_system.html#afe08187d318113c33bda890c69570c36">simSystem::getMaxOrder</a></div><div class="ttdeci">const int getMaxOrder()</div><div class="ttdoc">Return the max order the extensive moments are being stored out to. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00078">system.h:78</a></div></div>
<div class="ttc" id="classhistogram_html_a3a75adbce72057f3a4db805d9efc3c9c"><div class="ttname"><a href="classhistogram.html#a3a75adbce72057f3a4db805d9efc3c9c">histogram::getRawHistogram</a></div><div class="ttdeci">std::vector&lt; double &gt; getRawHistogram()</div><div class="ttdoc">Return the current histogram. </div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00026">histogram.h:26</a></div></div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
<div class="ttc" id="classhistogram_html"><div class="ttname"><a href="classhistogram.html">histogram</a></div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00014">histogram.h:14</a></div></div>
<div class="ttc" id="classsim_system_html_aee2c65ecb43a35c0c4d070cdb45f7dc0"><div class="ttname"><a href="classsim_system.html#aee2c65ecb43a35c0c4d070cdb45f7dc0">simSystem::totNMax</a></div><div class="ttdeci">const int totNMax()</div><div class="ttdoc">Return upper bound on the total number of atoms in the system. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00075">system.h:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3239a23e35f30e40eeecf8795386c164"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::restartPkHistogram </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>prefix</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Restart the particle histogram for each Ntot from unnormalized checkpoint. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">prefix</td><td>Prefix of the filename to load from </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l01136">1136</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>References <a class="el" href="system_8h_source.html#l00075">totNMax()</a>, and <a class="el" href="system_8h_source.html#l00076">totNMin()</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00054">checkpoint::load()</a>.</p>
<div class="fragment"><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                                                          {</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> spec = 0; spec &lt; nSpecies_; ++spec) {</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        <span class="keywordtype">int</span> minBound = 0, maxBound = <a class="code" href="classsim_system.html#aee2c65ecb43a35c0c4d070cdb45f7dc0">totNMax</a>() - <a class="code" href="classsim_system.html#af10842e0eaa638373b8717c87b47e6bc">totNMin</a>() + 1;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        std::vector &lt; double &gt; lb(maxBound - minBound, 0), ub(maxBound - minBound, 0), delta(maxBound - minBound, 0);</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        std::string fileName = prefix+<span class="stringliteral">&quot;_&quot;</span>+std::to_string(spec+1)+<span class="stringliteral">&quot;.dat&quot;</span>;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        std::ifstream infile (fileName.c_str());</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        <span class="keywordflow">if</span> (!infile.is_open()) {</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Cannot load pkHistogram from &quot;</span>+fileName);</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        }</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        std::string line, tmp = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        <span class="keywordtype">int</span> lineIndex = 0;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        <span class="keywordflow">while</span>(std::getline(infile,line)) {</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;            std::stringstream lineStream(line);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;            <span class="keywordflow">if</span> (lineIndex == 2) {</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                <span class="comment">// get upper bound</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                std::getline(lineStream, tmp, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                std::getline(lineStream, tmp, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                <span class="keywordtype">int</span> high = atoi(tmp.c_str());</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                <span class="keywordflow">if</span> (high != <a class="code" href="classsim_system.html#aee2c65ecb43a35c0c4d070cdb45f7dc0">totNMax</a>()) {</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                    <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Max bound (&quot;</span>+ std::to_string(high)+<span class="stringliteral">&quot;) is not Nmax(&quot;</span>+std::to_string(<a class="code" href="classsim_system.html#aee2c65ecb43a35c0c4d070cdb45f7dc0">totNMax</a>())+<span class="stringliteral">&quot;), cannot restart particle histogram from &quot;</span>+fileName);</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                }</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lineIndex == 3) {</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                <span class="comment">// get lower bound</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                std::getline(lineStream, tmp, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                std::getline(lineStream, tmp, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                <span class="keywordtype">int</span> low = atoi(tmp.c_str());</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                <span class="keywordflow">if</span> (low != <a class="code" href="classsim_system.html#af10842e0eaa638373b8717c87b47e6bc">totNMin</a>()) {</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                    <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Min bound (&quot;</span>+ std::to_string(low)+<span class="stringliteral">&quot;) is not Nmin(&quot;</span>+std::to_string(<a class="code" href="classsim_system.html#af10842e0eaa638373b8717c87b47e6bc">totNMin</a>())+<span class="stringliteral">&quot;), cannot restart particle histogram from &quot;</span>+fileName);</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                }</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lineIndex == 1) {</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                <span class="comment">// check the number of species is correct</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                std::getline(lineStream, tmp, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                std::getline(lineStream, tmp, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                <span class="keywordtype">int</span> ns = atoi(tmp.c_str());</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                <span class="keywordflow">if</span> (ns != nSpecies_) {</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                    <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Number of speces in restart file (&quot;</span>+ std::to_string(ns)+<span class="stringliteral">&quot;) is not the same as provided in input (&quot;</span>+std::to_string(nSpecies_)+<span class="stringliteral">&quot;), cannot restart particle histogram from &quot;</span>+fileName);</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                }</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lineIndex == 6) {</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                <span class="comment">// delta</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; maxBound-minBound; ++i) {</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                    lineStream &gt;&gt; delta[i];</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                }</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lineIndex == 8) {</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                <span class="comment">// lower bound</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; maxBound-minBound; ++i) {</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                    lineStream &gt;&gt; lb[i];</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                }</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lineIndex == 10) {</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                <span class="comment">// upper bound</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; maxBound-minBound; ++i) {</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                    lineStream &gt;&gt; ub[i];</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                }</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                <span class="comment">// now can reinitialize the histogram</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = minBound; i &lt; maxBound; ++i) {</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                        pkHistogram_[spec][i-minBound].reinitialize(lb[i-minBound], ub[i-minBound], delta[i-minBound]);</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                    } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Unable to restart particle histogram from &quot;</span>+fileName);</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                    }</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                }</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lineIndex &gt;= 12) {</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                <span class="comment">// histogram itself</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                std::deque &lt;double&gt; h = pkHistogram_[spec][lineIndex-12].get_hist();</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                <span class="keywordflow">for</span> (std::deque &lt;double&gt;::iterator it = h.begin(); it != h.end(); ++it) {</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                    lineStream &gt;&gt; *it;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                }</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                pkHistogram_[spec][lineIndex-12].set_hist(h);</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;            }</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;            lineIndex++;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        }</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        infile.close();</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    }</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;}</div>
<div class="ttc" id="classsim_system_html_af10842e0eaa638373b8717c87b47e6bc"><div class="ttname"><a href="classsim_system.html#af10842e0eaa638373b8717c87b47e6bc">simSystem::totNMin</a></div><div class="ttdeci">const int totNMin()</div><div class="ttdoc">Return lower bound on the total number of atoms in the system. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00076">system.h:76</a></div></div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
<div class="ttc" id="classsim_system_html_aee2c65ecb43a35c0c4d070cdb45f7dc0"><div class="ttname"><a href="classsim_system.html#aee2c65ecb43a35c0c4d070cdb45f7dc0">simSystem::totNMax</a></div><div class="ttdeci">const int totNMax()</div><div class="ttdoc">Return upper bound on the total number of atoms in the system. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00075">system.h:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a51539ed4c3bb4905b32ce428c1c537fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const double simSystem::scratchEnergy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Recalculate the energy of the system from scratch. </p>
<dl class="section return"><dt>Returns</dt><dd>totU Total energy of the system </dd></dl>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l01545">1545</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>References <a class="el" href="system_8h_source.html#l00118">atoms</a>, <a class="el" href="potentials_8h_source.html#l00014">NUM_INFINITY</a>, <a class="el" href="system_8h_source.html#l00117">numSpecies</a>, <a class="el" href="system_8h_source.html#l00119">ppot</a>, <a class="el" href="system_8h_source.html#l00120">speciesBarriers</a>, and <a class="el" href="global_8h_source.html#l00170">customException::what()</a>.</p>

<p>Referenced by <a class="el" href="system_8cpp_source.html#l01387">readConfig()</a>, and <a class="el" href="sanity_8cpp_source.html#l00008">sanityChecks()</a>.</p>
<div class="fragment"><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                                       {</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <span class="keywordtype">double</span> totU = 0.0;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    <span class="keywordtype">double</span> V = 1.0;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; box_.size(); ++i) {</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        V *= box_[i];</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    }</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> spec1 = 0; spec1 &lt; nSpecies_; ++spec1) {</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;        <span class="keywordtype">int</span> num1 = 0, adj1 = 0;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;            num1 = <a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[spec1];</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        } <span class="keywordflow">catch</span> (<a class="code" href="classcustom_exception.html">customException</a> &amp;ce) {</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;            std::string a = <span class="stringliteral">&quot;Cannot recalculate energy from scratch: &quot;</span>, b = ce.<a class="code" href="classcustom_exception.html#aeb6ab5848b038adfc68fde86a512f691">what</a>();</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (a+b);</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;        }</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;        <span class="comment">// Possibly have fractionally inserted atom</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;        <span class="keywordflow">if</span> (fractionalAtomType_ == spec1 &amp;&amp; Mcurrent_ &gt; 0) {</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;            adj1 = 1;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;        }</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        <span class="comment">// Wall/barrier interactions</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; num1+adj1; ++j) {</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;            <span class="keywordtype">double</span> dU = 0.0;</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;            <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                dU = <a class="code" href="classsim_system.html#a5ae652ff4519f39c3862abae32a9581b">speciesBarriers</a>[spec1].energy(&amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[spec1][j], box_);</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;            } <span class="keywordflow">catch</span> (<a class="code" href="classcustom_exception.html">customException</a> &amp;ce) {</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                std::string a = <span class="stringliteral">&quot;Cannot recalculate energy from scratch: &quot;</span>, b = ce.<a class="code" href="classcustom_exception.html#aeb6ab5848b038adfc68fde86a512f691">what</a>();</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (a+b);</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;            }</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;            <span class="keywordflow">if</span> (dU == <a class="code" href="potentials_8h.html#ab94ab1d09e2291d03fe92a0e24a9d33b">NUM_INFINITY</a>) {</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="potentials_8h.html#ab94ab1d09e2291d03fe92a0e24a9d33b">NUM_INFINITY</a>;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                totU += dU;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;            }</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        }</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;        <span class="comment">// Interactions with same type</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; num1+adj1; ++j) {</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = j+1; k &lt; num1+adj1; ++k) {</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;                <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                    totU += <a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>[spec1][spec1]-&gt;energy(&amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[spec1][j], &amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[spec1][k], box_);</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                } <span class="keywordflow">catch</span> (<a class="code" href="classcustom_exception.html">customException</a> &amp;ce) {</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;                    std::string a = <span class="stringliteral">&quot;Cannot recalculate energy from scratch: &quot;</span>, b = ce.<a class="code" href="classcustom_exception.html#aeb6ab5848b038adfc68fde86a512f691">what</a>();</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;                    <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (a+b);</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                }</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;            }</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;        }</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;        <span class="comment">// Add tail correction to potential energy but only for atoms fully inserted</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;<span class="preprocessor">#ifdef FLUID_PHASE_SIMULATIONS</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">if</span> ((<a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>[spec1][spec1]-&gt;useTailCorrection) &amp;&amp; (num1 &gt; 1)) {</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;            totU += (num1)*0.5*<a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>[spec1][spec1]-&gt;tailCorrection((num1-1)/V);</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;        }</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;        <span class="comment">// Interactions with other unique types</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> spec2 = spec1+1; spec2 &lt; nSpecies_; ++spec2) {</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;            <span class="keywordtype">int</span> num2 = 0, adj2 = 0;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;            <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                num2 = <a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[spec2];</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;            } <span class="keywordflow">catch</span> (<a class="code" href="classcustom_exception.html">customException</a> &amp;ce) {</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                std::string a = <span class="stringliteral">&quot;Cannot recalculate energy from scratch: &quot;</span>, b = ce.<a class="code" href="classcustom_exception.html#aeb6ab5848b038adfc68fde86a512f691">what</a>();</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (a+b);</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;            }</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;            <span class="keywordflow">if</span> (fractionalAtomType_ == spec2 &amp;&amp; Mcurrent_ &gt; 0) {</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                adj2 = 1;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;            }</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; num1+adj1; ++j) {</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; num2+adj2; ++k) {</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                        totU += <a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>[spec1][spec2]-&gt;energy(&amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[spec1][j], &amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[spec2][k], box_);</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                    } <span class="keywordflow">catch</span> (<a class="code" href="classcustom_exception.html">customException</a> &amp;ce) {</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                        std::string a = <span class="stringliteral">&quot;Cannot recalculate energy from scratch: &quot;</span>, b = ce.<a class="code" href="classcustom_exception.html#aeb6ab5848b038adfc68fde86a512f691">what</a>();</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (a+b);</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                    }</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                }</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;            }</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;            <span class="comment">// Add tail correction to potential energy but only bewteen fully inserted species</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;<span class="preprocessor">#ifdef FLUID_PHASE_SIMULATIONS</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;<span class="preprocessor"></span>            <span class="keywordflow">if</span> ((<a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>[spec1][spec2]-&gt;useTailCorrection) &amp;&amp; (num2 &gt; 0) &amp;&amp; (num1 &gt; 0)) {</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                totU += (num1)*<a class="code" href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">ppot</a>[spec1][spec2]-&gt;tailCorrection(num2/V);</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;            }</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;<span class="preprocessor"></span>        }</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    }</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <span class="keywordflow">if</span> (toggleKE_ == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;        <span class="keywordtype">double</span> ns = 0.0;</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nSpecies_; ++i) {</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;            ns += <a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[i];</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;        }</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;        totU += 1.5/beta_*ns; <span class="comment">// Only adjust for FULLY-INSERTED ATOMS</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    }</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="keywordflow">return</span> totU;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;}</div>
<div class="ttc" id="classsim_system_html_ad2e290b5963f132e6a3a56cee35c8e9f"><div class="ttname"><a href="classsim_system.html#ad2e290b5963f132e6a3a56cee35c8e9f">simSystem::ppot</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::shared_ptr&lt; pairPotential &gt; &gt; &gt; ppot</div><div class="ttdoc">Matrix of pair potentials for atom types i, j. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00119">system.h:119</a></div></div>
<div class="ttc" id="potentials_8h_html_ab94ab1d09e2291d03fe92a0e24a9d33b"><div class="ttname"><a href="potentials_8h.html#ab94ab1d09e2291d03fe92a0e24a9d33b">NUM_INFINITY</a></div><div class="ttdeci">#define NUM_INFINITY</div><div class="ttdef"><b>Definition:</b> <a href="potentials_8h_source.html#l00014">potentials.h:14</a></div></div>
<div class="ttc" id="classcustom_exception_html_aeb6ab5848b038adfc68fde86a512f691"><div class="ttname"><a href="classcustom_exception.html#aeb6ab5848b038adfc68fde86a512f691">customException::what</a></div><div class="ttdeci">const char * what() const </div><div class="ttdoc">Return the user&#39;s message. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00170">global.h:170</a></div></div>
<div class="ttc" id="classsim_system_html_a9eea865e6dc1cff377b1e79c4d9c23f0"><div class="ttname"><a href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">simSystem::numSpecies</a></div><div class="ttdeci">std::vector&lt; int &gt; numSpecies</div><div class="ttdoc">Total number of each type of atom the system contains. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00117">system.h:117</a></div></div>
<div class="ttc" id="classsim_system_html_a5ae652ff4519f39c3862abae32a9581b"><div class="ttname"><a href="classsim_system.html#a5ae652ff4519f39c3862abae32a9581b">simSystem::speciesBarriers</a></div><div class="ttdeci">std::vector&lt; compositeBarrier &gt; speciesBarriers</div><div class="ttdoc">Barriers, if any, for each species. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00120">system.h:120</a></div></div>
<div class="ttc" id="classsim_system_html_a90421b19082f7fb8fc23b7264b1161e4"><div class="ttname"><a href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">simSystem::atoms</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; atom &gt; &gt; atoms</div><div class="ttdoc">Atoms in a matrix by type, and particle index, respectively that a system CAN hold but not all are ac...</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00118">system.h:118</a></div></div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a284cf6c00f572db12db0cb263974a78a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::setELB </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>elb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Assign energy lower bound from restart. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00043">43</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00054">checkpoint::load()</a>.</p>

</div>
</div>
<a class="anchor" id="ab894de5ccd37efa97ae799f1dc1875a1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::setEUB </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>eub</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Assign energy upper bound from restart. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00042">42</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00054">checkpoint::load()</a>.</p>

</div>
</div>
<a class="anchor" id="a76b5dc3e179e275e40726c660d8e669b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::setTotNBounds </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>bounds</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the bounds on the total number of particles in a system. </p>
<p>If not set manually, this defaults to the sum of the bounds given for each individual species in the system. Therefore, for single component simulations, this is identical to [minSpecies(0), maxSpecies(0)] unless otherwise set. These bounds are intended to be used to create "windows" so that specific simulations can sample subregions of [minSpecies(0), maxSpecies(0)] and be stitched together with histogram reweighting later.</p>
<p>However, this routine will ALSO cause the system to reevaluate its bounds. If these total bounds are outside any individual bound for each atom type, nothing will change. However, if the upper bound for total atoms is less than an upper bound for a specific species, that species will have its bounds changed to match the total maximum. As a result sys.atoms can change so this routine should be called at the beginning of a simulation, never during. The total minimum will also be checked. That is, if the sum of the minimum for all species is still higher than this, an exception will be throw since the system will never reach such a low density anyway. Most likely the user has made a mistake.</p>
<p>Be sure to initialize other objects, such as biases, AFTER this routine has been called since it will adjust the allowable number of particles in the system.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bounds</td><td>Vector of [min, max] </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l00041">41</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>References <a class="el" href="system_8h_source.html#l00118">atoms</a>, and <a class="el" href="system_8h_source.html#l00117">numSpecies</a>.</p>

<p>Referenced by <a class="el" href="input_8cpp_source.html#l00037">initialize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                                                              {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">if</span> (bounds.size() != 2) {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Bounds on total N must supplied as vector of &lt;minN, maxN&gt;&quot;</span>);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">if</span> (bounds[0] &lt; 0) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Lower bound on total particles must be &gt; 0&quot;</span>);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">if</span> (bounds[0] &gt; bounds[1]) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Upper bound must be greater than lower bound for total number of particles in the system&quot;</span>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    totNBounds_ = bounds;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordtype">int</span> totMin = 0;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nSpecies_; ++i) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordflow">if</span> (maxSpecies_[i] &gt; totNBounds_[1]) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            maxSpecies_[i] = totNBounds_[1];</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordflow">if</span> (maxSpecies_[i] &lt; totNBounds_[1]) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Upper bound for species &quot;</span>+std::to_string(i+1)+<span class="stringliteral">&quot; is lower than overall max, so cannot realize possibility of system being full of this species&quot;</span>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        totMin += minSpecies_[i];</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">if</span> (totMin &gt; totNBounds_[0]) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Lower total N bound is lower than the sum of all individual lower bounds, region cannot be completely sampled&quot;</span>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">// recheck bounds and possibly resize</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordtype">int</span> tmpTot = 0;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; nSpecies_; ++i) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">if</span> (maxSpecies_[i] &lt; minSpecies_[i]) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Max species &lt; Min species&quot;</span>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[i].resize(maxSpecies_[i], <a class="code" href="classatom.html">atom</a>());</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        } <span class="keywordflow">catch</span> (std::exception &amp;e) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (e.what());</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="comment">// if numSpecies[i] above maxSpecies_[i] for some reason, destroy the atoms beyond bound</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[i] &gt; (<span class="keywordtype">int</span>)<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[i].size()) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[i] = <a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[i].size();</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        tmpTot += <a class="code" href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">numSpecies</a>[i];</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    totN_ = tmpTot;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// Allocate space for energy matrix - this will only be recorded when the system is within the specific window we are looking for</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// Because of implementation of Shen and Errington method, this syntax is the same for single and multicomponent systems</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> size = totNBounds_[1] - totNBounds_[0] + 1;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    energyHistogram_.resize(0);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    energyHistogram_lb_.resize(size, -5.0);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    energyHistogram_ub_.resize(size, 5.0);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; size; ++i) {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <a class="code" href="classdynamic__one__dim__histogram.html">dynamic_one_dim_histogram</a> dummyHist (energyHistogram_lb_[i], energyHistogram_ub_[i], energyHistDelta_);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            energyHistogram_.resize(i+1, dummyHist);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        } <span class="keywordflow">catch</span> (std::bad_alloc &amp;ba) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Out of memory for energy histogram for each Ntot&quot;</span>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    pkHistogram_.resize(0);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="classdynamic__one__dim__histogram.html">dynamic_one_dim_histogram</a> dummyPkHist (0.0, totNBounds_[1], 1.0);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        std::vector &lt; dynamic_one_dim_histogram &gt; tmp (totNBounds_[1]-totNBounds_[0]+1, dummyPkHist);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        pkHistogram_.resize(nSpecies_, tmp);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    } <span class="keywordflow">catch</span> (std::bad_alloc &amp;ba) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Out of memory for particle histogram for each Ntot&quot;</span>);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">// initialize moments</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    std::vector &lt; double &gt; lbn (6,0), ubn(6,0);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    std::vector &lt; long long unsigned int &gt; nbn (6,0);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    ubn[0] = nSpecies_-1;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    ubn[1] = max_order_;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    ubn[2] = nSpecies_-1;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    ubn[3] = max_order_;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    ubn[4] = max_order_;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    ubn[5] = totNBounds_[1]-totNBounds_[0];</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    nbn[0] = nSpecies_;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    nbn[1] = max_order_+1;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    nbn[2] = nSpecies_;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    nbn[3] = max_order_+1;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    nbn[4] = max_order_+1;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    nbn[5] = size;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="classhistogram.html">histogram</a> hnn (lbn, ubn, nbn);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    extensive_moments_ = hnn;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;}</div>
<div class="ttc" id="classdynamic__one__dim__histogram_html"><div class="ttname"><a href="classdynamic__one__dim__histogram.html">dynamic_one_dim_histogram</a></div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00041">histogram.h:41</a></div></div>
<div class="ttc" id="classsim_system_html_a9eea865e6dc1cff377b1e79c4d9c23f0"><div class="ttname"><a href="classsim_system.html#a9eea865e6dc1cff377b1e79c4d9c23f0">simSystem::numSpecies</a></div><div class="ttdeci">std::vector&lt; int &gt; numSpecies</div><div class="ttdoc">Total number of each type of atom the system contains. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00117">system.h:117</a></div></div>
<div class="ttc" id="classsim_system_html_a90421b19082f7fb8fc23b7264b1161e4"><div class="ttname"><a href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">simSystem::atoms</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; atom &gt; &gt; atoms</div><div class="ttdoc">Atoms in a matrix by type, and particle index, respectively that a system CAN hold but not all are ac...</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00118">system.h:118</a></div></div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
<div class="ttc" id="classatom_html"><div class="ttname"><a href="classatom.html">atom</a></div><div class="ttdoc">Atom class with rigid internal degrees of freedom besides its center of mass. </div><div class="ttdef"><b>Definition:</b> <a href="atom_8h_source.html#l00012">atom.h:12</a></div></div>
<div class="ttc" id="classhistogram_html"><div class="ttname"><a href="classhistogram.html">histogram</a></div><div class="ttdef"><b>Definition:</b> <a href="histogram_8h_source.html#l00014">histogram.h:14</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac689245cd8e9ddfdcd94d3871a5a5d6b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::startTMMC </td>
          <td>(</td>
          <td class="paramtype">const long long int&#160;</td>
          <td class="paramname"><em>tmmcSweepSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Mtot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start using TMMC and instantiate the bias object. </p>
<p>Start using a transition-matrix in the simulation.</p>
<p>Throws an exception if input values are illegal or there is another problem (e.g. memory).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tmmcSweepSize</td><td>Number of times each transition in the collection matrix must be visited for a "sweep" to be completed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Mtot</td><td>Total number of expanded ensemble state allowed within the system </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l01734">1734</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>References <a class="el" href="system_8h_source.html#l00112">tmmcBias</a>, <a class="el" href="system_8h_source.html#l00091">useTMMC</a>, and <a class="el" href="global_8h_source.html#l00170">customException::what()</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00054">checkpoint::load()</a>, <a class="el" href="crossover_8cpp_source.html#l00010">performCrossover()</a>, and <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>.</p>
<div class="fragment"><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;                                                                            {</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <span class="comment">// initialize the tmmc object</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;        <a class="code" href="classsim_system.html#a13173f45a1e40a5f5a3552b0ebe15b54">tmmcBias</a> = <span class="keyword">new</span> <a class="code" href="classtmmc.html">tmmc</a> (totNBounds_[1], totNBounds_[0], Mtot, <a class="code" href="classsim_system.html#a56e284a361964d0a9ce5c45f41d56ab1">tmmcSweepSize</a>, box_);</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    } <span class="keywordflow">catch</span> (<a class="code" href="classcustom_exception.html">customException</a>&amp; ce) {</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Cannot start TMMC biasing in system: &quot;</span>+std::to_string(*ce.<a class="code" href="classcustom_exception.html#aeb6ab5848b038adfc68fde86a512f691">what</a>()));</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    }</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <a class="code" href="classsim_system.html#aa474a50b6353c8897331b1ab1ce53ab1">useTMMC</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;}</div>
<div class="ttc" id="classcustom_exception_html_aeb6ab5848b038adfc68fde86a512f691"><div class="ttname"><a href="classcustom_exception.html#aeb6ab5848b038adfc68fde86a512f691">customException::what</a></div><div class="ttdeci">const char * what() const </div><div class="ttdoc">Return the user&#39;s message. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00170">global.h:170</a></div></div>
<div class="ttc" id="classsim_system_html_a56e284a361964d0a9ce5c45f41d56ab1"><div class="ttname"><a href="classsim_system.html#a56e284a361964d0a9ce5c45f41d56ab1">simSystem::tmmcSweepSize</a></div><div class="ttdeci">long long int tmmcSweepSize</div><div class="ttdoc">Size of a sweep in TMMC. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00095">system.h:95</a></div></div>
<div class="ttc" id="classsim_system_html_aa474a50b6353c8897331b1ab1ce53ab1"><div class="ttname"><a href="classsim_system.html#aa474a50b6353c8897331b1ab1ce53ab1">simSystem::useTMMC</a></div><div class="ttdeci">bool useTMMC</div><div class="ttdoc">Logical stating whether or not to use TMMC biasing. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00091">system.h:91</a></div></div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
<div class="ttc" id="classsim_system_html_a13173f45a1e40a5f5a3552b0ebe15b54"><div class="ttname"><a href="classsim_system.html#a13173f45a1e40a5f5a3552b0ebe15b54">simSystem::tmmcBias</a></div><div class="ttdeci">tmmc * tmmcBias</div><div class="ttdoc">TMMC biasing function. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00112">system.h:112</a></div></div>
<div class="ttc" id="classtmmc_html"><div class="ttname"><a href="classtmmc.html">tmmc</a></div><div class="ttdoc">Transition Matrix Monte Carlo biasing class. </div><div class="ttdef"><b>Definition:</b> <a href="bias_8h_source.html#l00024">bias.h:24</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a57af66c88ce4dc1aeb6a1cd3f14ff0bb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::startWALA </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lnF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Mtot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start using Wang-Landau and instantiate the bias object. </p>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l01717">1717</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>References <a class="el" href="system_8h_source.html#l00092">useWALA</a>, <a class="el" href="global_8h_source.html#l00170">customException::what()</a>, and <a class="el" href="system_8h_source.html#l00113">wlBias</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00054">checkpoint::load()</a>, and <a class="el" href="wala_8cpp_source.html#l00010">performWALA()</a>.</p>
<div class="fragment"><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;                                                                                           {</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    <span class="comment">// initialize the wala object</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        <a class="code" href="classsim_system.html#a6dc8d9f89dfcfa247a59bc50889c49e7">wlBias</a> = <span class="keyword">new</span> <a class="code" href="classwala.html">wala</a> (lnF, g, s, totNBounds_[1], totNBounds_[0], Mtot, box_);</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    } <span class="keywordflow">catch</span> (<a class="code" href="classcustom_exception.html">customException</a>&amp; ce) {</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Cannot start Wang-Landau biasing in system: &quot;</span>+std::to_string(*ce.<a class="code" href="classcustom_exception.html#aeb6ab5848b038adfc68fde86a512f691">what</a>()));</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    }</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    <a class="code" href="classsim_system.html#aa83b00006b3919fb6e13f1bdeadece6a">useWALA</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;}</div>
<div class="ttc" id="classcustom_exception_html_aeb6ab5848b038adfc68fde86a512f691"><div class="ttname"><a href="classcustom_exception.html#aeb6ab5848b038adfc68fde86a512f691">customException::what</a></div><div class="ttdeci">const char * what() const </div><div class="ttdoc">Return the user&#39;s message. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00170">global.h:170</a></div></div>
<div class="ttc" id="classwala_html"><div class="ttname"><a href="classwala.html">wala</a></div><div class="ttdoc">Wang-Landau biasing class. </div><div class="ttdef"><b>Definition:</b> <a href="bias_8h_source.html#l00059">bias.h:59</a></div></div>
<div class="ttc" id="classsim_system_html_aa83b00006b3919fb6e13f1bdeadece6a"><div class="ttname"><a href="classsim_system.html#aa83b00006b3919fb6e13f1bdeadece6a">simSystem::useWALA</a></div><div class="ttdeci">bool useWALA</div><div class="ttdoc">Logical stating whether or not to use Wang-Landau biasing. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00092">system.h:92</a></div></div>
<div class="ttc" id="classsim_system_html_a6dc8d9f89dfcfa247a59bc50889c49e7"><div class="ttname"><a href="classsim_system.html#a6dc8d9f89dfcfa247a59bc50889c49e7">simSystem::wlBias</a></div><div class="ttdeci">wala * wlBias</div><div class="ttdoc">WL biasing function. </div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00113">system.h:113</a></div></div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a69edcc2c27db3d4e94002ac5635e9030"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::stopTMMC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stop using TMMC and free the bias object. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00063">63</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>References <a class="el" href="system_8h_source.html#l00112">tmmcBias</a>, and <a class="el" href="system_8h_source.html#l00091">useTMMC</a>.</p>

<p>Referenced by <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>.</p>

</div>
</div>
<a class="anchor" id="ad6febde00f19ae0787771f2d1d9e391b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::stopWALA </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stop using Wang-Landau and free the bias object. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00061">61</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>References <a class="el" href="system_8h_source.html#l00092">useWALA</a>, and <a class="el" href="system_8h_source.html#l00113">wlBias</a>.</p>

<p>Referenced by <a class="el" href="crossover_8cpp_source.html#l00010">performCrossover()</a>.</p>

</div>
</div>
<a class="anchor" id="aa5853448f04712e9163174860efadefd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::toggleKE </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Toggle KE adjustment to energy setting. </p>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l00399">399</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>Referenced by <a class="el" href="input_8cpp_source.html#l00037">initialize()</a>, and <a class="el" href="input_8cpp_source.html#l00457">setConfig()</a>.</p>
<div class="fragment"><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                         {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">if</span> (toggleKE_ == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        toggleKE_ = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        toggleKE_ = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aee2c65ecb43a35c0c4d070cdb45f7dc0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int simSystem::totNMax </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return upper bound on the total number of atoms in the system. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00075">75</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>, <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>, <a class="el" href="system_8cpp_source.html#l00879">reInitializeEnergyHistogram()</a>, <a class="el" href="system_8cpp_source.html#l00969">restartEnergyHistogram()</a>, <a class="el" href="system_8cpp_source.html#l00742">restartExtMoments()</a>, and <a class="el" href="system_8cpp_source.html#l01136">restartPkHistogram()</a>.</p>

</div>
</div>
<a class="anchor" id="af10842e0eaa638373b8717c87b47e6bc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int simSystem::totNMin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return lower bound on the total number of atoms in the system. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00076">76</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>, <a class="el" href="system_8cpp_source.html#l00879">reInitializeEnergyHistogram()</a>, <a class="el" href="system_8cpp_source.html#l00969">restartEnergyHistogram()</a>, <a class="el" href="system_8cpp_source.html#l00742">restartExtMoments()</a>, <a class="el" href="system_8cpp_source.html#l01136">restartPkHistogram()</a>, and <a class="el" href="input_8cpp_source.html#l00457">setConfig()</a>.</p>

</div>
</div>
<a class="anchor" id="a22fdaceea44abd6cd021bac1ecd11890"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simSystem::translateAtom </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>typeIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>atomIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>oldPos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Translate an atom in the system. </p>
<p>Does all the bookkeeping behind the scenes. Do nothing if there is no cell list defined for the type</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">typeIndex</td><td>What type the atom is (&gt;= 0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atomIndex</td><td>Which atom <em>index</em> of type typeIndex to translate (&gt;= 0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">oldPos</td><td>Old position of the atom. The current/new position should already be stored in the atom at sys.atoms[typeIndex][atomIndex] </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="system_8cpp_source.html#l00378">378</a> of file <a class="el" href="system_8cpp_source.html">system.cpp</a>.</p>

<p>References <a class="el" href="system_8h_source.html#l00118">atoms</a>, and <a class="el" href="cell_list_8cpp_source.html#l00137">cellList::translateParticle()</a>.</p>

<p>Referenced by <a class="el" href="aggvolbias_8cpp_source.html#l00142">aggVolBias3::make()</a>, and <a class="el" href="translate_8cpp_source.html#l00010">translateParticle::make()</a>.</p>
<div class="fragment"><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                                                                                                 {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">if</span> (typeIndex &lt; nSpecies_ &amp;&amp; typeIndex &gt;= 0) {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keywordflow">if</span> (atomIndex &gt;= 0) {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            <span class="comment">// delete particle from appropriate cell list, move to new one</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;nSpecies_; i++) {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                <span class="keywordflow">if</span> (useCellList_[typeIndex][i]) {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                    <a class="code" href="classcell_list.html">cellList</a>* cl = cellListsByPairType_[typeIndex][i];</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                    cl-&gt;<a class="code" href="classcell_list.html#a0d77368abdd5a4665ca2302b9a20509b">translateParticle</a>(&amp;<a class="code" href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">atoms</a>[typeIndex][atomIndex], oldPos);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Number of those atoms in system is out of bounds, cannot translate an atom of type index &quot;</span>+std::to_string(typeIndex));</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;That species index does not exist, cannot translate the atom&quot;</span>);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;}</div>
<div class="ttc" id="classsim_system_html_a90421b19082f7fb8fc23b7264b1161e4"><div class="ttname"><a href="classsim_system.html#a90421b19082f7fb8fc23b7264b1161e4">simSystem::atoms</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; atom &gt; &gt; atoms</div><div class="ttdoc">Atoms in a matrix by type, and particle index, respectively that a system CAN hold but not all are ac...</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00118">system.h:118</a></div></div>
<div class="ttc" id="classcell_list_html"><div class="ttname"><a href="classcell_list.html">cellList</a></div><div class="ttdoc">cellList class. </div><div class="ttdef"><b>Definition:</b> <a href="cell_list_8h_source.html#l00015">cellList.h:15</a></div></div>
<div class="ttc" id="classcell_list_html_a0d77368abdd5a4665ca2302b9a20509b"><div class="ttname"><a href="classcell_list.html#a0d77368abdd5a4665ca2302b9a20509b">cellList::translateParticle</a></div><div class="ttdeci">void translateParticle(atom *, std::vector&lt; double &gt;)</div><div class="ttdef"><b>Definition:</b> <a href="cell_list_8cpp_source.html#l00137">cellList.cpp:137</a></div></div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Field Documentation</h2>
<a class="anchor" id="a90421b19082f7fb8fc23b7264b1161e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector &lt; <a class="el" href="classatom.html">atom</a> &gt; &gt; simSystem::atoms</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Atoms in a matrix by type, and particle index, respectively that a system CAN hold but not all are actually "in" the system. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00118">118</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="system_8cpp_source.html#l00241">deleteAtom()</a>, <a class="el" href="system_8cpp_source.html#l01498">getNeighborAtoms()</a>, <a class="el" href="system_8cpp_source.html#l00140">insertAtom()</a>, <a class="el" href="aggvolbias_8cpp_source.html#l00142">aggVolBias3::make()</a>, <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, <a class="el" href="translate_8cpp_source.html#l00010">translateParticle::make()</a>, <a class="el" href="swap_8cpp_source.html#l00010">swapParticles::make()</a>, <a class="el" href="system_8cpp_source.html#l01331">printSnapshot()</a>, <a class="el" href="sanity_8cpp_source.html#l00008">sanityChecks()</a>, <a class="el" href="system_8cpp_source.html#l01545">scratchEnergy()</a>, <a class="el" href="system_8cpp_source.html#l00041">setTotNBounds()</a>, <a class="el" href="system_8cpp_source.html#l00431">simSystem()</a>, and <a class="el" href="system_8cpp_source.html#l00378">translateAtom()</a>.</p>

</div>
</div>
<a class="anchor" id="a3fb5d01fd3abf49f577c050968fba9d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double simSystem::lnF_end</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Starting and ending lnF for Wang-Landau. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00100">100</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="input_8cpp_source.html#l00037">initialize()</a>, <a class="el" href="wala_8cpp_source.html#l00010">performWALA()</a>, and <a class="el" href="system_8cpp_source.html#l00431">simSystem()</a>.</p>

</div>
</div>
<a class="anchor" id="a794334e163fbeb4b4f61bcea676679ce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double simSystem::lnF_start</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="system_8h_source.html#l00100">100</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="input_8cpp_source.html#l00037">initialize()</a>, <a class="el" href="wala_8cpp_source.html#l00010">performWALA()</a>, and <a class="el" href="system_8cpp_source.html#l00431">simSystem()</a>.</p>

</div>
</div>
<a class="anchor" id="aa748f651ddd9a2bf6d88bfcab9153905"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long long int simSystem::nCrossoverVisits</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of crossovers that must occur before switching from WALA to TMMC. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00098">98</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="input_8cpp_source.html#l00037">initialize()</a>, <a class="el" href="crossover_8cpp_source.html#l00010">performCrossover()</a>, and <a class="el" href="system_8cpp_source.html#l00431">simSystem()</a>.</p>

</div>
</div>
<a class="anchor" id="a9eea865e6dc1cff377b1e79c4d9c23f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; int &gt; simSystem::numSpecies</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Total number of each type of atom the system contains. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00117">117</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="system_8cpp_source.html#l00241">deleteAtom()</a>, <a class="el" href="system_8cpp_source.html#l01498">getNeighborAtoms()</a>, <a class="el" href="system_8cpp_source.html#l00140">insertAtom()</a>, <a class="el" href="aggvolbias_8cpp_source.html#l00142">aggVolBias3::make()</a>, <a class="el" href="translate_8cpp_source.html#l00010">translateParticle::make()</a>, <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>, <a class="el" href="swap_8cpp_source.html#l00010">swapParticles::make()</a>, <a class="el" href="system_8cpp_source.html#l01331">printSnapshot()</a>, <a class="el" href="system_8cpp_source.html#l01387">readConfig()</a>, <a class="el" href="system_8cpp_source.html#l00626">recordExtMoments()</a>, <a class="el" href="system_8cpp_source.html#l01047">recordPkHistogram()</a>, <a class="el" href="sanity_8cpp_source.html#l00008">sanityChecks()</a>, <a class="el" href="system_8cpp_source.html#l01545">scratchEnergy()</a>, <a class="el" href="input_8cpp_source.html#l00457">setConfig()</a>, <a class="el" href="system_8cpp_source.html#l00041">setTotNBounds()</a>, and <a class="el" href="system_8cpp_source.html#l00431">simSystem()</a>.</p>

</div>
</div>
<a class="anchor" id="ad2e290b5963f132e6a3a56cee35c8e9f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector &lt; std::shared_ptr &lt; <a class="el" href="classpair_potential.html">pairPotential</a> &gt; &gt; &gt; simSystem::ppot</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Matrix of pair potentials for atom types i, j. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00119">119</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="system_8cpp_source.html#l01223">addPotential()</a>, <a class="el" href="input_8cpp_source.html#l00010">checkBounds()</a>, <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, <a class="el" href="translate_8cpp_source.html#l00010">translateParticle::make()</a>, <a class="el" href="swap_8cpp_source.html#l00010">swapParticles::make()</a>, <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>, <a class="el" href="system_8cpp_source.html#l01545">scratchEnergy()</a>, <a class="el" href="input_8cpp_source.html#l00322">setPairPotentials()</a>, and <a class="el" href="system_8cpp_source.html#l00431">simSystem()</a>.</p>

</div>
</div>
<a class="anchor" id="a0c81d3b606c070c801f8d86288e44391"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool simSystem::restartFromTMMC</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flags to restart from WALA or TMMC initially. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00093">93</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00014">checkpoint::checkpoint()</a>, <a class="el" href="input_8cpp_source.html#l00037">initialize()</a>, <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>, and <a class="el" href="system_8cpp_source.html#l00431">simSystem()</a>.</p>

</div>
</div>
<a class="anchor" id="a5ccdad82b3767ba21b1e4b1e36362082"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string simSystem::restartFromTMMCFile</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Files to restart from WALA or TMMC initially. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00115">115</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="input_8cpp_source.html#l00037">initialize()</a>, <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>, and <a class="el" href="system_8cpp_source.html#l00431">simSystem()</a>.</p>

</div>
</div>
<a class="anchor" id="a2b168c89742f4d64270583e7e54b2929"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool simSystem::restartFromWALA</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="system_8h_source.html#l00093">93</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="input_8cpp_source.html#l00037">initialize()</a>, <a class="el" href="wala_8cpp_source.html#l00010">performWALA()</a>, and <a class="el" href="system_8cpp_source.html#l00431">simSystem()</a>.</p>

</div>
</div>
<a class="anchor" id="afbf0b172dc35572e71ec6d27a018e2fc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string simSystem::restartFromWALAFile</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="system_8h_source.html#l00115">115</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="input_8cpp_source.html#l00037">initialize()</a>, <a class="el" href="wala_8cpp_source.html#l00010">performWALA()</a>, and <a class="el" href="system_8cpp_source.html#l00431">simSystem()</a>.</p>

</div>
</div>
<a class="anchor" id="a5ae652ff4519f39c3862abae32a9581b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classcomposite_barrier.html">compositeBarrier</a> &gt; simSystem::speciesBarriers</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Barriers, if any, for each species. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00120">120</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, <a class="el" href="translate_8cpp_source.html#l00010">translateParticle::make()</a>, <a class="el" href="swap_8cpp_source.html#l00010">swapParticles::make()</a>, <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>, <a class="el" href="system_8cpp_source.html#l01545">scratchEnergy()</a>, <a class="el" href="input_8cpp_source.html#l00616">setBarriers()</a>, and <a class="el" href="system_8cpp_source.html#l00431">simSystem()</a>.</p>

</div>
</div>
<a class="anchor" id="a13173f45a1e40a5f5a3552b0ebe15b54"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtmmc.html">tmmc</a>* simSystem::tmmcBias</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>TMMC biasing function. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00112">112</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="system_8cpp_source.html#l01755">calculateBias()</a>, <a class="el" href="system_8cpp_source.html#l01688">getTMMCBias()</a>, <a class="el" href="aggvolbias_8cpp_source.html#l00142">aggVolBias3::make()</a>, <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, <a class="el" href="translate_8cpp_source.html#l00010">translateParticle::make()</a>, <a class="el" href="swap_8cpp_source.html#l00010">swapParticles::make()</a>, <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>, <a class="el" href="system_8cpp_source.html#l01734">startTMMC()</a>, <a class="el" href="system_8h_source.html#l00063">stopTMMC()</a>, and <a class="el" href="system_8cpp_source.html#l00410">~simSystem()</a>.</p>

</div>
</div>
<a class="anchor" id="a56e284a361964d0a9ce5c45f41d56ab1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long long int simSystem::tmmcSweepSize</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Size of a sweep in TMMC. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00095">95</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="input_8cpp_source.html#l00037">initialize()</a>, <a class="el" href="checkpoint_8cpp_source.html#l00054">checkpoint::load()</a>, <a class="el" href="crossover_8cpp_source.html#l00010">performCrossover()</a>, and <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>.</p>

</div>
</div>
<a class="anchor" id="a78b107e20bcbf2f818264fa076de5db3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long long int simSystem::totalTMMCSweeps</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Total number of sweeps to perform during TMMC. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00096">96</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="input_8cpp_source.html#l00037">initialize()</a>, <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>, and <a class="el" href="system_8cpp_source.html#l00431">simSystem()</a>.</p>

</div>
</div>
<a class="anchor" id="aa474a50b6353c8897331b1ab1ce53ab1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool simSystem::useTMMC</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Logical stating whether or not to use TMMC biasing. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00091">91</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="system_8cpp_source.html#l01755">calculateBias()</a>, <a class="el" href="system_8cpp_source.html#l01688">getTMMCBias()</a>, <a class="el" href="aggvolbias_8cpp_source.html#l00142">aggVolBias3::make()</a>, <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, <a class="el" href="translate_8cpp_source.html#l00010">translateParticle::make()</a>, <a class="el" href="swap_8cpp_source.html#l00010">swapParticles::make()</a>, <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>, <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>, <a class="el" href="wala_8cpp_source.html#l00010">performWALA()</a>, <a class="el" href="system_8cpp_source.html#l00431">simSystem()</a>, <a class="el" href="system_8cpp_source.html#l01734">startTMMC()</a>, <a class="el" href="system_8h_source.html#l00063">stopTMMC()</a>, and <a class="el" href="system_8cpp_source.html#l00410">~simSystem()</a>.</p>

</div>
</div>
<a class="anchor" id="aa83b00006b3919fb6e13f1bdeadece6a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool simSystem::useWALA</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Logical stating whether or not to use Wang-Landau biasing. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00092">92</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="system_8cpp_source.html#l01755">calculateBias()</a>, <a class="el" href="system_8cpp_source.html#l01701">getWALABias()</a>, <a class="el" href="aggvolbias_8cpp_source.html#l00142">aggVolBias3::make()</a>, <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, <a class="el" href="translate_8cpp_source.html#l00010">translateParticle::make()</a>, <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>, <a class="el" href="swap_8cpp_source.html#l00010">swapParticles::make()</a>, <a class="el" href="crossover_8cpp_source.html#l00010">performCrossover()</a>, <a class="el" href="tmmc_8cpp_source.html#l00010">performTMMC()</a>, <a class="el" href="wala_8cpp_source.html#l00010">performWALA()</a>, <a class="el" href="system_8cpp_source.html#l00431">simSystem()</a>, <a class="el" href="system_8cpp_source.html#l01717">startWALA()</a>, <a class="el" href="system_8h_source.html#l00061">stopWALA()</a>, and <a class="el" href="system_8cpp_source.html#l00410">~simSystem()</a>.</p>

</div>
</div>
<a class="anchor" id="aa2e866e69ebe5fa0761894212592175a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double simSystem::wala_g</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="system_8h_source.html#l00101">101</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="input_8cpp_source.html#l00037">initialize()</a>, <a class="el" href="checkpoint_8cpp_source.html#l00054">checkpoint::load()</a>, <a class="el" href="wala_8cpp_source.html#l00010">performWALA()</a>, and <a class="el" href="system_8cpp_source.html#l00431">simSystem()</a>.</p>

</div>
</div>
<a class="anchor" id="a7cc3431bb59acca9165b044dbd07dcdc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double simSystem::wala_s</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wang-Landau g and s factors. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00101">101</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="input_8cpp_source.html#l00037">initialize()</a>, <a class="el" href="checkpoint_8cpp_source.html#l00054">checkpoint::load()</a>, <a class="el" href="wala_8cpp_source.html#l00010">performWALA()</a>, and <a class="el" href="system_8cpp_source.html#l00431">simSystem()</a>.</p>

</div>
</div>
<a class="anchor" id="a6dc8d9f89dfcfa247a59bc50889c49e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classwala.html">wala</a>* simSystem::wlBias</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>WL biasing function. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00113">113</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="system_8cpp_source.html#l01755">calculateBias()</a>, <a class="el" href="system_8cpp_source.html#l01701">getWALABias()</a>, <a class="el" href="system_8cpp_source.html#l01717">startWALA()</a>, <a class="el" href="system_8h_source.html#l00061">stopWALA()</a>, and <a class="el" href="system_8cpp_source.html#l00410">~simSystem()</a>.</p>

</div>
</div>
<a class="anchor" id="ae625e1026daee4f99f83fb73881875a1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long long int simSystem::wlSweepSize</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Size of Wang-Landau sweep. </p>

<p>Definition at line <a class="el" href="system_8h_source.html#l00097">97</a> of file <a class="el" href="system_8h_source.html">system.h</a>.</p>

<p>Referenced by <a class="el" href="input_8cpp_source.html#l00037">initialize()</a>, <a class="el" href="crossover_8cpp_source.html#l00010">performCrossover()</a>, <a class="el" href="wala_8cpp_source.html#l00010">performWALA()</a>, and <a class="el" href="system_8cpp_source.html#l00431">simSystem()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/nam4/Desktop/sandbox/FHMCSimulation/src/<a class="el" href="system_8h_source.html">system.h</a></li>
<li>/home/nam4/Desktop/sandbox/FHMCSimulation/src/<a class="el" href="system_8cpp_source.html">system.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Dec 30 2016 14:21:51 for Flat-Histogram Monte Carlo Simulation by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
