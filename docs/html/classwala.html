<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Flat-Histogram Monte Carlo Simulation: wala Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Flat-Histogram Monte Carlo Simulation
   &#160;<span id="projectnumber">v0.1.0</span>
   </div>
   <div id="projectbrief">Extensible Flat-Histogram MC code for Simple 3D Fluids</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="classes.html"><span>Data&#160;Structure&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">wala Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Wang-Landau biasing class.  
 <a href="classwala.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="bias_8h_source.html">bias.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1a4483327eb3527ecc114c075b0b0598"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#a1a4483327eb3527ecc114c075b0b0598">wala</a> ()</td></tr>
<tr class="separator:a1a4483327eb3527ecc114c075b0b0598"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0d2f33ee8226fb4306628a750ed0d14"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#ac0d2f33ee8226fb4306628a750ed0d14">wala</a> (const double <a class="el" href="classwala.html#acb8e59580d97bc3c5b9b4ff45eb6bb9a">lnF</a>, const double g, const double s, const int Nmax, const int Nmin, const int Mtot, const std::vector&lt; double &gt; box)</td></tr>
<tr class="memdesc:ac0d2f33ee8226fb4306628a750ed0d14"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wang-Landau biasing constructor.  <a href="#ac0d2f33ee8226fb4306628a750ed0d14">More...</a><br/></td></tr>
<tr class="separator:ac0d2f33ee8226fb4306628a750ed0d14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab439e3f60bea6c54522a870b9ad67acf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#ab439e3f60bea6c54522a870b9ad67acf">update</a> (const int Nval, const int Mval)</td></tr>
<tr class="memdesc:ab439e3f60bea6c54522a870b9ad67acf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the estimate of the macrostate distribution.  <a href="#ab439e3f60bea6c54522a870b9ad67acf">More...</a><br/></td></tr>
<tr class="separator:ab439e3f60bea6c54522a870b9ad67acf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae06c2f1475702ec9d1b0a243b7f34e4b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#ae06c2f1475702ec9d1b0a243b7f34e4b">iterateForward</a> ()</td></tr>
<tr class="memdesc:ae06c2f1475702ec9d1b0a243b7f34e4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This should only be called when the "flatness" criterion is met.  <a href="#ae06c2f1475702ec9d1b0a243b7f34e4b">More...</a><br/></td></tr>
<tr class="separator:ae06c2f1475702ec9d1b0a243b7f34e4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65569289fac85d0da9c336e17c9d809a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#a65569289fac85d0da9c336e17c9d809a">print</a> (const std::string fileName, const bool printH=false)</td></tr>
<tr class="memdesc:a65569289fac85d0da9c336e17c9d809a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the UN-NORMALIZED biasing function (lnPI) and possible the visted states histogram to files.  <a href="#a65569289fac85d0da9c336e17c9d809a">More...</a><br/></td></tr>
<tr class="separator:a65569289fac85d0da9c336e17c9d809a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae04916f49c11b0636e813787a3906570"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#ae04916f49c11b0636e813787a3906570">readlnPI</a> (const std::string fileName)</td></tr>
<tr class="memdesc:ae04916f49c11b0636e813787a3906570"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the macrostate distribution (biasing function) from a file.  <a href="#ae04916f49c11b0636e813787a3906570">More...</a><br/></td></tr>
<tr class="separator:ae04916f49c11b0636e813787a3906570"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b8df0fb2b7722fc4a458e527a478b6f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#a0b8df0fb2b7722fc4a458e527a478b6f">readH</a> (const std::string fileName)</td></tr>
<tr class="memdesc:a0b8df0fb2b7722fc4a458e527a478b6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the visited states histogram from a file.  <a href="#a0b8df0fb2b7722fc4a458e527a478b6f">More...</a><br/></td></tr>
<tr class="separator:a0b8df0fb2b7722fc4a458e527a478b6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d778061b12611b1a35eb3ca15038d02"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#a1d778061b12611b1a35eb3ca15038d02">setlnPI</a> (const std::vector&lt; double &gt; &amp;lnPIguess)</td></tr>
<tr class="memdesc:a1d778061b12611b1a35eb3ca15038d02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Blindly assign a guess of the macrostate distribution.  <a href="#a1d778061b12611b1a35eb3ca15038d02">More...</a><br/></td></tr>
<tr class="separator:a1d778061b12611b1a35eb3ca15038d02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add6302db96fcc45811b2944de2936525"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#add6302db96fcc45811b2944de2936525">evaluateFlatness</a> ()</td></tr>
<tr class="memdesc:add6302db96fcc45811b2944de2936525"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate if the visited states histogram is approxiamtely "flat".  <a href="#add6302db96fcc45811b2944de2936525">More...</a><br/></td></tr>
<tr class="separator:add6302db96fcc45811b2944de2936525"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6120a0549bee60f2acabf6db132ff9d9"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#a6120a0549bee60f2acabf6db132ff9d9">getAddress</a> (const int Nval, const int Mval)</td></tr>
<tr class="memdesc:a6120a0549bee60f2acabf6db132ff9d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">For multidimensional Wang-Landau biasing, get the 1D coordinate of the macrostate distribution estimate (bias) for multidimensional data.  <a href="#a6120a0549bee60f2acabf6db132ff9d9">More...</a><br/></td></tr>
<tr class="separator:a6120a0549bee60f2acabf6db132ff9d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb8e59580d97bc3c5b9b4ff45eb6bb9a"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#acb8e59580d97bc3c5b9b4ff45eb6bb9a">lnF</a> ()</td></tr>
<tr class="separator:acb8e59580d97bc3c5b9b4ff45eb6bb9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03f7b333aa0a280e78060bd9af7ec318"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#a03f7b333aa0a280e78060bd9af7ec318">getBias</a> (const int address)</td></tr>
<tr class="separator:a03f7b333aa0a280e78060bd9af7ec318"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80b00e34135eb6da4e81cd0935622fc5"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#a80b00e34135eb6da4e81cd0935622fc5">getlnPI</a> ()</td></tr>
<tr class="memdesc:a80b00e34135eb6da4e81cd0935622fc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the current estimate of the macrostate distribution.  <a href="#a80b00e34135eb6da4e81cd0935622fc5">More...</a><br/></td></tr>
<tr class="separator:a80b00e34135eb6da4e81cd0935622fc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52cec7bdf93eec7d4eefc627b71f1f65"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwala.html#a52cec7bdf93eec7d4eefc627b71f1f65">getH</a> ()</td></tr>
<tr class="memdesc:a52cec7bdf93eec7d4eefc627b71f1f65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the visited-states histogram.  <a href="#a52cec7bdf93eec7d4eefc627b71f1f65">More...</a><br/></td></tr>
<tr class="separator:a52cec7bdf93eec7d4eefc627b71f1f65"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Wang-Landau biasing class. </p>

<p>Definition at line <a class="el" href="bias_8h_source.html#l00059">59</a> of file <a class="el" href="bias_8h_source.html">bias.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a1a4483327eb3527ecc114c075b0b0598"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">wala::wala </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bias_8h_source.html#l00061">61</a> of file <a class="el" href="bias_8h_source.html">bias.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;{};</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac0d2f33ee8226fb4306628a750ed0d14"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">wala::wala </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>lnF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Mtot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>box</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wang-Landau biasing constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lnF</td><td>Factor by which the estimate of the density of states in updated each time it is visited. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">g</td><td>Factor by which lnF is reduced (multiplied) once "flatness" has been achieved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Factor by which the min(H) must be within the mean of H to be considered "flat", e.g. 0.8 &ndash;&gt; min is within 20% error of mean </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Nmax</td><td>Upper bound for total number of particles. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Nmin</td><td>Lower bound for total number of particles. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Mtot</td><td>Total number of expanded ensemble states in a system. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">box</td><td>Vector of simulation box size. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00407">407</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>References <a class="el" href="bias_8h_source.html#l00016">__BIAS_INT_TYPE__</a>, and <a class="el" href="bias_8h_source.html#l00072">lnF()</a>.</p>
<div class="fragment"><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                                                                                                                                          {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classwala.html#acb8e59580d97bc3c5b9b4ff45eb6bb9a">lnF</a> &lt; 0) {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;lnF in Wang-Landau cannot be &lt; 0&quot;</span>);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    lnF_ = <a class="code" href="classwala.html#acb8e59580d97bc3c5b9b4ff45eb6bb9a">lnF</a>;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">if</span> (g &lt;= 0 || g &gt;= 1) {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;In Wang-Landau 0 &lt; g &lt; 1&quot;</span>);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    g_ = g;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">if</span> (s &lt;= 0 || s &gt;= 1) {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;In Wang-Landau 0 &lt; s &lt; 1&quot;</span>);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    s_ = s;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">if</span> (Nmin &gt; Nmax) {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Nmin &gt; Nmax in Wang-Landau object&quot;</span>);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">if</span> (Nmin &lt; 0) {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Nmin &lt; 0 in Wang-Landau object&quot;</span>);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">if</span> (Mtot &lt; 1) {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Mtot &lt; 1 in Wang-Landau object&quot;</span>);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    Mtot_ = Mtot;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">if</span> (box.size() != 3) {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Illegal number of box dimensions in Wang-Landau&quot;</span>);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; box.size(); ++i) {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keywordflow">if</span> (box[i] &lt; 0) {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Illegal box dimensions in Wang-Landau&quot;</span>);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        }</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    box_.resize(3, 0);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    box_ = box;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <a class="code" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> size = (Nmax - Nmin + 1);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    Nmin_ = Nmin;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    Nmax_ = Nmax;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">// attempt to allocate memory for macrostate distribution matrix and initializes it all to 0</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        lnPI_.resize(size*Mtot_, 0.0);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::bad_alloc &amp;ce) {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Out of memory, cannot allocate space for macrostate distribution matrix in wala&quot;</span>);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">// initialize the visited-states histogram</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        H_.resize(size*Mtot_, 0.0);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::bad_alloc &amp;ce) {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Out of memory, cannot allocate space for visited-states histogram in wala&quot;</span>);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;}</div>
<div class="ttc" id="classwala_html_acb8e59580d97bc3c5b9b4ff45eb6bb9a"><div class="ttname"><a href="classwala.html#acb8e59580d97bc3c5b9b4ff45eb6bb9a">wala::lnF</a></div><div class="ttdeci">const double lnF()</div><div class="ttdef"><b>Definition:</b> <a href="bias_8h_source.html#l00072">bias.h:72</a></div></div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
<div class="ttc" id="bias_8h_html_a1ceb524363fcb94da0c64d297ea27438"><div class="ttname"><a href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a></div><div class="ttdeci">#define __BIAS_INT_TYPE__</div><div class="ttdoc">For biasing, need to address things with large indices. </div><div class="ttdef"><b>Definition:</b> <a href="bias_8h_source.html#l00016">bias.h:16</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="add6302db96fcc45811b2944de2936525"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool wala::evaluateFlatness </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate if the visited states histogram is approxiamtely "flat". </p>
<dl class="section return"><dt>Returns</dt><dd>Returns whether the histogram is flat or not. </dd></dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00497">497</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>References <a class="el" href="bias_8h_source.html#l00021">specExp</a>.</p>

<p>Referenced by <a class="el" href="crossover_8cpp_source.html#l00010">performCrossover()</a>, and <a class="el" href="wala_8cpp_source.html#l00010">performWALA()</a>.</p>
<div class="fragment"><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                             {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordtype">double</span> min = H_[0], lnMean = -DBL_MAX;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; H_.size() - (Mtot_-1); ++i) { <span class="comment">// insert routine prevents the sampling past N = Nmax, M = 0, so N = Nmax and M &gt; 0 are validly empty</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="keywordflow">if</span> (H_[i] &lt; min) {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            min = H_[i];</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        }</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="comment">// summing so many doubles may overrun DBL_MAX, so instead track the lnMean</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        lnMean = <a class="code" href="bias_8h.html#a9f1e113b6454173bd61677519ec34c3a">specExp</a>(lnMean, log(H_[i]));</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    lnMean -= log(H_.size() - (Mtot_-1));</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">if</span> (log(min) - lnMean &gt; log(s_)) {</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;}</div>
<div class="ttc" id="bias_8h_html_a9f1e113b6454173bd61677519ec34c3a"><div class="ttname"><a href="bias_8h.html#a9f1e113b6454173bd61677519ec34c3a">specExp</a></div><div class="ttdeci">#define specExp(a, b)</div><div class="ttdoc">Jacobi method for evaluating natural logarithm of a sum of exponentials E.g. </div><div class="ttdef"><b>Definition:</b> <a href="bias_8h_source.html#l00021">bias.h:21</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6120a0549bee60f2acabf6db132ff9d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> wala::getAddress </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Mval</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For multidimensional Wang-Landau biasing, get the 1D coordinate of the macrostate distribution estimate (bias) for multidimensional data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Nval</td><td>Total number of atoms in the system </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Mval</td><td>Current value of the expanded ensemble state of the system </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00473">473</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>Referenced by <a class="el" href="system_8cpp_source.html#l01755">calculateBias()</a>, and <a class="el" href="bias_8cpp_source.html#l00486">update()</a>.</p>
<div class="fragment"><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                                                                        {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">if</span> (Nval &gt; Nmax_ || Nval &lt; Nmin_ || Mval &lt; 0 || Mval &gt; Mtot_-1) {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;N, M out of bounds in Wang-Landau object, cannot retrieve address&quot;</span>);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">return</span> (Nval - Nmin_)*Mtot_ + Mval;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;}</div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a03f7b333aa0a280e78060bd9af7ec318"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double wala::getBias </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>address</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bias_8h_source.html#l00073">73</a> of file <a class="el" href="bias_8h_source.html">bias.h</a>.</p>

<p>Referenced by <a class="el" href="system_8cpp_source.html#l01755">calculateBias()</a>.</p>
<div class="fragment"><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;{ <span class="keywordflow">return</span> -lnPI_[address]; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a52cec7bdf93eec7d4eefc627b71f1f65"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt;double&gt; wala::getH </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the visited-states histogram. </p>

<p>Definition at line <a class="el" href="bias_8h_source.html#l00075">75</a> of file <a class="el" href="bias_8h_source.html">bias.h</a>.</p>

</div>
</div>
<a class="anchor" id="a80b00e34135eb6da4e81cd0935622fc5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt;double&gt; wala::getlnPI </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the current estimate of the macrostate distribution. </p>

<p>Definition at line <a class="el" href="bias_8h_source.html#l00074">74</a> of file <a class="el" href="bias_8h_source.html">bias.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae06c2f1475702ec9d1b0a243b7f34e4b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wala::iterateForward </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This should only be called when the "flatness" criterion is met. </p>
<p>This then resets the visited-states histogram H, and decrements lnF. </p>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00518">518</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>Referenced by <a class="el" href="crossover_8cpp_source.html#l00010">performCrossover()</a>, and <a class="el" href="wala_8cpp_source.html#l00010">performWALA()</a>.</p>
<div class="fragment"><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                           {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    lnF_ = lnF_*g_;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    std::fill(H_.begin(), H_.end(), 0);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acb8e59580d97bc3c5b9b4ff45eb6bb9a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double wala::lnF </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="bias_8h_source.html#l00072">72</a> of file <a class="el" href="bias_8h_source.html">bias.h</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00168">checkpoint::dump()</a>, <a class="el" href="crossover_8cpp_source.html#l00010">performCrossover()</a>, <a class="el" href="wala_8cpp_source.html#l00010">performWALA()</a>, and <a class="el" href="bias_8cpp_source.html#l00407">wala()</a>.</p>
<div class="fragment"><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;{ <span class="keywordflow">return</span> lnF_; }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a65569289fac85d0da9c336e17c9d809a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wala::print </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>fileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>printH</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print the UN-NORMALIZED biasing function (lnPI) and possible the visted states histogram to files. </p>
<p>Will overwrite the files if another with that name exists.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>Name of the file to print to. Will append with "_lnPI" and "_H" for the macrostate distribution and visited-states histogram, respectively. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">printH</td><td>Defaults to false, but if true will also print the visited states histogram. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00530">530</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00168">checkpoint::dump()</a>.</p>
<div class="fragment"><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                                                       {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">// Print visited-states histogram</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">if</span> (printH) {</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="comment">// print complete visited states histogram to restart / visualize progress</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        std::ofstream of;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        std::string name = fileName+<span class="stringliteral">&quot;_H.dat&quot;</span>;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        of.open(name.c_str(), std::ofstream::out);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="keywordflow">if</span> (!of.is_open()) {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Unable to write Wang-Landau visited states histogram to &quot;</span>+name);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        of &lt;&lt; <span class="stringliteral">&quot;# Visited states histogram in single row (vectorized) notation.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        of &lt;&lt; <span class="stringliteral">&quot;# species_total_upper_bound: &quot;</span> &lt;&lt; Nmax_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        of &lt;&lt; <span class="stringliteral">&quot;# species_total_lower_bound: &quot;</span> &lt;&lt; Nmin_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="keywordtype">double</span> V = box_[0]*box_[1]*box_[2];</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        of &lt;&lt; <span class="stringliteral">&quot;# volume: &quot;</span> &lt;&lt; std::setprecision(15) &lt;&lt; V &lt;&lt; std::endl;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i = 0; i &lt; H_.size(); ++i) {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            of &lt;&lt; std::setprecision(15) &lt;&lt; H_[i] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        of.close();</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="comment">// Print lnPI (bias) matrix</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    std::ofstream of;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    std::string name = fileName+<span class="stringliteral">&quot;_lnPI.dat&quot;</span>;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    of.open(name.c_str(), std::ofstream::out);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordflow">if</span> (!of.is_open()) {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Unable to write Wang-Landau lnPI histogram to &quot;</span>+name);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# lnPI (bias) matrix in single row (vectorized) notation.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# species_total_upper_bound: &quot;</span> &lt;&lt; Nmax_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# species_total_lower_bound: &quot;</span> &lt;&lt; Nmin_ &lt;&lt; std::endl;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordtype">double</span> V = box_[0]*box_[1]*box_[2];</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    of &lt;&lt; <span class="stringliteral">&quot;# volume: &quot;</span> &lt;&lt; std::setprecision(15) &lt;&lt; V &lt;&lt; std::endl;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i = 0; i &lt; lnPI_.size(); ++i) {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        of &lt;&lt; std::setprecision(15) &lt;&lt; lnPI_[i] &lt;&lt; std::endl; <span class="comment">// only ALL states for restarting purposes</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    }</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    of.close();</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;}</div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0b8df0fb2b7722fc4a458e527a478b6f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wala::readH </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>fileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read the visited states histogram from a file. </p>
<p>This assumes the user has already guaranteed that the bounds are consistent, e.g. Nmin and Nmax, as it will not check this automatically. Also assumes file was generated by this code. "Hand made" ones might have formatting issues since parsing is done based on tokens.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>Name of file containing visited states. Must include file extension. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00600">600</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00060">checkpoint::load()</a>.</p>
<div class="fragment"><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                                          {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    std::ifstream infile (fileName.c_str());</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordflow">if</span> (!infile.is_open()) {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Unable to read Wang-Landau visited states matrix  from &quot;</span>+fileName);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    std::string line;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordtype">int</span> lineIndex = 0;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">while</span>(std::getline(infile,line)) {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        std::stringstream lineStream(line);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="comment">// skip any header information</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="keywordflow">if</span> (line.compare(0,1,<span class="stringliteral">&quot;#&quot;</span>,0,1) != 0) {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            H_[lineIndex] = atof(line.c_str());</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            lineIndex++;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        }</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;}</div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae04916f49c11b0636e813787a3906570"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wala::readlnPI </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>fileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read the macrostate distribution (biasing function) from a file. </p>
<p>This assumes the user has already guaranteed that the bounds are consistent, e.g. Nmin and Nmax, as it will not check this automatically. Also assumes file was generated by this code. "Hand made" ones might have formatting issues since parsing is done based on tokens.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>Name of file containing lnPI. Must include file extension. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00576">576</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>Referenced by <a class="el" href="checkpoint_8cpp_source.html#l00060">checkpoint::load()</a>, and <a class="el" href="wala_8cpp_source.html#l00010">performWALA()</a>.</p>
<div class="fragment"><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                                             {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    std::ifstream infile (fileName.c_str());</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordflow">if</span> (!infile.is_open()) {</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="classcustom_exception.html">customException</a> (<span class="stringliteral">&quot;Unable to read Wang-Landau lnPI from &quot;</span>+fileName);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    std::string line;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordtype">int</span> lineIndex = 0;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordflow">while</span>(std::getline(infile,line)) {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        std::stringstream lineStream(line);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="comment">// skip any header information</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <span class="keywordflow">if</span> (line.compare(0,1,<span class="stringliteral">&quot;#&quot;</span>,0,1) != 0) {</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            lnPI_[lineIndex] = atof(line.c_str());</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            lineIndex++;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        }</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;}</div>
<div class="ttc" id="classcustom_exception_html"><div class="ttname"><a href="classcustom_exception.html">customException</a></div><div class="ttdoc">Error handling via custom exceptions. </div><div class="ttdef"><b>Definition:</b> <a href="global_8h_source.html#l00168">global.h:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1d778061b12611b1a35eb3ca15038d02"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void wala::setlnPI </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>lnPIguess</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Blindly assign a guess of the macrostate distribution. </p>

<p>Definition at line <a class="el" href="bias_8h_source.html#l00069">69</a> of file <a class="el" href="bias_8h_source.html">bias.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab439e3f60bea6c54522a870b9ad67acf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wala::update </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Nval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>Mval</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the estimate of the macrostate distribution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Nval</td><td>Total current number of atoms in the system </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Mval</td><td>Current value of the expanded ensemble state of the system </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="bias_8cpp_source.html#l00486">486</a> of file <a class="el" href="bias_8cpp_source.html">bias.cpp</a>.</p>

<p>References <a class="el" href="bias_8h_source.html#l00016">__BIAS_INT_TYPE__</a>, and <a class="el" href="bias_8cpp_source.html#l00473">getAddress()</a>.</p>

<p>Referenced by <a class="el" href="aggvolbias_8cpp_source.html#l00142">aggVolBias3::make()</a>, <a class="el" href="translate_8cpp_source.html#l00010">translateParticle::make()</a>, <a class="el" href="delete_8cpp_source.html#l00010">deleteParticle::make()</a>, <a class="el" href="insert_8cpp_source.html#l00010">insertParticle::make()</a>, and <a class="el" href="swap_8cpp_source.html#l00010">swapParticles::make()</a>.</p>
<div class="fragment"><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                                                 {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <a class="code" href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a> address = <a class="code" href="classwala.html#a6120a0549bee60f2acabf6db132ff9d9">getAddress</a> (Nval, Mval);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    lnPI_[address] += lnF_;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    H_[address] += 1.0;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;}</div>
<div class="ttc" id="classwala_html_a6120a0549bee60f2acabf6db132ff9d9"><div class="ttname"><a href="classwala.html#a6120a0549bee60f2acabf6db132ff9d9">wala::getAddress</a></div><div class="ttdeci">const __BIAS_INT_TYPE__ getAddress(const int Nval, const int Mval)</div><div class="ttdoc">For multidimensional Wang-Landau biasing, get the 1D coordinate of the macrostate distribution estima...</div><div class="ttdef"><b>Definition:</b> <a href="bias_8cpp_source.html#l00473">bias.cpp:473</a></div></div>
<div class="ttc" id="bias_8h_html_a1ceb524363fcb94da0c64d297ea27438"><div class="ttname"><a href="bias_8h.html#a1ceb524363fcb94da0c64d297ea27438">__BIAS_INT_TYPE__</a></div><div class="ttdeci">#define __BIAS_INT_TYPE__</div><div class="ttdoc">For biasing, need to address things with large indices. </div><div class="ttdef"><b>Definition:</b> <a href="bias_8h_source.html#l00016">bias.h:16</a></div></div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/nam4/Desktop/sandbox/FHMCSimulation/src/<a class="el" href="bias_8h_source.html">bias.h</a></li>
<li>/home/nam4/Desktop/sandbox/FHMCSimulation/src/<a class="el" href="bias_8cpp_source.html">bias.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Dec 30 2016 13:19:40 for Flat-Histogram Monte Carlo Simulation by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
